<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Rollup APIs | Elasticsearch Guide | Elastic</title>
<meta class="elastic" name="content" content="Rollup APIs | Elasticsearch Guide">

<link rel="home" href="index.html" title="Elasticsearch Guide"/>
<link rel="up" href="rest-apis.html" title="REST APIs"/>
<link rel="prev" href="repositories-metering-apis.html" title="Repositories metering APIs"/>
<link rel="next" href="search.html" title="Search APIs"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="repositories-metering-apis.html">« Repositories metering APIs</a>
</span>
<span class="next">
<a href="search.html">Search APIs »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rollup-apis"></a>Rollup APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/rollup-api.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<h3><a id="rollup-jobs-endpoint"></a>Jobs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/rollup-api.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="rollup-apis.html#rollup-put-job" title="Create rollup jobs API">Create</a> or <a class="xref" href="rollup-apis.html#rollup-delete-job" title="Delete rollup jobs API">delete rollup jobs</a>
</li>
<li class="listitem">
<a class="xref" href="rollup-apis.html#rollup-start-job" title="Start rollup jobs API">Start</a> or <a class="xref" href="rollup-apis.html#rollup-stop-job" title="Stop rollup jobs API">stop rollup jobs</a>
</li>
<li class="listitem">
<a class="xref" href="rollup-apis.html#rollup-get-job" title="Get rollup jobs API">Get rollup jobs</a>
</li>
</ul>
</div>
<h3><a id="rollup-data-endpoint"></a>Data<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/rollup-api.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="rollup-apis.html#rollup-get-rollup-caps" title="Get rollup job capabilities API">Get Rollup Capabilities</a>
</li>
<li class="listitem">
<a class="xref" href="rollup-apis.html#rollup-get-rollup-index-caps" title="Get rollup index capabilities API">Get Rollup Index Capabilities</a>
</li>
</ul>
</div>
<h3><a id="rollup-search-endpoint"></a>Search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/rollup-api.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="rollup-apis.html#rollup-search" title="Rollup search">Rollup Search</a>
</li>
</ul>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rollup-put-job"></a>Create rollup jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/put-job.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Creates a rollup job.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-put-job-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/put-job.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT _rollup/job/&lt;job_id&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-put-job-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/put-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have <code class="literal">manage</code> or
<code class="literal">manage_rollup</code> cluster privileges to use this API. For more information, see
<a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-put-job-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/put-job.asciidoc">edit</a></h3>
</div></div></div>
<p>The rollup job configuration contains all the details about how the job should
run, when it indexes documents, and what future queries will be able to execute
against the rollup index.</p>
<p>There are three main sections to the job configuration: the logistical details
about the job (cron schedule, etc), the fields that are used for grouping, and
what metrics to collect for each group.</p>
<p>Jobs are created in a <code class="literal">STOPPED</code> state. You can start them with the
<a class="xref" href="rollup-apis.html#rollup-start-job" title="Start rollup jobs API">start rollup jobs API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-put-job-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/put-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;job_id&gt;</code>
</span>
</dt>
<dd>
(Required, string) Identifier for the rollup job. This can be any
alphanumeric string and uniquely identifies the data that is associated with
the rollup job. The ID is persistent; it is stored with the rolled up data.
If you create a job, let it run for a while, then delete the job, the data
that the job rolled up is still be associated with this job ID. You cannot
create a new job with the same ID since that could lead to problems with
mismatched job configurations.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-put-job-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/put-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">cron</code>
</span>
</dt>
<dd>
(Required, string) A cron string which defines the intervals when the
rollup job should be executed. When the interval triggers, the indexer
attempts to rollup the data in the index pattern. The cron pattern is
unrelated to the time interval of the data being rolled up. For example, you
may wish to create hourly rollups of your document but to only run the indexer
on a daily basis at midnight, as defined by the cron. The cron pattern is
defined just like a Watcher cron schedule.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="rollup-groups-config"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">groups</code>
</span>
</dt>
<dd>
<p>
(Required, object) Defines the grouping fields and aggregations that are
defined for this rollup job. These fields will then be available later for
aggregating into buckets.
</p>
<p>These aggs and fields can be used in any combination. Think of the <code class="literal">groups</code>
configuration as defining a set of tools that can later be used in aggregations
to partition the data. Unlike raw data, we have to think ahead to which fields
and aggregations might be used. Rollups provide enough flexibility that you
simply need to determine <em>which</em> fields are needed, not <em>in what order</em> they are
needed.</p>
<p>There are three types of groupings currently available: <code class="literal">date_histogram</code>,
<code class="literal">histogram</code>, and <code class="literal">terms</code>.</p>
<details open>
<summary class="title">Properties of <code class="literal">groups</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">date_histogram</code>
</span>
</dt>
<dd>
<p>
(Required, object) A date histogram group aggregates a <code class="literal">date</code> field into
time-based buckets. This group is <span class="strong strong"><strong>mandatory</strong></span>; you currently cannot rollup
documents without a timestamp and a <code class="literal">date_histogram</code> group. The
<code class="literal">date_histogram</code> group has several parameters:
</p>
<details open>
<summary class="title">Properties of <code class="literal">date_histogram</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">calendar_interval</code> or <code class="literal">fixed_interval</code>
</span>
</dt>
<dd>
<p>
(Required, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) The interval of time buckets to be
generated when rolling up. For example, <code class="literal">60m</code> produces 60 minute (hourly)
rollups. This follows standard time formatting syntax as used elsewhere in Elasticsearch.
The interval defines the <em>minimum</em> interval that can be aggregated only. If
hourly (<code class="literal">60m</code>) intervals are configured, <a class="xref" href="rollup-apis.html#rollup-search" title="Rollup search">rollup search</a>
can execute aggregations with 60m or greater (weekly, monthly, etc) intervals.
So define the interval as the smallest unit that you wish to later query. For
more information about the difference between calendar and fixed time
intervals, see <a class="xref" href="search-aggregations-bucket.html#calendar_and_fixed_intervals" title="Calendar and fixed intervals">Calendar and fixed intervals</a>.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Smaller, more granular intervals take up proportionally more space.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">delay</code>
</span>
</dt>
<dd>
<p>
(Optional,<a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) How long to wait before rolling up new
documents. By default, the indexer attempts to roll up all data that is
available. However, it is not uncommon for data to arrive out of order,
sometimes even a few days late. The indexer is unable to deal with data that
arrives after a time-span has been rolled up. That is to say, there is no
provision to update already-existing rollups.
</p>
<p>Instead, you should specify a <code class="literal">delay</code> that matches the longest period of time
you expect out-of-order data to arrive. For example, a <code class="literal">delay</code> of <code class="literal">1d</code>
instructs the indexer to roll up documents up to <code class="literal">now - 1d</code>, which provides
a day of buffer time for out-of-order documents to arrive.</p>
</dd>
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string) The date field that is to be rolled up.
</dd>
<dt>
<span class="term">
<code class="literal">time_zone</code>
</span>
</dt>
<dd>
(Optional, string) Defines what time_zone the rollup documents are stored as.
Unlike raw data, which can shift timezones on the fly, rolled documents have to
be stored with a specific timezone. By default, rollup documents are stored
in <code class="literal">UTC</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">histogram</code>
</span>
</dt>
<dd>
<p>
(Optional, object) The histogram group aggregates one or more numeric fields
into numeric histogram intervals.
</p>
<details open>
<summary class="title">Properties of <code class="literal">histogram</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">fields</code>
</span>
</dt>
<dd>
(Required, array) The set of fields that you wish to build histograms for. All
fields specified must be some kind of numeric. Order does not matter.
</dd>
<dt>
<span class="term">
<code class="literal">interval</code>
</span>
</dt>
<dd>
(Required, integer) The interval of histogram buckets to be generated when
rolling up. For example, a value of <code class="literal">5</code> creates buckets that are five units wide
(<code class="literal">0-5</code>, <code class="literal">5-10</code>, etc). Note that only one interval can be specified in the
<code class="literal">histogram</code> group, meaning that all fields being grouped via the histogram
must share the same interval.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">terms</code>
</span>
</dt>
<dd>
<p>
(Optional, object) The terms group can be used on <code class="literal">keyword</code> or numeric fields to
allow bucketing via the <code class="literal">terms</code> aggregation at a later point. The indexer
enumerates and stores <em>all</em> values of a field for each time-period. This can be
potentially costly for high-cardinality groups such as IP addresses, especially
if the time-bucket is particularly sparse.
</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>While it is unlikely that a rollup will ever be larger in size than the raw
data, defining <code class="literal">terms</code> groups on multiple high-cardinality fields can
effectively reduce the compression of a rollup to a large extent. You should be
judicious which high-cardinality fields are included for that reason.</p>
</div>
</div>
<details open>
<summary class="title">Properties of <code class="literal">terms</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">fields</code>
</span>
</dt>
<dd>
(Required, string) The set of fields that you wish to collect terms for. This
array can contain fields that are both <code class="literal">keyword</code> and numerics. Order does not
matter.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">index_pattern</code>
</span>
</dt>
<dd>
<p>
(Required, string) The index or index pattern to roll up. Supports
wildcard-style patterns (<code class="literal">logstash-*</code>). The job attempts to rollup the entire
index or index-pattern.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">index_pattern</code> cannot be a pattern that would also match the
destination <code class="literal">rollup_index</code>. For example, the pattern <code class="literal">foo-*</code> would match the
rollup index <code class="literal">foo-rollup</code>. This situation would cause problems because the
rollup job would attempt to rollup its own data at runtime. If you attempt to
configure a pattern that matches the <code class="literal">rollup_index</code>, an exception occurs to
prevent this behavior.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="rollup-metrics-config"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">metrics</code>
</span>
</dt>
<dd>
<p>
(Optional, object) Defines the metrics to collect for each grouping tuple. By
default, only the doc_counts are collected for each group. To make rollup useful,
you will often add metrics like averages, mins, maxes, etc. Metrics are defined
on a per-field basis and for each field you configure which metric should be
collected.
</p>
<p>The <code class="literal">metrics</code> configuration accepts an array of objects, where each object has
two parameters.</p>
<details open>
<summary class="title">Properties of metric objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string) The field to collect metrics for. This must be a numeric of
some kind.
</dd>
<dt>
<span class="term">
<code class="literal">metrics</code>
</span>
</dt>
<dd>
(Required, array) An array of metrics to collect for the field. At least one
metric must be configured. Acceptable metrics are <code class="literal">min</code>,<code class="literal">max</code>,<code class="literal">sum</code>,<code class="literal">avg</code>, and
<code class="literal">value_count</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">page_size</code>
</span>
</dt>
<dd>
(Required, integer) The number of bucket results that are processed on each
iteration of the rollup indexer. A larger value tends to execute faster, but
requires more memory during processing. This value has no effect on how the data
is rolled up; it is merely used for tweaking the speed or memory cost of
the indexer.
</dd>
<dt>
<span class="term">
<code class="literal">rollup_index</code>
</span>
</dt>
<dd>
(Required, string) The index that contains the rollup results. The index can
be shared with other rollup jobs. The data is stored so that it doesn&#8217;t
interfere with unrelated jobs.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-put-job-api-example"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/put-job.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example creates a rollup job named <code class="literal">sensor</code>, targeting the
<code class="literal">sensor-*</code> index pattern:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _rollup/job/sensor
{
  "index_pattern": "sensor-*",
  "rollup_index": "sensor_rollup",
  "cron": "*/30 * * * * ?",
  "page_size": 1000,
  "groups": { <a id="CO657-1"></a><i class="conum" data-value="1"></i>
    "date_histogram": {
      "field": "timestamp",
      "fixed_interval": "1h",
      "delay": "7d"
    },
    "terms": {
      "fields": [ "node" ]
    }
  },
  "metrics": [ <a id="CO657-2"></a><i class="conum" data-value="2"></i>
      {
      "field": "temperature",
      "metrics": [ "min", "max", "sum" ]
    },
    {
      "field": "voltage",
      "metrics": [ "avg" ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2124.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO657-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This configuration enables date histograms to be used on the <code class="literal">timestamp</code>
field and <code class="literal">terms</code> aggregations to be used on the <code class="literal">node</code> field.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO657-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This configuration defines metrics over two fields: <code class="literal">temperature</code> and
<code class="literal">voltage</code>. For the <code class="literal">temperature</code> field, we are collecting the min, max, and
sum of the temperature. For <code class="literal">voltage</code>, we are collecting the average.</p>
</td>
</tr>
</table>
</div>
<p>When the job is created, you receive the following results:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "acknowledged": true
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rollup-delete-job"></a>Delete rollup jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/delete-job.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Deletes an existing rollup job.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-delete-job-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/delete-job.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE _rollup/job/&lt;job_id&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-delete-job-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/delete-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have <code class="literal">manage</code> or
<code class="literal">manage_rollup</code> cluster privileges to use this API. For more information, see
<a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-delete-job-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/delete-job.asciidoc">edit</a></h3>
</div></div></div>
<p>A job must be <span class="strong strong"><strong>stopped</strong></span> first before it can be deleted. If you attempt to delete
a started job, an error occurs. Similarly, if you attempt to delete a
nonexistent job, an exception occurs.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>When a job is deleted, that only removes the process that is actively monitoring
and rolling up data. It does not delete any previously rolled up data. This is
by design; a user may wish to roll up a static dataset. Because the dataset is
static, once it has been fully rolled up there is no need to keep the indexing
rollup job around (as there will be no new data). So the job can be deleted,
leaving behind the rolled up data for analysis.</p>
<p>If you wish to also remove the rollup data, and the rollup index only contains
the data for a single job, you can simply delete the whole rollup index. If the
rollup index stores data from several jobs, you must issue a delete-by-query
that targets the rollup job&#8217;s ID in the rollup index.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">POST my_rollup_index/_delete_by_query
{
  "query": {
    "term": {
      "_rollup.id": "the_rollup_job_id"
    }
  }
}</pre>
</div>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-delete-job-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/delete-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;job_id&gt;</code>
</span>
</dt>
<dd>
(Required, string) Identifier for the job.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-delete-job-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/delete-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">404</code> (Missing resources)
</span>
</dt>
<dd>
This code indicates that there are no resources that match the request. It
occurs if you try to delete a job that doesn&#8217;t exist.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-delete-job-example"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/delete-job.asciidoc">edit</a></h3>
</div></div></div>
<p>If we have a rollup job named <code class="literal">sensor</code>, it can be deleted with:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE _rollup/job/sensor</pre>
</div>
<div class="console_widget" data-snippet="snippets/2125.console"></div>
<p>Which will return the response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "acknowledged": true
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rollup-get-job"></a>Get rollup jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/get-job.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves the configuration, stats, and status of rollup jobs.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-job-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/get-job.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET _rollup/job/&lt;job_id&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-job-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/get-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have <code class="literal">monitor</code>,
<code class="literal">monitor_rollup</code>, <code class="literal">manage</code> or <code class="literal">manage_rollup</code> cluster privileges to use this API.
For more information, see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-job-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/get-job.asciidoc">edit</a></h3>
</div></div></div>
<p>The API can return the details for a single rollup job or for all rollup jobs.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API returns only active (both <code class="literal">STARTED</code> and <code class="literal">STOPPED</code>) jobs. If a job
was created, ran for a while then deleted, this API does not return any details
about that job.</p>
</div>
</div>
<p>For details about a historical rollup job, the
<a class="xref" href="rollup-apis.html#rollup-get-rollup-caps" title="Get rollup job capabilities API">rollup capabilities API</a> may be more useful.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-job-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/get-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;job_id&gt;</code>
</span>
</dt>
<dd>
(Optional, string) Identifier for the rollup job. If it is <code class="literal">_all</code> or omitted,
 the API returns all rollup jobs.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-job-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/get-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">jobs</code>
</span>
</dt>
<dd>
<p>
(array) An array of rollup job resources.
</p>
<details open>
<summary class="title">Properties of rollup job resources</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">config</code>
</span>
</dt>
<dd>
(object) Contains the configuration for the rollup job. This information is
identical to the configuration that was supplied when creating the job via the
<a class="xref" href="rollup-apis.html#rollup-put-job" title="Create rollup jobs API">create job API</a>.
</dd>
<dt>
<span class="term">
<code class="literal">stats</code>
</span>
</dt>
<dd>
(object) Contains transient statistics about the rollup job, such as how many
documents have been processed and how many rollup summary docs have been
indexed. These stats are not persisted. If a node is restarted, these stats are
reset.
</dd>
<dt>
<span class="term">
<code class="literal">status</code>
</span>
</dt>
<dd>
<p>
(object) Contains the current status of the indexer for the rollup job. The
possible values and their meanings are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">stopped</code> means the indexer is paused and will not process data, even if its
cron interval triggers.
</li>
<li class="listitem">
<code class="literal">started</code> means the indexer is running, but not actively indexing data. When
the cron interval triggers, the job&#8217;s indexer will begin to process data.
</li>
<li class="listitem">
<code class="literal">indexing</code> means the indexer is actively processing data and creating new
rollup documents. When in this state, any subsequent cron interval triggers will
be ignored because the job is already active with the prior trigger.
</li>
<li class="listitem">
<code class="literal">abort</code> is a transient state, which is usually not witnessed by the user. It
is used if the task needs to be shut down for some reason (job has been deleted,
an unrecoverable error has been encountered, etc).  Shortly after the <code class="literal">abort</code>
state is set, the job will remove itself from the cluster.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-job-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/get-job.asciidoc">edit</a></h3>
</div></div></div>
<p>If we have already created a rollup job named <code class="literal">sensor</code>, the details about the
job can be retrieved with:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _rollup/job/sensor</pre>
</div>
<div class="console_widget" data-snippet="snippets/2126.console"></div>
<p>The API yields the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "jobs": [
    {
      "config": {
        "id": "sensor",
        "index_pattern": "sensor-*",
        "rollup_index": "sensor_rollup",
        "cron": "*/30 * * * * ?",
        "groups": {
          "date_histogram": {
            "fixed_interval": "1h",
            "delay": "7d",
            "field": "timestamp",
            "time_zone": "UTC"
          },
          "terms": {
            "fields": [
              "node"
            ]
          }
        },
        "metrics": [
          {
            "field": "temperature",
            "metrics": [
              "min",
              "max",
              "sum"
            ]
          },
          {
            "field": "voltage",
            "metrics": [
              "avg"
            ]
          }
        ],
        "timeout": "20s",
        "page_size": 1000
      },
      "status": {
        "job_state": "stopped",
        "upgraded_doc_id": true
      },
      "stats": {
        "pages_processed": 0,
        "documents_processed": 0,
        "rollups_indexed": 0,
        "trigger_count": 0,
        "index_failures": 0,
        "index_time_in_ms": 0,
        "index_total": 0,
        "search_failures": 0,
        "search_time_in_ms": 0,
        "search_total": 0,
        "processing_time_in_ms": 0,
        "processing_total": 0
      }
    }
  ]
}</pre>
</div>
<p>The <code class="literal">jobs</code> array contains a single job (<code class="literal">id: sensor</code>) since we requested a single job in the endpoint&#8217;s URL.
If we add another job, we can see how multi-job responses are handled:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _rollup/job/sensor2 <a id="CO658-1"></a><i class="conum" data-value="1"></i>
{
  "index_pattern": "sensor-*",
  "rollup_index": "sensor_rollup",
  "cron": "*/30 * * * * ?",
  "page_size": 1000,
  "groups": {
    "date_histogram": {
      "field": "timestamp",
      "fixed_interval": "1h",
      "delay": "7d"
    },
    "terms": {
      "fields": [ "node" ]
    }
  },
  "metrics": [
    {
      "field": "temperature",
      "metrics": [ "min", "max", "sum" ]
    },
    {
      "field": "voltage",
      "metrics": [ "avg" ]
    }
  ]
}

GET _rollup/job/_all <a id="CO658-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="console_widget" data-snippet="snippets/2127.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO658-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>We create a second job with name <code class="literal">sensor2</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO658-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Then request all jobs by using <code class="literal">_all</code> in the GetJobs API</p>
</td>
</tr>
</table>
</div>
<p>Which will yield the following response:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "jobs": [
    {
      "config": {
        "id": "sensor2",
        "index_pattern": "sensor-*",
        "rollup_index": "sensor_rollup",
        "cron": "*/30 * * * * ?",
        "groups": {
          "date_histogram": {
            "fixed_interval": "1h",
            "delay": "7d",
            "field": "timestamp",
            "time_zone": "UTC"
          },
          "terms": {
            "fields": [
              "node"
            ]
          }
        },
        "metrics": [
          {
            "field": "temperature",
            "metrics": [
              "min",
              "max",
              "sum"
            ]
          },
          {
            "field": "voltage",
            "metrics": [
              "avg"
            ]
          }
        ],
        "timeout": "20s",
        "page_size": 1000
      },
      "status": {
        "job_state": "stopped",
        "upgraded_doc_id": true
      },
      "stats": {
        "pages_processed": 0,
        "documents_processed": 0,
        "rollups_indexed": 0,
        "trigger_count": 0,
        "index_failures": 0,
        "index_time_in_ms": 0,
        "index_total": 0,
        "search_failures": 0,
        "search_time_in_ms": 0,
        "search_total": 0,
        "processing_time_in_ms": 0,
        "processing_total": 0
      }
    },
    {
      "config": {
        "id": "sensor",
        "index_pattern": "sensor-*",
        "rollup_index": "sensor_rollup",
        "cron": "*/30 * * * * ?",
        "groups": {
          "date_histogram": {
            "fixed_interval": "1h",
            "delay": "7d",
            "field": "timestamp",
            "time_zone": "UTC"
          },
          "terms": {
            "fields": [
              "node"
            ]
          }
        },
        "metrics": [
          {
            "field": "temperature",
            "metrics": [
              "min",
              "max",
              "sum"
            ]
          },
          {
            "field": "voltage",
            "metrics": [
              "avg"
            ]
          }
        ],
        "timeout": "20s",
        "page_size": 1000
      },
      "status": {
        "job_state": "stopped",
        "upgraded_doc_id": true
      },
      "stats": {
        "pages_processed": 0,
        "documents_processed": 0,
        "rollups_indexed": 0,
        "trigger_count": 0,
        "index_failures": 0,
        "index_time_in_ms": 0,
        "index_total": 0,
        "search_failures": 0,
        "search_time_in_ms": 0,
        "search_total": 0,
        "processing_time_in_ms": 0,
        "processing_total": 0
      }
    }
  ]
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rollup-get-rollup-caps"></a>Get rollup job capabilities API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-caps.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Returns the capabilities of any rollup jobs that have been configured for a
specific index or index pattern.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-caps-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-caps.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET _rollup/data/&lt;index&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-caps-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-caps.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have <code class="literal">monitor</code>,
<code class="literal">monitor_rollup</code>, <code class="literal">manage</code> or <code class="literal">manage_rollup</code> cluster privileges to use this API.
For more information, see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-caps-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-caps.asciidoc">edit</a></h3>
</div></div></div>
<p>This API is useful because a rollup job is often configured to rollup only a
subset of fields from the source index. Furthermore, only certain aggregations
can be configured for various fields, leading to a limited subset of
functionality depending on that configuration.</p>
<p>This API enables you to inspect an index and determine:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Does this index have associated rollup data somewhere in the cluster?
</li>
<li class="listitem">
If yes to the first question, what fields were rolled up, what aggregations
can be performed, and where does the data live?
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-caps.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;index&gt;</code>
</span>
</dt>
<dd>
(string) Index, indices or index-pattern to return rollup capabilities for.
<code class="literal">_all</code> may be used to fetch rollup capabilities from all jobs.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-caps.asciidoc">edit</a></h3>
</div></div></div>
<p>Imagine we have an index named <code class="literal">sensor-1</code> full of raw data.  We know that the
data will grow over time, so there will be a <code class="literal">sensor-2</code>, <code class="literal">sensor-3</code>, etc.  Let&#8217;s
create a rollup job that targets the index pattern <code class="literal">sensor-*</code> to accommodate
this future scaling:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _rollup/job/sensor
{
  "index_pattern": "sensor-*",
  "rollup_index": "sensor_rollup",
  "cron": "*/30 * * * * ?",
  "page_size": 1000,
  "groups": {
    "date_histogram": {
      "field": "timestamp",
      "fixed_interval": "1h",
      "delay": "7d"
    },
    "terms": {
      "fields": [ "node" ]
    }
  },
  "metrics": [
    {
      "field": "temperature",
      "metrics": [ "min", "max", "sum" ]
    },
    {
      "field": "voltage",
      "metrics": [ "avg" ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2128.console"></div>
<p>We can then retrieve the rollup capabilities of that index pattern (<code class="literal">sensor-*</code>)
via the following command:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _rollup/data/sensor-*</pre>
</div>
<div class="console_widget" data-snippet="snippets/2129.console"></div>
<p>Which will yield the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "sensor-*" : {
    "rollup_jobs" : [
      {
        "job_id" : "sensor",
        "rollup_index" : "sensor_rollup",
        "index_pattern" : "sensor-*",
        "fields" : {
          "node" : [
            {
              "agg" : "terms"
            }
          ],
          "temperature" : [
            {
              "agg" : "min"
            },
            {
              "agg" : "max"
            },
            {
              "agg" : "sum"
            }
          ],
          "timestamp" : [
            {
              "agg" : "date_histogram",
              "time_zone" : "UTC",
              "fixed_interval" : "1h",
              "delay": "7d"
            }
          ],
          "voltage" : [
            {
              "agg" : "avg"
            }
          ]
        }
      }
    ]
  }
}</pre>
</div>
<p>The response that is returned contains information that is similar to the
original rollup configuration, but formatted differently.  First, there are some
house-keeping details: the rollup job ID, the index that holds the rolled data,
and the index pattern that the job was targeting.</p>
<p>Next it shows a list of fields that contain data eligible for rollup searches.
Here we see four fields: <code class="literal">node</code>, <code class="literal">temperature</code>, <code class="literal">timestamp</code> and <code class="literal">voltage</code>. Each
of these fields list the aggregations that are possible. For example, you can
use a min, max or sum aggregation on the <code class="literal">temperature</code> field, but only a
<code class="literal">date_histogram</code> on <code class="literal">timestamp</code>.</p>
<p>Note that the <code class="literal">rollup_jobs</code> element is an array; there can be multiple,
independent jobs configured for a single index or index pattern. Each of these
jobs may have different configurations, so the API returns a list of all the
various configurations available.</p>
<p>We could also retrieve the same information with a request to <code class="literal">_all</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _rollup/data/_all</pre>
</div>
<div class="console_widget" data-snippet="snippets/2130.console"></div>
<p>But note that if we use the concrete index name (<code class="literal">sensor-1</code>), we&#8217;ll retrieve no
rollup capabilities:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _rollup/data/sensor-1</pre>
</div>
<div class="console_widget" data-snippet="snippets/2131.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{

}</pre>
</div>
<p>Why is this?  The original rollup job was configured against a specific index
pattern (<code class="literal">sensor-*</code>) not a concrete index (<code class="literal">sensor-1</code>).  So while the index
belongs to the pattern, the rollup job is only valid across the entirety of
the pattern not just one of it&#8217;s containing indices. So for that reason, the
get rollup capabilities API only returns information based on the originally
configured index name or pattern.</p>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rollup-get-rollup-index-caps"></a>Get rollup index capabilities API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-index-caps.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Returns the rollup capabilities of all jobs inside of a rollup index (e.g. the
index where rollup data is stored).</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-index-caps-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-index-caps.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET &lt;target&gt;/_rollup/data</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-index-caps-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-index-caps.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">read</code> index
privilege on the index that stores the rollup results. For more information, see
<a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-index-caps-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-index-caps.asciidoc">edit</a></h3>
</div></div></div>
<p>A single rollup index may store the data for multiple rollup jobs, and may
have a variety of capabilities depending on those jobs.</p>
<p>This API will allow you to determine:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
What jobs are stored in an index (or indices specified via a pattern)?
</li>
<li class="listitem">
What target indices were rolled up, what fields were used in those rollups
and what aggregations can be performed on each job?
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-index-caps-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-index-caps.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;target&gt;</code>
</span>
</dt>
<dd>
(Required, string) Data stream or index to check for rollup capabilities.
Wildcard (<code class="literal">*</code>) expressions are supported.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-get-rollup-index-caps-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-index-caps.asciidoc">edit</a></h3>
</div></div></div>
<p>Imagine we have an index named <code class="literal">sensor-1</code> full of raw data.  We know that the
data will grow over time, so there will be a <code class="literal">sensor-2</code>, <code class="literal">sensor-3</code>, etc.
Let&#8217;s create a rollup job that stores its data in <code class="literal">sensor_rollup</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _rollup/job/sensor
{
  "index_pattern": "sensor-*",
  "rollup_index": "sensor_rollup",
  "cron": "*/30 * * * * ?",
  "page_size": 1000,
  "groups": {
    "date_histogram": {
      "field": "timestamp",
      "fixed_interval": "1h",
      "delay": "7d"
    },
    "terms": {
      "fields": [ "node" ]
    }
  },
  "metrics": [
    {
      "field": "temperature",
      "metrics": [ "min", "max", "sum" ]
    },
    {
      "field": "voltage",
      "metrics": [ "avg" ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2132.console"></div>
<p>If at a later date, we&#8217;d like to determine what jobs and capabilities were
stored in the <code class="literal">sensor_rollup</code> index, we can use the get rollup index API:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /sensor_rollup/_rollup/data</pre>
</div>
<div class="console_widget" data-snippet="snippets/2133.console"></div>
<p>Note how we are requesting the concrete rollup index name (<code class="literal">sensor_rollup</code>) as
the first part of the URL. This  will yield the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "sensor_rollup" : {
    "rollup_jobs" : [
      {
        "job_id" : "sensor",
        "rollup_index" : "sensor_rollup",
        "index_pattern" : "sensor-*",
        "fields" : {
          "node" : [
            {
              "agg" : "terms"
            }
          ],
          "temperature" : [
            {
              "agg" : "min"
            },
            {
              "agg" : "max"
            },
            {
              "agg" : "sum"
            }
          ],
          "timestamp" : [
            {
              "agg" : "date_histogram",
              "time_zone" : "UTC",
              "fixed_interval" : "1h",
              "delay": "7d"
            }
          ],
          "voltage" : [
            {
              "agg" : "avg"
            }
          ]
        }
      }
    ]
  }
}</pre>
</div>
<p>The response that is returned contains information that is similar to the
original rollup configuration, but formatted differently. First, there are some
house-keeping details: the rollup job ID, the index that holds the rolled data,
the index pattern that the job was targeting.</p>
<p>Next it shows a list of fields that contain data eligible for rollup searches.
Here we see four fields: <code class="literal">node</code>, <code class="literal">temperature</code>, <code class="literal">timestamp</code> and <code class="literal">voltage</code>. Each
of these fields list the aggregations that are possible. For example, you can
use a min, max, or sum aggregation on the <code class="literal">temperature</code> field, but only a
<code class="literal">date_histogram</code> on <code class="literal">timestamp</code>.</p>
<p>Note that the <code class="literal">rollup_jobs</code> element is an array; there can be multiple,
independent jobs configured for a single index or index pattern. Each of these
jobs may have different configurations, so the API returns a list of all the
various configurations available.</p>
<p>Like other APIs that interact with indices, you can specify index patterns
instead of explicit indices:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /*_rollup/_rollup/data</pre>
</div>
<div class="console_widget" data-snippet="snippets/2134.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rollup-search"></a>Rollup search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-search.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Enables searching rolled-up data using the standard query DSL.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-search-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-search.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET &lt;target&gt;/_rollup_search</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-search-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-search.asciidoc">edit</a></h3>
</div></div></div>
<p>The rollup search endpoint is needed because, internally, rolled-up documents
utilize a different document structure than the original data. The rollup search
endpoint rewrites standard query DSL into a format that matches the rollup
documents, then takes the response and rewrites it back to what a client would
expect given the original query.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-search-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-search.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;target&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string)
Comma-separated list of data streams and indices used to limit
the request. Wildcard expressions (<code class="literal">*</code>) are supported.</p>
<p>This target can include both rollup and non-rollup indices.</p>
<p>Rules for the <code class="literal">&lt;target&gt;</code> parameter:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
At least one data stream, index, or wildcard expression must be specified.
This target can include a rollup or non-rollup index. For data streams, the
stream&#8217;s backing indices can only serve as non-rollup indices. Omitting the
<code class="literal">&lt;target&gt;</code> parameter or using <code class="literal">_all</code> is not permitted.
</li>
<li class="listitem">
Multiple non-rollup indices may be specified.
</li>
<li class="listitem">
Only one rollup index may be specified. If more than one are supplied, an
exception occurs.
</li>
<li class="listitem">
Wildcard expressions may be used, but, if they match more than one rollup index, an
exception occurs. However, you can use an expression to match multiple non-rollup
indices or data streams.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-search-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-search.asciidoc">edit</a></h3>
</div></div></div>
<p>The request body supports a subset of features from the regular Search API. It
supports:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">query</code> param for specifying an DSL query, subject to some limitations
(see <a class="xref" href="xpack-rollup.html#rollup-search-limitations" title="Rollup search limitations">Rollup search limitations</a> and <a class="xref" href="xpack-rollup.html#rollup-agg-limitations" title="Rollup aggregation limitations">Rollup aggregation limitations</a>
</li>
<li class="listitem">
<code class="literal">aggregations</code> param for specifying aggregations
</li>
</ul>
</div>
<p>Functionality that is not available:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">size</code>: Because rollups work on pre-aggregated data, no search hits can be
returned and so size must be set to zero or omitted entirely.
</li>
<li class="listitem">
<code class="literal">highlighter</code>, <code class="literal">suggestors</code>, <code class="literal">post_filter</code>, <code class="literal">profile</code>, <code class="literal">explain</code>: These are
similarly disallowed.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-search-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-search.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_historical_only_search_example"></a>Historical-only search example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-search.asciidoc">edit</a></h4>
</div></div></div>
<p>Imagine we have an index named <code class="literal">sensor-1</code> full of raw data, and we have created
a rollup job with the following configuration:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _rollup/job/sensor
{
  "index_pattern": "sensor-*",
  "rollup_index": "sensor_rollup",
  "cron": "*/30 * * * * ?",
  "page_size": 1000,
  "groups": {
    "date_histogram": {
      "field": "timestamp",
      "fixed_interval": "1h",
      "delay": "7d"
    },
    "terms": {
      "fields": [ "node" ]
    }
  },
  "metrics": [
    {
      "field": "temperature",
      "metrics": [ "min", "max", "sum" ]
    },
    {
      "field": "voltage",
      "metrics": [ "avg" ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2135.console"></div>
<p>This rolls up the <code class="literal">sensor-*</code> pattern and stores the results in <code class="literal">sensor_rollup</code>.
To search this rolled up data, we need to use the <code class="literal">_rollup_search</code> endpoint.
However, you&#8217;ll notice that we can use regular query DSL to search the rolled-up
data:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /sensor_rollup/_rollup_search
{
  "size": 0,
  "aggregations": {
    "max_temperature": {
      "max": {
        "field": "temperature"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2136.console"></div>
<p>The query is targeting the <code class="literal">sensor_rollup</code> data, since this contains the rollup
data as configured in the job. A <code class="literal">max</code> aggregation has been used on the
<code class="literal">temperature</code> field, yielding the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took" : 102,
  "timed_out" : false,
  "terminated_early" : false,
  "_shards" : ... ,
  "hits" : {
    "total" : {
        "value": 0,
        "relation": "eq"
    },
    "max_score" : 0.0,
    "hits" : [ ]
  },
  "aggregations" : {
    "max_temperature" : {
      "value" : 202.0
    }
  }
}</pre>
</div>
<p>The response is exactly as you&#8217;d expect from a regular query + aggregation; it
provides some metadata about the request (<code class="literal">took</code>, <code class="literal">_shards</code>, etc), the search
hits (which is always empty for rollup searches), and the aggregation response.</p>
<p>Rollup searches are limited to functionality that was configured in the
rollup job. For example, we are not able to calculate the average temperature
because <code class="literal">avg</code> was not one of the configured metrics for the <code class="literal">temperature</code> field.
If we try to execute that search:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET sensor_rollup/_rollup_search
{
  "size": 0,
  "aggregations": {
    "avg_temperature": {
      "avg": {
        "field": "temperature"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2137.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "error": {
    "root_cause": [
      {
        "type": "illegal_argument_exception",
        "reason": "There is not a rollup job that has a [avg] agg with name [avg_temperature] which also satisfies all requirements of query.",
        "stack_trace": ...
      }
    ],
    "type": "illegal_argument_exception",
    "reason": "There is not a rollup job that has a [avg] agg with name [avg_temperature] which also satisfies all requirements of query.",
    "stack_trace": ...
  },
  "status": 400
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_searching_both_historical_rollup_and_non_rollup_data"></a>Searching both historical rollup and non-rollup data<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/rollup-search.asciidoc">edit</a></h4>
</div></div></div>
<p>The rollup search API has the capability to search across both "live"
non-rollup data and the aggregated rollup data. This is done by simply adding
the live indices to the URI:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET sensor-1,sensor_rollup/_rollup_search <a id="CO659-1"></a><i class="conum" data-value="1"></i>
{
  "size": 0,
  "aggregations": {
    "max_temperature": {
      "max": {
        "field": "temperature"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2138.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO659-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Note the URI now searches <code class="literal">sensor-1</code> and <code class="literal">sensor_rollup</code> at the same time</p>
</td>
</tr>
</table>
</div>
<p>When the search is executed, the rollup search endpoint does two things:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
The original request is sent to the non-rollup index unaltered.
</li>
<li class="listitem">
A rewritten version of the original request is sent to the rollup index.
</li>
</ol>
</div>
<p>When the two responses are received, the endpoint rewrites the rollup response
and merges the two together. During the merging process, if there is any overlap
in buckets between the two responses, the buckets from the non-rollup index are
used.</p>
<p>The response to the above query looks as expected, despite spanning rollup and
non-rollup indices:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took" : 102,
  "timed_out" : false,
  "terminated_early" : false,
  "_shards" : ... ,
  "hits" : {
    "total" : {
        "value": 0,
        "relation": "eq"
    },
    "max_score" : 0.0,
    "hits" : [ ]
  },
  "aggregations" : {
    "max_temperature" : {
      "value" : 202.0
    }
  }
}</pre>
</div>
</div>

</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rollup-start-job"></a>Start rollup jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/start-job.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Starts an existing, stopped rollup job.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-start-job-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/start-job.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _rollup/job/&lt;job_id&gt;/_start</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-start-job-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/start-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have <code class="literal">manage</code> or
<code class="literal">manage_rollup</code> cluster privileges to use this API. For more information, see
<a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-start-job-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/start-job.asciidoc">edit</a></h3>
</div></div></div>
<p>If you try to start a job that does not exist, an exception occurs. If you try
to start a job that is already started, nothing happens.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-start-job-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/start-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;job_id&gt;</code>
</span>
</dt>
<dd>
(Required, string) Identifier for the rollup job.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-start-job-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/start-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">404</code> (Missing resources)
</span>
</dt>
<dd>
This code indicates that there are no resources that match the request. It
occurs if you try to start a job that doesn&#8217;t exist.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-start-job-examples"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/start-job.asciidoc">edit</a></h3>
</div></div></div>
<p>If we have already created a rollup job named <code class="literal">sensor</code>, it can be started with:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _rollup/job/sensor/_start</pre>
</div>
<div class="console_widget" data-snippet="snippets/2139.console"></div>
<p>Which will return the response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "started": true
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rollup-stop-job"></a>Stop rollup jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/stop-job.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Stops an existing, started rollup job.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-stop-job-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/stop-job.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _rollup/job/&lt;job_id&gt;/_stop</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-stop-job-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/stop-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have <code class="literal">manage</code> or
<code class="literal">manage_rollup</code> cluster privileges to use this API. For more information, see
<a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="rollup-stop-job-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/stop-job.asciidoc">edit</a></h4>
</div></div></div>
<p>If you try to stop a job that does not exist, an exception occurs. If you try
to stop a job that is already stopped, nothing happens.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-stop-job-path-parms"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/stop-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;job_id&gt;</code>
</span>
</dt>
<dd>
(Required, string) Identifier for the rollup job.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-stop-job-query-parms"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/stop-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
<p>
(Optional, TimeValue) If <code class="literal">wait_for_completion</code> is <code class="literal">true</code>, the API blocks for
(at maximum) the specified duration while waiting for the job to stop. If more
than <code class="literal">timeout</code> time has passed, the API throws a timeout exception. Defaults
to <code class="literal">30s</code>.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Even if a timeout exception is thrown, the stop request is still
processing and eventually moves the job to <code class="literal">STOPPED</code>. The timeout simply means
the API call itself timed out while waiting for the status change.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">wait_for_completion</code>
</span>
</dt>
<dd>
(Optional, Boolean) If set to <code class="literal">true</code>, causes the API to block until the
indexer state completely stops. If set to <code class="literal">false</code>, the API returns immediately
and the indexer is stopped asynchronously in the background. Defaults to
<code class="literal">false</code>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-stop-job-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/stop-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">404</code> (Missing resources)
</span>
</dt>
<dd>
This code indicates that there are no resources that match the request. It
occurs if you try to stop a job that doesn&#8217;t exist.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rollup-stop-job-examples"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/rollup/apis/stop-job.asciidoc">edit</a></h3>
</div></div></div>
<p>Since only a stopped job can be deleted, it can be useful to block the API until
the indexer has fully stopped. This is accomplished with the
<code class="literal">wait_for_completion</code> query parameter, and optionally a <code class="literal">timeout</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _rollup/job/sensor/_stop?wait_for_completion=true&amp;timeout=10s</pre>
</div>
<div class="console_widget" data-snippet="snippets/2140.console"></div>
<p>The parameter blocks the API call from returning until either the job has moved
to <code class="literal">STOPPED</code> or the specified time has elapsed. If the specified time elapses
without the job moving to <code class="literal">STOPPED</code>, a timeout exception is thrown.</p>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="repositories-metering-apis.html">« Repositories metering APIs</a>
</span>
<span class="next">
<a href="search.html">Search APIs »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
