<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Ingest processor reference | Elasticsearch Guide | Elastic</title>
<meta class="elastic" name="content" content="Ingest processor reference | Elasticsearch Guide">

<link rel="home" href="index.html" title="Elasticsearch Guide"/>
<link rel="up" href="ingest.html" title="Ingest pipelines"/>
<link rel="prev" href="ingest-enriching-data.html" title="Enrich your data"/>
<link rel="next" href="aliases.html" title="Aliases"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ingest.html">Ingest pipelines</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ingest-enriching-data.html">« Enrich your data</a>
</span>
<span class="next">
<a href="aliases.html">Aliases »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="processors"></a>Ingest processor reference<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors.asciidoc">edit</a></h2>
</div></div></div>

<p>Elasticsearch includes several configurable processors. To get a list of available
processors, use the <a class="xref" href="cluster.html#cluster-nodes-info" title="Nodes info API">nodes info</a> API.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _nodes/ingest?filter_path=nodes.*.ingest.processors</pre>
</div>
<div class="console_widget" data-snippet="snippets/726.console"></div>
<p>The pages in this section contain reference documentation for each processor.</p>
<h3><a id="ingest-process-plugins"></a>Processor plugins<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors.asciidoc">edit</a></h3>
<p>You can install additional processors as <a href="https://www.elastic.co/guide/en/elasticsearch/plugins/8.9/ingest.html" class="ulink" target="_top">plugins</a>.</p>
<p>You must install any plugin processors on all nodes in your cluster. Otherwise,
Elasticsearch will fail to create pipelines containing the processor.</p>
<p>Mark a plugin as mandatory by setting <code class="literal">plugin.mandatory</code> in
<code class="literal">elasticsearch.yml</code>. A node will fail to start if a mandatory plugin is not
installed.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">plugin.mandatory: my-ingest-plugin</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="append-processor"></a>Append processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/append.asciidoc">edit</a></h2>
</div></div></div>

<p>Appends one or more values to an existing array if the field already exists and it is an array.
Converts a scalar to an array and appends one or more values to it if the field exists and it is a scalar.
Creates an array containing the provided values if the field doesn&#8217;t exist.
Accepts a single value or an array of values.</p>
<div class="table">
<a id="append-options"></a>
<p class="title"><strong>Table 3. Append Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Append Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be appended to. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">value</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The value to be appended. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">allow_duplicates</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>true</p></td>
<td align="left" valign="top"><p>If <code class="literal">false</code>, the processor does not append
values already present in the field.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">media_type</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">application/json</code></p></td>
<td align="left" valign="top"><p>The media type for encoding <code class="literal">value</code>. Applies only when <code class="literal">value</code> is a
<a class="xref" href="ingest.html#template-snippets">template snippet</a>. Must be one of <code class="literal">application/json</code>, <code class="literal">text/plain</code>, or
<code class="literal">application/x-www-form-urlencoded</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "append": {
    "field": "tags",
    "value": ["production", "{{{app}}}", "{{{owner}}}"]
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="attachment"></a>Attachment processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/attachment.asciidoc">edit</a></h2>
</div></div></div>

<p>The attachment processor lets Elasticsearch extract file attachments in common formats (such as PPT, XLS, and PDF) by
using the Apache text extraction library <a href="https://tika.apache.org/" class="ulink" target="_top">Tika</a>.</p>
<p>The source field must be a base64 encoded binary. If you do not want to incur
the overhead of converting back and forth between base64, you can use the CBOR
format instead of JSON and specify the field as a bytes array instead of a string
representation. The processor will skip the base64 decoding then.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="using-attachment"></a>Using the attachment processor in a pipeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/attachment.asciidoc">edit</a></h3>
</div></div></div>
<div class="table">
<a id="attachment-options"></a>
<p class="title"><strong>Table 4. Attachment options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Attachment options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to get the base64 encoded field from</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>attachment</p></td>
<td align="left" valign="top"><p>The field that will hold the attachment information</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">indexed_chars</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>100000</p></td>
<td align="left" valign="top"><p>The number of chars being used for extraction to prevent huge fields. Use <code class="literal">-1</code> for no limit.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">indexed_chars_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>Field name from which you can overwrite the number of chars being used for extraction. See <code class="literal">indexed_chars</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">properties</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>all properties</p></td>
<td align="left" valign="top"><p> Array of properties to select to be stored. Can be <code class="literal">content</code>, <code class="literal">title</code>, <code class="literal">name</code>, <code class="literal">author</code>, <code class="literal">keywords</code>, <code class="literal">date</code>, <code class="literal">content_type</code>, <code class="literal">content_length</code>, <code class="literal">language</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">remove_binary</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, the binary <code class="literal">field</code> will be removed from the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">resource_name</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Field containing the name of the resource to decode. If specified, the processor passes this resource name to the underlying Tika library to enable <a href="https://tika.apache.org/1.24.1/detection.html#Resource_Name_Based_Detection" class="ulink" target="_top">Resource Name Based Detection</a>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<h4><a id="attachment-json-ex"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/attachment.asciidoc">edit</a></h4>
<p>If attaching files to JSON documents, you must first encode the file as a base64
string. On Unix-like systems, you can do this using a <code class="literal">base64</code> command:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">base64 -in myfile.rtf</pre>
</div>
<p>The command returns the base64-encoded string for the file. The following base64
string is for an <code class="literal">.rtf</code> file containing the text <code class="literal">Lorem ipsum dolor sit amet</code>:
<code class="literal">e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0=</code>.</p>
<p>Use an attachment processor to decode the string and extract the file&#8217;s
properties:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/attachment
{
  "description" : "Extract attachment information",
  "processors" : [
    {
      "attachment" : {
        "field" : "data",
        "remove_binary": false
      }
    }
  ]
}
PUT my-index-000001/_doc/my_id?pipeline=attachment
{
  "data": "e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0="
}
GET my-index-000001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/727.console"></div>
<p>The document&#8217;s <code class="literal">attachment</code> object contains extracted properties for the file:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "my-index-000001",
  "_id": "my_id",
  "_version": 1,
  "_seq_no": 22,
  "_primary_term": 1,
  "_source": {
    "data": "e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0=",
    "attachment": {
      "content_type": "application/rtf",
      "language": "ro",
      "content": "Lorem ipsum dolor sit amet",
      "content_length": 28
    }
  }
}</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Keeping the binary as a field within the document might consume a lot of resources. It is highly recommended
      to remove that field from the document. Set <code class="literal">remove_binary</code> to <code class="literal">true</code> to automatically remove the field.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="attachment-fields"></a>Exported fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/attachment.asciidoc">edit</a></h3>
</div></div></div>
<p>The fields which might be extracted from a document are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">content</code>,
</li>
<li class="listitem">
<code class="literal">title</code>,
</li>
<li class="listitem">
<code class="literal">author</code>,
</li>
<li class="listitem">
<code class="literal">keywords</code>,
</li>
<li class="listitem">
<code class="literal">date</code>,
</li>
<li class="listitem">
<code class="literal">content_type</code>,
</li>
<li class="listitem">
<code class="literal">content_length</code>,
</li>
<li class="listitem">
<code class="literal">language</code>,
</li>
<li class="listitem">
<code class="literal">modified</code>,
</li>
<li class="listitem">
<code class="literal">format</code>,
</li>
<li class="listitem">
<code class="literal">identifier</code>,
</li>
<li class="listitem">
<code class="literal">contributor</code>,
</li>
<li class="listitem">
<code class="literal">coverage</code>,
</li>
<li class="listitem">
<code class="literal">modifier</code>,
</li>
<li class="listitem">
<code class="literal">creator_tool</code>,
</li>
<li class="listitem">
<code class="literal">publisher</code>,
</li>
<li class="listitem">
<code class="literal">relation</code>,
</li>
<li class="listitem">
<code class="literal">rights</code>,
</li>
<li class="listitem">
<code class="literal">source</code>,
</li>
<li class="listitem">
<code class="literal">type</code>,
</li>
<li class="listitem">
<code class="literal">description</code>,
</li>
<li class="listitem">
<code class="literal">print_date</code>,
</li>
<li class="listitem">
<code class="literal">metadata_date</code>,
</li>
<li class="listitem">
<code class="literal">latitude</code>,
</li>
<li class="listitem">
<code class="literal">longitude</code>,
</li>
<li class="listitem">
<code class="literal">altitude</code>,
</li>
<li class="listitem">
<code class="literal">rating</code>,
</li>
<li class="listitem">
<code class="literal">comments</code>
</li>
</ul>
</div>
<p>To extract only certain <code class="literal">attachment</code> fields, specify the <code class="literal">properties</code> array:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/attachment
{
  "description" : "Extract attachment information",
  "processors" : [
    {
      "attachment" : {
        "field" : "data",
        "properties": [ "content", "title" ],
        "remove_binary": false
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/728.console"></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Extracting contents from binary data is a resource intensive operation and
      consumes a lot of resources. It is highly recommended to run pipelines
      using this processor in a dedicated ingest node.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="attachment-cbor"></a>Use the attachment processor with CBOR<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/attachment.asciidoc">edit</a></h3>
</div></div></div>
<p>To avoid encoding and decoding JSON to base64, you can instead pass CBOR data to
the attachment processor. For example, the following request creates the
<code class="literal">cbor-attachment</code> pipeline, which uses the attachment processor.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/cbor-attachment
{
  "description" : "Extract attachment information",
  "processors" : [
    {
      "attachment" : {
        "field" : "data",
        "remove_binary": false
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/729.console"></div>
<p>The following Python script passes CBOR data to an HTTP indexing request that
includes the <code class="literal">cbor-attachment</code> pipeline. The HTTP request headers use a
<code class="literal">content-type</code> of <code class="literal">application/cbor</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Not all Elasticsearch clients support custom HTTP request headers.</p>
</div>
</div>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">import cbor2
import requests

file = 'my-file'
headers = {'content-type': 'application/cbor'}

with open(file, 'rb') as f:
  doc = {
    'data': f.read()
  }
  requests.put(
    'http://localhost:9200/my-index-000001/_doc/my_id?pipeline=cbor-attachment',
    data=cbor2.dumps(doc),
    headers=headers
  )</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="attachment-extracted-chars"></a>Limit the number of extracted chars<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/attachment.asciidoc">edit</a></h3>
</div></div></div>
<p>To prevent extracting too many chars and overload the node memory, the number of chars being used for extraction
is limited by default to <code class="literal">100000</code>. You can change this value by setting <code class="literal">indexed_chars</code>. Use <code class="literal">-1</code> for no limit but
ensure when setting this that your node will have enough HEAP to extract the content of very big documents.</p>
<p>You can also define this limit per document by extracting from a given field the limit to set. If the document
has that field, it will overwrite the <code class="literal">indexed_chars</code> setting. To set this field, define the <code class="literal">indexed_chars_field</code>
setting.</p>
<p>For example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/attachment
{
  "description" : "Extract attachment information",
  "processors" : [
    {
      "attachment" : {
        "field" : "data",
        "indexed_chars" : 11,
        "indexed_chars_field" : "max_size",
        "remove_binary": false
      }
    }
  ]
}
PUT my-index-000001/_doc/my_id?pipeline=attachment
{
  "data": "e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0="
}
GET my-index-000001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/730.console"></div>
<p>Returns this:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "my-index-000001",
  "_id": "my_id",
  "_version": 1,
  "_seq_no": 35,
  "_primary_term": 1,
  "_source": {
    "data": "e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0=",
    "attachment": {
      "content_type": "application/rtf",
      "language": "is",
      "content": "Lorem ipsum",
      "content_length": 11
    }
  }
}</pre>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/attachment
{
  "description" : "Extract attachment information",
  "processors" : [
    {
      "attachment" : {
        "field" : "data",
        "indexed_chars" : 11,
        "indexed_chars_field" : "max_size",
        "remove_binary": false
      }
    }
  ]
}
PUT my-index-000001/_doc/my_id_2?pipeline=attachment
{
  "data": "e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0=",
  "max_size": 5
}
GET my-index-000001/_doc/my_id_2</pre>
</div>
<div class="console_widget" data-snippet="snippets/731.console"></div>
<p>Returns this:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "my-index-000001",
  "_id": "my_id_2",
  "_version": 1,
  "_seq_no": 40,
  "_primary_term": 1,
  "_source": {
    "data": "e1xydGYxXGFuc2kNCkxvcmVtIGlwc3VtIGRvbG9yIHNpdCBhbWV0DQpccGFyIH0=",
    "max_size": 5,
    "attachment": {
      "content_type": "application/rtf",
      "language": "sl",
      "content": "Lorem",
      "content_length": 5
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="attachment-with-arrays"></a>Using the attachment processor with arrays<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/attachment.asciidoc">edit</a></h3>
</div></div></div>
<p>To use the attachment processor within an array of attachments the
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.9/foreach-processor.html" class="ulink" target="_top">foreach processor</a> is required. This
enables the attachment processor to be run on the individual elements
of the array.</p>
<p>For example, given the following source:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "attachments" : [
    {
      "filename" : "ipsum.txt",
      "data" : "dGhpcyBpcwpqdXN0IHNvbWUgdGV4dAo="
    },
    {
      "filename" : "test.txt",
      "data" : "VGhpcyBpcyBhIHRlc3QK"
    }
  ]
}</pre>
</div>
<p>In this case, we want to process the data field in each element
of the attachments field and insert
the properties into the document so the following <code class="literal">foreach</code>
processor is used:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/attachment
{
  "description" : "Extract attachment information from arrays",
  "processors" : [
    {
      "foreach": {
        "field": "attachments",
        "processor": {
          "attachment": {
            "target_field": "_ingest._value.attachment",
            "field": "_ingest._value.data",
            "remove_binary": false
          }
        }
      }
    }
  ]
}
PUT my-index-000001/_doc/my_id?pipeline=attachment
{
  "attachments" : [
    {
      "filename" : "ipsum.txt",
      "data" : "dGhpcyBpcwpqdXN0IHNvbWUgdGV4dAo="
    },
    {
      "filename" : "test.txt",
      "data" : "VGhpcyBpcyBhIHRlc3QK"
    }
  ]
}
GET my-index-000001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/732.console"></div>
<p>Returns this:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "_index" : "my-index-000001",
  "_id" : "my_id",
  "_version" : 1,
  "_seq_no" : 50,
  "_primary_term" : 1,
  "found" : true,
  "_source" : {
    "attachments" : [
      {
        "filename" : "ipsum.txt",
        "data" : "dGhpcyBpcwpqdXN0IHNvbWUgdGV4dAo=",
        "attachment" : {
          "content_type" : "text/plain; charset=ISO-8859-1",
          "language" : "en",
          "content" : "this is\njust some text",
          "content_length" : 24
        }
      },
      {
        "filename" : "test.txt",
        "data" : "VGhpcyBpcyBhIHRlc3QK",
        "attachment" : {
          "content_type" : "text/plain; charset=ISO-8859-1",
          "language" : "en",
          "content" : "This is a test",
          "content_length" : 16
        }
      }
    ]
  }
}</pre>
</div>
<p>Note that the <code class="literal">target_field</code> needs to be set, otherwise the
default value is used which is a top level field <code class="literal">attachment</code>. The
properties on this top level field will contain the value of the
first attachment only. However, by specifying the
<code class="literal">target_field</code> on to a value on <code class="literal">_ingest._value</code> it will correctly
associate the properties with the correct attachment.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="bytes-processor"></a>Bytes processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/bytes.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a human readable byte value (e.g. 1kb) to its value in bytes (e.g. 1024). If the field is an array of strings, all members of the array will be converted.</p>
<p>Supported human readable units are "b", "kb", "mb", "gb", "tb", "pb" case insensitive. An error will occur if
the field is not a supported format or resultant value exceeds 2^63.</p>
<div class="table">
<a id="bytes-options"></a>
<p class="title"><strong>Table 5. Bytes Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Bytes Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to convert</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "bytes": {
    "field": "file.size"
  }
}</pre>
</div>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ingest-circle-processor"></a>Circle processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/circle.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts circle definitions of shapes to regular polygons which approximate them.</p>
<div class="table">
<a id="circle-processor-options"></a>
<p class="title"><strong>Table 6. Circle Processor Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Circle Processor Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to interpret as a circle. Either a string in WKT format or a map for GeoJSON.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the polygon shape to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">error_distance</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The difference between the resulting inscribed distance from center to side and the circle&#8217;s radius (measured in meters for <code class="literal">geo_shape</code>, unit-less for <code class="literal">shape</code>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">shape_type</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Which field mapping type is to be used when processing the circle: <code class="literal">geo_shape</code> or <code class="literal">shape</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="image"><img src="images/spatial/error_distance.png" alt="error distance"></span></p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT circles
{
  "mappings": {
    "properties": {
      "circle": {
        "type": "geo_shape"
      }
    }
  }
}

PUT _ingest/pipeline/polygonize_circles
{
  "description": "translate circle to polygon",
  "processors": [
    {
      "circle": {
        "field": "circle",
        "error_distance": 28.0,
        "shape_type": "geo_shape"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/733.console"></div>
<p>Using the above pipeline, we can attempt to index a document into the <code class="literal">circles</code> index.
The circle can be represented as either a WKT circle or a GeoJSON circle. The resulting
polygon will be represented and indexed using the same format as the input circle. WKT will
be translated to a WKT polygon, and GeoJSON circles will be translated to GeoJSON polygons.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Circles that contain a pole are not supported.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_example_circle_defined_in_well_known_text"></a>Example: Circle defined in Well Known Text<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/circle.asciidoc">edit</a></h3>
</div></div></div>
<p>In this example a circle defined in WKT format is indexed</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT circles/_doc/1?pipeline=polygonize_circles
{
  "circle": "CIRCLE (30 10 40)"
}

GET circles/_doc/1</pre>
</div>
<div class="console_widget" data-snippet="snippets/734.console"></div>
<p>The response from the above index request:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "circles",
  "_id": "1",
  "_version": 1,
  "_seq_no": 22,
  "_primary_term": 1,
  "_source": {
    "circle": "POLYGON ((30.000365257263184 10.0, 30.000111397193788 10.00034284530941, 29.999706043744222 10.000213571721195, 29.999706043744222 9.999786428278805, 30.000111397193788 9.99965715469059, 30.000365257263184 10.0))"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_example_circle_defined_in_geojson"></a>Example: Circle defined in GeoJSON<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/circle.asciidoc">edit</a></h3>
</div></div></div>
<p>In this example a circle defined in GeoJSON format is indexed</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT circles/_doc/2?pipeline=polygonize_circles
{
  "circle": {
    "type": "circle",
    "radius": "40m",
    "coordinates": [30, 10]
  }
}

GET circles/_doc/2</pre>
</div>
<div class="console_widget" data-snippet="snippets/735.console"></div>
<p>The response from the above index request:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "circles",
  "_id": "2",
  "_version": 1,
  "_seq_no": 22,
  "_primary_term": 1,
  "_source": {
    "circle": {
      "coordinates": [
        [
          [30.000365257263184, 10.0],
          [30.000111397193788, 10.00034284530941],
          [29.999706043744222, 10.000213571721195],
          [29.999706043744222, 9.999786428278805],
          [30.000111397193788, 9.99965715469059],
          [30.000365257263184, 10.0]
        ]
      ],
      "type": "Polygon"
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="circle-processor-notes"></a>Notes on Accuracy<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/circle.asciidoc">edit</a></h3>
</div></div></div>
<p>Accuracy of the polygon that represents the circle is defined as <code class="literal">error_distance</code>. The smaller this
difference is, the closer to a perfect circle the polygon is.</p>
<p>Below is a table that aims to help capture how the radius of the circle affects the resulting number of sides
of the polygon given different inputs.</p>
<p>The minimum number of sides is <code class="literal">4</code> and the maximum is <code class="literal">1000</code>.</p>
<div class="table">
<a id="circle-processor-accuracy"></a>
<p class="title"><strong>Table 7. Circle Processor Accuracy</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Circle Processor Accuracy">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">error_distance</th>
<th align="left" valign="top">radius in meters</th>
<th align="left" valign="top">number of sides of polygon</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>1.0</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>10.0</p></td>
<td align="left" valign="top"><p>14</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>100.0</p></td>
<td align="left" valign="top"><p>45</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>1000.0</p></td>
<td align="left" valign="top"><p>141</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>10000.0</p></td>
<td align="left" valign="top"><p>445</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>100000.0</p></td>
<td align="left" valign="top"><p>1000</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="community-id-processor"></a>Community ID processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/community-id.asciidoc">edit</a></h2>
</div></div></div>

<p>Computes the Community ID for network flow data as defined in the
<a href="https://github.com/corelight/community-id-spec" class="ulink" target="_top">Community ID Specification</a>.
You can use a community ID to correlate network events related to a single
flow.</p>
<p>The community ID processor reads network flow data from related
<a href="https://www.elastic.co/guide/en/ecs/8.9" class="ulink" target="_top">Elastic Common Schema (ECS)</a> fields by default. If you use the ECS, no
configuration is required.</p>
<div class="table">
<a id="community-id-options"></a>
<p class="title"><strong>Table 8. Community ID Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Community ID Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">source_ip</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">source.ip</code></p></td>
<td align="left" valign="top"><p>Field containing the source IP address.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">source_port</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">source.port</code></p></td>
<td align="left" valign="top"><p>Field containing the source port.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">destination_ip</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">destination.ip</code></p></td>
<td align="left" valign="top"><p>Field containing the destination IP address.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">destination_port</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">destination.port</code></p></td>
<td align="left" valign="top"><p>Field containing the destination port.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">iana_number</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">network.iana_number</code></p></td>
<td align="left" valign="top"><p>Field containing the IANA number. The following protocol numbers are currently supported: <code class="literal">1</code> ICMP, <code class="literal">2</code> IGMP, <code class="literal">6</code> TCP, <code class="literal">17</code> UDP, <code class="literal">47</code> GRE, <code class="literal">58</code> ICMP IPv6, <code class="literal">88</code> EIGRP, <code class="literal">89</code> OSPF, <code class="literal">103</code> PIM, and <code class="literal">132</code> SCTP.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">icmp_type</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">icmp.type</code></p></td>
<td align="left" valign="top"><p>Field containing the ICMP type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">icmp_code</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">icmp.code</code></p></td>
<td align="left" valign="top"><p>Field containing the ICMP code.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">transport</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">network.transport</code></p></td>
<td align="left" valign="top"><p>Field containing the transport protocol.
Used only when the <code class="literal">iana_number</code> field is not present.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">network.community_id</code></p></td>
<td align="left" valign="top"><p>Output field for the community ID.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">seed</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">0</code></p></td>
<td align="left" valign="top"><p>Seed for the community ID hash. Must be between
0 and 65535 (inclusive). The seed can prevent hash collisions between network domains, such as
a staging and production network that use the same addressing scheme.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and any required fields are missing,
the processor quietly exits without modifying the document.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example definition of the community ID processor:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "...",
  "processors" : [
    {
      "community_id": {
      }
    }
  ]
}</pre>
</div>
<p>When the above processor executes on the following document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "_source": {
    "source": {
      "ip": "123.124.125.126",
      "port": 12345
    },
    "destination": {
      "ip": "55.56.57.58",
      "port": 80
    },
    "network": {
      "transport": "TCP"
    }
  }
}</pre>
</div>
<p>It produces this result:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"_source" : {
  "destination" : {
    "port" : 80,
    "ip" : "55.56.57.58"
  },
  "source" : {
    "port" : 12345,
    "ip" : "123.124.125.126"
  },
  "network" : {
    "community_id" : "1:9qr9Z1LViXcNwtLVOHZ3CL8MlyM=",
    "transport" : "TCP"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="convert-processor"></a>Convert processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/convert.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a field in the currently ingested document to a different type, such as converting a string to an integer.
If the field value is an array, all members will be converted.</p>
<p>The supported types include: <code class="literal">integer</code>, <code class="literal">long</code>, <code class="literal">float</code>, <code class="literal">double</code>, <code class="literal">string</code>, <code class="literal">boolean</code>, <code class="literal">ip</code>, and <code class="literal">auto</code>.</p>
<p>Specifying <code class="literal">boolean</code> will set the field to true if its string value is equal to <code class="literal">true</code> (ignore case), to
false if its string value is equal to <code class="literal">false</code> (ignore case), or it will throw an exception otherwise.</p>
<p>Specifying <code class="literal">ip</code> will set the target field to the value of <code class="literal">field</code> if it contains a valid IPv4 or IPv6 address
that can be indexed into an <a class="xref" href="mapping-types.html#ip" title="IP field type">IP field type</a>.</p>
<p>Specifying <code class="literal">auto</code> will attempt to convert the string-valued <code class="literal">field</code> into the closest non-string, non-IP type.
For example, a field whose value is <code class="literal">"true"</code> will be converted to its respective boolean type: <code class="literal">true</code>. Do note
that float takes precedence of double in <code class="literal">auto</code>. A value of <code class="literal">"242.15"</code> will "automatically" be converted to
<code class="literal">242.15</code> of type <code class="literal">float</code>. If a provided field cannot be appropriately converted, the processor will
still process successfully and leave the field value as-is. In such a case, <code class="literal">target_field</code> will
be updated with the unconverted field value.</p>
<div class="table">
<a id="convert-options"></a>
<p class="title"><strong>Table 9. Convert Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Convert Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field whose value is to be converted</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">type</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The type to convert the existing value to</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">PUT _ingest/pipeline/my-pipeline-id
{
  "description": "converts the content of the id field to an integer",
  "processors" : [
    {
      "convert" : {
        "field" : "id",
        "type": "integer"
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="csv-processor"></a>CSV processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/csv.asciidoc">edit</a></h2>
</div></div></div>

<p>Extracts fields from CSV line out of a single text field within a document. Any empty field in CSV will be skipped.</p>
<div class="table">
<a id="csv-options"></a>
<p class="title"><strong>Table 10. CSV Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="CSV Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to extract data from</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_fields</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The array of fields to assign extracted values to</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">separator</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>,</p></td>
<td align="left" valign="top"><p>Separator used in CSV, has to be single character string</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">quote</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>"</p></td>
<td align="left" valign="top"><p>Quote used in CSV, has to be single character string</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">trim</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Trim whitespaces in unquoted fields</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">empty_value</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Value used to fill empty fields, empty fields will be skipped if this is not provided.
                                             Empty field is one with no value (2 consecutive separators) or empty quotes (<code class="literal">""</code>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "csv": {
    "field": "my_field",
    "target_fields": ["field1", "field2"]
  }
}</pre>
</div>
<p>If the <code class="literal">trim</code> option is enabled then any whitespace in the beginning and in the end of each unquoted field will be trimmed.
For example with configuration above, a value of <code class="literal">A, B</code> will result in field <code class="literal">field2</code>
having value <code class="literal">{nbsp}B</code> (with space at the beginning). If <code class="literal">trim</code> is enabled <code class="literal">A, B</code> will result in field <code class="literal">field2</code>
having value <code class="literal">B</code> (no whitespace). Quoted fields will be left untouched.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="date-processor"></a>Date processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/date.asciidoc">edit</a></h2>
</div></div></div>

<p>Parses dates from fields, and then uses the date or timestamp as the timestamp for the document.
By default, the date processor adds the parsed date as a new field called <code class="literal">@timestamp</code>. You can specify a
different field by setting the <code class="literal">target_field</code> configuration parameter. Multiple date formats are supported
as part of the same date processor definition. They will be used sequentially to attempt parsing the date field,
in the same order they were defined as part of the processor definition.</p>
<div class="table">
<a id="date-options"></a>
<p class="title"><strong>Table 11. Date options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Date options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to get the date from.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>The field that will hold the parsed date.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">formats</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An array of the expected date formats. Can be a <a class="xref" href="mapping-params.html#mapping-date-format" title="format">java time pattern</a> or one of the following formats: ISO8601, UNIX, UNIX_MS, or TAI64N.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">timezone</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>UTC</p></td>
<td align="left" valign="top"><p>The timezone to use when parsing the date. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">locale</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>ENGLISH</p></td>
<td align="left" valign="top"><p>The locale to use when parsing the date, relevant when parsing month names or week days. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">output_format</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">yyyy-MM-dd'T'HH:mm:ss.SSSXXX</code></p></td>
<td align="left" valign="top"><p>The format to use when writing the date to <code class="literal">target_field</code>. Must be a valid <a class="xref" href="mapping-params.html#mapping-date-format" title="format">java time pattern</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example that adds the parsed date to the <code class="literal">timestamp</code> field based on the <code class="literal">initial_date</code> field:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "...",
  "processors" : [
    {
      "date" : {
        "field" : "initial_date",
        "target_field" : "timestamp",
        "formats" : ["dd/MM/yyyy HH:mm:ss"],
        "timezone" : "Europe/Amsterdam"
      }
    }
  ]
}</pre>
</div>
<p>The <code class="literal">timezone</code> and <code class="literal">locale</code> processor parameters are templated. This means that their values can be
extracted from fields within documents. The example below shows how to extract the locale/timezone
details from existing fields, <code class="literal">my_timezone</code> and <code class="literal">my_locale</code>, in the ingested document that contain
the timezone and locale values.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "...",
  "processors" : [
    {
      "date" : {
        "field" : "initial_date",
        "target_field" : "timestamp",
        "formats" : ["ISO8601"],
        "timezone" : "{{{my_timezone}}}",
        "locale" : "{{{my_locale}}}"
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="date-index-name-processor"></a>Date index name processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/date-index-name.asciidoc">edit</a></h2>
</div></div></div>

<p>The purpose of this processor is to point documents to the right time based index based
on a date or timestamp field in a document by using the <a class="xref" href="api-conventions.html#api-date-math-index-names" title="Date math support in index and index alias names">date math index name support</a>.</p>
<p>The processor sets the <code class="literal">_index</code> metadata field with a date math index name expression based on the provided index name
prefix, a date or timestamp field in the documents being processed and the provided date rounding.</p>
<p>First, this processor fetches the date or timestamp from a field in the document being processed. Optionally,
date formatting can be configured on how the field&#8217;s value should be parsed into a date. Then this date,
the provided index name prefix and the provided date rounding get formatted into a date math index name expression.
Also here optionally date formatting can be specified on how the date should be formatted into a date math index name
expression.</p>
<p>An example pipeline that points documents to a monthly index that starts with a <code class="literal">my-index-</code> prefix based on a
date in the <code class="literal">date1</code> field:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/monthlyindex
{
  "description": "monthly date-time index naming",
  "processors" : [
    {
      "date_index_name" : {
        "field" : "date1",
        "index_name_prefix" : "my-index-",
        "date_rounding" : "M"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/736.console"></div>
<p>Using that pipeline for an index request:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /my-index/_doc/1?pipeline=monthlyindex
{
  "date1" : "2016-04-25T12:02:01.789Z"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/737.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "_index" : "my-index-2016-04-01",
  "_id" : "1",
  "_version" : 1,
  "result" : "created",
  "_shards" : {
    "total" : 2,
    "successful" : 1,
    "failed" : 0
  },
  "_seq_no" : 55,
  "_primary_term" : 1
}</pre>
</div>
<p>The above request will not index this document into the <code class="literal">my-index</code> index, but into the <code class="literal">my-index-2016-04-01</code> index because
it was rounded by month. This is because the date-index-name-processor overrides the <code class="literal">_index</code> property of the document.</p>
<p>To see the date-math value of the index supplied in the actual index request which resulted in the above document being
indexed into <code class="literal">my-index-2016-04-01</code> we can inspect the effects of the processor using a simulate request.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline" :
  {
    "description": "monthly date-time index naming",
    "processors" : [
      {
        "date_index_name" : {
          "field" : "date1",
          "index_name_prefix" : "my-index-",
          "date_rounding" : "M"
        }
      }
    ]
  },
  "docs": [
    {
      "_source": {
        "date1": "2016-04-25T12:02:01.789Z"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/738.console"></div>
<p>and the result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs" : [
    {
      "doc" : {
        "_id" : "_id",
        "_index" : "&lt;my-index-{2016-04-25||/M{yyyy-MM-dd|UTC}}&gt;",
        "_version" : "-3",
        "_source" : {
          "date1" : "2016-04-25T12:02:01.789Z"
        },
        "_ingest" : {
          "timestamp" : "2016-11-08T19:43:03.850+0000"
        }
      }
    }
  ]
}</pre>
</div>
<p>The above example shows that <code class="literal">_index</code> was set to <code class="literal">&lt;my-index-{2016-04-25||/M{yyyy-MM-dd|UTC}}&gt;</code>. Elasticsearch
understands this to mean <code class="literal">2016-04-01</code> as is explained in the <a class="xref" href="api-conventions.html#api-date-math-index-names" title="Date math support in index and index alias names">date math index name documentation</a></p>
<div class="table">
<a id="date-index-name-options"></a>
<p class="title"><strong>Table 12. Date index name options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Date index name options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to get the date or timestamp from.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">index_name_prefix</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>A prefix of the index name to be prepended before the printed date. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">date_rounding</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>How to round the date when formatting the date into the index name. Valid values are: <code class="literal">y</code> (year), <code class="literal">M</code> (month), <code class="literal">w</code> (week), <code class="literal">d</code> (day), <code class="literal">h</code> (hour), <code class="literal">m</code> (minute) and <code class="literal">s</code> (second). Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">date_formats</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>yyyy-MM-dd'T'HH:mm:ss.SSSXX</p></td>
<td align="left" valign="top"><p>An array of the expected date formats for parsing dates / timestamps in the document being preprocessed. Can be a java time pattern or one of the following formats: ISO8601, UNIX, UNIX_MS, or TAI64N.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">timezone</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>UTC</p></td>
<td align="left" valign="top"><p>The timezone to use when parsing the date and when date math index supports resolves expressions into concrete index names.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">locale</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>ENGLISH</p></td>
<td align="left" valign="top"><p>The locale to use when parsing the date from the document being preprocessed, relevant when parsing month names or week days.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">index_name_format</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>yyyy-MM-dd</p></td>
<td align="left" valign="top"><p>The format to be used when printing the parsed date into the index name. A valid java time pattern is expected here. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="dissect-processor"></a>Dissect processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h2>
</div></div></div>

<p>Similar to the <a class="xref" href="processors.html#grok-processor" title="Grok processor">Grok Processor</a>, dissect also extracts structured fields out of a single text field
within a document. However unlike the <a class="xref" href="processors.html#grok-processor" title="Grok processor">Grok Processor</a>, dissect does not use
<a href="https://en.wikipedia.org/wiki/Regular_expression" class="ulink" target="_top">Regular Expressions</a>. This allows dissect&#8217;s syntax to be simple and for
some cases faster than the <a class="xref" href="processors.html#grok-processor" title="Grok processor">Grok Processor</a>.</p>
<p>Dissect matches a single text field against a defined pattern.</p>
<p>For example the following pattern:</p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">%{clientip} %{ident} %{auth} [%{@timestamp}] \"%{verb} %{request} HTTP/%{httpversion}\" %{status} %{size}</pre>
</div>
<p>will match a log line of this format:</p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">1.2.3.4 - - [30/Apr/1998:22:00:52 +0000] \"GET /english/venues/cities/images/montpellier/18.gif HTTP/1.0\" 200 3171</pre>
</div>
<p>and result in a document with the following fields:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"doc": {
  "_index": "_index",
  "_type": "_type",
  "_id": "_id",
  "_source": {
    "request": "/english/venues/cities/images/montpellier/18.gif",
    "auth": "-",
    "ident": "-",
    "verb": "GET",
    "@timestamp": "30/Apr/1998:22:00:52 +0000",
    "size": "3171",
    "clientip": "1.2.3.4",
    "httpversion": "1.0",
    "status": "200"
  }
}</pre>
</div>
<p>A dissect pattern is defined by the parts of the string that will be discarded. In the example above the first part
to be discarded is a single space. Dissect finds this space, then assigns the value of <code class="literal">clientip</code> is everything up
until that space.
Later dissect matches the <code class="literal">[</code> and then <code class="literal">]</code> and then assigns <code class="literal">@timestamp</code> to everything in-between <code class="literal">[</code> and <code class="literal">]</code>.
Paying special attention the parts of the string to discard will help build successful dissect patterns.</p>
<p>Successful matches require all keys in a pattern to have a value. If any of the <code class="literal">%{keyname}</code> defined in the pattern do
not have a value, then an exception is thrown and may be handled by the <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures"><code class="literal">on_failure</code></a> directive.
An empty key <code class="literal">%{}</code> or a <a class="xref" href="processors.html#dissect-modifier-named-skip-key">named skip key</a> can be used to match values, but exclude the value from
the final document. All matched values are represented as string data types. The <a class="xref" href="processors.html#convert-processor" title="Convert processor">convert processor</a>
may be used to convert to expected data type.</p>
<p>Dissect also supports <a class="xref" href="processors.html#dissect-key-modifiers" title="Dissect key modifiers">key modifiers</a> that can change dissect&#8217;s default
behavior. For example you can instruct dissect to ignore certain fields, append fields, skip over padding, etc.
See <a class="xref" href="processors.html#dissect-key-modifiers" title="Dissect key modifiers">below</a> for more information.</p>
<div class="table">
<a id="dissect-options"></a>
<p class="title"><strong>Table 13. Dissect Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Dissect Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to dissect</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">pattern</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The pattern to apply to the field</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">append_separator</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>"" (empty string)</p></td>
<td align="left" valign="top"><p>The character(s) that separate the appended fields.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "dissect": {
    "field": "message",
    "pattern" : "%{clientip} %{ident} %{auth} [%{@timestamp}] \"%{verb} %{request} HTTP/%{httpversion}\" %{status} %{size}"
   }
}</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dissect-key-modifiers"></a>Dissect key modifiers<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h3>
</div></div></div>
<p>Key modifiers can change the default behavior for dissection. Key modifiers may be found on the left or right
of the <code class="literal">%{keyname}</code> always inside the <code class="literal">%{</code> and <code class="literal">}</code>. For example <code class="literal">%{+keyname -&gt;}</code> has the append and right padding
modifiers.</p>
<div class="table">
<a id="dissect-key-modifiers-table"></a>
<p class="title"><strong>Table 14. Dissect Key Modifiers</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Dissect Key Modifiers">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
<col class="col_6"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Modifier</th>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Position</th>
<th align="left" valign="top">Example</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Details</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">-&gt;</code></p></td>
<td align="left" valign="top"><p>Skip right padding</p></td>
<td align="left" valign="top"><p>(far) right</p></td>
<td align="left" valign="top"><p><code class="literal">%{keyname1-&gt;}</code></p></td>
<td align="left" valign="top"><p>Skips any repeated characters to the right</p></td>
<td align="left" valign="top"><p><a class="xref" href="processors.html#dissect-modifier-skip-right-padding" title="Right padding modifier (-&gt;)">link</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">+</code></p></td>
<td align="left" valign="top"><p>Append</p></td>
<td align="left" valign="top"><p>left</p></td>
<td align="left" valign="top"><p><code class="literal">%{+keyname} %{+keyname}</code></p></td>
<td align="left" valign="top"><p>Appends two or more fields together</p></td>
<td align="left" valign="top"><p><a class="xref" href="processors.html#dissect-modifier-append-key">link</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">+</code> with <code class="literal">/n</code></p></td>
<td align="left" valign="top"><p>Append with order</p></td>
<td align="left" valign="top"><p>left and right</p></td>
<td align="left" valign="top"><p><code class="literal">%{+keyname/2} %{+keyname/1}</code></p></td>
<td align="left" valign="top"><p>Appends two or more fields together in the order specified</p></td>
<td align="left" valign="top"><p><a class="xref" href="processors.html#dissect-modifier-append-key-with-order">link</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">?</code></p></td>
<td align="left" valign="top"><p>Named skip key</p></td>
<td align="left" valign="top"><p>left</p></td>
<td align="left" valign="top"><p><code class="literal">%{?ignoreme}</code></p></td>
<td align="left" valign="top"><p>Skips the matched value in the output. Same behavior as <code class="literal">%{}</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="processors.html#dissect-modifier-named-skip-key">link</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">*</code> and <code class="literal">&amp;</code></p></td>
<td align="left" valign="top"><p>Reference keys</p></td>
<td align="left" valign="top"><p>left</p></td>
<td align="left" valign="top"><p><code class="literal">%{*r1} %{&amp;r1}</code></p></td>
<td align="left" valign="top"><p>Sets the output key as value of <code class="literal">*</code> and output value of <code class="literal">&amp;</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="processors.html#dissect-modifier-reference-keys">link</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="dissect-modifier-skip-right-padding"></a>Right padding modifier (<code class="literal">-&gt;</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p>The algorithm that performs the dissection is very strict in that it requires all characters in the pattern to match
the source string. For example, the pattern <code class="literal">%{fookey} %{barkey}</code> (1 space), will match the string "foo&#160;bar"
(1 space), but will not match the string "foo&#160;&#160;bar" (2 spaces) since the pattern has only 1 space and the
source string has 2 spaces.</p>
<p>The right padding modifier helps with this case. Adding the right padding modifier to the pattern <code class="literal">%{fookey-&gt;} %{barkey}</code>,
It will now will match "foo&#160;bar" (1 space) and "foo&#160;&#160;bar" (2 spaces)
and even "foo&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;bar" (10 spaces).</p>
<p>Use the right padding modifier to allow for repetition of the characters after a <code class="literal">%{keyname-&gt;}</code>.</p>
<p>The right padding modifier may be placed on any key with any other modifiers. It should always be the furthest right
modifier. For example: <code class="literal">%{+keyname/1-&gt;}</code> and <code class="literal">%{-&gt;}</code></p>
<p>Right padding modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">%{ts-&gt;} %{level}</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>1998-08-10T17:15:42,466&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;WARN</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
ts = 1998-08-10T17:15:42,466
</li>
<li class="listitem">
level = WARN
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>The right padding modifier may be used with an empty key to help skip unwanted data. For example, the same input string, but wrapped with brackets requires the use of an empty right padded key to achieve the same result.</p>
<p>Right padding modifier with empty key example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">[%{ts}]%{-&gt;}[%{level}]</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>[1998-08-10T17:15:42,466]&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[WARN]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
ts = 1998-08-10T17:15:42,466
</li>
<li class="listitem">
level = WARN
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="append-modifier"></a>Append modifier (<code class="literal">+</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p><a id="dissect-modifier-append-key"></a>Dissect supports appending two or more results together for the output.
Values are appended left to right. An append separator can be specified.
In this example the append_separator is defined as a space.</p>
<p>Append modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">%{+name} %{+name} %{+name} %{+name}</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>john jacob jingleheimer schmidt</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
name = john jacob jingleheimer schmidt
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="append-order-modifier"></a>Append with order modifier (<code class="literal">+</code> and <code class="literal">/n</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p><a id="dissect-modifier-append-key-with-order"></a>Dissect supports appending two or more results together for the output.
Values are appended based on the order defined (<code class="literal">/n</code>). An append separator can be specified.
In this example the append_separator is defined as a comma.</p>
<p>Append with order modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">%{+name/2} %{+name/4} %{+name/3} %{+name/1}</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>john jacob jingleheimer schmidt</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
name = schmidt,john,jingleheimer,jacob
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="named-skip-key"></a>Named skip key (<code class="literal">?</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p><a id="dissect-modifier-named-skip-key"></a>Dissect supports ignoring matches in the final result. This can be done with an empty key <code class="literal">%{}</code>, but for readability
it may be desired to give that empty key a name.</p>
<p>Named skip key modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">%{clientip} %{?ident} %{?auth} [%{@timestamp}]</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>1.2.3.4 - - [30/Apr/1998:22:00:52 +0000]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
clientip = 1.2.3.4
</li>
<li class="listitem">
@timestamp = 30/Apr/1998:22:00:52 +0000
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="reference-keys"></a>Reference keys (<code class="literal">*</code> and <code class="literal">&amp;</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p><a id="dissect-modifier-reference-keys"></a>Dissect support using parsed values as the key/value pairings for the structured content. Imagine a system that
partially logs in key/value pairs. Reference keys allow you to maintain that key/value relationship.</p>
<p>Reference key modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">[%{ts}] [%{level}] %{*p1}:%{&amp;p1} %{*p2}:%{&amp;p2}</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>[2018-08-10T17:15:42,466] [ERR] ip:1.2.3.4 error:REFUSED</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
ts = 2018-08-10T17:15:42,466
</li>
<li class="listitem">
level = ERR
</li>
<li class="listitem">
ip = 1.2.3.4
</li>
<li class="listitem">
error = REFUSED
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="dot-expand-processor"></a>Dot expander processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/dot-expand.asciidoc">edit</a></h2>
</div></div></div>

<p>Expands a field with dots into an object field. This processor allows fields
with dots in the name to be accessible by other processors in the pipeline.
Otherwise these fields can&#8217;t be accessed by any processor.</p>
<div class="table">
<a id="dot-expander-options"></a>
<p class="title"><strong>Table 15. Dot Expand Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Dot Expand Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to expand into an object field. If set to <code class="literal">*</code>, all top-level fields will be expanded.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">path</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field that contains the field to expand. Only required if the field to expand is part another object field, because the <code class="literal">field</code> option can only understand leaf fields.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">override</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>Controls the behavior when there is already an existing nested object that conflicts with the expanded field. When <code class="literal">false</code>, the processor will merge conflicts by combining the old and the new values into an array. When <code class="literal">true</code>, the value from the expanded field will overwrite the existing value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "dot_expander": {
    "field": "foo.bar"
  }
}</pre>
</div>
<p>For example the dot expand processor would turn this document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo.bar" : "value"
}</pre>
</div>
<p>into:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo" : {
    "bar" : "value"
  }
}</pre>
</div>
<p>If there is already a <code class="literal">bar</code> field nested under <code class="literal">foo</code> then
this processor merges the <code class="literal">foo.bar</code> field into it. If the field is
a scalar value then it will turn that field into an array field.</p>
<p>For example, the following document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo.bar" : "value2",
  "foo" : {
    "bar" : "value1"
  }
}</pre>
</div>
<p>is transformed by the <code class="literal">dot_expander</code> processor into:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo" : {
    "bar" : ["value1", "value2"]
  }
}</pre>
</div>
<p>Contrast that with when the <code class="literal">override</code> option is set to <code class="literal">true</code>.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "dot_expander": {
    "field": "foo.bar",
    "override": true
  }
}</pre>
</div>
<p>In that case, the value of the expanded field overrides the value of the nested object.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo" : {
    "bar" : "value2"
  }
}</pre>
</div>
<hr>
<p>The value of <code class="literal">field</code> can also be set to a <code class="literal">*</code> to expand all top-level dotted field names:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "dot_expander": {
    "field": "*"
  }
}</pre>
</div>
<p>The dot expand processor would turn this document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo.bar" : "value",
  "baz.qux" : "value"
}</pre>
</div>
<p>into:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo" : {
    "bar" : "value"
  },
  "baz" : {
    "qux" : "value"
  }
}</pre>
</div>
<hr>
<p>If the dotted field is nested within a non-dotted structure, then use the <code class="literal">path</code> option to navigate the
non-dotted structure:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "dot_expander": {
    "path": "foo"
    "field": "*"
  }
}</pre>
</div>
<p>The dot expand processor would turn this document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo" : {
    "bar.one" : "value",
    "bar.two" : "value"
  }
}</pre>
</div>
<p>into:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo" : {
    "bar" : {
      "one" : "value",
      "two" : "value"
    }
  }
}</pre>
</div>
<hr>
<p>If any field outside of the leaf field conflicts with a pre-existing field of the same name,
then that field needs to be renamed first.</p>
<p>Consider the following document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo": "value1",
  "foo.bar": "value2"
}</pre>
</div>
<p>Then the <code class="literal">foo</code> needs to be renamed first before the <code class="literal">dot_expander</code>
processor is applied. So in order for the <code class="literal">foo.bar</code> field to properly
be expanded into the <code class="literal">bar</code> field under the <code class="literal">foo</code> field the following
pipeline should be used:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "processors" : [
    {
      "rename" : {
        "field" : "foo",
        "target_field" : "foo.bar"
      }
    },
    {
      "dot_expander": {
        "field": "foo.bar"
      }
    }
  ]
}</pre>
</div>
<p>The reason for this is that Ingest doesn&#8217;t know how to automatically cast
a scalar field to an object field.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="drop-processor"></a>Drop processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/drop.asciidoc">edit</a></h2>
</div></div></div>

<p>Drops the document without raising any errors. This is useful to prevent the document from
getting indexed based on some condition.</p>
<div class="table">
<a id="drop-options"></a>
<p class="title"><strong>Table 16. Drop Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Drop Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "drop": {
    "if" : "ctx.network_name == 'Guest'"
  }
}</pre>
</div>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="enrich-processor"></a>Enrich processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/enrich.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">enrich</code> processor can enrich documents with data from another index.
See <a class="xref" href="ingest-enriching-data.html" title="Enrich your data">enrich data</a> section for more information about how to set this up.</p>
<div class="table">
<a id="enrich-options"></a>
<p class="title"><strong>Table 17. Enrich Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Enrich Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">policy_name</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The name of the enrich policy to use.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field in the input document that matches the policies match_field used to retrieve the enrichment data. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Field added to incoming documents to contain enrich data. This field contains both the <code class="literal">match_field</code> and <code class="literal">enrich_fields</code> specified in the <a class="xref" href="enrich-apis.html#put-enrich-policy-api" title="Create enrich policy API">enrich policy</a>. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">override</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>true</p></td>
<td align="left" valign="top"><p>If processor will update fields with pre-existing non-null-valued field. When set to <code class="literal">false</code>, such fields will not be touched.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">max_matches</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>The maximum number of matched documents to include under the configured target field. The <code class="literal">target_field</code> will be turned into a json array if <code class="literal">max_matches</code> is higher than 1, otherwise <code class="literal">target_field</code> will become a json object. In order to avoid documents getting too large, the maximum allowed value is 128.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">shape_relation</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">INTERSECTS</code></p></td>
<td align="left" valign="top"><p>A spatial relation operator used to match the <a class="xref" href="mapping-types.html#geo-shape" title="Geoshape field type">geoshape</a> of incoming documents to documents in the enrich index. This option is only used for <code class="literal">geo_match</code> enrich policy types. See <a class="xref" href="shape-queries.html#_spatial_relations" title="Spatial Relations">Spatial Relations</a> for operators and more information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="fail-processor"></a>Fail processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/fail.asciidoc">edit</a></h2>
</div></div></div>

<p>Raises an exception. This is useful for when
you expect a pipeline to fail and want to relay a specific message
to the requester.</p>
<div class="table">
<a id="fail-options"></a>
<p class="title"><strong>Table 18. Fail Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Fail Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">message</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The error message thrown by the processor. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "fail": {
    "if" : "ctx.tags.contains('production') != true",
    "message": "The production tag is not present, found tags: {{{tags}}}"
  }
}</pre>
</div>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="fingerprint-processor"></a>Fingerprint processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/fingerprint.asciidoc">edit</a></h2>
</div></div></div>

<p>Computes a hash of the document&#8217;s content. You can use this hash for
<a href="https://en.wikipedia.org/wiki/Fingerprint_(computing)" class="ulink" target="_top">content fingerprinting</a>.</p>
<div class="table">
<a id="fingerprint-options"></a>
<p class="title"><strong>Table 19. Fingerprint Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Fingerprint Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">fields</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>n/a</p></td>
<td align="left" valign="top"><p>Array of fields to include in
the fingerprint. For objects, the processor hashes both the field key and
value. For other fields, the processor hashes only the field value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">fingerprint</code></p></td>
<td align="left" valign="top"><p>Output field for the fingerprint.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">salt</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>&lt;none&gt;</p></td>
<td align="left" valign="top"><p><a href="https://en.wikipedia.org/wiki/Salt_(cryptography)" class="ulink" target="_top">Salt value</a> for the hash function.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">method</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">SHA-1</code></p></td>
<td align="left" valign="top"><p>The hash method used to
compute the fingerprint. Must be one of <code class="literal">MD5</code>, <code class="literal">SHA-1</code>, <code class="literal">SHA-256</code>, <code class="literal">SHA-512</code>, or
<code class="literal">MurmurHash3</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, the processor
ignores any missing <code class="literal">fields</code>. If all fields are missing, the processor silently
exits without modifying the document.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<h5><a id="fingerprint-processor-ex"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/fingerprint.asciidoc">edit</a></h5>
<p>The following example illustrates the use of the fingerprint processor:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "processors": [
      {
        "fingerprint": {
          "fields": ["user"]
        }
      }
    ]
  },
  "docs": [
    {
      "_source": {
        "user": {
          "last_name": "Smith",
          "first_name": "John",
          "date_of_birth": "1980-01-15",
          "is_active": true
        }
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/739.console"></div>
<p>Which produces the following result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        ...
        "_source": {
          "fingerprint" : "WbSUPW4zY1PBPehh2AA/sSxiRjw=",
          "user" : {
            "last_name" : "Smith",
            "first_name" : "John",
            "date_of_birth" : "1980-01-15",
            "is_active" : true
          }
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="foreach-processor"></a>Foreach processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/foreach.asciidoc">edit</a></h2>
</div></div></div>

<p>Runs an ingest processor on each element of an array or object.</p>
<p>All ingest processors can run on array or object elements. However, if the
number of elements is unknown, it can be cumbersome to process each one in the
same way.</p>
<p>The <code class="literal">foreach</code> processor lets you specify a <code class="literal">field</code> containing array or object
values and a <code class="literal">processor</code> to run on each element in the field.</p>
<div class="table">
<a id="foreach-options"></a>
<p class="title"><strong>Table 20. Foreach Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Foreach Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Field containing array or object
values.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">processor</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Ingest processor to run on each
element.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, the processor silently
exits without changing the document if the <code class="literal">field</code> is <code class="literal">null</code> or missing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<h4><a id="foreach-keys-values"></a>Access keys and values<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/foreach.asciidoc">edit</a></h4>
<p>When iterating through an array or object, the <code class="literal">foreach</code> processor stores the
current element&#8217;s value in the <code class="literal">_ingest._value</code> <a class="xref" href="ingest.html#access-ingest-metadata" title="Access ingest metadata in a processor">ingest
metadata</a> field. <code class="literal">_ingest._value</code> contains the entire element value, including
any child fields. You can access child field values using dot notation on the
<code class="literal">_ingest._value</code> field.</p>
<p>When iterating through an object, the <code class="literal">foreach</code> processor also stores the
current element&#8217;s key as a string in <code class="literal">_ingest._key</code>.</p>
<p>You can access and change <code class="literal">_ingest._key</code> and <code class="literal">_ingest._value</code> in the
<code class="literal">processor</code>. For an example, see the <a class="xref" href="processors.html#foreach-object-ex" title="Object">object
example</a>.</p>
<h4><a id="foreach-failure-handling"></a>Failure handling<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/foreach.asciidoc">edit</a></h4>
<p>If the <code class="literal">foreach</code> processor fails to process an element and no <code class="literal">on_failure</code>
processor is specified, the <code class="literal">foreach</code> processor silently exits. This leaves the
entire array or object value unchanged.</p>
<h4><a id="foreach-examples"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/foreach.asciidoc">edit</a></h4>
<p>The following examples show how you can use the <code class="literal">foreach</code> processor with
different data types and options:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="processors.html#foreach-array-ex" title="Array">Array</a>
</li>
<li class="listitem">
<a class="xref" href="processors.html#foreach-array-objects-ex" title="Array of objects">Array of objects</a>
</li>
<li class="listitem">
<a class="xref" href="processors.html#foreach-object-ex" title="Object">Object</a>
</li>
<li class="listitem">
<a class="xref" href="processors.html#failure-handling-ex" title="Failure handling">Failure handling</a>
</li>
</ul>
</div>
<h5><a id="foreach-array-ex"></a>Array<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/foreach.asciidoc">edit</a></h5>
<p>Assume the following document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "values" : ["foo", "bar", "baz"]
}</pre>
</div>
<p>When this <code class="literal">foreach</code> processor operates on this sample document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foreach" : {
    "field" : "values",
    "processor" : {
      "uppercase" : {
        "field" : "_ingest._value"
      }
    }
  }
}</pre>
</div>
<p>Then the document will look like this after processing:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "values" : ["FOO", "BAR", "BAZ"]
}</pre>
</div>
<h5><a id="foreach-array-objects-ex"></a>Array of objects<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/foreach.asciidoc">edit</a></h5>
<p>Assume the following document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "persons" : [
    {
      "id" : "1",
      "name" : "John Doe"
    },
    {
      "id" : "2",
      "name" : "Jane Doe"
    }
  ]
}</pre>
</div>
<p>In this case, the <code class="literal">id</code> field needs to be removed,
so the following <code class="literal">foreach</code> processor is used:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foreach" : {
    "field" : "persons",
    "processor" : {
      "remove" : {
        "field" : "_ingest._value.id"
      }
    }
  }
}</pre>
</div>
<p>After processing the result is:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "persons" : [
    {
      "name" : "John Doe"
    },
    {
      "name" : "Jane Doe"
    }
  ]
}</pre>
</div>
<p>For another array of objects example, refer to the
<a class="xref" href="processors.html#attachment-with-arrays" title="Using the attachment processor with arrays">attachment processor documentation</a>.</p>
<h5><a id="foreach-object-ex"></a>Object<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/foreach.asciidoc">edit</a></h5>
<p>You can also use the <code class="literal">foreach</code> processor on object fields. For example,
the following document contains a <code class="literal">products</code> field with object values.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "products" : {
    "widgets" : {
      "total_sales" : 50,
      "unit_price": 1.99,
      "display_name": ""
    },
    "sprockets" : {
      "total_sales" : 100,
      "unit_price": 9.99,
      "display_name": "Super Sprockets"
    },
    "whizbangs" : {
      "total_sales" : 200,
      "unit_price": 19.99,
      "display_name": "Wonderful Whizbangs"
    }
  }
}</pre>
</div>
<p>The following <code class="literal">foreach</code> processor changes the value of <code class="literal">products.display_name</code>
to uppercase.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foreach": {
    "field": "products",
    "processor": {
      "uppercase": {
        "field": "_ingest._value.display_name"
      }
    }
  }
}</pre>
</div>
<p>When run on the document, the <code class="literal">foreach</code> processor returns:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "products" : {
    "widgets" : {
      "total_sales" : 50,
      "unit_price" : 1.99,
      "display_name" : ""
    },
    "sprockets" : {
      "total_sales" : 100,
      "unit_price" : 9.99,
      "display_name" : "SUPER SPROCKETS"
    },
    "whizbangs" : {
      "total_sales" : 200,
      "unit_price" : 19.99,
      "display_name" : "WONDERFUL WHIZBANGS"
    }
  }
}</pre>
</div>
<p>The following <code class="literal">foreach</code> processor sets each element&#8217;s key to the
value of <code class="literal">products.display_name</code>. If <code class="literal">products.display_name</code> contains an empty string,
the processor deletes the element.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foreach": {
    "field": "products",
    "processor": {
      "set": {
        "field": "_ingest._key",
        "value": "{{_ingest._value.display_name}}"
      }
    }
  }
}</pre>
</div>
<p>When run on the previous document, the <code class="literal">foreach</code> processor returns:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "products" : {
    "Wonderful Whizbangs" : {
      "total_sales" : 200,
      "unit_price" : 19.99,
      "display_name" : "Wonderful Whizbangs"
    },
    "Super Sprockets" : {
      "total_sales" : 100,
      "unit_price" : 9.99,
      "display_name" : "Super Sprockets"
    }
  }
}</pre>
</div>
<h5><a id="failure-handling-ex"></a>Failure handling<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/foreach.asciidoc">edit</a></h5>
<p>The wrapped processor can have a <code class="literal">on_failure</code> definition.
For example, the <code class="literal">id</code> field may not exist on all person objects.
Instead of failing the index request, you can use an <code class="literal">on_failure</code>
block to send the document to the <em>failure_index</em> index for later inspection:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foreach" : {
    "field" : "persons",
    "processor" : {
      "remove" : {
        "field" : "_value.id",
        "on_failure" : [
          {
            "set" : {
              "field": "_index",
              "value": "failure_index"
            }
          }
        ]
      }
    }
  }
}</pre>
</div>
<p>In this example, if the <code class="literal">remove</code> processor does fail, then
the array elements that have been processed thus far will
be updated.</p>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ingest-geo-grid-processor"></a>Geo-grid processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geo-grid.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts geo-grid definitions of grid tiles or cells to regular bounding boxes or polygons which describe their shape.
This is useful if there is a need to interact with the tile shapes as spatially indexable fields.
For example the <code class="literal">geotile</code> field value <code class="literal">"4/8/3"</code> could be indexed as a string field, but that would not enable
any spatial operations on it.
Instead, convert it to the value
<code class="literal">"POLYGON ((0.0 40.979898069620134, 22.5 40.979898069620134, 22.5 55.77657301866769, 0.0 55.77657301866769, 0.0 40.979898069620134))"</code>,
which can be indexed as a <a class="xref" href="mapping-types.html#geo-shape" title="Geoshape field type"><code class="literal">geo_shape</code></a> field.</p>
<div class="table">
<a id="geo-grid-processor-options"></a>
<p class="title"><strong>Table 21. geo_grid processor options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="geo_grid processor options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to interpret as a geo-tile. The field format is determined by the <code class="literal">tile_type</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tile_type</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Three tile formats are understood: <code class="literal">geohash</code>, <code class="literal">geotile</code> and <code class="literal">geohex</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the polygon shape to, by default <code class="literal">field</code> is updated in-place.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">parent_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>If specified and a parent tile exists, save that tile address to this field.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">children_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>If specified and children tiles exist, save those tile addresses to this field as an array of strings.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">non_children_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>If specified and intersecting non-child tiles exist, save their addresses to this field as an array of strings.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">precision_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>If specified, save the tile precision (zoom) as an integer to this field.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_format</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>"GeoJSON"</p></td>
<td align="left" valign="top"><p>Which format to save the generated polygon in. Either <code class="literal">WKT</code> or <code class="literal">GeoJSON</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>To demonstrate the usage of this ingest processor, consider an index called <code class="literal">geocells</code>
with a mapping for a field <code class="literal">geocell</code> of type <code class="literal">geo_shape</code>.
In order to populate that index using <code class="literal">geotile</code> and <code class="literal">geohex</code> fields, define
two ingest processors:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT geocells
{
  "mappings": {
    "properties": {
      "geocell": {
        "type": "geo_shape"
      }
    }
  }
}

PUT _ingest/pipeline/geotile2shape
{
  "description": "translate rectangular z/x/y geotile to bounding box",
  "processors": [
    {
      "geo_grid": {
        "field": "geocell",
        "tile_type": "geotile"
      }
    }
  ]
}

PUT _ingest/pipeline/geohex2shape
{
  "description": "translate H3 cell to polygon",
  "processors": [
    {
      "geo_grid": {
        "field": "geocell",
        "tile_type": "geohex",
        "target_format": "wkt"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/740.console"></div>
<p>These two pipelines can be used to index documents into the <code class="literal">geocells</code> index.
The <code class="literal">geocell</code> field will be the string version of either a rectangular tile with format <code class="literal">z/x/y</code> or an H3 cell address,
depending on which ingest processor we use when indexing the document.
The resulting geometry will be represented and indexed as a <a class="xref" href="mapping-types.html#geo-shape" title="Geoshape field type"><code class="literal">geo_shape</code></a> field in either
<a href="http://geojson.org" class="ulink" target="_top">GeoJSON</a> or the <a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">Well-Known Text</a> format.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_example_rectangular_geotile_with_envelope_in_geojson"></a>Example: Rectangular geotile with envelope in GeoJSON<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geo-grid.asciidoc">edit</a></h3>
</div></div></div>
<p>In this example a <code class="literal">geocell</code> field with a value defined in <code class="literal">z/x/y</code> format is indexed as a
<a href="http://geojson.org" class="ulink" target="_top">GeoJSON Envelope</a> since the ingest-processor above was defined with default <code class="literal">target_format</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT geocells/_doc/1?pipeline=geotile2shape
{
  "geocell": "4/8/5"
}

GET geocells/_doc/1</pre>
</div>
<div class="console_widget" data-snippet="snippets/741.console"></div>
<p>The response shows how the ingest-processor has replaced the <code class="literal">geocell</code> field with an indexable <code class="literal">geo_shape</code>:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
 "_index": "geocells",
  "_id": "1",
  "_version": 1,
  "_seq_no": 0,
  "_primary_term": 1,
  "found": true,
  "_source": {
    "geocell": {
      "type": "Envelope",
      "coordinates": [
        [ 0.0, 55.77657301866769 ],
        [ 22.5, 40.979898069620134 ]
      ]
    }
  }
}</pre>
</div>
<p><span class="image"><img src="images/spatial/geogrid_tile.png" alt="Kibana map with showing the geotile at 4/8/5 and its four child cells"></span></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_example_hexagonal_geohex_with_polygon_in_wkt_format"></a>Example: Hexagonal geohex with polygon in WKT format<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geo-grid.asciidoc">edit</a></h3>
</div></div></div>
<p>In this example a <code class="literal">geocell</code> field with an H3 string address is indexed as a
<a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">WKT Polygon</a>, since this ingest processor explicitly
defined the <code class="literal">target_format</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT geocells/_doc/1?pipeline=geohex2shape
{
  "geocell": "811fbffffffffff"
}

GET geocells/_doc/1</pre>
</div>
<div class="console_widget" data-snippet="snippets/742.console"></div>
<p>The response shows how the ingest-processor has replaced the <code class="literal">geocell</code> field with an indexable <code class="literal">geo_shape</code>:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
 "_index": "geocells",
  "_id": "1",
  "_version": 1,
  "_seq_no": 0,
  "_primary_term": 1,
  "found": true,
  "_source": {
    "geocell": "POLYGON ((1.1885095294564962 49.470279179513454, 2.0265689212828875 45.18424864858389, 7.509948452934623 43.786609335802495, 12.6773177459836 46.40695743262768, 12.345747342333198 50.55427505169064, 6.259687012061477 51.964770150370896, 3.6300085578113794 50.610463307239115, 1.1885095294564962 49.470279179513454))"
  }
}</pre>
</div>
<p><span class="image"><img src="images/spatial/geogrid_h3.png" alt="Kibana map with showing an H3 cell" width="and its seven child cells"></span></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_example_enriched_tile_details"></a>Example: Enriched tile details<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geo-grid.asciidoc">edit</a></h3>
</div></div></div>
<p>As described in <a class="xref" href="processors.html#geo-grid-processor-options" title="geo_grid processor options">geo_grid processor options</a>,
there are many other fields that can be set, which will enrich the information available.
For example, with H3 tiles there are 7 child tiles, but only the first is fully contained by the parent.
The remaining six are only partially overlapping the parent, and there exist a further six non-child tiles
that overlap the parent.
This can be investigated by adding parent and child additional fields to the ingest-processor:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/geohex2shape
{
  "description": "translate H3 cell to polygon with enriched fields",
  "processors": [
    {
      "geo_grid": {
        "description": "Ingest H3 cells like '811fbffffffffff' and create polygons",
        "field": "geocell",
        "tile_type": "geohex",
        "target_format": "wkt",
        "target_field": "shape",
        "parent_field": "parent",
        "children_field": "children",
        "non_children_field": "nonChildren",
        "precision_field": "precision"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/743.console"></div>
<p>Index the document to see a different result:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT geocells/_doc/1?pipeline=geohex2shape
{
  "geocell": "811fbffffffffff"
}

GET geocells/_doc/1</pre>
</div>
<div class="console_widget" data-snippet="snippets/744.console"></div>
<p>The response from this index request:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "_index": "geocells",
  "_id": "1",
  "_version": 1,
  "_seq_no": 0,
  "_primary_term": 1,
  "found": true,
  "_source": {
    "parent": "801ffffffffffff",
    "geocell": "811fbffffffffff",
    "precision": 1,
    "shape": "POLYGON ((1.1885095294564962 49.470279179513454, 2.0265689212828875 45.18424864858389, 7.509948452934623 43.786609335802495, 12.6773177459836 46.40695743262768, 12.345747342333198 50.55427505169064, 6.259687012061477 51.964770150370896, 3.6300085578113794 50.610463307239115, 1.1885095294564962 49.470279179513454))",
    "children": [
      "821f87fffffffff",
      "821f8ffffffffff",
      "821f97fffffffff",
      "821f9ffffffffff",
      "821fa7fffffffff",
      "821faffffffffff",
      "821fb7fffffffff"
    ],
    "nonChildren": [
      "821ea7fffffffff",
      "82186ffffffffff",
      "82396ffffffffff",
      "821f17fffffffff",
      "821e37fffffffff",
      "82194ffffffffff"
    ]
  }
}</pre>
</div>
<p>This additional information will then enable, for example, creating a visualization of the H3 cell,
its children and its intersecting non-children cells.</p>
<p><span class="image"><img src="images/spatial/geogrid_h3_children.png" alt="Kibana map with three H3 layers: cell" width="children and intersecting non-children"></span></p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="geoip-processor"></a>GeoIP processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">geoip</code> processor adds information about the geographical location of an
IPv4 or IPv6 address.</p>
<p><a id="geoip-automatic-updates"></a>By default, the processor uses the GeoLite2 City, GeoLite2 Country, and GeoLite2
ASN GeoIP2 databases from <a href="http://dev.maxmind.com/geoip/geoip2/geolite2/" class="ulink" target="_top">MaxMind</a>, shared under the
CC BY-SA 4.0 license. It automatically downloads these databases if your nodes can connect to <code class="literal">storage.googleapis.com</code> domain and either:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">ingest.geoip.downloader.eager.download</code> is set to true
</li>
<li class="listitem">
your cluster has at least one pipeline with a <code class="literal">geoip</code> processor
</li>
</ul>
</div>
<p>Elasticsearch automatically downloads updates for these databases from the Elastic GeoIP
endpoint:
<a href="https://geoip.elastic.co/v1/database?elastic_geoip_service_tos=agree" class="ulink" target="_top">https://geoip.elastic.co/v1/database</a>.
To get download statistics for these updates, use the <a class="xref" href="ingest-apis.html#geoip-stats-api" title="GeoIP stats API">GeoIP
stats API</a>.</p>
<p>If your cluster can&#8217;t connect to the Elastic GeoIP endpoint or you want to
manage your own updates, see <a class="xref" href="processors.html#manage-geoip-database-updates" title="Manage your own GeoIP2 database updates">Manage your own GeoIP2 database updates</a>.</p>
<p>If Elasticsearch can&#8217;t connect to the endpoint for 30 days all updated databases will become
invalid. Elasticsearch will stop enriching documents with geoip data and will add <code class="literal">tags: ["_geoip_expired_database"]</code>
field instead.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="using-ingest-geoip"></a>Using the <code class="literal">geoip</code> Processor in a Pipeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h3>
</div></div></div>
<div class="table">
<a id="ingest-geoip-options"></a>
<p class="title"><strong>Table 22. <code class="literal">geoip</code> options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="geoip options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to get the ip address from for the geographical lookup.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>geoip</p></td>
<td align="left" valign="top"><p>The field that will hold the geographical information looked up from the MaxMind database.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">database_file</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>GeoLite2-City.mmdb</p></td>
<td align="left" valign="top"><p>The database filename referring to a database the module ships with (GeoLite2-City.mmdb, GeoLite2-Country.mmdb, or GeoLite2-ASN.mmdb) or a custom database in the <code class="literal">ingest-geoip</code> config directory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">properties</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>[<code class="literal">continent_name</code>, <code class="literal">country_iso_code</code>, <code class="literal">country_name</code>, <code class="literal">region_iso_code</code>, <code class="literal">region_name</code>, <code class="literal">city_name</code>, <code class="literal">location</code>] *</p></td>
<td align="left" valign="top"><p>Controls what properties are added to the <code class="literal">target_field</code> based on the geoip lookup.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">first_only</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> only first found geoip data will be returned, even if <code class="literal">field</code> contains array</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">download_database_on_pipeline_creation</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> (and if <code class="literal">ingest.geoip.downloader.eager.download</code> is <code class="literal">false</code>), the missing database is downloaded when the pipeline is created. Else, the download is triggered by when the pipeline is used as the <code class="literal">default_pipeline</code> or <code class="literal">final_pipeline</code> in an index.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>*Depends on what is available in <code class="literal">database_file</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the GeoLite2 City database is used, then the following fields may be added under the <code class="literal">target_field</code>: <code class="literal">ip</code>,
<code class="literal">country_iso_code</code>, <code class="literal">country_name</code>, <code class="literal">continent_name</code>, <code class="literal">region_iso_code</code>, <code class="literal">region_name</code>, <code class="literal">city_name</code>, <code class="literal">timezone</code>, <code class="literal">latitude</code>, <code class="literal">longitude</code>
and <code class="literal">location</code>. The fields actually added depend on what has been found and which properties were configured in <code class="literal">properties</code>.
</li>
<li class="listitem">
If the GeoLite2 Country database is used, then the following fields may be added under the <code class="literal">target_field</code>: <code class="literal">ip</code>,
<code class="literal">country_iso_code</code>, <code class="literal">country_name</code> and <code class="literal">continent_name</code>. The fields actually added depend on what has been found and which properties
were configured in <code class="literal">properties</code>.
</li>
<li class="listitem">
If the GeoLite2 ASN database is used, then the following fields may be added under the <code class="literal">target_field</code>: <code class="literal">ip</code>,
<code class="literal">asn</code>, <code class="literal">organization_name</code> and <code class="literal">network</code>. The fields actually added depend on what has been found and which properties were configured
in <code class="literal">properties</code>.
</li>
</ul>
</div>
<p>Here is an example that uses the default city database and adds the geographical information to the <code class="literal">geoip</code> field based on the <code class="literal">ip</code> field:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/geoip
{
  "description" : "Add geoip info",
  "processors" : [
    {
      "geoip" : {
        "field" : "ip"
      }
    }
  ]
}
PUT my-index-000001/_doc/my_id?pipeline=geoip
{
  "ip": "89.160.20.128"
}
GET my-index-000001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/745.console"></div>
<p>Which returns:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "my-index-000001",
  "_id": "my_id",
  "_version": 1,
  "_seq_no": 55,
  "_primary_term": 1,
  "_source": {
    "ip": "89.160.20.128",
    "geoip": {
      "continent_name": "Europe",
      "country_name": "Sweden",
      "country_iso_code": "SE",
      "city_name" : "Linköping",
      "region_iso_code" : "SE-E",
      "region_name" : "Östergötland County",
      "location": { "lat": 58.4167, "lon": 15.6167 }
    }
  }
}</pre>
</div>
<p>Here is an example that uses the default country database and adds the
geographical information to the <code class="literal">geo</code> field based on the <code class="literal">ip</code> field. Note that
this database is included in the module. So this:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/geoip
{
  "description" : "Add geoip info",
  "processors" : [
    {
      "geoip" : {
        "field" : "ip",
        "target_field" : "geo",
        "database_file" : "GeoLite2-Country.mmdb"
      }
    }
  ]
}
PUT my-index-000001/_doc/my_id?pipeline=geoip
{
  "ip": "89.160.20.128"
}
GET my-index-000001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/746.console"></div>
<p>returns this:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "my-index-000001",
  "_id": "my_id",
  "_version": 1,
  "_seq_no": 65,
  "_primary_term": 1,
  "_source": {
    "ip": "89.160.20.128",
    "geo": {
      "continent_name": "Europe",
      "country_name": "Sweden",
      "country_iso_code": "SE"
    }
  }
}</pre>
</div>
<p>Not all IP addresses find geo information from the database, When this
occurs, no <code class="literal">target_field</code> is inserted into the document.</p>
<p>Here is an example of what documents will be indexed as when information for "80.231.5.0"
cannot be found:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/geoip
{
  "description" : "Add geoip info",
  "processors" : [
    {
      "geoip" : {
        "field" : "ip"
      }
    }
  ]
}

PUT my-index-000001/_doc/my_id?pipeline=geoip
{
  "ip": "80.231.5.0"
}

GET my-index-000001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/747.console"></div>
<p>Which returns:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "_index" : "my-index-000001",
  "_id" : "my_id",
  "_version" : 1,
  "_seq_no" : 71,
  "_primary_term": 1,
  "found" : true,
  "_source" : {
    "ip" : "80.231.5.0"
  }
}</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ingest-geoip-mappings-note"></a>Recognizing Location as a Geopoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h4>
</div></div></div>
<p>Although this processor enriches your document with a <code class="literal">location</code> field containing
the estimated latitude and longitude of the IP address, this field will not be
indexed as a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.9/geo-point.html" class="ulink" target="_top"><code class="literal">geo_point</code></a> type in Elasticsearch without explicitly defining it
as such in the mapping.</p>
<p>You can use the following mapping for the example index above:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my_ip_locations
{
  "mappings": {
    "properties": {
      "geoip": {
        "properties": {
          "location": { "type": "geo_point" }
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/748.console"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="manage-geoip-database-updates"></a>Manage your own GeoIP2 database updates<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h3>
</div></div></div>
<p>If you can&#8217;t <a class="xref" href="processors.html#geoip-automatic-updates">automatically update</a> your GeoIP2
databases from the Elastic endpoint, you have a few other options:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="processors.html#use-proxy-geoip-endpoint">Use a proxy endpoint</a>
</li>
<li class="listitem">
<a class="xref" href="processors.html#use-custom-geoip-endpoint">Use a custom endpoint</a>
</li>
<li class="listitem">
<a class="xref" href="processors.html#manually-update-geoip-databases">Manually update your GeoIP2 databases</a>
</li>
</ul>
</div>
<p><a id="use-proxy-geoip-endpoint"></a><span class="strong strong"><strong>Use a proxy endpoint</strong></span></p>
<p>If you can&#8217;t connect directly to the Elastic GeoIP endpoint, consider setting up
a secure proxy. You can then specify the proxy endpoint URL in the
<a class="xref" href="processors.html#ingest-geoip-downloader-endpoint"><code class="literal">ingest.geoip.downloader.endpoint</code></a> setting
of each node’s <code class="literal">elasticsearch.yml</code> file.</p>
<p>In a strict setup the following domains may need to be added to the allowed
domains list:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">geoip.elastic.co</code>
</li>
<li class="listitem">
<code class="literal">storage.googleapis.com</code>
</li>
</ul>
</div>
<p><a id="use-custom-geoip-endpoint"></a><span class="strong strong"><strong>Use a custom endpoint</strong></span></p>
<p>You can create a service that mimics the Elastic GeoIP endpoint. You can then
get automatic updates from this service.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Download your <code class="literal">.mmdb</code> database files from the
<a href="http://dev.maxmind.com/geoip/geoip2/geolite2" class="ulink" target="_top">MaxMind site</a>.
</li>
<li class="listitem">
Copy your database files to a single directory.
</li>
<li class="listitem">
<p>From your Elasticsearch directory, run:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">./bin/elasticsearch-geoip -s my/source/dir [-t target/directory]</pre>
</div>
</li>
<li class="listitem">
<p>Serve the static database files from your directory. For example, you can use
Docker to serve the files from an nginx server:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">docker run -v my/source/dir:/usr/share/nginx/html:ro nginx</pre>
</div>
</li>
<li class="listitem">
<p>Specify the service&#8217;s endpoint URL in the
<a class="xref" href="processors.html#ingest-geoip-downloader-endpoint"><code class="literal">ingest.geoip.downloader.endpoint</code></a> setting
of each node’s <code class="literal">elasticsearch.yml</code> file.</p>
<p>By default, Elasticsearch checks the endpoint for updates every three days. To use
another polling interval, use the <a class="xref" href="cluster.html#cluster-update-settings" title="Cluster update settings API">cluster update
settings API</a> to set
<a class="xref" href="processors.html#ingest-geoip-downloader-poll-interval"><code class="literal">ingest.geoip.downloader.poll.interval</code></a>.</p>
</li>
</ol>
</div>
<p><a id="manually-update-geoip-databases"></a><span class="strong strong"><strong>Manually update your GeoIP2 databases</strong></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Use the <a class="xref" href="cluster.html#cluster-update-settings" title="Cluster update settings API">cluster update settings API</a> to set
<code class="literal">ingest.geoip.downloader.enabled</code> to <code class="literal">false</code>. This disables automatic updates
that may overwrite your database changes. This also deletes all downloaded
databases.
</li>
<li class="listitem">
<p>Download your <code class="literal">.mmdb</code> database files from the
<a href="http://dev.maxmind.com/geoip/geoip2/geolite2" class="ulink" target="_top">MaxMind site</a>.</p>
<p>You can also use custom city, country, and ASN <code class="literal">.mmdb</code> files. These files must
be uncompressed and use the respective <code class="literal">-City.mmdb</code>, <code class="literal">-Country.mmdb</code>, or
<code class="literal">-ASN.mmdb</code> extensions.</p>
</li>
<li class="listitem">
On Elasticsearch Service deployments upload database using
a <a href="https://www.elastic.co/guide/en/cloud/current/ec-custom-bundles.html" class="ulink" target="_top">custom bundle</a>.
</li>
<li class="listitem">
On self-managed deployments copy the database files to <code class="literal">$ES_CONFIG/ingest-geoip</code>.
</li>
<li class="listitem">
In your <code class="literal">geoip</code> processors, configure the <code class="literal">database_file</code> parameter to use a
custom database file.
</li>
</ol>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ingest-geoip-settings"></a>Node Settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">geoip</code> processor supports the following setting:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ingest.geoip.cache_size</code>
</span>
</dt>
<dd>
The maximum number of results that should be cached. Defaults to <code class="literal">1000</code>.
</dd>
</dl>
</div>
<p>Note that these settings are node settings and apply to all <code class="literal">geoip</code> processors, i.e. there is one cache for all defined <code class="literal">geoip</code> processors.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="geoip-cluster-settings"></a>Cluster settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<a id="ingest-geoip-downloader-enabled"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ingest.geoip.downloader.enabled</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#dynamic-cluster-setting">Dynamic</a>, Boolean)
If <code class="literal">true</code>, Elasticsearch automatically downloads and manages updates for GeoIP2 databases
from the <code class="literal">ingest.geoip.downloader.endpoint</code>. If <code class="literal">false</code>, Elasticsearch does not download
updates and deletes all downloaded databases. Defaults to <code class="literal">true</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="ingest-geoip-downloader-eager-download"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ingest.geoip.downloader.eager.download</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#dynamic-cluster-setting">Dynamic</a>, Boolean)
If <code class="literal">true</code>, Elasticsearch downloads GeoIP2 databases immediately, regardless of whether a
pipeline exists with a geoip processor. If <code class="literal">false</code>, Elasticsearch only begins downloading
the databases if a pipeline with a geoip processor exists or is added. Defaults
to <code class="literal">false</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="ingest-geoip-downloader-endpoint"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ingest.geoip.downloader.endpoint</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Endpoint URL used to download updates for GeoIP2 databases. For example, <code class="literal">https://myDomain.com/overview.json</code>.
Defaults to <code class="literal">https://geoip.elastic.co/v1/database</code>. Elasticsearch stores downloaded database files in
each node&#8217;s <a class="xref" href="settings.html#es-tmpdir" title="Temporary directory settings">temporary directory</a> at <code class="literal">$ES_TMPDIR/geoip-databases/&lt;node_id&gt;</code>.
Note that Elasticsearch will make a GET request to <code class="literal">${ingest.geoip.downloader.endpoint}?elastic_geoip_service_tos=agree</code>,
expecting the list of metadata about databases typically found in <code class="literal">overview.json</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="ingest-geoip-downloader-poll-interval"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ingest.geoip.downloader.poll.interval</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#dynamic-cluster-setting">Dynamic</a>, <a class="xref" href="api-conventions.html#time-units" title="Time units">time value</a>)
How often Elasticsearch checks for GeoIP2 database updates at the
<code class="literal">ingest.geoip.downloader.endpoint</code>. Must be greater than <code class="literal">1d</code> (one day). Defaults
to <code class="literal">3d</code> (three days).
</dd>
</dl>
</div>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="grok-processor"></a>Grok processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/grok.asciidoc">edit</a></h2>
</div></div></div>

<p>Extracts structured fields out of a single text field within a document. You choose which field to
extract matched fields from, as well as the grok pattern you expect will match. A grok pattern is like a regular
expression that supports aliased expressions that can be reused.</p>
<p>This processor comes packaged with many
<a href="https://github.com/elastic/elasticsearch/blob/8.9/libs/grok/src/main/resources/patterns" class="ulink" target="_top">reusable patterns</a>.</p>
<p>If you need help building patterns to match your logs, you will find the
<a href="https://www.elastic.co/guide/en/kibana/8.9/xpack-grokdebugger.html" class="ulink" target="_top">Grok Debugger</a> tool quite useful!
The <a href="https://grokconstructor.appspot.com" class="ulink" target="_top">Grok Constructor</a> is also a useful tool.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="using-grok"></a>Using the Grok Processor in a Pipeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<div class="table">
<a id="grok-options"></a>
<p class="title"><strong>Table 23. Grok Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Grok Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to use for grok expression parsing</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">patterns</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An ordered list of grok expression to match and extract named captures with. Returns on the first expression in the list that matches.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">pattern_definitions</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>A map of pattern-name and pattern tuples defining custom patterns to be used by the current processor. Patterns matching existing names will override the pre-existing definition.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ecs_compatibility</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">disabled</code></p></td>
<td align="left" valign="top"><p>Must be <code class="literal">disabled</code> or <code class="literal">v1</code>. If <code class="literal">v1</code>, the processor uses patterns with <a href="https://www.elastic.co/guide/en/ecs/8.9/ecs-field-reference.html" class="ulink" target="_top">Elastic Common Schema (ECS)</a> field names.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">trace_match</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>when true, <code class="literal">_ingest._grok_match_index</code> will be inserted into your matched document&#8217;s metadata with the index into the pattern found in <code class="literal">patterns</code> that matched.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example of using the provided patterns to extract out and name structured fields from a string field in
a document.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "description" : "...",
    "processors": [
      {
        "grok": {
          "field": "message",
          "patterns": ["%{IP:client} %{WORD:method} %{URIPATHPARAM:request} %{NUMBER:bytes:int} %{NUMBER:duration:double}"]
        }
      }
    ]
  },
  "docs":[
    {
      "_source": {
        "message": "55.3.244.1 GET /index.html 15824 0.043"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/749.console"></div>
<p>This pipeline will insert these named captures as new fields within the document, like so:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_index": "_index",
        "_id": "_id",
        "_version": "-3",
        "_source" : {
          "duration" : 0.043,
          "request" : "/index.html",
          "method" : "GET",
          "bytes" : 15824,
          "client" : "55.3.244.1",
          "message" : "55.3.244.1 GET /index.html 15824 0.043"
        },
        "_ingest": {
          "timestamp": "2016-11-08T19:43:03.850+0000"
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="custom-patterns"></a>Custom Patterns<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>The Grok processor comes pre-packaged with a base set of patterns. These patterns may not always have
what you are looking for. Patterns have a very basic format. Each entry has a name and the pattern itself.</p>
<p>You can add your own patterns to a processor definition under the <code class="literal">pattern_definitions</code> option.
Here is an example of a pipeline specifying custom pattern definitions:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "...",
  "processors": [
    {
      "grok": {
        "field": "message",
        "patterns": ["my %{FAVORITE_DOG:dog} is colored %{RGB:color}"],
        "pattern_definitions" : {
          "FAVORITE_DOG" : "beagle",
          "RGB" : "RED|GREEN|BLUE"
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="trace-match"></a>Providing Multiple Match Patterns<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>Sometimes one pattern is not enough to capture the potential structure of a field. Let&#8217;s assume we
want to match all messages that contain your favorite pet breeds of either cats or dogs. One way to accomplish
this is to provide two distinct patterns that can be matched, instead of one really complicated expression capturing
the same <code class="literal">or</code> behavior.</p>
<p>Here is an example of such a configuration executed against the simulate API:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
  "description" : "parse multiple patterns",
  "processors": [
    {
      "grok": {
        "field": "message",
        "patterns": ["%{FAVORITE_DOG:pet}", "%{FAVORITE_CAT:pet}"],
        "pattern_definitions" : {
          "FAVORITE_DOG" : "beagle",
          "FAVORITE_CAT" : "burmese"
        }
      }
    }
  ]
},
"docs":[
  {
    "_source": {
      "message": "I love burmese cats!"
    }
  }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/750.console"></div>
<p>response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_index": "_index",
        "_id": "_id",
        "_version": "-3",
        "_source": {
          "message": "I love burmese cats!",
          "pet": "burmese"
        },
        "_ingest": {
          "timestamp": "2016-11-08T19:43:03.850+0000"
        }
      }
    }
  ]
}</pre>
</div>
<p>Both patterns will set the field <code class="literal">pet</code> with the appropriate match, but what if we want to trace which of our
patterns matched and populated our fields? We can do this with the <code class="literal">trace_match</code> parameter. Here is the output of
that same pipeline, but with <code class="literal">"trace_match": true</code> configured:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_index": "_index",
        "_id": "_id",
        "_version": "-3",
        "_source": {
          "message": "I love burmese cats!",
          "pet": "burmese"
        },
        "_ingest": {
          "_grok_match_index": "1",
          "timestamp": "2016-11-08T19:43:03.850+0000"
        }
      }
    }
  ]
}</pre>
</div>
<p>In the above response, you can see that the index of the pattern that matched was <code class="literal">"1"</code>. This is to say that it was the
second (index starts at zero) pattern in <code class="literal">patterns</code> to match.</p>
<p>This trace metadata enables debugging which of the patterns matched. This information is stored in the ingest
metadata and will not be indexed.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="grok-processor-rest-get"></a>Retrieving patterns from REST endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>The Grok processor comes packaged with its own REST endpoint for retrieving the patterns included with the processor.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _ingest/processor/grok</pre>
</div>
<div class="console_widget" data-snippet="snippets/751.console"></div>
<p>The above request will return a response body containing a key-value representation of the built-in patterns dictionary.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "patterns" : {
    "BACULA_CAPACITY" : "%{INT}{1,3}(,%{INT}{3})*",
    "PATH" : "(?:%{UNIXPATH}|%{WINPATH})",
    ...
}</pre>
</div>
<p>By default, the API returns a list of legacy Grok patterns. These legacy
patterns predate the <a href="https://www.elastic.co/guide/en/ecs/8.9/ecs-field-reference.html" class="ulink" target="_top">Elastic Common Schema
(ECS)</a> and don&#8217;t use ECS field names. To return patterns that extract ECS field
names, specify <code class="literal">v1</code> in the optional <code class="literal">ecs_compatibility</code> query parameter.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _ingest/processor/grok?ecs_compatibility=v1</pre>
</div>
<div class="console_widget" data-snippet="snippets/752.console"></div>
<p>By default, the API returns patterns in the order they are read from disk. This
sort order preserves groupings of related patterns. For example, all patterns
related to parsing Linux syslog lines stay grouped together.</p>
<p>You can use the optional boolean <code class="literal">s</code> query parameter to sort returned patterns
by key name instead.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _ingest/processor/grok?s</pre>
</div>
<div class="console_widget" data-snippet="snippets/753.console"></div>
<p>The API returns the following response.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "patterns" : {
    "BACULA_CAPACITY" : "%{INT}{1,3}(,%{INT}{3})*",
    "BACULA_DEVICE" : "%{USER}",
    "BACULA_DEVICEPATH" : "%{UNIXPATH}",
    ...
}</pre>
</div>
<p>This can be useful to reference as the built-in patterns change across versions.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="grok-watchdog"></a>Grok watchdog<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>Grok expressions that take too long to execute are interrupted and
the grok processor then fails with an exception. The grok
processor has a watchdog thread that determines when evaluation of
a grok expression takes too long and is controlled by the following
settings:</p>
<div class="table">
<a id="grok-watchdog-options"></a>
<p class="title"><strong>Table 24. Grok watchdog settings</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Grok watchdog settings">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ingest.grok.watchdog.interval</code></p></td>
<td align="left" valign="top"><p>1s</p></td>
<td align="left" valign="top"><p>How often to check whether there are grok evaluations that take longer than the maximum allowed execution time.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ingest.grok.watchdog.max_execution_time</code></p></td>
<td align="left" valign="top"><p>1s</p></td>
<td align="left" valign="top"><p>The maximum allowed execution of a grok expression evaluation.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="grok-debugging"></a>Grok debugging<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>It is advised to use the <a href="https://www.elastic.co/guide/en/kibana/8.9/xpack-grokdebugger.html" class="ulink" target="_top">Grok Debugger</a> to debug grok patterns. From there you can test one or more
patterns in the UI against sample data. Under the covers it uses the same engine as ingest node processor.</p>
<p>Additionally, it is recommended to enable debug logging for Grok so that any additional messages may also be seen in the Elasticsearch
server log.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">PUT _cluster/settings
{
  "persistent": {
    "logger.org.elasticsearch.ingest.common.GrokProcessor": "debug"
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="gsub-processor"></a>Gsub processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/gsub.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a string field by applying a regular expression and a replacement.
If the field is an array of string, all members of the array will be converted. If any non-string values are encountered, the processor will throw an exception.</p>
<div class="table">
<a id="gsub-options"></a>
<p class="title"><strong>Table 25. Gsub Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Gsub Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to apply the replacement to</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">pattern</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The pattern to be replaced</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">replacement</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The string to replace the matching patterns with</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "gsub": {
    "field": "field1",
    "pattern": "\\.",
    "replacement": "-"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="htmlstrip-processor"></a>HTML strip processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/html_strip.asciidoc">edit</a></h2>
</div></div></div>

<p>Removes HTML tags from the field. If the field is an array of strings, HTML tags will be removed from all members of the array.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Each HTML tag is replaced with a <code class="literal">\n</code> character.</p>
</div>
</div>
<div class="table">
<a id="htmlstrip-options"></a>
<p class="title"><strong>Table 26. HTML Strip Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="HTML Strip Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The string-valued field to remove HTML tags from</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "html_strip": {
    "field": "foo"
  }
}</pre>
</div>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="inference-processor"></a>Inference processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h2>
</div></div></div>

<p>Uses a pre-trained data frame analytics model or a model deployed for natural
language processing tasks to infer against the data that is being
ingested in the pipeline.</p>
<div class="table">
<a id="inference-options"></a>
<p class="title"><strong>Table 27. Inference Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Inference Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">model_id</code> .</p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>(String) The ID or alias for the trained model, or the ID of the deployment.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">ml.inference.&lt;processor_tag&gt;</code></p></td>
<td align="left" valign="top"><p>(String) Field added to incoming documents to contain results objects.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">field_map</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>If defined the model&#8217;s default field map</p></td>
<td align="left" valign="top"><p>(Object) Maps the document field names to the known field names of the model. This mapping takes precedence over any default mappings provided in the model configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">inference_config</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>The default settings defined in the model</p></td>
<td align="left" valign="top"><p>(Object) Contains the inference type and its options.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "inference": {
    "model_id": "model_deployment_for_inference",
    "target_field": "FlightDelayMin_prediction_infer",
    "field_map": {
      "your_field": "my_field"
    },
    "inference_config": { "regression": {} }
  }
}</pre>
</div>
<h4><a id="inference-processor-classification-opt"></a>Classification configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<p>Classification configuration for inference.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">num_top_classes</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the number of top class predictions to return. Defaults to 0.
</dd>
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/8.9/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document. Defaults
to 0 which means no feature importance calculation occurs.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to the <code class="literal">results_field</code> value of the data frame analytics job that was
used to train the model, which defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">top_classes_results_field</code>
</span>
</dt>
<dd>
(Optional, string)
Specifies the field to which the top classes are written. Defaults to
<code class="literal">top_classes</code>.
</dd>
<dt>
<span class="term">
<code class="literal">prediction_field_type</code>
</span>
</dt>
<dd>
(Optional, string)
Specifies the type of the predicted field to write.
Valid values are: <code class="literal">string</code>, <code class="literal">number</code>, <code class="literal">boolean</code>. When <code class="literal">boolean</code> is provided
<code class="literal">1.0</code> is transformed to <code class="literal">true</code> and <code class="literal">0.0</code> to <code class="literal">false</code>.
</dd>
</dl>
</div>
<h4><a id="inference-processor-fill-mask-opt"></a>Fill mask configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">num_top_classes</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the number of top class predictions to return. Defaults to 0.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to the <code class="literal">results_field</code> value of the data frame analytics job that was
used to train the model, which defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">tokenization</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Indicates the tokenization to perform and the desired settings.
The default tokenization configuration is <code class="literal">bert</code>. Valid tokenization
values are
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">bert</code>: Use for BERT-style models
</li>
<li class="listitem">
<code class="literal">mpnet</code>: Use for MPNet-style models
</li>
<li class="listitem">
<code class="literal">roberta</code>: Use for RoBERTa-style and BART-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">xlm_roberta</code>: Use for XLMRoBERTa-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">bert_ja</code>: Use for BERT-style models trained for the Japanese
language.
</li>
</ul>
</div>
<details open>
<summary class="title">Properties of tokenization</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">bert</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
BERT-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of bert</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">roberta</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
RoBERTa-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of roberta</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">mpnet</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
MPNet-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of mpnet</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<h4><a id="inference-processor-ner-opt"></a>NER configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to the <code class="literal">results_field</code> value of the data frame analytics job that was
used to train the model, which defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">tokenization</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Indicates the tokenization to perform and the desired settings.
The default tokenization configuration is <code class="literal">bert</code>. Valid tokenization
values are
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">bert</code>: Use for BERT-style models
</li>
<li class="listitem">
<code class="literal">mpnet</code>: Use for MPNet-style models
</li>
<li class="listitem">
<code class="literal">roberta</code>: Use for RoBERTa-style and BART-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">xlm_roberta</code>: Use for XLMRoBERTa-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">bert_ja</code>: Use for BERT-style models trained for the Japanese
language.
</li>
</ul>
</div>
<details open>
<summary class="title">Properties of tokenization</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">bert</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
BERT-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of bert</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">roberta</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
RoBERTa-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of roberta</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">mpnet</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
MPNet-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of mpnet</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<h4><a id="inference-processor-regression-opt"></a>Regression configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<p>Regression configuration for inference.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to the <code class="literal">results_field</code> value of the data frame analytics job that was
used to train the model, which defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/8.9/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document.
By default, it is zero and no feature importance calculation occurs.
</dd>
</dl>
</div>
<h4><a id="inference-processor-text-classification-opt"></a>Text classification configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">classification_labels</code>
</span>
</dt>
<dd>
(Optional, string) An array of classification labels.
</dd>
<dt>
<span class="term">
<code class="literal">num_top_classes</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the number of top class predictions to return. Defaults to 0.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to the <code class="literal">results_field</code> value of the data frame analytics job that was
used to train the model, which defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">tokenization</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Indicates the tokenization to perform and the desired settings.
The default tokenization configuration is <code class="literal">bert</code>. Valid tokenization
values are
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">bert</code>: Use for BERT-style models
</li>
<li class="listitem">
<code class="literal">mpnet</code>: Use for MPNet-style models
</li>
<li class="listitem">
<code class="literal">roberta</code>: Use for RoBERTa-style and BART-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">xlm_roberta</code>: Use for XLMRoBERTa-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">bert_ja</code>: Use for BERT-style models trained for the Japanese
language.
</li>
</ul>
</div>
<details open>
<summary class="title">Properties of tokenization</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">bert</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
BERT-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of bert</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">span</code>
</span>
</dt>
<dd>
<p>
(Optional, integer)
When <code class="literal">truncate</code> is <code class="literal">none</code>, you can partition longer text sequences
for inference. The value indicates how many tokens overlap between each
subsequence.
</p>
<p>The default value is <code class="literal">-1</code>, indicating no windowing or spanning occurs.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When your typical input is just slightly larger than <code class="literal">max_sequence_length</code>, it may be best to simply truncate;
there will be very little information in the second subsequence.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">roberta</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
RoBERTa-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of roberta</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">span</code>
</span>
</dt>
<dd>
<p>
(Optional, integer)
When <code class="literal">truncate</code> is <code class="literal">none</code>, you can partition longer text sequences
for inference. The value indicates how many tokens overlap between each
subsequence.
</p>
<p>The default value is <code class="literal">-1</code>, indicating no windowing or spanning occurs.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When your typical input is just slightly larger than <code class="literal">max_sequence_length</code>, it may be best to simply truncate;
there will be very little information in the second subsequence.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">mpnet</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
MPNet-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of mpnet</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<h4><a id="inference-processor-text-embedding-opt"></a>Text embedding configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to the <code class="literal">results_field</code> value of the data frame analytics job that was
used to train the model, which defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">tokenization</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Indicates the tokenization to perform and the desired settings.
The default tokenization configuration is <code class="literal">bert</code>. Valid tokenization
values are
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">bert</code>: Use for BERT-style models
</li>
<li class="listitem">
<code class="literal">mpnet</code>: Use for MPNet-style models
</li>
<li class="listitem">
<code class="literal">roberta</code>: Use for RoBERTa-style and BART-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">xlm_roberta</code>: Use for XLMRoBERTa-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">bert_ja</code>: Use for BERT-style models trained for the Japanese
language.
</li>
</ul>
</div>
<details open>
<summary class="title">Properties of tokenization</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">bert</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
BERT-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of bert</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">roberta</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
RoBERTa-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of roberta</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">mpnet</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
MPNet-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of mpnet</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<h4><a id="inference-processor-zero-shot-opt"></a>Zero shot classification configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">labels</code>
</span>
</dt>
<dd>
(Optional, array)
The labels to classify. Can be set at creation for default labels, and
then updated during inference.
</dd>
<dt>
<span class="term">
<code class="literal">multi_label</code>
</span>
</dt>
<dd>
(Optional, boolean)
Indicates if more than one <code class="literal">true</code> label is possible given the input.
This is useful when labeling text that could pertain to more than one of the
input labels. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to the <code class="literal">results_field</code> value of the data frame analytics job that was
used to train the model, which defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">tokenization</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Indicates the tokenization to perform and the desired settings.
The default tokenization configuration is <code class="literal">bert</code>. Valid tokenization
values are
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">bert</code>: Use for BERT-style models
</li>
<li class="listitem">
<code class="literal">mpnet</code>: Use for MPNet-style models
</li>
<li class="listitem">
<code class="literal">roberta</code>: Use for RoBERTa-style and BART-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">xlm_roberta</code>: Use for XLMRoBERTa-style models
</li>
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> <code class="literal">bert_ja</code>: Use for BERT-style models trained for the Japanese
language.
</li>
</ul>
</div>
<details open>
<summary class="title">Properties of tokenization</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">bert</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
BERT-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of bert</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">roberta</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
RoBERTa-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of roberta</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">mpnet</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
MPNet-style tokenization is to be performed with the enclosed settings.
</p>
<details open>
<summary class="title">Properties of mpnet</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">truncate</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Indicates how tokens are truncated when they exceed <code class="literal">max_sequence_length</code>.
The default value is <code class="literal">first</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">none</code>: No truncation occurs; the inference request receives an error.
</li>
<li class="listitem">
<code class="literal">first</code>: Only the first sequence is truncated.
</li>
<li class="listitem">
<code class="literal">second</code>: Only the second sequence is truncated. If there is just one sequence,
that sequence is truncated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">zero_shot_classification</code>, the hypothesis sequence is always the second
sequence. Therefore, do not use <code class="literal">second</code> in this case.</p>
</div>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<h4><a id="inference-processor-config-example"></a>Inference processor examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"inference":{
  "model_id": "my_model_id",
  "field_map": {
    "original_fieldname": "expected_fieldname"
  },
  "inference_config": {
    "regression": {
      "results_field": "my_regression"
    }
  }
}</pre>
</div>
<p>This configuration specifies a <code class="literal">regression</code> inference and the results are
written to the <code class="literal">my_regression</code> field contained in the <code class="literal">target_field</code> results
object. The <code class="literal">field_map</code> configuration maps the field <code class="literal">original_fieldname</code> from
the source document to the field expected by the model.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"inference":{
  "model_id":"my_model_id"
  "inference_config": {
    "classification": {
      "num_top_classes": 2,
      "results_field": "prediction",
      "top_classes_results_field": "probabilities"
    }
  }
}</pre>
</div>
<p>This configuration specifies a <code class="literal">classification</code> inference. The number of
categories for which the predicted probabilities are reported is 2
(<code class="literal">num_top_classes</code>). The result is written to the <code class="literal">prediction</code> field and the top
classes to the <code class="literal">probabilities</code> field. Both fields are contained in the
<code class="literal">target_field</code> results object.</p>
<p>For an example that uses natural language processing trained models, refer to
<a href="https://www.elastic.co/guide/en/machine-learning/8.9/ml-nlp-inference.html" class="ulink" target="_top">Add NLP inference to ingest pipelines</a>.</p>
<h4><a id="inference-processor-feature-importance"></a>Feature importance object mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<p>To get the full benefit of aggregating and searching for
<a href="https://www.elastic.co/guide/en/machine-learning/8.9/ml-feature-importance.html" class="ulink" target="_top">feature importance</a>, update your index mapping of
the feature importance result field as you can see below:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"ml.inference.feature_importance": {
  "type": "nested",
  "dynamic": true,
  "properties": {
    "feature_name": {
      "type": "keyword"
    },
    "importance": {
      "type": "double"
    }
  }
}</pre>
</div>
<p>The mapping field name for feature importance (in the example above, it is
<code class="literal">ml.inference.feature_importance</code>) is compounded as follows:</p>
<p><code class="literal">&lt;ml.inference.target_field&gt;</code>.<code class="literal">&lt;inference.tag&gt;</code>.<code class="literal">feature_importance</code></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">&lt;ml.inference.target_field&gt;</code>: defaults to <code class="literal">ml.inference</code>.
</li>
<li class="listitem">
<code class="literal">&lt;inference.tag&gt;</code>: if is not provided in the processor definition, then it is
not part of the field path.
</li>
</ul>
</div>
<p>For example, if you provide a tag <code class="literal">foo</code> in the definition as you can see below:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "tag": "foo",
  ...
}</pre>
</div>
<p>Then, the feature importance value is written to the
<code class="literal">ml.inference.foo.feature_importance</code> field.</p>
<p>You can also specify the target field as follows:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "tag": "foo",
  "target_field": "my_field"
}</pre>
</div>
<p>In this case, feature importance is exposed in the
<code class="literal">my_field.foo.feature_importance</code> field.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="join-processor"></a>Join processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/join.asciidoc">edit</a></h2>
</div></div></div>

<p>Joins each element of an array into a single string using a separator character between each element.
Throws an error when the field is not an array.</p>
<div class="table">
<a id="join-options"></a>
<p class="title"><strong>Table 28. Join Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Join Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Field containing array values to join</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">separator</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The separator character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the joined value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "join": {
    "field": "joined_array_field",
    "separator": "-"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="json-processor"></a>JSON processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/json.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a JSON string into a structured JSON object.</p>
<div class="table">
<a id="json-options"></a>
<p class="title"><strong>Table 29. Json Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Json Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be parsed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field that the converted structured object will be written into. Any existing content in this field will be overwritten.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">add_to_root</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>Flag that forces the parsed JSON to be added at the top level of the document. <code class="literal">target_field</code> must not be set when this option is chosen.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">add_to_root_conflict_strategy</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">replace</code></p></td>
<td align="left" valign="top"><p>When set to <code class="literal">replace</code>, root fields that conflict with fields from the parsed JSON will be overridden. When set to <code class="literal">merge</code>, conflicting fields will be merged. Only applicable if <code class="literal">add_to_root</code> is set to <code class="literal">true</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">allow_duplicate_keys</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>When set to <code class="literal">true</code>, the JSON parser will not fail if the JSON contains duplicate keys. Instead, the last encountered value for any duplicate key wins.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">strict_json_parsing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>true</p></td>
<td align="left" valign="top"><p>When set to <code class="literal">true</code>, the JSON parser will strictly parse the field value. When set to <code class="literal">false</code>, the JSON parser will be more lenient but also more likely to drop parts of the field value. For example if <code class="literal">strict_json_parsing</code> is set to <code class="literal">true</code> and the field value is <code class="literal">123 "foo"</code> then the processor will throw an IllegalArgumentException. But if <code class="literal">strict_json_parsing</code> is set to <code class="literal">false</code> then the field value will be parsed as <code class="literal">123</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>All JSON-supported types will be parsed (null, boolean, number, array, object, string).</p>
<p>Suppose you provide this configuration of the <code class="literal">json</code> processor:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "json" : {
    "field" : "string_source",
    "target_field" : "json_target"
  }
}</pre>
</div>
<p>If the following document is processed:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "string_source": "{\"foo\": 2000}"
}</pre>
</div>
<p>after the <code class="literal">json</code> processor operates on it, it will look like:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "string_source": "{\"foo\": 2000}",
  "json_target": {
    "foo": 2000
  }
}</pre>
</div>
<p>If the following configuration is provided, omitting the optional <code class="literal">target_field</code> setting:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "json" : {
    "field" : "source_and_target"
  }
}</pre>
</div>
<p>then after the <code class="literal">json</code> processor operates on this document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "source_and_target": "{\"foo\": 2000}"
}</pre>
</div>
<p>it will look like:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "source_and_target": {
    "foo": 2000
  }
}</pre>
</div>
<p>This illustrates that, unless it is explicitly named in the processor configuration, the <code class="literal">target_field</code>
is the same field provided in the required <code class="literal">field</code> configuration.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="kv-processor"></a>KV processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/kv.asciidoc">edit</a></h2>
</div></div></div>

<p>This processor helps automatically parse messages (or specific event fields) which are of the <code class="literal">foo=bar</code> variety.</p>
<p>For example, if you have a log message which contains <code class="literal">ip=1.2.3.4 error=REFUSED</code>, you can parse those fields automatically by configuring:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "kv": {
    "field": "message",
    "field_split": " ",
    "value_split": "="
  }
}</pre>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using the KV Processor can result in field names that you cannot control. Consider using the <a class="xref" href="mapping-types.html#flattened" title="Flattened field type">Flattened</a> data type instead, which maps an entire object as a single field and allows for simple searches over its contents.</p>
</div>
</div>
<div class="table">
<a id="kv-options"></a>
<p class="title"><strong>Table 30. KV Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="KV Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be parsed. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">field_split</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Regex pattern to use for splitting key-value pairs</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">value_split</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Regex pattern to use for splitting the key from the value within a key-value pair</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>The field to insert the extracted keys into. Defaults to the root of the document. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">include_keys</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>List of keys to filter and insert into document. Defaults to including all keys</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">exclude_keys</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>List of keys to exclude from document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">prefix</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>Prefix to be added to extracted keys</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">trim_key</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>String of characters to trim from extracted keys</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">trim_value</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>String of characters to trim from extracted values</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">strip_brackets</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> strip brackets <code class="literal">()</code>, <code class="literal">&lt;&gt;</code>, <code class="literal">[]</code> as well as quotes <code class="literal">'</code> and <code class="literal">"</code> from extracted values</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="lowercase-processor"></a>Lowercase processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/lowercase.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a string to its lowercase equivalent. If the field is an array of strings, all members of the array will be converted.</p>
<div class="table">
<a id="lowercase-options"></a>
<p class="title"><strong>Table 31. Lowercase Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Lowercase Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to make lowercase</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "lowercase": {
    "field": "foo"
  }
}</pre>
</div>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="network-direction-processor"></a>Network direction processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/network-direction.asciidoc">edit</a></h2>
</div></div></div>

<p>Calculates the network direction given a source IP address, destination IP
address, and a list of internal networks.</p>
<p>The network direction processor reads IP addresses from
<a href="https://www.elastic.co/guide/en/ecs/8.9" class="ulink" target="_top">Elastic Common Schema (ECS)</a> fields by default. If you use the ECS,
only the <code class="literal">internal_networks</code> option must be specified.</p>
<div class="table">
<a id="network-direction-options"></a>
<p class="title"><strong>Table 32. Network Direction Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Network Direction Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">source_ip</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">source.ip</code></p></td>
<td align="left" valign="top"><p>Field containing the source IP address.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">destination_ip</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">destination.ip</code></p></td>
<td align="left" valign="top"><p>Field containing the destination IP address.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">network.direction</code></p></td>
<td align="left" valign="top"><p>Output field for the network direction.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">internal_networks</code></p></td>
<td align="left" valign="top"><p>yes *</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>List of internal networks. Supports IPv4 and
IPv6 addresses and ranges in CIDR notation. Also supports the named ranges listed below. These may be constructed with <a class="xref" href="ingest.html#template-snippets">template snippets</a>. * Must specify only one of <code class="literal">internal_networks</code> or <code class="literal">internal_networks_field</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">internal_networks_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>A field on the given document to read the <code class="literal">internal_networks</code> configuration from.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and any required fields are missing,
the processor quietly exits without modifying the document.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>One of either <code class="literal">internal_networks</code> or <code class="literal">internal_networks_field</code> must be specified. If <code class="literal">internal_networks_field</code> is specified, it follows the behavior specified by <code class="literal">ignore_missing</code>.</p>
<h5><a id="supported-named-network-ranges"></a>Supported named network ranges<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/network-direction.asciidoc">edit</a></h5>
<p>The named ranges supported for the <code class="literal">internal_networks</code> option are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">loopback</code> - Matches loopback addresses in the range of <code class="literal">127.0.0.0/8</code> or
<code class="literal">::1/128</code>.
</li>
<li class="listitem">
<code class="literal">unicast</code> or <code class="literal">global_unicast</code> - Matches global unicast addresses defined in
RFC 1122, RFC 4632, and RFC 4291 with the exception of the IPv4 broadcast
address (<code class="literal">255.255.255.255</code>). This includes private address ranges.
</li>
<li class="listitem">
<code class="literal">multicast</code> - Matches multicast addresses.
</li>
<li class="listitem">
<code class="literal">interface_local_multicast</code> - Matches IPv6 interface-local multicast addresses.
</li>
<li class="listitem">
<code class="literal">link_local_unicast</code> - Matches link-local unicast addresses.
</li>
<li class="listitem">
<code class="literal">link_local_multicast</code> - Matches link-local multicast addresses.
</li>
<li class="listitem">
<code class="literal">private</code> - Matches private address ranges defined in RFC 1918 (IPv4) and
RFC 4193 (IPv6).
</li>
<li class="listitem">
<code class="literal">public</code> - Matches addresses that are not loopback, unspecified, IPv4
broadcast, link local unicast, link local multicast, interface local
multicast, or private.
</li>
<li class="listitem">
<code class="literal">unspecified</code> - Matches unspecified addresses (either the IPv4 address
"0.0.0.0" or the IPv6 address "::").
</li>
</ul>
</div>
<h5><a id="network-direction-processor-ex"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/network-direction.asciidoc">edit</a></h5>
<p>The following example illustrates the use of the network direction processor:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "processors": [
      {
        "network_direction": {
          "internal_networks": ["private"]
        }
      }
    ]
  },
  "docs": [
    {
      "_source": {
        "source": {
          "ip": "128.232.110.120"
        },
        "destination": {
          "ip": "192.168.1.1"
        }
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/754.console"></div>
<p>Which produces the following result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        ...
        "_source": {
          "destination": {
            "ip": "192.168.1.1"
          },
          "source": {
            "ip": "128.232.110.120"
          },
          "network": {
            "direction": "inbound"
          }
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="pipeline-processor"></a>Pipeline processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/pipeline.asciidoc">edit</a></h2>
</div></div></div>

<p>Executes another pipeline.</p>
<div class="table">
<a id="pipeline-options"></a>
<p class="title"><strong>Table 33. Pipeline Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Pipeline Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">name</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The name of the pipeline to execute. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing_pipeline</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>Whether to ignore missing pipelines instead of failing.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "pipeline": {
    "name": "inner-pipeline"
  }
}</pre>
</div>
<p>The name of the current pipeline can be accessed from the <code class="literal">_ingest.pipeline</code> ingest metadata key.</p>
<p>An example of using this processor for nesting pipelines would be:</p>
<p>Define an inner pipeline:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/pipelineA
{
  "description" : "inner pipeline",
  "processors" : [
    {
      "set" : {
        "field": "inner_pipeline_set",
        "value": "inner"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/755.console"></div>
<p>Define another pipeline that uses the previously defined inner pipeline:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/pipelineB
{
  "description" : "outer pipeline",
  "processors" : [
    {
      "pipeline" : {
        "name": "pipelineA"
      }
    },
    {
      "set" : {
        "field": "outer_pipeline_set",
        "value": "outer"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/756.console"></div>
<p>Now indexing a document while applying the outer pipeline will see the inner pipeline executed
from the outer pipeline:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /my-index-000001/_doc/1?pipeline=pipelineB
{
  "field": "value"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/757.console"></div>
<p>Response from the index request:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "_index": "my-index-000001",
  "_id": "1",
  "_version": 1,
  "result": "created",
  "_shards": {
    "total": 2,
    "successful": 1,
    "failed": 0
  },
  "_seq_no": 66,
  "_primary_term": 1
}</pre>
</div>
<p>Indexed document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "field": "value",
  "inner_pipeline_set": "inner",
  "outer_pipeline_set": "outer"
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="redact-processor"></a>Redact processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/redact.asciidoc">edit</a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>The Redact processor uses the Grok rules engine to obscure
text in the input document matching the given Grok patterns. The processor can
be used to obscure Personal Identifying Information (PII) by configuring it to
detect known patterns such as email or IP addresses. Text that matches a Grok
pattern is replaced with a configurable string such as <code class="literal">&lt;EMAIL&gt;</code> where an email
address is matched or simply replace all matches with the text <code class="literal">&lt;REDACTED&gt;</code>
if preferred.</p>
<p>Elasticsearch comes packaged with a number of useful predefined <a href="https://github.com/elastic/elasticsearch/blob/8.9/libs/grok/src/main/resources/patterns/ecs-v1" class="ulink" target="_top">patterns</a>
that can be conveniently referenced by the Redact processor.
If one of those does not suit your needs, create a new pattern with a
custom pattern definition. The Redact processor replaces every occurrence
of a match. If there are multiple matches all will be replaced with the
pattern name.</p>
<p>The Redact processor is compatible with <a href="https://www.elastic.co/guide/en/ecs/8.9/ecs-field-reference.html" class="ulink" target="_top">Elastic Common Schema (ECS)</a>
patterns. Legacy Grok patterns are not supported.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="using-redact"></a>Using the Redact processor in a pipeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/redact.asciidoc">edit</a></h3>
</div></div></div>
<div class="table">
<a id="redact-options"></a>
<p class="title"><strong>Table 34. Redact Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Redact Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be redacted</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">patterns</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>A list of grok expressions to match and redact named captures with</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">pattern_definitions</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>A map of pattern-name and pattern tuples defining custom patterns to be used by the processor. Patterns matching existing names will override the pre-existing definition</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">prefix</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>&lt;</p></td>
<td align="left" valign="top"><p>Start a redacted section with this token</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">suffix</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>&gt;</p></td>
<td align="left" valign="top"><p>End a redacted section with this token</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">skip_if_unlicensed</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and the current license does not support running redact processors, then the processor quietly exits without modifying the document</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>In this example the predefined <code class="literal">IP</code> Grok pattern is used to match
and redact an IP addresses from the <code class="literal">message</code> text field. The pipeline
is tested using the Simulate API.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "description" : "Hide my IP",
    "processors": [
      {
        "redact": {
          "field": "message",
          "patterns": ["%{IP:client}"]
        }
      }
    ]
  },
  "docs":[
    {
      "_source": {
        "message": "55.3.244.1 GET /index.html 15824 0.043"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/758.console"></div>
<p>The document in the response still contains the <code class="literal">message</code> field
but now the IP address <code class="literal">55.3.244.1</code> is replaced by the text <code class="literal">&lt;client&gt;</code>.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_index": "_index",
        "_id": "_id",
        "_version": "-3",
        "_source": {
          "message": "&lt;client&gt; GET /index.html 15824 0.043"
        },
        "_ingest": {
          "timestamp": "2023-02-01T16:08:39.419056008Z"
        }
      }
    }
  ]
}</pre>
</div>
<p>The IP address is replaced with the word <code class="literal">client</code> because that is what is
specified in the Grok pattern <code class="literal">%{IP:client}</code>. The <code class="literal">&lt;</code> and <code class="literal">&gt;</code> tokens which
surround the pattern name are configurable using the <code class="literal">prefix</code> and <code class="literal">suffix</code> options.</p>
<p>The next example defines multiple patterns both of which are replaced
with the word <code class="literal">REDACTED</code> and the prefix and suffix tokens are set to <code class="literal">*</code></p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "description": "Hide my IP",
    "processors": [
      {
        "redact": {
          "field": "message",
          "patterns": [
            "%{IP:REDACTED}",
            "%{EMAILADDRESS:REDACTED}"
          ],
          "prefix": "*",
          "suffix": "*"
        }
      }
    ]
  },
  "docs": [
    {
      "_source": {
        "message": "55.3.244.1 GET /index.html 15824 0.043 test@elastic.co"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/759.console"></div>
<p>In the response both the IP <code class="literal">55.3.244.1</code> and email address <code class="literal">test@elastic.co</code>
have been replaced by <code class="literal">*REDACTED*</code>.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_index": "_index",
        "_id": "_id",
        "_version": "-3",
        "_source": {
          "message": "*REDACTED* GET /index.html 15824 0.043 *REDACTED*"
        },
        "_ingest": {
          "timestamp": "2023-02-01T16:53:14.560005377Z"
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="redact-custom-patterns"></a>Custom patterns<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/redact.asciidoc">edit</a></h3>
</div></div></div>
<p>If one of the existing Grok <a href="https://github.com/elastic/elasticsearch/blob/8.9/libs/grok/src/main/resources/patterns/ecs-v1" class="ulink" target="_top">patterns</a>
does not fit your requirements custom patterns can be added with the
<code class="literal">pattern_definitions</code> option. New patterns definitions are composed of
a pattern name and the pattern itself. The pattern may be a regular
expression or reference existing Grok patterns.</p>
<p>This example defines the custom pattern <code class="literal">GITHUB_NAME</code> to match
GitHub usernames. The pattern definition uses the existing
<code class="literal">USERNAME</code> Grok <a href="https://github.com/elastic/elasticsearch/blob/8.9/libs/grok/src/main/resources/patterns/ecs-v1/grok-patterns" class="ulink" target="_top">pattern</a> prefixed by the
literal <code class="literal">@</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <a href="https://www.elastic.co/guide/en/kibana/8.9/xpack-grokdebugger.html" class="ulink" target="_top">Grok Debugger</a> is a really
useful tool for building custom patterns.</p>
</div>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "processors": [
      {
        "redact": {
          "field": "message",
          "patterns": [
            "%{GITHUB_NAME:GITHUB_NAME}"
          ],
          "pattern_definitions": {
            "GITHUB_NAME": "@%{USERNAME}"
          }
        }
      }
    ]
  },
  "docs": [
    {
      "_source": {
        "message": "@elastic-data-management the PR is ready for review"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/760.console"></div>
<p>The username is redacted in the response.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_index": "_index",
        "_id": "_id",
        "_version": "-3",
        "_source": {
          "message": "&lt;GITHUB_NAME&gt; the PR is ready for review"
        },
        "_ingest": {
          "timestamp": "2023-02-01T16:53:14.560005377Z"
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="grok-watchdog-redact"></a>Grok watchdog<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/redact.asciidoc">edit</a></h3>
</div></div></div>
<p>The watchdog interrupts expressions that take too long to execute.
When interrupted, the Redact processor fails with an error.
The same <a class="xref" href="processors.html#grok-watchdog-options" title="Grok watchdog settings">settings</a> that control the
Grok Watchdog timeout also apply to the Redact processor.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="redact-licensing"></a>Licensing<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/redact.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">redact</code> processor is a commercial feature that requires an
appropriate license. For more information, refer to
<a href="https://www.elastic.co/subscriptions" class="ulink" target="_top">https://www.elastic.co/subscriptions</a>.</p>
<p>The <code class="literal">skip_if_unlicensed</code> option can be set on a redact processor to
control behavior when the cluster&#8217;s license is not sufficient to run
such a processor. <code class="literal">skip_if_unlicensed</code> defaults to <code class="literal">false</code>, and the
redact processor will throw an exception if the cluster&#8217;s license is
not sufficient. If you set the <code class="literal">skip_if_unlicensed</code> option to <code class="literal">true</code>,
however, then the redact processor not throw an exception (it will do
nothing at all) in the case of an insufficient license.</p>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="registered-domain-processor"></a>Registered domain processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/registered-domain.asciidoc">edit</a></h2>
</div></div></div>

<p>Extracts the registered domain (also known as the effective top-level domain or
eTLD), sub-domain, and top-level domain from a fully qualified domain name
(FQDN). Uses the registered domains defined in the
<a href="https://publicsuffix.org/" class="ulink" target="_top">Mozilla Public Suffix List</a>.</p>
<div class="table">
<a id="registered-domain-options"></a>
<p class="title"><strong>Table 35. Registered Domain Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Registered Domain Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Field containing the source FQDN.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">&lt;empty string&gt;</code></p></td>
<td align="left" valign="top"><p>Object field containing
extracted domain components. If an <code class="literal">&lt;empty string&gt;</code>, the processor adds
components to the document&#8217;s root.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and any required fields
are missing, the processor quietly exits without modifying the document.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<h5><a id="registered-domain-processor-ex"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/registered-domain.asciidoc">edit</a></h5>
<p>The following example illustrates the use of the registered domain processor:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "processors": [
      {
        "registered_domain": {
          "field": "fqdn",
          "target_field": "url"
        }
      }
    ]
  },
  "docs": [
    {
      "_source": {
        "fqdn": "www.example.ac.uk"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/761.console"></div>
<p>Which produces the following result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        ...
        "_source": {
          "fqdn": "www.example.ac.uk",
          "url": {
            "subdomain": "www",
            "registered_domain": "example.ac.uk",
            "top_level_domain": "ac.uk",
            "domain": "www.example.ac.uk"
          }
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="remove-processor"></a>Remove processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/remove.asciidoc">edit</a></h2>
</div></div></div>

<p>Removes existing fields. If one field doesn&#8217;t exist, an exception will be thrown.</p>
<div class="table">
<a id="remove-options"></a>
<p class="title"><strong>Table 36. Remove Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Remove Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Fields to be removed. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">keep</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Fields to be kept. When set, all fields other than those specified are removed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example to remove a single field:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "remove": {
    "field": "user_agent"
  }
}</pre>
</div>
<p>To remove multiple fields, you can use the following query:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "remove": {
    "field": ["user_agent", "url"]
  }
}</pre>
</div>
<p>You can also choose to remove all fields other than a specified list:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "remove": {
    "keep": ["url"]
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rename-processor"></a>Rename processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/rename.asciidoc">edit</a></h2>
</div></div></div>

<p>Renames an existing field. If the field doesn&#8217;t exist or the new name is already used, an exception will be thrown.</p>
<div class="table">
<a id="rename-options"></a>
<p class="title"><strong>Table 37. Rename Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Rename Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be renamed. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The new name of the field. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "rename": {
    "field": "provider",
    "target_field": "cloud.provider"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="reroute-processor"></a>Reroute processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/reroute.asciidoc">edit</a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>The <code class="literal">reroute</code> processor allows to route a document to another target index or data stream.
It has two main modes:</p>
<p>When setting the <code class="literal">destination</code> option, the target is explicitly specified and the <code class="literal">dataset</code> and <code class="literal">namespace</code> options can&#8217;t be set.</p>
<p>When the <code class="literal">destination</code> option is not set, this processor is in a data stream mode.
Note that in this mode, the <code class="literal">reroute</code> processor can only be used on data streams that follow the <a href="https://www.elastic.co/guide/en/fleet/8.9/data-streams.html#data-streams-naming-scheme" class="ulink" target="_top">data stream naming scheme</a>.
Trying to use this processor on a data stream with a non-compliant name will raise an exception.</p>
<p>The name of a data stream consists of three parts: <code class="literal">&lt;type&gt;-&lt;dataset&gt;-&lt;namespace&gt;</code>.
See the <a href="https://www.elastic.co/guide/en/fleet/8.9/data-streams.html#data-streams-naming-scheme" class="ulink" target="_top">data stream naming scheme</a> documentation for more details.</p>
<p>This processor can use both static values or reference fields from the document to determine the <code class="literal">dataset</code> and <code class="literal">namespace</code> components of the new target.
See <a class="xref" href="processors.html#reroute-options" title="Reroute options">Table 38, &#8220;Reroute options&#8221;</a> for more details.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>It&#8217;s not possible to change the <code class="literal">type</code> of the data stream with the <code class="literal">reroute</code> processor.</p>
</div>
</div>
<p>After a <code class="literal">reroute</code> processor has been executed, all the other processors of the current pipeline are skipped, including the final pipeline.
If the current pipeline is executed in the context of a <a class="xref" href="processors.html#pipeline-processor" title="Pipeline processor">Pipeline</a>, the calling pipeline will be skipped, too.
This means that at most one <code class="literal">reroute</code> processor is ever executed within a pipeline,
allowing to define mutually exclusive routing conditions,
similar to a if, else-if, else-if, … condition.</p>
<p>The reroute processor ensures that the <code class="literal">data_stream.&lt;type|dataset|namespace&gt;</code> fields are set according to the new target.
If the document contains a <code class="literal">event.dataset</code> value, it will be updated to reflect the same value as <code class="literal">data_stream.dataset</code>.</p>
<p>Note that the client needs to have permissions to the final target.
Otherwise, the document will be rejected with a security exception which looks like this:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{"type":"security_exception","reason":"action [indices:admin/auto_create] is unauthorized for API key id [8-dt9H8BqGblnY2uSI--] of user [elastic/fleet-server] on indices [logs-foo-default], this action is granted by the index privileges [auto_configure,create_index,manage,all]"}</pre>
</div>
<div class="table">
<a id="reroute-options"></a>
<p class="title"><strong>Table 38. Reroute options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Reroute options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">destination</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>A static value for the target. Can&#8217;t be set when the <code class="literal">dataset</code> or <code class="literal">namespace</code> option is set.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">dataset</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">{{data_stream.dataset}}</code></p></td>
<td align="left" valign="top">
<p>Field references or a static value for the dataset part of the data stream name. In addition to the criteria for <a class="xref" href="indices.html#indices-create-api-path-params" title="Path parameters">index names</a>, cannot contain <code class="literal">-</code> and must be no longer than 100 characters. Example values are <code class="literal">nginx.access</code> and <code class="literal">nginx.error</code>.</p>
<p>Supports field references with a mustache-like syntax (denoted as <code class="literal">{{double}}</code> or <code class="literal">{{{triple}}}</code> curly braces). When resolving field references, the processor replaces invalid characters with <code class="literal">_</code>. Uses the <code class="literal">&lt;dataset&gt;</code> part of the index name as a fallback if all field references resolve to a <code class="literal">null</code>, missing, or non-string value.</p>
</td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">namespace</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">{{data_stream.namespace}}</code></p></td>
<td align="left" valign="top">
<p>Field references or a static value for the namespace part of the data stream name. See the criteria for <a class="xref" href="indices.html#indices-create-api-path-params" title="Path parameters">index names</a> for allowed characters. Must be no longer than 100 characters.</p>
<p>Supports field references with a mustache-like syntax (denoted as <code class="literal">{{double}}</code> or <code class="literal">{{{triple}}}</code> curly braces). When resolving field references, the processor replaces invalid characters with <code class="literal">_</code>. Uses the <code class="literal">&lt;namespace&gt;</code> part of the index name as a fallback if all field references resolve to a <code class="literal">null</code>, missing, or non-string value.</p>
</td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The <code class="literal">if</code> option can be used to define the condition in which the document should be rerouted to a new target.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "reroute": {
    "tag": "nginx",
    "if" : "ctx?.log?.file?.path?.contains('nginx')",
    "dataset": "nginx"
  }
}</pre>
</div>
<p>The dataset and namespace options can contain either a single value or a list of values that are used as a fallback.
If a field reference evaluates to <code class="literal">null</code>, is not present in the document, the next value or field reference is used.
If a field reference evaluates to a non-<code class="literal">String</code> value, the processor fails.</p>
<p>In the following example, the processor would first try to resolve the value for the <code class="literal">service.name</code> field to determine the value for <code class="literal">dataset</code>.
If that field resolves to <code class="literal">null</code>, is missing, or is a non-string value, it would try the next element in the list.
In this case, this is the static value <code class="literal">"generic</code>".
The <code class="literal">namespace</code> option is configured with just a single static value.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "reroute": {
    "dataset": [
        "{{service.name}}",
        "generic"
    ],
    "namespace": "default"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="script-processor"></a>Script processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/script.asciidoc">edit</a></h2>
</div></div></div>

<p>Runs an inline or stored <a class="xref" href="modules-scripting.html" title="Scripting">script</a> on incoming documents. The
script runs in the <a href="https://www.elastic.co/guide/en/elasticsearch/painless/8.9/painless-ingest-processor-context.html" class="ulink" target="_top"><code class="literal">ingest</code></a>
context.</p>
<p>The script processor uses the <a class="xref" href="modules-scripting-using.html#scripts-and-search-speed" title="Scripts, caching, and search speed">script cache</a> to avoid
recompiling the script for each incoming document. To improve performance,
ensure the script cache is properly sized before using a script processor in
production.</p>
<div class="table">
<a id="script-options"></a>
<p class="title"><strong>Table 39. Script options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Script options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">lang</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>"painless"</p></td>
<td align="left" valign="top"><p><a class="xref" href="modules-scripting.html#scripting-available-languages" title="Available scripting languages">Script language</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">id</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>ID of a <a class="xref" href="script-apis.html#create-stored-script-api" title="Create or update stored script API">stored script</a>.
                                         If no <code class="literal">source</code> is specified, this parameter is required.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">source</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Inline script.
                                         If no <code class="literal">id</code> is specified, this parameter is required.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">params</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Object containing parameters for the script.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<h4><a id="script-processor-access-source-fields"></a>Access source fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/script.asciidoc">edit</a></h4>
<p>The script processor parses each incoming document&#8217;s JSON source fields into a
set of maps, lists, and primitives. To access these fields with a Painless
script, use the
<a href="https://www.elastic.co/guide/en/elasticsearch/painless/8.9/painless-operators-reference.html#map-access-operator" class="ulink" target="_top">map access
operator</a>: <code class="literal">ctx['my-field']</code>. You can also use the shorthand <code class="literal">ctx.&lt;my-field&gt;</code>
syntax.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The script processor does not support the <code class="literal">ctx['_source']['my-field']</code> or
<code class="literal">ctx._source.&lt;my-field&gt;</code> syntaxes.</p>
</div>
</div>
<p>The following processor uses a Painless script to extract the <code class="literal">tags</code> field from
the <code class="literal">env</code> source field.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "processors": [
      {
        "script": {
          "description": "Extract 'tags' from 'env' field",
          "lang": "painless",
          "source": """
            String[] envSplit = ctx['env'].splitOnToken(params['delimiter']);
            ArrayList tags = new ArrayList();
            tags.add(envSplit[params['position']].trim());
            ctx['tags'] = tags;
          """,
          "params": {
            "delimiter": "-",
            "position": 1
          }
        }
      }
    ]
  },
  "docs": [
    {
      "_source": {
        "env": "es01-prod"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/762.console"></div>
<p>The processor produces:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        ...
        "_source": {
          "env": "es01-prod",
          "tags": [
            "prod"
          ]
        }
      }
    }
  ]
}</pre>
</div>
<h4><a id="script-processor-access-metadata-fields"></a>Access metadata fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/script.asciidoc">edit</a></h4>
<p>You can also use a script processor to access metadata fields. The following
processor uses a Painless script to set an incoming document&#8217;s <code class="literal">_index</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "processors": [
      {
        "script": {
          "description": "Set index based on `lang` field and `dataset` param",
          "lang": "painless",
          "source": """
            ctx['_index'] = ctx['lang'] + '-' + params['dataset'];
          """,
          "params": {
            "dataset": "catalog"
          }
        }
      }
    ]
  },
  "docs": [
    {
      "_index": "generic-index",
      "_source": {
        "lang": "fr"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/763.console"></div>
<p>The processor changes the document&#8217;s <code class="literal">_index</code> to <code class="literal">fr-catalog</code> from
<code class="literal">generic-index</code>.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        ...
        "_index": "fr-catalog",
        "_source": {
          "lang": "fr"
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="set-processor"></a>Set processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/set.asciidoc">edit</a></h2>
</div></div></div>

<p>Sets one field and associates it with the specified value. If the field already exists,
its value will be replaced with the provided one.</p>
<div class="table">
<a id="set-options"></a>
<p class="title"><strong>Table 40. Set Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Set Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to insert, upsert, or update. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">value</code></p></td>
<td align="left" valign="top"><p>yes*</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The value to be set for the field. Supports <a class="xref" href="ingest.html#template-snippets">template snippets</a>. May specify only one of <code class="literal">value</code> or <code class="literal">copy_from</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">copy_from</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The origin field which will be copied to <code class="literal">field</code>, cannot set <code class="literal">value</code> simultaneously. Supported data types are <code class="literal">boolean</code>, <code class="literal">number</code>, <code class="literal">array</code>, <code class="literal">object</code>, <code class="literal">string</code>, <code class="literal">date</code>, etc.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">override</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> processor will update fields with pre-existing non-null-valued field. When set to <code class="literal">false</code>, such fields will not be touched.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_empty_value</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and used in combination with <code class="literal">value</code> which is a <a class="xref" href="ingest.html#template-snippets">template snippet</a> that evaluates to <code class="literal">null</code> or an empty string, the processor quietly exits without modifying the document. Similarly, if used in combination with <code class="literal">copy_from</code> it will quietly exit if the field does not exist or its value evaluates to <code class="literal">null</code> or an empty string.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">media_type</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">application/json</code></p></td>
<td align="left" valign="top"><p>The media type for encoding <code class="literal">value</code>. Applies only when <code class="literal">value</code> is a <a class="xref" href="ingest.html#template-snippets">template snippet</a>. Must be one of <code class="literal">application/json</code>, <code class="literal">text/plain</code>, or <code class="literal">application/x-www-form-urlencoded</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "sets the value of count to 1",
  "set": {
    "field": "count",
    "value": 1
  }
}</pre>
</div>
<p>This processor can also be used to copy data from one field to another. For example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/set_os
{
  "description": "sets the value of host.os.name from the field os",
  "processors": [
    {
      "set": {
        "field": "host.os.name",
        "value": "{{{os}}}"
      }
    }
  ]
}

POST _ingest/pipeline/set_os/_simulate
{
  "docs": [
    {
      "_source": {
        "os": "Ubuntu"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/764.console"></div>
<p>Result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs" : [
    {
      "doc" : {
        "_index" : "_index",
        "_id" : "_id",
        "_version" : "-3",
        "_source" : {
          "host" : {
            "os" : {
              "name" : "Ubuntu"
            }
          },
          "os" : "Ubuntu"
        },
        "_ingest" : {
          "timestamp" : "2019-03-11T21:54:37.909224Z"
        }
      }
    }
  ]
}</pre>
</div>
<p>This processor can also access array fields using dot notation:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_ingest/pipeline/_simulate
{
  "pipeline": {
    "processors": [
      {
        "set": {
          "field": "my_field",
          "value": "{{{input_field.1}}}"
        }
      }
    ]
  },
  "docs": [
    {
      "_index": "index",
      "_id": "id",
      "_source": {
        "input_field": [
          "Ubuntu",
          "Windows",
          "Ventura"
        ]
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/765.console"></div>
<p>Result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_index": "index",
        "_id": "id",
        "_version": "-3",
        "_source": {
          "input_field": [
            "Ubuntu",
            "Windows",
            "Ventura"
          ],
          "my_field": "Windows"
        },
        "_ingest": {
          "timestamp": "2023-05-05T16:04:16.456475214Z"
        }
      }
    }
  ]
}</pre>
</div>
<p>The contents of a field including complex values such as arrays and objects can be copied to another field using <code class="literal">copy_from</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/set_bar
{
  "description": "sets the value of bar from the field foo",
  "processors": [
    {
      "set": {
        "field": "bar",
        "copy_from": "foo"
      }
    }
  ]
}

POST _ingest/pipeline/set_bar/_simulate
{
  "docs": [
    {
      "_source": {
        "foo": ["foo1", "foo2"]
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/766.console"></div>
<p>Result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs" : [
    {
      "doc" : {
        "_index" : "_index",
        "_id" : "_id",
        "_version" : "-3",
        "_source" : {
          "bar": ["foo1", "foo2"],
          "foo": ["foo1", "foo2"]
        },
        "_ingest" : {
          "timestamp" : "2020-09-30T12:55:17.742795Z"
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ingest-node-set-security-user-processor"></a>Set security user processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/set-security-user.asciidoc">edit</a></h2>
</div></div></div>

<p>Sets user-related details (such as <code class="literal">username</code>,  <code class="literal">roles</code>, <code class="literal">email</code>, <code class="literal">full_name</code>,
<code class="literal">metadata</code>, <code class="literal">api_key</code>, <code class="literal">realm</code> and <code class="literal">authentication_type</code>) from the current
authenticated user to the current document by pre-processing the ingest.
The <code class="literal">api_key</code> property exists only if the user authenticates with an
API key. It is an object containing the <code class="literal">id</code>, <code class="literal">name</code> and <code class="literal">metadata</code>
(if it exists and is non-empty) fields of the API key.
The <code class="literal">realm</code> property is also an object with two fields, <code class="literal">name</code> and <code class="literal">type</code>.
When using API key authentication, the <code class="literal">realm</code> property refers to the realm
from which the API key is created.
The <code class="literal">authentication_type</code> property is a string that can take value from
<code class="literal">REALM</code>, <code class="literal">API_KEY</code>, <code class="literal">TOKEN</code> and <code class="literal">ANONYMOUS</code>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Requires an authenticated user for the index request.</p>
</div>
</div>
<div class="table">
<a id="set-security-user-options"></a>
<p class="title"><strong>Table 41. Set Security User Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Set Security User Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to store the user information into.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">properties</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>[<code class="literal">username</code>, <code class="literal">roles</code>, <code class="literal">email</code>, <code class="literal">full_name</code>, <code class="literal">metadata</code>, <code class="literal">api_key</code>, <code class="literal">realm</code>, <code class="literal">authentication_type</code>]</p></td>
<td align="left" valign="top"><p>Controls what user related properties are added to the <code class="literal">field</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The following example adds all user details for the current authenticated user
to the <code class="literal">user</code> field for all documents that are processed by this pipeline:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "processors" : [
    {
      "set_security_user": {
        "field": "user"
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="sort-processor"></a>Sort processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/sort.asciidoc">edit</a></h2>
</div></div></div>

<p>Sorts the elements of an array ascending or descending. Homogeneous arrays of numbers will be sorted
numerically, while arrays of strings or heterogeneous arrays of strings + numbers will be sorted lexicographically.
Throws an error when the field is not an array.</p>
<div class="table">
<a id="sort-options"></a>
<p class="title"><strong>Table 42. Sort Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Sort Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be sorted</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">order</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">"asc"</code></p></td>
<td align="left" valign="top"><p>The sort order to use. Accepts <code class="literal">"asc"</code> or <code class="literal">"desc"</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the sorted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "sort": {
    "field": "array_field_to_sort",
    "order": "desc"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="split-processor"></a>Split processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/split.asciidoc">edit</a></h2>
</div></div></div>

<p>Splits a field into an array using a separator character. Only works on string fields.</p>
<div class="table">
<a id="split-options"></a>
<p class="title"><strong>Table 43. Split Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Split Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to split</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">separator</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>A regex which matches the separator, eg <code class="literal">,</code> or <code class="literal">\s+</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the split value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">preserve_trailing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Preserves empty trailing fields, if any.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "split": {
    "field": "my_field",
    "separator": "\\s+" <a id="CO181-1"></a><i class="conum" data-value="1"></i>
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO181-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Treat all consecutive whitespace characters as a single separator</p>
</td>
</tr>
</table>
</div>
<p>If the <code class="literal">preserve_trailing</code> option is enabled, any trailing empty fields in the input will be preserved. For example,
in the configuration below, a value of <code class="literal">A,,B,,</code> in the <code class="literal">my_field</code> property will be split into an array of five elements
<code class="literal">["A", "", "B", "", ""]</code> with two empty trailing fields. If the <code class="literal">preserve_trailing</code> property were not enabled, the two
empty trailing fields would be discarded resulting in the three-element array <code class="literal">["A", "", "B"]</code>.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "split": {
    "field": "my_field",
    "separator": ",",
    "preserve_trailing": true
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="trim-processor"></a>Trim processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/trim.asciidoc">edit</a></h2>
</div></div></div>

<p>Trims whitespace from field. If the field is an array of strings, all members of the array will be trimmed.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This only works on leading and trailing whitespace.</p>
</div>
</div>
<div class="table">
<a id="trim-options"></a>
<p class="title"><strong>Table 44. Trim Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Trim Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The string-valued field to trim whitespace from</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the trimmed value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "trim": {
    "field": "foo"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="uppercase-processor"></a>Uppercase processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/uppercase.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a string to its uppercase equivalent. If the field is an array of strings, all members of the array will be converted.</p>
<div class="table">
<a id="uppercase-options"></a>
<p class="title"><strong>Table 45. Uppercase Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Uppercase Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to make uppercase</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "uppercase": {
    "field": "foo"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="urldecode-processor"></a>URL decode processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/url-decode.asciidoc">edit</a></h2>
</div></div></div>

<p>URL-decodes a string. If the field is an array of strings, all members of the array will be decoded.</p>
<div class="table">
<a id="urldecode-options"></a>
<p class="title"><strong>Table 46. URL Decode Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="URL Decode Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to decode</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "urldecode": {
    "field": "my_url_to_decode"
  }
}</pre>
</div>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="uri-parts-processor"></a>URI parts processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/uri-parts.asciidoc">edit</a></h2>
</div></div></div>

<p>Parses a Uniform Resource Identifier (URI) string and extracts its components as
an object. This URI object includes properties for the URI&#8217;s domain, path, fragment,
port, query, scheme, user info, username, and password.</p>
<div class="table">
<a id="uri-parts-options"></a>
<p class="title"><strong>Table 47. URI Parts Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="URI Parts Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Field containing the URI string.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">url</code></p></td>
<td align="left" valign="top"><p>Output field for the URI object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">keep_original</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>true</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, the processor copies the
unparsed URI to <code class="literal">&lt;target_field&gt;.original</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">remove_if_successful</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, the processor removes
the <code class="literal">field</code> after parsing the URI string. If parsing fails, the processor does not
remove the <code class="literal">field</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Description of the processor. Useful for describing the purpose of the processor or its configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute the processor. See <a class="xref" href="ingest.html#conditionally-run-processor" title="Conditionally run a processor">Conditionally run a processor</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for the processor. See <a class="xref" href="ingest.html#handling-pipeline-failures" title="Handling pipeline failures">Handling pipeline failures</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Identifier for the processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example definition of the URI parts processor:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "...",
  "processors" : [
    {
      "uri_parts": {
        "field": "input_field",
        "target_field": "url",
        "keep_original": true,
        "remove_if_successful": false
      }
    }
  ]
}</pre>
</div>
<p>When the above processor executes on the following document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "_source": {
    "input_field": "http://myusername:mypassword@www.example.com:80/foo.gif?key1=val1&amp;key2=val2#fragment"
  }
}</pre>
</div>
<p>It produces this result:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"_source" : {
  "input_field" : "http://myusername:mypassword@www.example.com:80/foo.gif?key1=val1&amp;key2=val2#fragment",
  "url" : {
    "path" : "/foo.gif",
    "fragment" : "fragment",
    "extension" : "gif",
    "password" : "mypassword",
    "original" : "http://myusername:mypassword@www.example.com:80/foo.gif?key1=val1&amp;key2=val2#fragment",
    "scheme" : "http",
    "port" : 80,
    "user_info" : "myusername:mypassword",
    "domain" : "www.example.com",
    "query" : "key1=val1&amp;key2=val2",
    "username" : "myusername"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="user-agent-processor"></a>User agent processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/user-agent.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">user_agent</code> processor extracts details from the user agent string a browser sends with its web requests.
This processor adds this information by default under the <code class="literal">user_agent</code> field.</p>
<p>The ingest-user-agent module ships by default with the regexes.yaml made available by uap-java with an Apache 2.0 license. For more details see <a href="https://github.com/ua-parser/uap-core" class="ulink" target="_top">https://github.com/ua-parser/uap-core</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="using-ingest-user-agent"></a>Using the user_agent Processor in a Pipeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/user-agent.asciidoc">edit</a></h3>
</div></div></div>
<div class="table">
<a id="ingest-user-agent-options"></a>
<p class="title"><strong>Table 48. User-agent options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="User-agent options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field containing the user agent string.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>user_agent</p></td>
<td align="left" valign="top"><p>The field that will be filled with the user agent details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">regex_file</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The name of the file in the <code class="literal">config/ingest-user-agent</code> directory containing the regular expressions for parsing the user agent string. Both the directory and the file have to be created before starting Elasticsearch. If not specified, ingest-user-agent will use the regexes.yaml from uap-core it ships with (see below).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">properties</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>[<code class="literal">name</code>, <code class="literal">major</code>, <code class="literal">minor</code>, <code class="literal">patch</code>, <code class="literal">build</code>, <code class="literal">os</code>, <code class="literal">os_name</code>, <code class="literal">os_major</code>, <code class="literal">os_minor</code>, <code class="literal">device</code>]</p></td>
<td align="left" valign="top"><p>Controls what properties are added to <code class="literal">target_field</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">extract_device_type</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p><span class="Admonishment Admonishment--beta">
[<span class="Admonishment-title u-mono">beta</span>]
<span class="Admonishment-detail">
This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.
</span>
</span> Extracts device type from the user agent string on a best-effort basis.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example that adds the user agent details to the <code class="literal">user_agent</code> field based on the <code class="literal">agent</code> field:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/user_agent
{
  "description" : "Add user agent information",
  "processors" : [
    {
      "user_agent" : {
        "field" : "agent"
      }
    }
  ]
}
PUT my-index-000001/_doc/my_id?pipeline=user_agent
{
  "agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36"
}
GET my-index-000001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/767.console"></div>
<p>Which returns</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "my-index-000001",
  "_id": "my_id",
  "_version": 1,
  "_seq_no": 22,
  "_primary_term": 1,
  "_source": {
    "agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36",
    "user_agent": {
      "name": "Chrome",
      "original": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36",
      "version": "51.0.2704.103",
      "os": {
        "name": "Mac OS X",
        "version": "10.10.5",
        "full": "Mac OS X 10.10.5"
      },
      "device" : {
        "name" : "Mac"
      }
    }
  }
}</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_using_a_custom_regex_file"></a>Using a custom regex file<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/user-agent.asciidoc">edit</a></h4>
</div></div></div>
<p>To use a custom regex file for parsing the user agents, that file has to be put into the <code class="literal">config/ingest-user-agent</code> directory and
has to have a <code class="literal">.yml</code> filename extension. The file has to be present at node startup, any changes to it or any new files added
while the node is running will not have any effect.</p>
<p>In practice, it will make most sense for any custom regex file to be a variant of the default file, either a more recent version
or a customised version.</p>
<p>The default file included in <code class="literal">ingest-user-agent</code> is the <code class="literal">regexes.yaml</code> from uap-core: <a href="https://github.com/ua-parser/uap-core/blob/master/regexes.yaml" class="ulink" target="_top">https://github.com/ua-parser/uap-core/blob/master/regexes.yaml</a></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ingest-user-agent-settings"></a>Node Settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/ingest/processors/user-agent.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">user_agent</code> processor supports the following setting:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ingest.user_agent.cache_size</code>
</span>
</dt>
<dd>
The maximum number of results that should be cached. Defaults to <code class="literal">1000</code>.
</dd>
</dl>
</div>
<p>Note that these settings are node settings and apply to all <code class="literal">user_agent</code> processors, i.e. there is one cache for all defined <code class="literal">user_agent</code> processors.</p>
</div>

</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ingest-enriching-data.html">« Enrich your data</a>
</span>
<span class="next">
<a href="aliases.html">Aliases »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
