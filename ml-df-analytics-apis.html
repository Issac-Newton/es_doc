<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Machine learning data frame analytics APIs | Elasticsearch Guide | Elastic</title>
<meta class="elastic" name="content" content="Machine learning data frame analytics APIs | Elasticsearch Guide">

<link rel="home" href="index.html" title="Elasticsearch Guide"/>
<link rel="up" href="rest-apis.html" title="REST APIs"/>
<link rel="prev" href="ml-apis.html" title="Machine learning anomaly detection APIs"/>
<link rel="next" href="migration-api.html" title="Migration APIs"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ml-apis.html">« Machine learning anomaly detection APIs</a>
</span>
<span class="next">
<a href="migration-api.html">Migration APIs »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ml-df-analytics-apis"></a>Machine learning data frame analytics APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/ml-df-analytics-apis.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>You can use the following APIs to perform machine learning data frame analytics activities.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#put-dfanalytics" title="Create data frame analytics jobs API">Create data frame analytics jobs</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#update-dfanalytics" title="Update data frame analytics jobs API">Update data frame analytics jobs</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#delete-dfanalytics" title="Delete data frame analytics jobs API">Delete data frame analytics jobs</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#get-dfanalytics" title="Get data frame analytics jobs API">Get data frame analytics jobs info</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#get-dfanalytics-stats" title="Get data frame analytics jobs statistics API">Get data frame analytics jobs statistics</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#start-dfanalytics" title="Start data frame analytics jobs API">Start data frame analytics jobs</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#stop-dfanalytics" title="Stop data frame analytics jobs API">Stop data frame analytics jobs</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#evaluate-dfanalytics" title="Evaluate data frame analytics API">Evaluate data frame analytics</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#explain-dfanalytics" title="Explain data frame analytics API">Explain data frame analytics</a>
</li>
</ul>
</div>
<p>You can use the following APIs to perform inference operations.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#put-trained-models" title="Create trained models API">Create trained models</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#get-trained-models" title="Get trained models API">Get trained models</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#get-trained-models-stats" title="Get trained models statistics API">Get trained models stats</a>
</li>
<li class="listitem">
<a class="xref" href="ml-df-analytics-apis.html#delete-trained-models" title="Delete trained models API">Delete trained models</a>
</li>
</ul>
</div>
<p>You can deploy a trained model to make predictions in an ingest pipeline or in
an aggregation. Refer to the following documentation to learn more.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ingest-processors.html#inference-processor" title="Inference processor">Inference processor</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-pipeline.html#search-aggregations-pipeline-inference-bucket-aggregation" title="Inference bucket aggregation">Inference bucket aggregation</a>
</li>
</ul>
</div>
<p>See also <a class="xref" href="ml-apis.html" title="Machine learning anomaly detection APIs"><em>Machine learning anomaly detection APIs</em></a>.</p>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="put-dfanalytics"></a>Create data frame analytics jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Instantiates a data frame analytics job.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-dfanalytics-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-dfanalytics-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following built-in roles and privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">machine_learning_admin</code>
</li>
<li class="listitem">
source indices: <code class="literal">read</code>, <code class="literal">view_index_metadata</code>
</li>
<li class="listitem">
destination index: <code class="literal">read</code>, <code class="literal">create_index</code>, <code class="literal">manage</code> and <code class="literal">index</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#built-in-roles" title="Built-in roles">Built-in roles</a>, <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>, and
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The data frame analytics job remembers which roles the user who created it had at
the time of creation. When you start the job, it performs the analysis using
those same roles. If you provide
<a class="xref" href="ccs-clients-integrations.html#http-clients-secondary-authorization" title="Secondary authorization">secondary authorization headers</a>,
those credentials are used instead.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-dfanalytics-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>This API creates a data frame analytics job that performs an analysis on the source
indices and stores the outcome in a destination index.</p>
<p>If the destination index does not exist, it is created automatically when you
start the job. See <a class="xref" href="ml-df-analytics-apis.html#start-dfanalytics" title="Start data frame analytics jobs API">Start data frame analytics jobs</a>.</p>
<p>If you supply only a subset of the regression or classification parameters,
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/hyperparameters.html" class="ulink" target="_top">hyperparameter optimization</a> occurs. It
determines a value for each of the undefined parameters.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-dfanalytics-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;data_frame_analytics_id&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Identifier for the data frame analytics job. This identifier can contain lowercase
alphanumeric characters (a-z and 0-9), hyphens, and underscores. It must start
and end with alphanumeric characters.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-dfanalytics-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">allow_lazy_start</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Specifies whether this job can start when there is insufficient machine learning node
capacity for it to be immediately assigned to a node. The default is <code class="literal">false</code>; if
a machine learning node with capacity to run the job cannot immediately be found, the
<a class="xref" href="ml-df-analytics-apis.html#start-dfanalytics" title="Start data frame analytics jobs API">Start data frame analytics jobs</a> API returns an error. However, this is also subject to the
cluster-wide <code class="literal">xpack.ml.max_lazy_ml_nodes</code> setting. See <a class="xref" href="settings.html#advanced-ml-settings" title="Advanced machine learning settings">Advanced machine learning settings</a>.
If this option is set to <code class="literal">true</code>, the API does not return an error and the job
waits in the <code class="literal">starting</code> state until sufficient machine learning node capacity is available.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">analysis</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The analysis configuration, which contains the information necessary to perform
one of the following types of analysis: classification, outlier detection, or
regression.
</p>
<details open>
<summary class="title">Properties of <code class="literal">analysis</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">classification</code>
</span>
</dt>
<dd>
<p>
(Required<sup>*</sup>, object)
The configuration information necessary to perform
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/dfa-classification.html" class="ulink" target="_top">classification</a>.
</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Advanced parameters are for fine-tuning classification analysis. They are set
automatically by hyperparameter optimization to give the minimum validation
error. It is highly recommended to use the default values unless you fully
understand the function of these parameters.</p>
</div>
</div>
<details open>
<summary class="title">Properties of <code class="literal">classification</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">class_assignment_objective</code>
</span>
</dt>
<dd>
(Optional, string)
Defines the objective to optimize when assigning class labels:
<code class="literal">maximize_accuracy</code> or <code class="literal">maximize_minimum_recall</code>. When maximizing accuracy,
class labels are chosen to maximize the number of correct predictions. When
maximizing minimum recall, labels are chosen to maximize the minimum recall
for any class. Defaults to <code class="literal">maximize_minimum_recall</code>.
</dd>
<dt>
<span class="term">
<code class="literal">dependent_variable</code>
</span>
</dt>
<dd>
<p>
(Required, string)
</p>
<p>Defines which field of the document is to be predicted.
This parameter is supplied by field name and must match one of the fields in
the index being used to train. If this field is missing from a document, then
that document will not be used for training, but a prediction with the trained
model will be generated for it. It is also known as continuous target variable.</p>
<p>The data type of the field must be numeric (<code class="literal">integer</code>, <code class="literal">short</code>, <code class="literal">long</code>, <code class="literal">byte</code>),
categorical (<code class="literal">ip</code> or <code class="literal">keyword</code>), or boolean. There must be no more than 30
different values in this field.</p>
</dd>
<dt>
<span class="term">
<code class="literal">eta</code>
</span>
</dt>
<dd>
(Optional, double)
Advanced configuration option. The shrinkage applied to the weights. Smaller
values result in larger forests which have a better generalization error.
However, the smaller the value the longer the training will take. For more
information, about shrinkage, see
<a href="https://en.wikipedia.org/wiki/Gradient_boosting#Shrinkage" class="ulink" target="_top">this wiki article</a>. By
default, this value is calcuated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">feature_bag_fraction</code>
</span>
</dt>
<dd>
(Optional, double)
Advanced configuration option. Defines the fraction of features that will be
used when selecting a random bag for each candidate split. By default, this
value is calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">feature_processors</code>
</span>
</dt>
<dd>
<p>
(Optional, list)
Advanced configuration option.
A collection of feature preprocessors that modify one or more included fields.
The analysis uses the resulting one or more features instead of the
original document field. Multiple <code class="literal">feature_processors</code> entries can refer to the
same document fields. Automatic categorical
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-encoding.html" class="ulink" target="_top">feature encoding</a> still occurs for the fields
that are unprocessed by a custom processor or that have categorical values.
Only use this if you want to override the automatic feature encoding of the
specified fields. Refer to
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-processors.html" class="ulink" target="_top">data frame analytics feature processors</a> to learn
more.
</p>
<details open>
<summary class="title">Properties of <code class="literal">feature_processors</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">frequency_encoding</code>
</span>
</dt>
<dd>
<p>
(object)
The configuration information necessary to perform frequency encoding.
</p>
<details open>
<summary class="title">Properties of <code class="literal">frequency_encoding</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feature_name</code>
</span>
</dt>
<dd>
(Required, string)
The resulting feature name.
</dd>
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string)
The name of the field to encode.
</dd>
<dt>
<span class="term">
<code class="literal">frequency_map</code>
</span>
</dt>
<dd>
(Required, object)
The resulting frequency map for the field value. If the field value is missing
from the <code class="literal">frequency_map</code>, the resulting value is <code class="literal">0</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">n_gram_encoding</code>
</span>
</dt>
<dd>
<p>
(object)
The configuration information necessary to perform n-gram encoding. Features
written out by this encoder have the following name format:
<code class="literal">&lt;feature_prefix&gt;.&lt;ngram&gt;&lt;string position&gt;</code>. For example, if the
<code class="literal">feature_prefix</code> is <code class="literal">f</code>, the feature name for the second unigram in a string is
<code class="literal">f.11</code>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">n_gram_encoding</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feature_prefix</code>
</span>
</dt>
<dd>
(Optional, string)
The feature name prefix. Defaults to <code class="literal">ngram_&lt;start&gt;_&lt;length&gt;</code>.
</dd>
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string)
The name of the text field to encode.
</dd>
<dt>
<span class="term">
<code class="literal">length</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the length of the n-gram substring. Defaults to <code class="literal">50</code>. Must be greater
than <code class="literal">0</code>.
</dd>
<dt>
<span class="term">
<code class="literal">n_grams</code>
</span>
</dt>
<dd>
(Required, array)
Specifies which n-grams to gather. It’s an array of integer values where the
minimum value is 1, and a maximum value is 5.
</dd>
<dt>
<span class="term">
<code class="literal">start</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the zero-indexed start of the n-gram substring. Negative values are
allowed for encoding n-grams of string suffixes. Defaults to <code class="literal">0</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">one_hot_encoding</code>
</span>
</dt>
<dd>
<p>
(object)
The configuration information necessary to perform one hot encoding.
</p>
<details open>
<summary class="title">Properties of <code class="literal">one_hot_encoding</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string)
The name of the field to encode.
</dd>
<dt>
<span class="term">
<code class="literal">hot_map</code>
</span>
</dt>
<dd>
(Required, string)
The one hot map mapping the field value with the column name.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">target_mean_encoding</code>
</span>
</dt>
<dd>
<p>
(object)
The configuration information necessary to perform target mean encoding.
</p>
<details open>
<summary class="title">Properties of <code class="literal">target_mean_encoding</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">default_value</code>
</span>
</dt>
<dd>
(Required, integer)
The default value if field value is not found in the <code class="literal">target_map</code>.
</dd>
<dt>
<span class="term">
<code class="literal">feature_name</code>
</span>
</dt>
<dd>
(Required, string)
The resulting feature name.
</dd>
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string)
The name of the field to encode.
</dd>
<dt>
<span class="term">
<code class="literal">target_map</code>
</span>
</dt>
<dd>
(Required, object)
The field value to target mean transition map.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">gamma</code>
</span>
</dt>
<dd>
(Optional, double)
Advanced configuration option. Regularization parameter to prevent overfitting
on the training data set. Multiplies a linear penalty associated with the size of
individual trees in the forest. The higher the value the more training will
prefer smaller trees. The smaller this parameter the larger individual trees
will be and the longer training will take. By default, this value is calculated
during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">lambda</code>
</span>
</dt>
<dd>
(Optional, double)
Advanced configuration option. Regularization parameter to prevent overfitting
on the training data set. Multiplies an L2 regularisation term which applies to
leaf weights of the individual trees in the forest. The higher the value the
more training will attempt to keep leaf weights small. This makes the prediction
function smoother at the expense of potentially not being able to capture
relevant relationships between the features and the dependent variable. The smaller this
parameter the larger individual trees will be and the longer training will take.
By default, this value is calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">max_trees</code>
</span>
</dt>
<dd>
(Optional, integer)
Advanced configuration option. Defines the maximum number of trees the forest is
allowed to contain. The maximum value is 2000. By default, this value is
calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">num_top_classes</code>
</span>
</dt>
<dd>
<p>
(Optional, integer)
Defines the number of categories for which the predicted probabilities are
reported. It must be non-negative or -1. If it is -1 or greater than the total
number of categories, probabilities are reported for all categories; if you have
a large number of categories, there could be a significant effect on the size of your destination index. Defaults to 2.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To use the
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-dfanalytics-evaluate.html#ml-dfanalytics-class-aucroc" class="ulink" target="_top">AUC ROC evaluation method</a>,
<code class="literal">num_top_classes</code> must be set to <code class="literal">-1</code> or a value greater than or equal to the
total number of categories.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(Optional, integer)
Advanced configuration option. Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document to return.
By default, it is zero and no feature importance calculation occurs.
</dd>
<dt>
<span class="term">
<code class="literal">prediction_field_name</code>
</span>
</dt>
<dd>
(Optional, string)
Defines the name of the prediction field in the results.
Defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">randomize_seed</code>
</span>
</dt>
<dd>
(Optional, long)
Defines the seed to the random generator that is used to pick
which documents will be used for training. By default it is randomly generated.
Set it to a specific value to ensure the same documents are used for training
assuming other related parameters (e.g. <code class="literal">source</code>, <code class="literal">analyzed_fields</code>, etc.) are
the same.
</dd>
<dt>
<span class="term">
<code class="literal">training_percent</code>
</span>
</dt>
<dd>
(Optional, integer)
Defines what percentage of the eligible documents that will
be used for training. Documents that are ignored by the analysis (for example
those that contain arrays with more than one value) won’t be included in the
calculation for used percentage. Defaults to <code class="literal">100</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">outlier_detection</code>
</span>
</dt>
<dd>
<p>
(Required<sup>*</sup>, object)
The configuration information necessary to perform
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/dfa-outlier-detection.html" class="ulink" target="_top">outlier detection</a>:
</p>
<details open>
<summary class="title">Properties of <code class="literal">outlier_detection</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">compute_feature_influence</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Specifies whether the feature influence calculation is enabled. Defaults to
<code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">feature_influence_threshold</code>
</span>
</dt>
<dd>
(Optional, double)
The minimum outlier score that a document needs to have to calculate its feature
influence score. Value range: 0-1 (<code class="literal">0.1</code> by default).
</dd>
<dt>
<span class="term">
<code class="literal">method</code>
</span>
</dt>
<dd>
(Optional, string)
The method that outlier detection uses. Available methods are <code class="literal">lof</code>, <code class="literal">ldof</code>,
<code class="literal">distance_kth_nn</code>, <code class="literal">distance_knn</code>, and <code class="literal">ensemble</code>. The default value is
<code class="literal">ensemble</code>, which means that outlier detection uses an ensemble of different methods
and normalises and combines their individual outlier scores to obtain the overall
outlier score.
</dd>
<dt>
<span class="term">
<code class="literal">n_neighbors</code>
</span>
</dt>
<dd>
(Optional, integer)
Defines the value for how many nearest neighbors each method of outlier detection
uses to calculate its outlier score. When the value is not set, different values are
used for different ensemble members. This deafault behavior helps improve the
diversity in the ensemble; only override it if you are confident that the value
you choose is appropriate for the data set.
</dd>
<dt>
<span class="term">
<code class="literal">outlier_fraction</code>
</span>
</dt>
<dd>
(Optional, double)
The proportion of the data set that is assumed to be outlying prior to
outlier detection. For example, 0.05 means it is assumed that 5% of values are real
outliers and 95% are inliers.
</dd>
<dt>
<span class="term">
<code class="literal">standardization_enabled</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, the following operation is performed on the columns before computing
outlier scores: (x_i - mean(x_i)) / sd(x_i). Defaults to <code class="literal">true</code>. For
more information about this concept, see
<a href="https://en.wikipedia.org/wiki/Feature_scaling#Standardization_(Z-score_Normalization)" class="ulink" target="_top">Wikipedia</a>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">regression</code>
</span>
</dt>
<dd>
<p>
(Required<sup>*</sup>, object)
The configuration information necessary to perform
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/dfa-regression.html" class="ulink" target="_top">regression</a>.
</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Advanced parameters are for fine-tuning regression analysis. They are set
automatically by hyperparameter optimization to give minimum validation error.
It is highly recommended to use the default values unless you fully understand
the function of these parameters.</p>
</div>
</div>
<details open>
<summary class="title">Properties of <code class="literal">regression</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">dependent_variable</code>
</span>
</dt>
<dd>
<p>
(Required, string)
</p>
<p>Defines which field of the document is to be predicted.
This parameter is supplied by field name and must match one of the fields in
the index being used to train. If this field is missing from a document, then
that document will not be used for training, but a prediction with the trained
model will be generated for it. It is also known as continuous target variable.</p>
<p>The data type of the field must be numeric.</p>
</dd>
<dt>
<span class="term">
<code class="literal">eta</code>
</span>
</dt>
<dd>
(Optional, double)
Advanced configuration option. The shrinkage applied to the weights. Smaller
values result in larger forests which have a better generalization error.
However, the smaller the value the longer the training will take. For more
information, about shrinkage, see
<a href="https://en.wikipedia.org/wiki/Gradient_boosting#Shrinkage" class="ulink" target="_top">this wiki article</a>. By
default, this value is calcuated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">feature_bag_fraction</code>
</span>
</dt>
<dd>
(Optional, double)
Advanced configuration option. Defines the fraction of features that will be
used when selecting a random bag for each candidate split. By default, this
value is calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">feature_processors</code>
</span>
</dt>
<dd>
(Optional, list)
Advanced configuration option.
A collection of feature preprocessors that modify one or more included fields.
The analysis uses the resulting one or more features instead of the
original document field. Multiple <code class="literal">feature_processors</code> entries can refer to the
same document fields. Automatic categorical
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-encoding.html" class="ulink" target="_top">feature encoding</a> still occurs for the fields
that are unprocessed by a custom processor or that have categorical values.
Only use this if you want to override the automatic feature encoding of the
specified fields. Refer to
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-processors.html" class="ulink" target="_top">data frame analytics feature processors</a> to learn
more.
</dd>
<dt>
<span class="term">
<code class="literal">gamma</code>
</span>
</dt>
<dd>
(Optional, double)
Advanced configuration option. Regularization parameter to prevent overfitting
on the training data set. Multiplies a linear penalty associated with the size of
individual trees in the forest. The higher the value the more training will
prefer smaller trees. The smaller this parameter the larger individual trees
will be and the longer training will take. By default, this value is calculated
during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">lambda</code>
</span>
</dt>
<dd>
(Optional, double)
Advanced configuration option. Regularization parameter to prevent overfitting
on the training data set. Multiplies an L2 regularisation term which applies to
leaf weights of the individual trees in the forest. The higher the value the
more training will attempt to keep leaf weights small. This makes the prediction
function smoother at the expense of potentially not being able to capture
relevant relationships between the features and the dependent variable. The smaller this
parameter the larger individual trees will be and the longer training will take.
By default, this value is calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">loss_function</code>
</span>
</dt>
<dd>
(Optional, string)
The loss function used during regression. Available options are <code class="literal">mse</code> (mean
squared error), <code class="literal">msle</code> (mean squared logarithmic error),  <code class="literal">huber</code> (Pseudo-Huber
loss). Defaults to <code class="literal">mse</code>. Refer to
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/dfa-regression.html#dfa-regression-lossfunction" class="ulink" target="_top">Loss functions for regression analyses</a>
to learn more.
</dd>
<dt>
<span class="term">
<code class="literal">loss_function_parameter</code>
</span>
</dt>
<dd>
(Optional, double)
A positive number that is used as a parameter to the <code class="literal">loss_function</code>.
</dd>
<dt>
<span class="term">
<code class="literal">max_trees</code>
</span>
</dt>
<dd>
(Optional, integer)
Advanced configuration option. Defines the maximum number of trees the forest is
allowed to contain. The maximum value is 2000. By default, this value is
calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(Optional, integer)
Advanced configuration option. Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document to return.
By default, it is zero and no feature importance calculation occurs.
</dd>
<dt>
<span class="term">
<code class="literal">prediction_field_name</code>
</span>
</dt>
<dd>
(Optional, string)
Defines the name of the prediction field in the results.
Defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">randomize_seed</code>
</span>
</dt>
<dd>
(Optional, long)
Defines the seed to the random generator that is used to pick
which documents will be used for training. By default it is randomly generated.
Set it to a specific value to ensure the same documents are used for training
assuming other related parameters (e.g. <code class="literal">source</code>, <code class="literal">analyzed_fields</code>, etc.) are
the same.
</dd>
<dt>
<span class="term">
<code class="literal">training_percent</code>
</span>
</dt>
<dd>
(Optional, integer)
Defines what percentage of the eligible documents that will
be used for training. Documents that are ignored by the analysis (for example
those that contain arrays with more than one value) won’t be included in the
calculation for used percentage. Defaults to <code class="literal">100</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">analyzed_fields</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Specify <code class="literal">includes</code> and/or <code class="literal">excludes</code> patterns to select which fields will be
included in the analysis. The patterns specified in <code class="literal">excludes</code> are applied last,
therefore <code class="literal">excludes</code> takes precedence. In other words, if the same field is
specified in both <code class="literal">includes</code> and <code class="literal">excludes</code>, then the field will not be included
in the analysis.
</p>
<p><a id="dfa-supported-fields"></a>The supported fields for each type of analysis are as follows:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Outlier detection requires numeric or boolean data to analyze. The algorithms
don&#8217;t support missing values therefore fields that have data types other than
numeric or boolean are ignored. Documents where included fields contain missing
values, null values, or an array are also ignored. Therefore the <code class="literal">dest</code> index
may contain documents that don&#8217;t have an outlier score.
</li>
<li class="listitem">
Regression supports fields that are numeric, <code class="literal">boolean</code>, <code class="literal">text</code>,
<code class="literal">keyword</code>, and <code class="literal">ip</code>. It is also tolerant of missing values. Fields that are
supported are included in the analysis, other fields are ignored. Documents
where included fields contain  an array with two or more values are also
ignored. Documents in the <code class="literal">dest</code> index  that don’t contain a results field are
not included in the regression analysis.
</li>
<li class="listitem">
Classification supports fields that are numeric, <code class="literal">boolean</code>, <code class="literal">text</code>,
<code class="literal">keyword</code>, and <code class="literal">ip</code>. It is also tolerant of missing values. Fields that are
supported are included in the analysis, other fields are ignored. Documents
where included fields contain an array with two or more values are also ignored.
Documents in the <code class="literal">dest</code> index that don’t contain a results field are not
included in the classification analysis. Classification analysis can be improved by mapping
ordinal variable values to a  single number. For example, in case of age ranges,
you can model the values as "0-14" = 0, "15-24" = 1, "25-34" = 2, and so on.
</li>
</ul>
</div>
<p>If <code class="literal">analyzed_fields</code> is not set, only the relevant fields will be included. For
example, all the numeric fields for outlier detection. For more information about
field selection, see <a class="xref" href="ml-df-analytics-apis.html#explain-dfanalytics" title="Explain data frame analytics API">Explain data frame analytics</a>.</p>
<details open>
<summary class="title">Properties of <code class="literal">analyzed_fields</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">excludes</code>
</span>
</dt>
<dd>
(Optional, array)
An array of strings that defines the fields that will be excluded from the
analysis. You do not need to add fields with unsupported data types to
<code class="literal">excludes</code>, these fields are excluded from the analysis automatically.
</dd>
<dt>
<span class="term">
<code class="literal">includes</code>
</span>
</dt>
<dd>
(Optional, array)
An array of strings that defines the fields that will be included in the
analysis.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">description</code>
</span>
</dt>
<dd>
(Optional, string)
A description of the job.
</dd>
<dt>
<span class="term">
<code class="literal">dest</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The destination configuration, consisting of <code class="literal">index</code> and optionally
<code class="literal">results_field</code> (<code class="literal">ml</code> by default).
</p>
<details open>
<summary class="title">Properties of <code class="literal">dest</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
(Required, string) Defines the <em>destination index</em> to store the results of the
data frame analytics job.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string) Defines the name of the field in which to store the results
of the analysis. Defaults to <code class="literal">ml</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">max_num_threads</code>
</span>
</dt>
<dd>
(Optional, integer)
The maximum number of threads to be used by the analysis.
The default value is <code class="literal">1</code>. Using more threads may decrease the time
necessary to complete the analysis at the cost of using more CPU.
Note that the process may use additional threads for operational
functionality other than the analysis itself.
</dd>
<dt>
<span class="term">
<code class="literal">model_memory_limit</code>
</span>
</dt>
<dd>
(Optional, string)
The approximate maximum amount of memory resources that are permitted for
analytical processing. The default value for data frame analytics jobs is <code class="literal">1gb</code>. If
your <code class="literal">elasticsearch.yml</code> file contains an <code class="literal">xpack.ml.max_model_memory_limit</code>
setting, an error occurs when you try to create data frame analytics jobs that have
<code class="literal">model_memory_limit</code> values greater than that setting. For more information, see
<a class="xref" href="settings.html#ml-settings" title="Machine learning settings in Elasticsearch">Machine learning settings</a>.
</dd>
<dt>
<span class="term">
<code class="literal">source</code>
</span>
</dt>
<dd>
<p>
(object)
The configuration of how to source the analysis data. It requires an <code class="literal">index</code>.
Optionally, <code class="literal">query</code> and <code class="literal">_source</code> may be specified.
</p>
<details open>
<summary class="title">Properties of <code class="literal">source</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
<p>
(Required, string or array) Index or indices on which to perform the analysis.
It can be a single index or index pattern as well as an array of indices or
patterns.
</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>If your source indices contain documents with the same IDs, only the
document that is indexed last appears in the destination index.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">query</code>
</span>
</dt>
<dd>
(Optional, object) The Elasticsearch query domain-specific language (<a class="xref" href="query-dsl.html" title="Query DSL">DSL</a>).
This value corresponds to the query object in an Elasticsearch search POST body. All the
options that are supported by Elasticsearch can be used, as this object is passed
verbatim to Elasticsearch. By default, this property has the following value:
<code class="literal">{"match_all": {}}</code>.
</dd>
<dt>
<span class="term">
<code class="literal">_source</code>
</span>
</dt>
<dd>
<p>
(Optional, object) Specify <code class="literal">includes</code> and/or <code class="literal">excludes</code> patterns to select which
fields will be present in the destination. Fields that are excluded cannot be
included in the analysis.
</p>
<details open>
<summary class="title">Properties of <code class="literal">_source</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">includes</code>
</span>
</dt>
<dd>
(array) An array of strings that defines the fields that will be included in the
destination.
</dd>
<dt>
<span class="term">
<code class="literal">excludes</code>
</span>
</dt>
<dd>
(array) An array of strings that defines the fields that will be excluded from
the destination.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-dfanalytics-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-put-dfanalytics-example-preprocess"></a>Preprocessing actions example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<p>The following example shows how to limit the scope of the analysis to certain
fields, specify excluded fields in the destination index, and use a query to
filter your data before analysis.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ml/data_frame/analytics/model-flight-delays-pre
{
  "source": {
    "index": [
      "kibana_sample_data_flights" <a id="CO648-1"></a><i class="conum" data-value="1"></i>
    ],
    "query": { <a id="CO648-2"></a><i class="conum" data-value="2"></i>
      "range": {
        "DistanceKilometers": {
          "gt": 0
        }
      }
    },
    "_source": { <a id="CO648-3"></a><i class="conum" data-value="3"></i>
      "includes": [],
      "excludes": [
        "FlightDelay",
        "FlightDelayType"
      ]
    }
  },
  "dest": { <a id="CO648-4"></a><i class="conum" data-value="4"></i>
    "index": "df-flight-delays",
    "results_field": "ml-results"
  },
  "analysis": {
  "regression": {
    "dependent_variable": "FlightDelayMin",
    "training_percent": 90
    }
  },
  "analyzed_fields": { <a id="CO648-5"></a><i class="conum" data-value="5"></i>
    "includes": [],
    "excludes": [
      "FlightNum"
    ]
  },
  "model_memory_limit": "100mb"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2097.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO648-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Source index to analyze.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO648-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This query filters out entire documents that will not be present in the
destination index.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO648-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">_source</code> object defines fields in the dataset that will be included or
excluded in the destination index.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO648-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Defines the destination index that contains the results of the analysis and
the fields of the source index specified in the <code class="literal">_source</code> object. Also defines
the name of the <code class="literal">results_field</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO648-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Specifies fields to be included in or excluded from the analysis. This does
not affect whether the fields will be present in the destination index, only
affects whether they are used in the analysis.</p>
</td>
</tr>
</table>
</div>
<p>In this example, we can see that all the fields of the source index are included
in the destination index except <code class="literal">FlightDelay</code> and <code class="literal">FlightDelayType</code> because
these are defined as excluded fields by the <code class="literal">excludes</code> parameter of the
<code class="literal">_source</code> object. The <code class="literal">FlightNum</code> field is included in the destination index,
however it is not included in the analysis because it is explicitly specified as
excluded field by the <code class="literal">excludes</code> parameter of the <code class="literal">analyzed_fields</code> object.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-put-dfanalytics-example-od"></a>Outlier detection example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<p>The following example creates the <code class="literal">loganalytics</code> data frame analytics job, the analysis
type is <code class="literal">outlier_detection</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ml/data_frame/analytics/loganalytics
{
  "description": "Outlier detection on log data",
  "source": {
    "index": "logdata"
  },
  "dest": {
    "index": "logdata_out"
  },
  "analysis": {
    "outlier_detection": {
      "compute_feature_influence": true,
      "outlier_fraction": 0.05,
      "standardization_enabled": true
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2098.console"></div>
<p>The API returns the following result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "id": "loganalytics",
  "description": "Outlier detection on log data",
  "source": {
    "index": ["logdata"],
    "query": {
      "match_all": {}
    }
  },
  "dest": {
    "index": "logdata_out",
    "results_field": "ml"
  },
  "analysis": {
    "outlier_detection": {
      "compute_feature_influence": true,
      "outlier_fraction": 0.05,
      "standardization_enabled": true
    }
  },
  "model_memory_limit": "1gb",
  "create_time" : 1562265491319,
  "version" : "7.6.0",
  "allow_lazy_start" : false,
  "max_num_threads": 1
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-put-dfanalytics-example-r"></a>Regression examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<p>The following example creates the <code class="literal">house_price_regression_analysis</code>
data frame analytics job, the analysis type is <code class="literal">regression</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ml/data_frame/analytics/house_price_regression_analysis
{
  "source": {
    "index": "houses_sold_last_10_yrs"
  },
  "dest": {
    "index": "house_price_predictions"
  },
  "analysis":
    {
      "regression": {
        "dependent_variable": "price"
      }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2099.console"></div>
<p>The API returns the following result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "id" : "house_price_regression_analysis",
  "source" : {
    "index" : [
      "houses_sold_last_10_yrs"
    ],
    "query" : {
      "match_all" : { }
    }
  },
  "dest" : {
    "index" : "house_price_predictions",
    "results_field" : "ml"
  },
  "analysis" : {
    "regression" : {
      "dependent_variable" : "price",
      "training_percent" : 100
    }
  },
  "model_memory_limit" : "1gb",
  "create_time" : 1567168659127,
  "version" : "8.0.0",
  "allow_lazy_start" : false
}</pre>
</div>
<p>The following example creates a job and specifies a training percent:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ml/data_frame/analytics/student_performance_mathematics_0.3
{
 "source": {
   "index": "student_performance_mathematics"
 },
 "dest": {
   "index":"student_performance_mathematics_reg"
 },
 "analysis":
   {
     "regression": {
       "dependent_variable": "G3",
       "training_percent": 70,  <a id="CO649-1"></a><i class="conum" data-value="1"></i>
       "randomize_seed": 19673948271  <a id="CO649-2"></a><i class="conum" data-value="2"></i>
     }
   }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2100.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO649-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The percentage of the data set that is used for training the model.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO649-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The seed that is used to randomly pick which data is used for training.</p>
</td>
</tr>
</table>
</div>
<p>The following example uses custom feature processors to transform the
categorical values for <code class="literal">DestWeather</code> into numerical values using one-hot,
target-mean, and frequency encoding techniques:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ml/data_frame/analytics/flight_prices
{
  "source": {
    "index": [
      "kibana_sample_data_flights"
    ]
  },
  "dest": {
    "index": "kibana_sample_flight_prices"
  },
  "analysis": {
    "regression": {
      "dependent_variable": "AvgTicketPrice",
      "num_top_feature_importance_values": 2,
      "feature_processors": [
        {
          "frequency_encoding": {
            "field": "DestWeather",
            "feature_name": "DestWeather_frequency",
            "frequency_map": {
              "Rain": 0.14604811155570188,
              "Heavy Fog": 0.14604811155570188,
              "Thunder &amp; Lightning": 0.14604811155570188,
              "Cloudy": 0.14604811155570188,
              "Damaging Wind": 0.14604811155570188,
              "Hail": 0.14604811155570188,
              "Sunny": 0.14604811155570188,
              "Clear": 0.14604811155570188
            }
          }
        },
        {
          "target_mean_encoding": {
            "field": "DestWeather",
            "feature_name": "DestWeather_targetmean",
            "target_map": {
              "Rain": 626.5588814585794,
              "Heavy Fog": 626.5588814585794,
              "Thunder &amp; Lightning": 626.5588814585794,
              "Hail": 626.5588814585794,
              "Damaging Wind": 626.5588814585794,
              "Cloudy": 626.5588814585794,
              "Clear": 626.5588814585794,
              "Sunny": 626.5588814585794
            },
            "default_value": 624.0249512020454
          }
        },
        {
          "one_hot_encoding": {
            "field": "DestWeather",
            "hot_map": {
              "Rain": "DestWeather_Rain",
              "Heavy Fog": "DestWeather_Heavy Fog",
              "Thunder &amp; Lightning": "DestWeather_Thunder &amp; Lightning",
              "Cloudy": "DestWeather_Cloudy",
              "Damaging Wind": "DestWeather_Damaging Wind",
              "Hail": "DestWeather_Hail",
              "Clear": "DestWeather_Clear",
              "Sunny": "DestWeather_Sunny"
            }
          }
        }
      ]
    }
  },
  "analyzed_fields": {
    "includes": [
      "AvgTicketPrice",
      "Cancelled",
      "DestWeather",
      "FlightDelayMin",
      "DistanceMiles"
    ]
  },
  "model_memory_limit": "30mb"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2101.console"></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>These custom feature processors are optional; automatic
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-encoding.html" class="ulink" target="_top">feature encoding</a> still occurs for all
categorical features.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-put-dfanalytics-example-c"></a>Classification example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<p>The following example creates the <code class="literal">loan_classification</code> data frame analytics job, the
analysis type is <code class="literal">classification</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ml/data_frame/analytics/loan_classification
{
  "source" : {
    "index": "loan-applicants"
  },
  "dest" : {
    "index": "loan-applicants-classified"
  },
  "analysis" : {
    "classification": {
      "dependent_variable": "label",
      "training_percent": 75,
      "num_top_classes": 2
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2102.console"></div>
</div>

</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="put-trained-models"></a>Create trained models API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Creates a trained model.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Models created in version 7.8.0 are not backwards compatible
         with older node versions. If in a mixed cluster environment,
         all nodes must be at least 7.8.0 to use a model stored by
         a 7.8.0 node.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-trained-models-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT _ml/trained_models/&lt;model_id&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-trained-models-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following
built-in roles or equivalent privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">machine_learning_admin</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#built-in-roles" title="Built-in roles">Built-in roles</a> and <a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-trained-models-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p>The create trained model API enables you to supply a trained model that is not
created by data frame analytics.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-trained-models-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;model_id&gt;</code>
</span>
</dt>
<dd>
(Required, string)
The unique identifier of the trained model.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-trained-models-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">compressed_definition</code>
</span>
</dt>
<dd>
(Required, string)
The compressed (GZipped and Base64 encoded) inference definition of the model.
If <code class="literal">compressed_definition</code> is specified, then <code class="literal">definition</code> cannot be specified.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">definition</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The inference definition for the model. If <code class="literal">definition</code> is specified, then
<code class="literal">compressed_definition</code> cannot be specified.
</p>
<details open>
<summary class="title">Properties of <code class="literal">definition</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">preprocessors</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Collection of preprocessors. See <a class="xref" href="ml-df-analytics-apis.html#ml-put-trained-models-preprocessor-example" title="Preprocessor examples">Preprocessor examples</a>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">preprocessors</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">frequency_encoding</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Defines a frequency encoding for a field.
</p>
<details open>
<summary class="title">Properties of <code class="literal">frequency_encoding</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feature_name</code>
</span>
</dt>
<dd>
(Required, string)
The name of the resulting feature.
</dd>
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string)
The field name to encode.
</dd>
<dt>
<span class="term">
<code class="literal">frequency_map</code>
</span>
</dt>
<dd>
(Required, object map of string:double)
Object that maps the field value to the frequency encoded value.
</dd>
<dt>
<span class="term">
<code class="literal">custom</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Boolean value indicating if the analytics job created the preprocessor
or if a user provided it. This adjusts the feature importance calculation.
When <code class="literal">true</code>, the feature importance calculation returns importance for the
processed feature. When <code class="literal">false</code>, the total importance of the original field
is returned. Default is <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">one_hot_encoding</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Defines a one hot encoding map for a field.
</p>
<details open>
<summary class="title">Properties of <code class="literal">one_hot_encoding</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string)
The field name to encode.
</dd>
<dt>
<span class="term">
<code class="literal">hot_map</code>
</span>
</dt>
<dd>
(Required, object map of strings)
String map of "field_value: one_hot_column_name".
</dd>
<dt>
<span class="term">
<code class="literal">custom</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Boolean value indicating if the analytics job created the preprocessor
or if a user provided it. This adjusts the feature importance calculation.
When <code class="literal">true</code>, the feature importance calculation returns importance for the
processed feature. When <code class="literal">false</code>, the total importance of the original field
is returned. Default is <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">target_mean_encoding</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Defines a target mean encoding for a field.
</p>
<details open>
<summary class="title">Properties of <code class="literal">target_mean_encoding</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">default_value</code>
</span>
</dt>
<dd>
(Required, double)
The feature value if the field value is not in the <code class="literal">target_map</code>.
</dd>
<dt>
<span class="term">
<code class="literal">feature_name</code>
</span>
</dt>
<dd>
(Required, string)
The name of the resulting feature.
</dd>
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string)
The field name to encode.
</dd>
<dt>
<span class="term">
<code class="literal">target_map</code>
</span>
</dt>
<dd>
<p>
(Required, object map of string:double)
Object that maps the field value to the target mean value.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">custom</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Boolean value indicating if the analytics job created the preprocessor
or if a user provided it. This adjusts the feature importance calculation.
When <code class="literal">true</code>, the feature importance calculation returns importance for the
processed feature. When <code class="literal">false</code>, the total importance of the original field
is returned. Default is <code class="literal">false</code>.
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">trained_model</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The definition of the trained model.
</p>
<details open>
<summary class="title">Properties of <code class="literal">trained_model</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">tree</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The definition for a binary decision tree.
</p>
<details open>
<summary class="title">Properties of <code class="literal">tree</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">classification_labels</code>
</span>
</dt>
<dd>
(Optional, string) An array of classification labels (used for
<code class="literal">classification</code>).
</dd>
<dt>
<span class="term">
<code class="literal">feature_names</code>
</span>
</dt>
<dd>
(Required, string)
Features expected by the tree, in their expected order.
</dd>
<dt>
<span class="term">
<code class="literal">target_type</code>
</span>
</dt>
<dd>
(Required, string)
String indicating the model target type; <code class="literal">regression</code> or <code class="literal">classification</code>.
</dd>
<dt>
<span class="term">
<code class="literal">tree_structure</code>
</span>
</dt>
<dd>
(Required, object)
An array of <code class="literal">tree_node</code> objects. The nodes must be in ordinal order by their
<code class="literal">tree_node.node_index</code> value.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">tree_node</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The definition of a node in a tree.
</p>
<p>There are two major types of nodes: leaf nodes and not-leaf nodes.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Leaf nodes only need <code class="literal">node_index</code> and <code class="literal">leaf_value</code> defined.
</li>
<li class="listitem">
All other nodes need <code class="literal">split_feature</code>, <code class="literal">left_child</code>, <code class="literal">right_child</code>,
<code class="literal">threshold</code>, <code class="literal">decision_type</code>, and <code class="literal">default_left</code> defined.
</li>
</ul>
</div>
<details open>
<summary class="title">Properties of <code class="literal">tree_node</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">decision_type</code>
</span>
</dt>
<dd>
(Optional, string)
Indicates the positive value (in other words, when to choose the left node)
decision type. Supported <code class="literal">lt</code>, <code class="literal">lte</code>, <code class="literal">gt</code>, <code class="literal">gte</code>. Defaults to <code class="literal">lte</code>.
</dd>
<dt>
<span class="term">
<code class="literal">default_left</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Indicates whether to default to the left when the feature is missing. Defaults
to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">leaf_value</code>
</span>
</dt>
<dd>
(Optional, double)
The leaf value of the of the node, if the value is a leaf (in other words, no
children).
</dd>
<dt>
<span class="term">
<code class="literal">left_child</code>
</span>
</dt>
<dd>
(Optional, integer)
The index of the left child.
</dd>
<dt>
<span class="term">
<code class="literal">node_index</code>
</span>
</dt>
<dd>
(Integer)
The index of the current node.
</dd>
<dt>
<span class="term">
<code class="literal">right_child</code>
</span>
</dt>
<dd>
(Optional, integer)
The index of the right child.
</dd>
<dt>
<span class="term">
<code class="literal">split_feature</code>
</span>
</dt>
<dd>
(Optional, integer)
The index of the feature value in the feature array.
</dd>
<dt>
<span class="term">
<code class="literal">split_gain</code>
</span>
</dt>
<dd>
(Optional, double) The information gain from the split.
</dd>
<dt>
<span class="term">
<code class="literal">threshold</code>
</span>
</dt>
<dd>
(Optional, double)
The decision threshold with which to compare the feature value.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ensemble</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
The definition for an ensemble model. See <a class="xref" href="ml-df-analytics-apis.html#ml-put-trained-models-model-example" title="Model examples">Model examples</a>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">ensemble</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aggregate_output</code>
</span>
</dt>
<dd>
<p>
(Required, object)
An aggregated output object that defines how to aggregate the outputs of the
<code class="literal">trained_models</code>. Supported objects are <code class="literal">weighted_mode</code>, <code class="literal">weighted_sum</code>, and
<code class="literal">logistic_regression</code>. See <a class="xref" href="ml-df-analytics-apis.html#ml-put-trained-models-aggregated-output-example" title="Aggregated output example">Aggregated output example</a>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">aggregate_output</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">logistic_regression</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
This <code class="literal">aggregated_output</code> type works with binary classification (classification
for values [0, 1]). It multiplies the outputs (in the case of the <code class="literal">ensemble</code>
model, the inference model values) by the supplied <code class="literal">weights</code>. The resulting
vector is summed and passed to a
<a href="https://en.wikipedia.org/wiki/Sigmoid_function" class="ulink" target="_top"><code class="literal">sigmoid</code> function</a>. The result
of the <code class="literal">sigmoid</code> function is considered the probability of class 1 (<code class="literal">P_1</code>),
consequently, the probability of class 0 is <code class="literal">1 - P_1</code>. The class with the
highest probability (either 0 or 1) is then returned. For more information about
logistic regression, see
<a href="https://en.wikipedia.org/wiki/Logistic_regression" class="ulink" target="_top">this wiki article</a>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">logistic_regression</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">weights</code>
</span>
</dt>
<dd>
(Required, double)
The weights to multiply by the input values (the inference values of the trained
models).
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">weighted_sum</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
This <code class="literal">aggregated_output</code> type works with regression. The weighted sum of the
input values.
</p>
<details open>
<summary class="title">Properties of <code class="literal">weighted_sum</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">weights</code>
</span>
</dt>
<dd>
(Required, double)
The weights to multiply by the input values (the inference values of the trained
models).
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">weighted_mode</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
This <code class="literal">aggregated_output</code> type works with regression or classification. It takes
a weighted vote of the input values. The most common input value (taking the
weights into account) is returned.
</p>
<details open>
<summary class="title">Properties of <code class="literal">weighted_mode</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">weights</code>
</span>
</dt>
<dd>
(Required, double)
The weights to multiply by the input values (the inference values of the trained
models).
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">exponent</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
This <code class="literal">aggregated_output</code> type works with regression. It takes a weighted sum of
the input values and passes the result to an exponent function
(<code class="literal">e^x</code> where <code class="literal">x</code> is the sum of the weighted values).
</p>
<details open>
<summary class="title">Properties of <code class="literal">exponent</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">weights</code>
</span>
</dt>
<dd>
(Required, double)
The weights to multiply by the input values (the inference values of the trained
models).
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">classification_labels</code>
</span>
</dt>
<dd>
(Optional, string)
An array of classification labels.
</dd>
<dt>
<span class="term">
<code class="literal">feature_names</code>
</span>
</dt>
<dd>
(Optional, string)
Features expected by the ensemble, in their expected order.
</dd>
<dt>
<span class="term">
<code class="literal">target_type</code>
</span>
</dt>
<dd>
(Required, string)
String indicating the model target type; <code class="literal">regression</code> or <code class="literal">classification.</code>
</dd>
<dt>
<span class="term">
<code class="literal">trained_models</code>
</span>
</dt>
<dd>
(Required, object)
An array of <code class="literal">trained_model</code> objects. Supported trained models are <code class="literal">tree</code> and
<code class="literal">ensemble</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">description</code>
</span>
</dt>
<dd>
(Optional, string)
A human-readable description of the inference trained model.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">inference_config</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The default configuration for inference. This can be either a <code class="literal">regression</code>
or <code class="literal">classification</code> configuration. It must match the underlying
<code class="literal">definition.trained_model</code>'s <code class="literal">target_type</code>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">inference_config</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">regression</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Regression configuration for inference.
</p>
<details open>
<summary class="title">Properties of regression inference</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document.
By default, it is zero and no feature importance calculation occurs.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to <code class="literal">predicted_value</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">classification</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Classification configuration for inference.
</p>
<details open>
<summary class="title">Properties of classification inference</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">num_top_classes</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the number of top class predictions to return. Defaults to 0.
</dd>
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document. By
default, it is zero and no feature importance calculation occurs.
</dd>
<dt>
<span class="term">
<code class="literal">prediction_field_type</code>
</span>
</dt>
<dd>
(Optional, string)
Specifies the type of the predicted field to write.
Acceptable values are: <code class="literal">string</code>, <code class="literal">number</code>, <code class="literal">boolean</code>. When <code class="literal">boolean</code> is provided
<code class="literal">1.0</code> is transformed to <code class="literal">true</code> and <code class="literal">0.0</code> to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to <code class="literal">predicted_value</code>.
</dd>
<dt>
<span class="term">
<code class="literal">top_classes_results_field</code>
</span>
</dt>
<dd>
(Optional, string)
Specifies the field to which the top classes are written. Defaults to
<code class="literal">top_classes</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">input</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The input field names for the model definition.
</p>
<details open>
<summary class="title">Properties of <code class="literal">input</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field_names</code>
</span>
</dt>
<dd>
(Required, string)
An array of input field names for the model.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(Optional, object)
An object map that contains metadata about the model.
</dd>
<dt>
<span class="term">
<code class="literal">tags</code>
</span>
</dt>
<dd>
(Optional, string)
An array of tags to organize the model.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-put-trained-models-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-put-trained-models-preprocessor-example"></a>Preprocessor examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h4>
</div></div></div>
<p>The example below shows a <code class="literal">frequency_encoding</code> preprocessor object:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
   "frequency_encoding":{
      "field":"FlightDelayType",
      "feature_name":"FlightDelayType_frequency",
      "frequency_map":{
         "Carrier Delay":0.6007414737092798,
         "NAS Delay":0.6007414737092798,
         "Weather Delay":0.024573576178086153,
         "Security Delay":0.02476631010889467,
         "No Delay":0.6007414737092798,
         "Late Aircraft Delay":0.6007414737092798
      }
   }
}</pre>
</div>
<p>The next example shows a <code class="literal">one_hot_encoding</code> preprocessor object:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
   "one_hot_encoding":{
      "field":"FlightDelayType",
      "hot_map":{
         "Carrier Delay":"FlightDelayType_Carrier Delay",
         "NAS Delay":"FlightDelayType_NAS Delay",
         "No Delay":"FlightDelayType_No Delay",
         "Late Aircraft Delay":"FlightDelayType_Late Aircraft Delay"
      }
   }
}</pre>
</div>
<p>This example shows a <code class="literal">target_mean_encoding</code> preprocessor object:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
   "target_mean_encoding":{
      "field":"FlightDelayType",
      "feature_name":"FlightDelayType_targetmean",
      "target_map":{
         "Carrier Delay":39.97465788139886,
         "NAS Delay":39.97465788139886,
         "Security Delay":203.171206225681,
         "Weather Delay":187.64705882352948,
         "No Delay":39.97465788139886,
         "Late Aircraft Delay":39.97465788139886
      },
      "default_value":158.17995752420433
   }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-put-trained-models-model-example"></a>Model examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h4>
</div></div></div>
<p>The first example shows a <code class="literal">trained_model</code> object:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
   "tree":{
      "feature_names":[
         "DistanceKilometers",
         "FlightTimeMin",
         "FlightDelayType_NAS Delay",
         "Origin_targetmean",
         "DestRegion_targetmean",
         "DestCityName_targetmean",
         "OriginAirportID_targetmean",
         "OriginCityName_frequency",
         "DistanceMiles",
         "FlightDelayType_Late Aircraft Delay"
      ],
      "tree_structure":[
         {
            "decision_type":"lt",
            "threshold":9069.33437193022,
            "split_feature":0,
            "split_gain":4112.094574306927,
            "node_index":0,
            "default_left":true,
            "left_child":1,
            "right_child":2
         },
         ...
         {
            "node_index":9,
            "leaf_value":-27.68987349695448
         },
         ...
      ],
      "target_type":"regression"
   }
}</pre>
</div>
<p>The following example shows an <code class="literal">ensemble</code> model object:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"ensemble":{
   "feature_names":[
      ...
   ],
   "trained_models":[
      {
         "tree":{
            "feature_names":[],
            "tree_structure":[
               {
                  "decision_type":"lte",
                  "node_index":0,
                  "leaf_value":47.64069875778043,
                  "default_left":false
               }
            ],
            "target_type":"regression"
         }
      },
      ...
   ],
   "aggregate_output":{
      "weighted_sum":{
         "weights":[
            ...
         ]
      }
   },
   "target_type":"regression"
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-put-trained-models-aggregated-output-example"></a>Aggregated output example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h4>
</div></div></div>
<p>Example of a <code class="literal">logistic_regression</code> object:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"aggregate_output" : {
  "logistic_regression" : {
    "weights" : [2.0, 1.0, .5, -1.0, 5.0, 1.0, 1.0]
  }
}</pre>
</div>
<p>Example of a <code class="literal">weighted_sum</code> object:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"aggregate_output" : {
  "weighted_sum" : {
    "weights" : [1.0, -1.0, .5, 1.0, 5.0]
  }
}</pre>
</div>
<p>Example of a <code class="literal">weighted_mode</code> object:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"aggregate_output" : {
  "weighted_mode" : {
    "weights" : [1.0, 1.0, 1.0, 1.0, 1.0]
  }
}</pre>
</div>
<p>Example of an <code class="literal">exponent</code> object:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"aggregate_output" : {
  "exponent" : {
    "weights" : [1.0, 1.0, 1.0, 1.0, 1.0]
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-put-trained-models-json-schema"></a>Trained models JSON schema<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/put-trained-models.asciidoc">edit</a></h4>
</div></div></div>
<p>For the full JSON schema of trained models,
<a href="https://github.com/elastic/ml-json-schemas" class="ulink" target="_top">click here</a>.</p>
</div>

</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="update-dfanalytics"></a>Update data frame analytics jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/update-dfanalytics.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Updates an existing data frame analytics job.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-update-dfanalytics-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/update-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;/_update</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-update-dfanalytics-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/update-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following
built-in roles and privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">machine_learning_admin</code>
</li>
<li class="listitem">
source indices: <code class="literal">read</code>, <code class="literal">view_index_metadata</code>
</li>
<li class="listitem">
destination index: <code class="literal">read</code>, <code class="literal">create_index</code>, <code class="literal">manage</code> and <code class="literal">index</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#built-in-roles" title="Built-in roles">Built-in roles</a>, <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>, and
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The data frame analytics job remembers which roles the user who updated it had at
the time of the update. When you start the job, it performs the analysis using
those same roles. If you provide
<a class="xref" href="ccs-clients-integrations.html#http-clients-secondary-authorization" title="Secondary authorization">secondary authorization headers</a>,
those credentials are used instead.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-update-dfanalytics-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/update-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>This API updates an existing data frame analytics job that performs an analysis on the source
indices and stores the outcome in a destination index.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-update-dfanalytics-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/update-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;data_frame_analytics_id&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Identifier for the data frame analytics job. This identifier can contain lowercase
alphanumeric characters (a-z and 0-9), hyphens, and underscores. It must start
and end with alphanumeric characters.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-update-dfanalytics-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/update-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">allow_lazy_start</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Specifies whether this job can start when there is insufficient machine learning node
capacity for it to be immediately assigned to a node. The default is <code class="literal">false</code>; if
a machine learning node with capacity to run the job cannot immediately be found, the API
returns an error. However, this is also subject to the cluster-wide
<code class="literal">xpack.ml.max_lazy_ml_nodes</code> setting. See <a class="xref" href="settings.html#advanced-ml-settings" title="Advanced machine learning settings">Advanced machine learning settings</a>. If this
option is set to <code class="literal">true</code>, the API does not return an error and the job waits in
the <code class="literal">starting</code> state until sufficient machine learning node capacity is available.
</dd>
<dt>
<span class="term">
<code class="literal">description</code>
</span>
</dt>
<dd>
(Optional, string)
A description of the job.
</dd>
<dt>
<span class="term">
<code class="literal">max_num_threads</code>
</span>
</dt>
<dd>
(Optional, integer)
The maximum number of threads to be used by the analysis.
The default value is <code class="literal">1</code>. Using more threads may decrease the time
necessary to complete the analysis at the cost of using more CPU.
Note that the process may use additional threads for operational
functionality other than the analysis itself.
</dd>
<dt>
<span class="term">
<code class="literal">model_memory_limit</code>
</span>
</dt>
<dd>
(Optional, string)
The approximate maximum amount of memory resources that are permitted for
analytical processing. The default value for data frame analytics jobs is <code class="literal">1gb</code>. If
your <code class="literal">elasticsearch.yml</code> file contains an <code class="literal">xpack.ml.max_model_memory_limit</code>
setting, an error occurs when you try to create data frame analytics jobs that have
<code class="literal">model_memory_limit</code> values greater than that setting. For more information, see
<a class="xref" href="settings.html#ml-settings" title="Machine learning settings in Elasticsearch">Machine learning settings</a>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-update-dfanalytics-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/update-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-update-dfanalytics-example-preprocess"></a>Updating model memory limit example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/update-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<p>The following example shows how to update the model memory limit for the existing data frame analytics configuration.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/analytics/model-flight-delays/_update
{
  "model_memory_limit": "200mb"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2103.console"></div>
</div>

</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="delete-dfanalytics"></a>Delete data frame analytics jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-dfanalytics.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Deletes an existing data frame analytics job.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-dfanalytics-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-dfanalytics-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following built-in roles or equivalent privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">machine_learning_admin</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#built-in-roles" title="Built-in roles">Built-in roles</a> and <a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-dfanalytics-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;data_frame_analytics_id&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Identifier for the data frame analytics job.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-dfanalytics-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">force</code>
</span>
</dt>
<dd>
(Optional, Boolean) If <code class="literal">true</code>, it deletes a job that is not stopped; this method is
quicker than stopping and deleting the job.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) The time to wait for the job to be deleted.
Defaults to 1 minute.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-dfanalytics-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example deletes the <code class="literal">loganalytics</code> data frame analytics job:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE _ml/data_frame/analytics/loganalytics</pre>
</div>
<div class="console_widget" data-snippet="snippets/2104.console"></div>
<p>The API returns the following result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "acknowledged" : true
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="delete-trained-models"></a>Delete trained models API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-trained-models.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Deletes an existing trained inference model that is currently not referenced by an
ingest pipeline.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-trained-models-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE _ml/trained_models/&lt;model_id&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-trained-models-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following built-in roles or equivalent privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">machine_learning_admin</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#built-in-roles" title="Built-in roles">Built-in roles</a> and <a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-trained-models-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;model_id&gt;</code>
</span>
</dt>
<dd>
(Optional, string)
The unique identifier of the trained model.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-trained-models-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">409</code>
</span>
</dt>
<dd>
The code indicates that the trained model is referenced by an ingest pipeline
and cannot be deleted.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-delete-trained-models-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/delete-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example deletes the <code class="literal">regression-job-one-1574775307356</code> trained
model:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE _ml/trained_models/regression-job-one-1574775307356</pre>
</div>
<div class="console_widget" data-snippet="snippets/2105.console"></div>
<p>The API returns the following result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "acknowledged" : true
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="evaluate-dfanalytics"></a>Evaluate data frame analytics API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Evaluates the data frame analytics for an annotated index.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-evaluate-dfanalytics-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _ml/data_frame/_evaluate</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-evaluate-dfanalytics-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
cluster: <code class="literal">monitor_ml</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a> and
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-evaluate-dfanalytics-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>The API packages together commonly used evaluation metrics for various types of
machine learning features. This has been designed for use on indexes created by
data frame analytics. Evaluation requires both a ground truth field and an analytics
result field to be present.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-evaluate-dfanalytics-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">evaluation</code>
</span>
</dt>
<dd>
<p>
(Required, object) Defines the type of evaluation you want to perform.
See <a class="xref" href="ml-df-analytics-apis.html#ml-evaluate-dfanalytics-resources" title="Data frame analytics evaluation resources">Data frame analytics evaluation resources</a>.
</p>
<p>Available evaluation types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">outlier_detection</code>
</li>
<li class="listitem">
<code class="literal">regression</code>
</li>
<li class="listitem">
<code class="literal">classification</code>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
(Required, object) Defines the <code class="literal">index</code> in which the evaluation will be
performed.
</dd>
<dt>
<span class="term">
<code class="literal">query</code>
</span>
</dt>
<dd>
(Optional, object) A query clause that retrieves a subset of data from the
source index. See <a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-evaluate-dfanalytics-resources"></a>Data frame analytics evaluation resources<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="oldetection-resources"></a>Outlier detection evaluation objects<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<p>Outlier detection evaluates the results of an outlier detection analysis which
outputs the probability that each document is an outlier.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">actual_field</code>
</span>
</dt>
<dd>
(Required, string) The field of the <code class="literal">index</code> which contains the <code class="literal">ground truth</code>.
The data type of this field can be boolean or integer. If the data type is
integer, the value has to be either <code class="literal">0</code> (false) or <code class="literal">1</code> (true).
</dd>
<dt>
<span class="term">
<code class="literal">predicted_probability_field</code>
</span>
</dt>
<dd>
(Required, string) The field of the <code class="literal">index</code> that defines the probability of
whether the item belongs to the class in question or not. It&#8217;s the field that
contains the results of the analysis.
</dd>
<dt>
<span class="term">
<code class="literal">metrics</code>
</span>
</dt>
<dd>
<p>
(Optional, object) Specifies the metrics that are used for the evaluation.
Available metrics:
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">auc_roc</code>
</span>
</dt>
<dd>
(Optional, object) The AUC ROC (area under the curve of the receiver
operating characteristic) score and optionally the curve. Default value is
{"include_curve": false}.
</dd>
<dt>
<span class="term">
<code class="literal">confusion_matrix</code>
</span>
</dt>
<dd>
(Optional, object) Set the different thresholds of the outlier score at where
the metrics (<code class="literal">tp</code> - true positive, <code class="literal">fp</code> - false positive, <code class="literal">tn</code> - true
negative, <code class="literal">fn</code> - false negative) are calculated. Default value is
{"at": [0.25, 0.50, 0.75]}.
</dd>
<dt>
<span class="term">
<code class="literal">precision</code>
</span>
</dt>
<dd>
(Optional, object) Set the different thresholds of the outlier score at where
the metric is calculated. Default value is {"at": [0.25, 0.50, 0.75]}.
</dd>
<dt>
<span class="term">
<code class="literal">recall</code>
</span>
</dt>
<dd>
(Optional, object) Set the different thresholds of the outlier score at where
the metric is calculated. Default value is {"at": [0.25, 0.50, 0.75]}.
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="regression-evaluation-resources"></a>Regression evaluation objects<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<p>Regression evaluation evaluates the results of a regression analysis
which outputs a prediction of values.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">actual_field</code>
</span>
</dt>
<dd>
(Required, string) The field of the <code class="literal">index</code> which contains the <code class="literal">ground truth</code>.
The data type of this field must be numerical.
</dd>
<dt>
<span class="term">
<code class="literal">predicted_field</code>
</span>
</dt>
<dd>
(Required, string) The field in the <code class="literal">index</code> that contains the predicted value,
in other words the results of the regression analysis.
</dd>
<dt>
<span class="term">
<code class="literal">metrics</code>
</span>
</dt>
<dd>
<p>
(Optional, object) Specifies the metrics that are used for the evaluation. For
more information on <code class="literal">mse</code>, <code class="literal">msle</code>, and <code class="literal">huber</code>, consult
<a href="https://github.com/elastic/examples/tree/master/Machine%20Learning/Regression%20Loss%20Functions" class="ulink" target="_top">the Jupyter notebook on regression loss functions</a>.
Available metrics:
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">mse</code>
</span>
</dt>
<dd>
(Optional, object) Average squared difference between the predicted values
and the actual (<code class="literal">ground truth</code>) value. For more information, read
<a href="https://en.wikipedia.org/wiki/Mean_squared_error" class="ulink" target="_top">this wiki article</a>.
</dd>
<dt>
<span class="term">
<code class="literal">msle</code>
</span>
</dt>
<dd>
<p>
(Optional, object) Average squared difference between the logarithm of the
predicted values and the logarithm of the actual (<code class="literal">ground truth</code>) value.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">offset</code>
</span>
</dt>
<dd>
(Optional, double) Defines the transition point at which you switch from
minimizing quadratic error to minimizing quadratic log error. Defaults to
<code class="literal">1</code>.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">huber</code>
</span>
</dt>
<dd>
<p>
(Optional, object) Pseudo Huber loss function. For more information, read
<a href="https://en.wikipedia.org/wiki/Huber_loss#Pseudo-Huber_loss_function" class="ulink" target="_top">this wiki article</a>.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">delta</code>
</span>
</dt>
<dd>
(Optional, double) Approximates 1/2 (prediction - actual)<sup>2</sup> for values
much less than delta and approximates a straight line with slope delta for
values much larger than delta. Defaults to <code class="literal">1</code>. Delta needs to be greater
than <code class="literal">0</code>.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">r_squared</code>
</span>
</dt>
<dd>
(Optional, object) Proportion of the variance in the dependent variable that
is predictable from the independent variables. For more information, read
<a href="https://en.wikipedia.org/wiki/Coefficient_of_determination" class="ulink" target="_top">this wiki article</a>.
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="classification-evaluation-resources"></a>Classification evaluation objects<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>Classification evaluation evaluates the results of a classification analysis which
outputs a prediction that identifies to which of the classes each document
belongs.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">actual_field</code>
</span>
</dt>
<dd>
(Required, string) The field of the <code class="literal">index</code> which contains the <code class="literal">ground truth</code>.
The data type of this field must be categorical.
</dd>
<dt>
<span class="term">
<code class="literal">predicted_field</code>
</span>
</dt>
<dd>
(Optional, string) The field in the <code class="literal">index</code> which contains the predicted value,
in other words the results of the classification analysis.
</dd>
<dt>
<span class="term">
<code class="literal">top_classes_field</code>
</span>
</dt>
<dd>
(Optional, string) The field of the <code class="literal">index</code> which is an array of documents
of the form <code class="literal">{ "class_name": XXX, "class_probability": YYY }</code>.
This field must be defined as <code class="literal">nested</code> in the mappings.
</dd>
<dt>
<span class="term">
<code class="literal">metrics</code>
</span>
</dt>
<dd>
<p>
(Optional, object) Specifies the metrics that are used for the evaluation.
Available metrics:
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">accuracy</code>
</span>
</dt>
<dd>
(Optional, object) Accuracy of predictions (per-class and overall).
</dd>
<dt>
<span class="term">
<code class="literal">auc_roc</code>
</span>
</dt>
<dd>
<p>
(Optional, object) The AUC ROC (area under the curve of the receiver
operating characteristic) score and optionally the curve.
It is calculated for a specific class (provided as "class_name") treated as
positive.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">class_name</code>
</span>
</dt>
<dd>
(Required, string) Name of the only class that is treated as positive
during AUC ROC calculation. Other classes are treated as negative
("one-vs-all" strategy). All the evaluated documents must have
<code class="literal">class_name</code> in the list of their top classes.
</dd>
<dt>
<span class="term">
<code class="literal">include_curve</code>
</span>
</dt>
<dd>
(Optional, Boolean) Whether or not the curve should be returned in
addition to the score. Default value is false.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">multiclass_confusion_matrix</code>
</span>
</dt>
<dd>
(Optional, object) Multiclass confusion matrix.
</dd>
<dt>
<span class="term">
<code class="literal">precision</code>
</span>
</dt>
<dd>
(Optional, object) Precision of predictions (per-class and average).
</dd>
<dt>
<span class="term">
<code class="literal">recall</code>
</span>
</dt>
<dd>
(Optional, object) Recall of predictions (per-class and average).
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-evaluate-dfanalytics-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-evaluate-oldetection-example"></a>Outlier detection<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/_evaluate
{
  "index": "my_analytics_dest_index",
  "evaluation": {
    "outlier_detection": {
      "actual_field": "is_outlier",
      "predicted_probability_field": "ml.outlier_score"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2106.console"></div>
<p>The API returns the following results:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "outlier_detection": {
    "auc_roc": {
      "score": 0.92584757746414444
    },
    "confusion_matrix": {
      "0.25": {
          "tp": 5,
          "fp": 9,
          "tn": 204,
          "fn": 5
      },
      "0.5": {
          "tp": 1,
          "fp": 5,
          "tn": 208,
          "fn": 9
      },
      "0.75": {
          "tp": 0,
          "fp": 4,
          "tn": 209,
          "fn": 10
      }
    },
    "precision": {
        "0.25": 0.35714285714285715,
        "0.5": 0.16666666666666666,
        "0.75": 0
    },
    "recall": {
        "0.25": 0.5,
        "0.5": 0.1,
        "0.75": 0
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-evaluate-regression-example"></a>Regression<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/_evaluate
{
  "index": "house_price_predictions", <a id="CO650-1"></a><i class="conum" data-value="1"></i>
  "query": {
      "bool": {
        "filter": [
          { "term":  { "ml.is_training": false } } <a id="CO650-2"></a><i class="conum" data-value="2"></i>
        ]
      }
  },
  "evaluation": {
    "regression": {
      "actual_field": "price", <a id="CO650-3"></a><i class="conum" data-value="3"></i>
      "predicted_field": "ml.price_prediction", <a id="CO650-4"></a><i class="conum" data-value="4"></i>
      "metrics": {
        "r_squared": {},
        "mse": {},
        "msle": {"offset": 10},
        "huber": {"delta": 1.5}
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2107.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO650-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The output destination index from a data frame analytics regression analysis.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO650-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>In this example, a test/train split (<code class="literal">training_percent</code>) was defined for the
regression analysis. This query limits evaluation to be performed on the test split
only.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO650-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The ground truth value for the actual house price. This is required in order
to evaluate results.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO650-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>The predicted value for house price calculated by the regression analysis.</p>
</td>
</tr>
</table>
</div>
<p>The following example calculates the training error:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/_evaluate
{
  "index": "student_performance_mathematics_reg",
  "query": {
    "term": {
      "ml.is_training": {
        "value": true <a id="CO651-1"></a><i class="conum" data-value="1"></i>
      }
    }
  },
  "evaluation": {
    "regression": {
      "actual_field": "G3", <a id="CO651-2"></a><i class="conum" data-value="2"></i>
      "predicted_field": "ml.G3_prediction", <a id="CO651-3"></a><i class="conum" data-value="3"></i>
      "metrics": {
        "r_squared": {},
        "mse": {},
        "msle": {},
        "huber": {}
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2108.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO651-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>In this example, a test/train split (<code class="literal">training_percent</code>) was defined for the
regression analysis. This query limits evaluation to be performed on the train split
only. It means that a training error will be calculated.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO651-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The field that contains the ground truth value for the actual student
performance. This is required in order to evaluate results.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO651-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The field that contains the predicted value for student performance
calculated by the regression analysis.</p>
</td>
</tr>
</table>
</div>
<p>The next example calculates the testing error. The only difference compared with
the previous example is that <code class="literal">ml.is_training</code> is set to <code class="literal">false</code> this time, so
the query excludes the train split from the evaluation.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/_evaluate
{
  "index": "student_performance_mathematics_reg",
  "query": {
    "term": {
      "ml.is_training": {
        "value": false <a id="CO652-1"></a><i class="conum" data-value="1"></i>
      }
    }
  },
  "evaluation": {
    "regression": {
      "actual_field": "G3", <a id="CO652-2"></a><i class="conum" data-value="2"></i>
      "predicted_field": "ml.G3_prediction", <a id="CO652-3"></a><i class="conum" data-value="3"></i>
      "metrics": {
        "r_squared": {},
        "mse": {},
        "msle": {},
        "huber": {}
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2109.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO652-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>In this example, a test/train split (<code class="literal">training_percent</code>) was defined for the
regression analysis. This query limits evaluation to be performed on the test split
only. It means that a testing error will be calculated.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO652-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The field that contains the ground truth value for the actual student
performance. This is required in order to evaluate results.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO652-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The field that contains the predicted value for student performance
calculated by the regression analysis.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ml-evaluate-classification-example"></a>Classification<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/evaluate-dfanalytics.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/_evaluate
{
   "index": "animal_classification",
   "evaluation": {
      "classification": { <a id="CO653-1"></a><i class="conum" data-value="1"></i>
         "actual_field": "animal_class", <a id="CO653-2"></a><i class="conum" data-value="2"></i>
         "predicted_field": "ml.animal_class_prediction", <a id="CO653-3"></a><i class="conum" data-value="3"></i>
         "metrics": {
           "multiclass_confusion_matrix" : {} <a id="CO653-4"></a><i class="conum" data-value="4"></i>
         }
      }
   }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2110.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO653-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The evaluation type.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO653-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The field that contains the ground truth value for the actual animal
classification. This is required in order to evaluate results.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO653-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The field that contains the predicted value for animal classification by
the classification analysis.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO653-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Specifies the metric for the evaluation.</p>
</td>
</tr>
</table>
</div>
<p>The API returns the following result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
   "classification" : {
      "multiclass_confusion_matrix" : {
         "confusion_matrix" : [
         {
            "actual_class" : "cat", <a id="CO654-1"></a><i class="conum" data-value="1"></i>
            "actual_class_doc_count" : 12, <a id="CO654-2"></a><i class="conum" data-value="2"></i>
            "predicted_classes" : [ <a id="CO654-3"></a><i class="conum" data-value="3"></i>
              {
                "predicted_class" : "cat",
                "count" : 12 <a id="CO654-4"></a><i class="conum" data-value="4"></i>
              },
              {
                "predicted_class" : "dog",
                "count" : 0 <a id="CO654-5"></a><i class="conum" data-value="5"></i>
              }
            ],
            "other_predicted_class_doc_count" : 0 <a id="CO654-6"></a><i class="conum" data-value="6"></i>
          },
          {
            "actual_class" : "dog",
            "actual_class_doc_count" : 11,
            "predicted_classes" : [
              {
                "predicted_class" : "dog",
                "count" : 7
              },
              {
                "predicted_class" : "cat",
                "count" : 4
              }
            ],
            "other_predicted_class_doc_count" : 0
          }
        ],
        "other_actual_class_count" : 0
      }
    }
  }</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO654-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The name of the actual class that the analysis tried to predict.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO654-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of documents in the index that belong to the <code class="literal">actual_class</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO654-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>This object contains the list of the predicted classes and the number of
predictions associated with the class.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO654-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of cats in the dataset that are correctly identified as cats.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO654-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of cats in the dataset that are incorrectly classified as dogs.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO654-6"><i class="conum" data-value="6"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of documents that are classified as a class that is not listed as
a <code class="literal">predicted_class</code>.</p>
</td>
</tr>
</table>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/_evaluate
{
   "index": "animal_classification",
   "evaluation": {
      "classification": { <a id="CO655-1"></a><i class="conum" data-value="1"></i>
         "actual_field": "animal_class", <a id="CO655-2"></a><i class="conum" data-value="2"></i>
         "metrics": {
            "auc_roc" : { <a id="CO655-3"></a><i class="conum" data-value="3"></i>
              "class_name": "dog" <a id="CO655-4"></a><i class="conum" data-value="4"></i>
            }
         }
      }
   }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2111.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO655-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The evaluation type.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO655-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The field that contains the ground truth value for the actual animal
classification. This is required in order to evaluate results.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO655-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Specifies the metric for the evaluation.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO655-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Specifies the class name that is treated as positive during the evaluation,
all the other classes are treated as negative.</p>
</td>
</tr>
</table>
</div>
<p>The API returns the following result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "classification" : {
    "auc_roc" : {
      "score" : 0.8941788639536681
    }
  }
}</pre>
</div>
</div>

</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="explain-dfanalytics"></a>Explain data frame analytics API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/explain-dfanalytics.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Explains a data frame analytics config.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-explain-dfanalytics-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/explain-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET _ml/data_frame/analytics/_explain</code><br></p>
<p><code class="literal">POST _ml/data_frame/analytics/_explain</code><br></p>
<p><code class="literal">GET _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;/_explain</code><br></p>
<p><code class="literal">POST _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;/_explain</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-explain-dfanalytics-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/explain-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
cluster: <code class="literal">monitor_ml</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a> and <a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-explain-dfanalytics-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/explain-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>This API provides explanations for a data frame analytics config that either
exists already or one that has not been created yet.
The following explanations are provided:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
which fields are included or not in the analysis and why,
</li>
<li class="listitem">
how much memory is estimated to be required. The estimate can be used when
deciding the appropriate value for <code class="literal">model_memory_limit</code> setting later on.
</li>
</ul>
</div>
<p>If you have object fields or fields that are excluded via source filtering,
they are not included in the explanation.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-explain-dfanalytics-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/explain-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;data_frame_analytics_id&gt;</code>
</span>
</dt>
<dd>
(Optional, string)
Identifier for the data frame analytics job.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-explain-dfanalytics-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/explain-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>A data frame analytics config as described in <a class="xref" href="ml-df-analytics-apis.html#put-dfanalytics" title="Create data frame analytics jobs API">Create data frame analytics jobs</a>.
Note that <code class="literal">id</code> and <code class="literal">dest</code> don&#8217;t need to be provided in the context of this API.</p>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-explain-dfanalytics-results"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/explain-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>The API returns a response that contains the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field_selection</code>
</span>
</dt>
<dd>
<p>
(array)
An array of objects that explain selection for each field, sorted by
the field names.
</p>
<details open>
<summary class="title">Properties of <code class="literal">field_selection</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">is_included</code>
</span>
</dt>
<dd>
(Boolean) Whether the field is selected to be included in the analysis.
</dd>
<dt>
<span class="term">
<code class="literal">is_required</code>
</span>
</dt>
<dd>
(Boolean) Whether the field is required.
</dd>
<dt>
<span class="term">
<code class="literal">feature_type</code>
</span>
</dt>
<dd>
(string) The feature type of this field for the analysis. May be <code class="literal">categorical</code>
or <code class="literal">numerical</code>.
</dd>
<dt>
<span class="term">
<code class="literal">mapping_types</code>
</span>
</dt>
<dd>
(string) The mapping types of the field.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string) The field name.
</dd>
<dt>
<span class="term">
<code class="literal">reason</code>
</span>
</dt>
<dd>
(string) The reason a field is not selected to be included in the analysis.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">memory_estimation</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing the memory estimates.
</p>
<details open>
<summary class="title">Properties of <code class="literal">memory_estimation</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">expected_memory_with_disk</code>
</span>
</dt>
<dd>
(string) Estimated memory usage under the assumption that overflowing to disk is
allowed during data frame analytics. <code class="literal">expected_memory_with_disk</code> is usually smaller
than <code class="literal">expected_memory_without_disk</code> as using disk allows to limit the main
memory needed to perform data frame analytics.
</dd>
<dt>
<span class="term">
<code class="literal">expected_memory_without_disk</code>
</span>
</dt>
<dd>
(string) Estimated memory usage under the assumption that the whole
data frame analytics should happen in memory (i.e. without overflowing to disk).
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-explain-dfanalytics-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/explain-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/analytics/_explain
{
  "source": {
    "index": "houses_sold_last_10_yrs"
  },
  "analysis": {
    "regression": {
      "dependent_variable": "price"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2112.console"></div>
<p>The API returns the following results:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "field_selection": [
    {
      "field": "number_of_bedrooms",
      "mappings_types": ["integer"],
      "is_included": true,
      "is_required": false,
      "feature_type": "numerical"
    },
    {
      "field": "postcode",
      "mappings_types": ["text"],
      "is_included": false,
      "is_required": false,
      "reason": "[postcode.keyword] is preferred because it is aggregatable"
    },
    {
      "field": "postcode.keyword",
      "mappings_types": ["keyword"],
      "is_included": true,
      "is_required": false,
      "feature_type": "categorical"
    },
    {
      "field": "price",
      "mappings_types": ["float"],
      "is_included": true,
      "is_required": true,
      "feature_type": "numerical"
    }
  ],
  "memory_estimation": {
    "expected_memory_without_disk": "128MB",
    "expected_memory_with_disk": "32MB"
  }
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-dfanalytics"></a>Get data frame analytics jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves configuration information for data frame analytics jobs.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;</code><br></p>
<p><code class="literal">GET _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;,&lt;data_frame_analytics_id&gt;</code><br></p>
<p><code class="literal">GET _ml/data_frame/analytics/</code><br></p>
<p><code class="literal">GET _ml/data_frame/analytics/_all</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
cluster: <code class="literal">monitor_ml</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a> and <a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>You can get information for multiple data frame analytics jobs in a single API request
by using a comma-separated list of data frame analytics jobs or a wildcard expression.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;data_frame_analytics_id&gt;</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Identifier for the data frame analytics job. If you do not specify this option, the API
returns information for the first hundred data frame analytics jobs.
</p>
<p>You can get information for all data frame analytics jobs by using _all, by specifying
<code class="literal">*</code> as the <code class="literal">&lt;data_frame_analytics_id&gt;</code>, or by omitting the
<code class="literal">&lt;data_frame_analytics_id&gt;</code>.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">allow_no_match</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
 Specifies what to do when the request:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Contains wildcard expressions and there are no data frame analytics jobs that match.
</li>
<li class="listitem">
Contains the <code class="literal">_all</code> string or no identifiers and there are no matches.
</li>
<li class="listitem">
Contains wildcard expressions and there are only partial matches.
</li>
</ul>
</div>
<p>The default value is <code class="literal">true</code>, which returns an empty <code class="literal">data_frame_analytics</code> array
when there are no matches and the subset of results when there are partial
matches. If this parameter is <code class="literal">false</code>, the request returns a <code class="literal">404</code> status code
when there are no matches or only partial matches.</p>
</dd>
<dt>
<span class="term">
<code class="literal">from</code>
</span>
</dt>
<dd>
(Optional, integer)
Skips the specified number of data frame analytics jobs. The default value is <code class="literal">0</code>.
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of data frame analytics jobs to obtain. The default value
is <code class="literal">100</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-results"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">data_frame_analytics</code>
</span>
</dt>
<dd>
<p>
(array)
An array of data frame analytics job resources, which are sorted by the <code class="literal">id</code> value in
ascending order.
</p>
<details open>
<summary class="title">Properties of data frame analytics job resources</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">analysis</code>
</span>
</dt>
<dd>
(object) The type of analysis that is performed on the <code class="literal">source</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">analyzed_fields</code>
</span>
</dt>
<dd>
<p>
(object) Contains <code class="literal">includes</code> and/or <code class="literal">excludes</code> patterns that select which fields
are included in the analysis.
</p>
<details open>
<summary class="title">Properties of <code class="literal">analyzed_fields</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">excludes</code>
</span>
</dt>
<dd>
(Optional, array) An array of strings that defines the fields that are excluded
from the analysis.
</dd>
<dt>
<span class="term">
<code class="literal">includes</code>
</span>
</dt>
<dd>
(Optional, array) An array of strings that defines the fields that are included
in the analysis.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">dest</code>
</span>
</dt>
<dd>
<p>
(string) The destination configuration of the analysis.
</p>
<details open>
<summary class="title">Properties of <code class="literal">dest</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
(string) The <em>destination index</em> that stores the results of the
data frame analytics job.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(string) The name of the field that stores the results of the analysis. Defaults
to <code class="literal">ml</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(string) The unique identifier of the data frame analytics job.
</dd>
<dt>
<span class="term">
<code class="literal">model_memory_limit</code>
</span>
</dt>
<dd>
(string) The <code class="literal">model_memory_limit</code> that has been set to the data frame analytics job.
</dd>
<dt>
<span class="term">
<code class="literal">source</code>
</span>
</dt>
<dd>
<p>
(object) The configuration of how the analysis data is sourced. It has an
<code class="literal">index</code> parameter and optionally a <code class="literal">query</code> and a <code class="literal">_source</code>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">source</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
(array) Index or indices on which to perform the analysis. It can be a single
index or index pattern as well as an array of indices or patterns.
</dd>
<dt>
<span class="term">
<code class="literal">query</code>
</span>
</dt>
<dd>
(object) The query that has been specified for the data frame analytics job. The Elasticsearch
query domain-specific language (<a class="xref" href="query-dsl.html" title="Query DSL">DSL</a>). This value corresponds to
the query object in an Elasticsearch search POST body. By default, this property has the
following value: <code class="literal">{"match_all": {}}</code>.
</dd>
<dt>
<span class="term">
<code class="literal">_source</code>
</span>
</dt>
<dd>
<p>
(object) Contains the specified <code class="literal">includes</code> and/or <code class="literal">excludes</code> patterns that
select which fields are present in the destination. Fields that are excluded
cannot be included in the analysis.
</p>
<details open>
<summary class="title">Properties of <code class="literal">_source</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">excludes</code>
</span>
</dt>
<dd>
(array) An array of strings that defines the fields that are excluded from the
destination.
</dd>
<dt>
<span class="term">
<code class="literal">includes</code>
</span>
</dt>
<dd>
(array) An array of strings that defines the fields that are included in the
destination.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">404</code> (Missing resources)
</span>
</dt>
<dd>
If <code class="literal">allow_no_match</code> is <code class="literal">false</code>, this code indicates that there are no
resources that match the request or only partial matches for the request.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example gets configuration information for the <code class="literal">loganalytics</code>
data frame analytics job:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _ml/data_frame/analytics/loganalytics</pre>
</div>
<div class="console_widget" data-snippet="snippets/2113.console"></div>
<p>The API returns the following results:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "count": 1,
  "data_frame_analytics": [
    {
      "id": "loganalytics",
      "source": {
        "index": "logdata",
        "query": {
          "match_all": {}
        }
      },
      "dest": {
        "index": "logdata_out",
        "results_field": "ml"
      },
      "analysis": {
        "outlier_detection": {}
      },
      "model_memory_limit": "1gb",
      "create_time": 1562265491319,
      "version": "8.0.0"
    }
  ]
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-dfanalytics-stats"></a>Get data frame analytics jobs statistics API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics-stats.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves usage information for data frame analytics jobs.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-stats-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics-stats.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;/_stats</code><br></p>
<p><code class="literal">GET _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;,&lt;data_frame_analytics_id&gt;/_stats</code><br></p>
<p><code class="literal">GET _ml/data_frame/analytics/_stats</code><br></p>
<p><code class="literal">GET _ml/data_frame/analytics/_all/_stats</code><br></p>
<p><code class="literal">GET _ml/data_frame/analytics/*/_stats</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-stats-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics-stats.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
cluster: <code class="literal">monitor_ml</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a> and <a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-stats-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics-stats.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;data_frame_analytics_id&gt;</code>
</span>
</dt>
<dd>
(Optional, string)
Identifier for the data frame analytics job. If you do not specify this option, the API
returns information for the first hundred data frame analytics jobs.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-stats-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics-stats.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">allow_no_match</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
 Specifies what to do when the request:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Contains wildcard expressions and there are no data frame analytics jobs that match.
</li>
<li class="listitem">
Contains the <code class="literal">_all</code> string or no identifiers and there are no matches.
</li>
<li class="listitem">
Contains wildcard expressions and there are only partial matches.
</li>
</ul>
</div>
<p>The default value is <code class="literal">true</code>, which returns an empty <code class="literal">data_frame_analytics</code> array
when there are no matches and the subset of results when there are partial
matches. If this parameter is <code class="literal">false</code>, the request returns a <code class="literal">404</code> status code
when there are no matches or only partial matches.</p>
</dd>
<dt>
<span class="term">
<code class="literal">from</code>
</span>
</dt>
<dd>
(Optional, integer)
Skips the specified number of data frame analytics jobs. The default value is <code class="literal">0</code>.
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of data frame analytics jobs to obtain. The default value
is <code class="literal">100</code>.
</dd>
<dt>
<span class="term">
<code class="literal">verbose</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Defines whether the stats response should be verbose. The default value is <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-stats-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics-stats.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">data_frame_analytics</code>
</span>
</dt>
<dd>
<p>
(array)
An array of objects that contain usage information for data frame analytics jobs, which
are sorted by the <code class="literal">id</code> value in ascending order.
</p>
<details open>
<summary class="title">Properties of data frame analytics job usage resources</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">analysis_stats</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing information about the analysis job.
</p>
<details open>
<summary class="title">Properties of <code class="literal">analysis_stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">classification_stats</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing information about the classification analysis job.
</p>
<details open>
<summary class="title">Properties of <code class="literal">classification_stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">hyperparameters</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing the parameters of the classification analysis job.
</p>
<details open>
<summary class="title">Properties of <code class="literal">hyperparameters</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">alpha</code>
</span>
</dt>
<dd>
(double)
Regularization factor to penalize deeper trees when training decision trees.
</dd>
<dt>
<span class="term">
<code class="literal">class_assignment_objective</code>
</span>
</dt>
<dd>
(string)
Defines the objective to optimize when assigning class labels:
<code class="literal">maximize_accuracy</code> or <code class="literal">maximize_minimum_recall</code>. When maximizing accuracy,
class labels are chosen to maximize the number of correct predictions. When
maximizing minimum recall, labels are chosen to maximize the minimum recall
for any class. Defaults to <code class="literal">maximize_minimum_recall</code>.
</dd>
<dt>
<span class="term">
<code class="literal">downsample_factor</code>
</span>
</dt>
<dd>
(double)
The value of the downsample factor.
</dd>
<dt>
<span class="term">
<code class="literal">eta</code>
</span>
</dt>
<dd>
(double)
Advanced configuration option. The shrinkage applied to the weights. Smaller
values result in larger forests which have a better generalization error.
However, the smaller the value the longer the training will take. For more
information, about shrinkage, see
<a href="https://en.wikipedia.org/wiki/Gradient_boosting#Shrinkage" class="ulink" target="_top">this wiki article</a>. By
default, this value is calcuated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">eta_growth_rate_per_tree</code>
</span>
</dt>
<dd>
(double)
Specifies the rate at which the <code class="literal">eta</code> increases for each new tree that is added to the
forest. For example, a rate of <code class="literal">1.05</code> increases <code class="literal">eta</code> by 5%.
</dd>
<dt>
<span class="term">
<code class="literal">feature_bag_fraction</code>
</span>
</dt>
<dd>
(double)
Advanced configuration option. Defines the fraction of features that will be
used when selecting a random bag for each candidate split. By default, this
value is calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">gamma</code>
</span>
</dt>
<dd>
(double)
Advanced configuration option. Regularization parameter to prevent overfitting
on the training data set. Multiplies a linear penalty associated with the size of
individual trees in the forest. The higher the value the more training will
prefer smaller trees. The smaller this parameter the larger individual trees
will be and the longer training will take. By default, this value is calculated
during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">lambda</code>
</span>
</dt>
<dd>
(double)
Advanced configuration option. Regularization parameter to prevent overfitting
on the training data set. Multiplies an L2 regularisation term which applies to
leaf weights of the individual trees in the forest. The higher the value the
more training will attempt to keep leaf weights small. This makes the prediction
function smoother at the expense of potentially not being able to capture
relevant relationships between the features and the dependent variable. The smaller this
parameter the larger individual trees will be and the longer training will take.
By default, this value is calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">max_attempts_to_add_tree</code>
</span>
</dt>
<dd>
(integer)
If the algorithm fails to determine a non-trivial tree (more than a single
leaf), this parameter determines how many of such consecutive failures are
tolerated. Once the number of attempts exceeds the threshold, the forest
training stops.
</dd>
<dt>
<span class="term">
<code class="literal">max_optimization_rounds_per_hyperparameter</code>
</span>
</dt>
<dd>
(integer)
A multiplier responsible for determining the maximum number of
hyperparameter optimization steps in the Bayesian optimization procedure.
The maximum number of steps is determined based on the number of undefined hyperparameters
times the maximum optimization rounds per hyperparameter.
</dd>
<dt>
<span class="term">
<code class="literal">max_trees</code>
</span>
</dt>
<dd>
(integer)
Advanced configuration option. Defines the maximum number of trees the forest is
allowed to contain. The maximum value is 2000. By default, this value is
calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">num_folds</code>
</span>
</dt>
<dd>
(integer)
The maximum number of folds for the cross-validation procedure.
</dd>
<dt>
<span class="term">
<code class="literal">num_splits_per_feature</code>
</span>
</dt>
<dd>
(integer)
Determines the maximum number of splits for every feature that can occur in a
decision tree when the tree is trained.
</dd>
<dt>
<span class="term">
<code class="literal">soft_tree_depth_limit</code>
</span>
</dt>
<dd>
(double)
Tree depth limit is used for calculating the tree depth penalty. This is a soft
limit, it can be exceeded.
</dd>
<dt>
<span class="term">
<code class="literal">soft_tree_depth_tolerance</code>
</span>
</dt>
<dd>
(double)
Tree depth tolerance is used for calculating the tree depth penalty. This is a
soft limit, it can be exceeded.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">iteration</code>
</span>
</dt>
<dd>
(integer)
The number of iterations on the analysis.
</dd>
<dt>
<span class="term">
<code class="literal">timestamp</code>
</span>
</dt>
<dd>
(date)
The timestamp when the statistics were reported in milliseconds since the epoch.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">timing_stats</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing time statistics about the data frame analytics job.
</p>
<details open>
<summary class="title">Properties of <code class="literal">timing_stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">elapsed_time</code>
</span>
</dt>
<dd>
(integer)
Runtime of the analysis in milliseconds.
</dd>
<dt>
<span class="term">
<code class="literal">iteration_time</code>
</span>
</dt>
<dd>
(integer)
Runtime of the latest iteration of the analysis in milliseconds.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">validation_loss</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing information about validation loss.
</p>
<details open>
<summary class="title">Properties of <code class="literal">validation_loss</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">fold_values</code>
</span>
</dt>
<dd>
(array of strings)
Validation loss values for every added decision tree during the forest growing
procedure.
</dd>
<dt>
<span class="term">
<code class="literal">loss_type</code>
</span>
</dt>
<dd>
(string)
The type of the loss metric. For example, <code class="literal">binomial_logistic</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">outlier_detection_stats</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing information about the outlier detection job.
</p>
<details open>
<summary class="title">Properties of <code class="literal">outlier_detection_stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">parameters</code>
</span>
</dt>
<dd>
<p>
(object)
The list of job parameters specified by the user or determined by algorithmic
heuristics.
</p>
<details open>
<summary class="title">Properties of <code class="literal">parameters</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">compute_feature_influence</code>
</span>
</dt>
<dd>
(Boolean)
Specifies whether the feature influence calculation is enabled. Defaults to
<code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">feature_influence_threshold</code>
</span>
</dt>
<dd>
(double)
The minimum outlier score that a document needs to have to calculate its feature
influence score. Value range: 0-1 (<code class="literal">0.1</code> by default).
</dd>
<dt>
<span class="term">
<code class="literal">method</code>
</span>
</dt>
<dd>
(string)
The method that outlier detection uses. Available methods are <code class="literal">lof</code>, <code class="literal">ldof</code>,
<code class="literal">distance_kth_nn</code>, <code class="literal">distance_knn</code>, and <code class="literal">ensemble</code>. The default value is
<code class="literal">ensemble</code>, which means that outlier detection uses an ensemble of different methods
and normalises and combines their individual outlier scores to obtain the overall
outlier score.
</dd>
<dt>
<span class="term">
<code class="literal">n_neighbors</code>
</span>
</dt>
<dd>
(integer)
Defines the value for how many nearest neighbors each method of outlier detection
uses to calculate its outlier score. When the value is not set, different values are
used for different ensemble members. This deafault behavior helps improve the
diversity in the ensemble; only override it if you are confident that the value
you choose is appropriate for the data set.
</dd>
<dt>
<span class="term">
<code class="literal">outlier_fraction</code>
</span>
</dt>
<dd>
(double)
The proportion of the data set that is assumed to be outlying prior to
outlier detection. For example, 0.05 means it is assumed that 5% of values are real
outliers and 95% are inliers.
</dd>
<dt>
<span class="term">
<code class="literal">standardization_enabled</code>
</span>
</dt>
<dd>
(Boolean)
If <code class="literal">true</code>, the following operation is performed on the columns before computing
outlier scores: (x_i - mean(x_i)) / sd(x_i). Defaults to <code class="literal">true</code>. For
more information about this concept, see
<a href="https://en.wikipedia.org/wiki/Feature_scaling#Standardization_(Z-score_Normalization)" class="ulink" target="_top">Wikipedia</a>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">timestamp</code>
</span>
</dt>
<dd>
(date)
The timestamp when the statistics were reported in milliseconds since the epoch.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">timing_stats</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing time statistics about the data frame analytics job.
</p>
<details open>
<summary class="title">Property of <code class="literal">timing_stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">elapsed_time</code>
</span>
</dt>
<dd>
(integer)
Runtime of the analysis in milliseconds.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">regression_stats</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing information about the regression analysis.
</p>
<details open>
<summary class="title">Properties of <code class="literal">regression_stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">hyperparameters</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing the parameters of the regression analysis.
</p>
<details open>
<summary class="title">Properties of <code class="literal">hyperparameters</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">alpha</code>
</span>
</dt>
<dd>
(double)
Regularization factor to penalize deeper trees when training decision trees.
</dd>
<dt>
<span class="term">
<code class="literal">downsample_factor</code>
</span>
</dt>
<dd>
(double)
The value of the downsample factor.
</dd>
<dt>
<span class="term">
<code class="literal">eta</code>
</span>
</dt>
<dd>
(double)
Advanced configuration option. The shrinkage applied to the weights. Smaller
values result in larger forests which have a better generalization error.
However, the smaller the value the longer the training will take. For more
information, about shrinkage, see
<a href="https://en.wikipedia.org/wiki/Gradient_boosting#Shrinkage" class="ulink" target="_top">this wiki article</a>. By
default, this value is calcuated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">eta_growth_rate_per_tree</code>
</span>
</dt>
<dd>
(double)
Specifies the rate at which the <code class="literal">eta</code> increases for each new tree that is added to the
forest. For example, a rate of <code class="literal">1.05</code> increases <code class="literal">eta</code> by 5%.
</dd>
<dt>
<span class="term">
<code class="literal">feature_bag_fraction</code>
</span>
</dt>
<dd>
(double)
Advanced configuration option. Defines the fraction of features that will be
used when selecting a random bag for each candidate split. By default, this
value is calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">gamma</code>
</span>
</dt>
<dd>
(double)
Advanced configuration option. Regularization parameter to prevent overfitting
on the training data set. Multiplies a linear penalty associated with the size of
individual trees in the forest. The higher the value the more training will
prefer smaller trees. The smaller this parameter the larger individual trees
will be and the longer training will take. By default, this value is calculated
during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">lambda</code>
</span>
</dt>
<dd>
(double)
Advanced configuration option. Regularization parameter to prevent overfitting
on the training data set. Multiplies an L2 regularisation term which applies to
leaf weights of the individual trees in the forest. The higher the value the
more training will attempt to keep leaf weights small. This makes the prediction
function smoother at the expense of potentially not being able to capture
relevant relationships between the features and the dependent variable. The smaller this
parameter the larger individual trees will be and the longer training will take.
By default, this value is calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">max_attempts_to_add_tree</code>
</span>
</dt>
<dd>
(integer)
If the algorithm fails to determine a non-trivial tree (more than a single
leaf), this parameter determines how many of such consecutive failures are
tolerated. Once the number of attempts exceeds the threshold, the forest
training stops.
</dd>
<dt>
<span class="term">
<code class="literal">max_optimization_rounds_per_hyperparameter</code>
</span>
</dt>
<dd>
(integer)
A multiplier responsible for determining the maximum number of
hyperparameter optimization steps in the Bayesian optimization procedure.
The maximum number of steps is determined based on the number of undefined hyperparameters
times the maximum optimization rounds per hyperparameter.
</dd>
<dt>
<span class="term">
<code class="literal">max_trees</code>
</span>
</dt>
<dd>
(integer)
Advanced configuration option. Defines the maximum number of trees the forest is
allowed to contain. The maximum value is 2000. By default, this value is
calculated during hyperparameter optimization.
</dd>
<dt>
<span class="term">
<code class="literal">num_folds</code>
</span>
</dt>
<dd>
(integer)
The maximum number of folds for the cross-validation procedure.
</dd>
<dt>
<span class="term">
<code class="literal">num_splits_per_feature</code>
</span>
</dt>
<dd>
(integer)
Determines the maximum number of splits for every feature that can occur in a
decision tree when the tree is trained.
</dd>
<dt>
<span class="term">
<code class="literal">soft_tree_depth_limit</code>
</span>
</dt>
<dd>
(double)
Tree depth limit is used for calculating the tree depth penalty. This is a soft
limit, it can be exceeded.
</dd>
<dt>
<span class="term">
<code class="literal">soft_tree_depth_tolerance</code>
</span>
</dt>
<dd>
(double)
Tree depth tolerance is used for calculating the tree depth penalty. This is a
soft limit, it can be exceeded.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">iteration</code>
</span>
</dt>
<dd>
(integer)
The number of iterations on the analysis.
</dd>
<dt>
<span class="term">
<code class="literal">timestamp</code>
</span>
</dt>
<dd>
(date)
The timestamp when the statistics were reported in milliseconds since the epoch.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">timing_stats</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing time statistics about the data frame analytics job.
</p>
<details open>
<summary class="title">Propertis of <code class="literal">timing_stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">elapsed_time</code>
</span>
</dt>
<dd>
(integer)
Runtime of the analysis in milliseconds.
</dd>
<dt>
<span class="term">
<code class="literal">iteration_time</code>
</span>
</dt>
<dd>
(integer)
Runtime of the latest iteration of the analysis in milliseconds.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">validation_loss</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing information about validation loss.
</p>
<details open>
<summary class="title">Properties of <code class="literal">validation_loss</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">fold_values</code>
</span>
</dt>
<dd>
(array of strings)
Validation loss values for every added decision tree during the forest growing
procedure.
</dd>
<dt>
<span class="term">
<code class="literal">loss_type</code>
</span>
</dt>
<dd>
(string)
The type of the loss metric. For example, <code class="literal">binomial_logistic</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">assignment_explanation</code>
</span>
</dt>
<dd>
(string)
For running jobs only, contains messages relating to the selection of a node to
run the job.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">data_counts</code>
</span>
</dt>
<dd>
<p>
(object)
An object that provides counts for the quantity of documents skipped, used in
training, or available for testing.
</p>
<details open>
<summary class="title">Properties of <code class="literal">data_counts</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">skipped_docs_count</code>
</span>
</dt>
<dd>
(integer)
The number of documents that are skipped during the analysis because they
contained values that are not supported by the analysis. For example,
outlier detection does not support missing fields so it skips documents with missing
fields. Likewise, all types of analysis skip documents that contain arrays with
more than one element.
</dd>
<dt>
<span class="term">
<code class="literal">test_docs_count</code>
</span>
</dt>
<dd>
(integer)
The number of documents that are not used for training the model and can be used
for testing.
</dd>
<dt>
<span class="term">
<code class="literal">training_docs_count</code>
</span>
</dt>
<dd>
(integer)
The number of documents that are used for training the model.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(string)
The unique identifier of the data frame analytics job.
</dd>
<dt>
<span class="term">
<code class="literal">memory_usage</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
An object describing memory usage of the analytics. It is present only after the
job is started and memory usage is reported.
</p>
<details open>
<summary class="title">Properties of <code class="literal">memory_usage</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">memory_reestimate_bytes</code>
</span>
</dt>
<dd>
(long)
This value is present when the <code class="literal">status</code> is <code class="literal">hard_limit</code> and it
is a new estimate of how much memory the job needs.
</dd>
<dt>
<span class="term">
<code class="literal">peak_usage_bytes</code>
</span>
</dt>
<dd>
(long)
The number of bytes used at the highest peak of memory usage.
</dd>
<dt>
<span class="term">
<code class="literal">status</code>
</span>
</dt>
<dd>
<p>
(string)
The memory usage status. May have one of the following values:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">ok</code>: usage stayed below the limit.
</li>
<li class="listitem">
<code class="literal">hard_limit</code>: usage surpassed the configured memory limit.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">timestamp</code>
</span>
</dt>
<dd>
(date)
The timestamp when memory usage was calculated.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">node</code>
</span>
</dt>
<dd>
<p>
(object)
Contains properties for the node that runs the job. This information is
available only for running jobs.
</p>
<details open>
<summary class="title">Properties of <code class="literal">node</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">attributes</code>
</span>
</dt>
<dd>
(object)
Lists node attributes such as <code class="literal">ml.machine_memory</code> or <code class="literal">ml.max_open_jobs</code> settings.
</dd>
<dt>
<span class="term">
<code class="literal">ephemeral_id</code>
</span>
</dt>
<dd>
(string)
The ephemeral ID of the node.
</dd>
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(string)
The unique identifier of the node.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string)
The node name.
</dd>
<dt>
<span class="term">
<code class="literal">transport_address</code>
</span>
</dt>
<dd>
(string)
The host and port where transport HTTP connections are accepted.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">progress</code>
</span>
</dt>
<dd>
<p>
(array) The progress report of the data frame analytics job by phase.
</p>
<details open>
<summary class="title">Properties of phase objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">phase</code>
</span>
</dt>
<dd>
<p>
(string) Defines the phase of the data frame analytics job. Possible phases:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">reindexing</code>,
</li>
<li class="listitem">
<code class="literal">loading_data</code>,
</li>
<li class="listitem">
<code class="literal">computing_outliers</code> (for outlier detection only),
</li>
<li class="listitem">
<code class="literal">feature_selection</code> (for regression and classification only),
</li>
<li class="listitem">
<code class="literal">coarse_parameter_search</code> (for regression and classification only),
</li>
<li class="listitem">
<code class="literal">fine_tuning_parameters</code> (for regression and classification only),
</li>
<li class="listitem">
<code class="literal">final_training</code> (for regression and classification only),
</li>
<li class="listitem">
<code class="literal">writing_results</code>,
</li>
<li class="listitem">
<p><code class="literal">inference</code> (for regression and classification only).</p>
<p>To learn more about the different phases, refer to
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-dfa-phases.html" class="ulink" target="_top">How a data frame analytics job works</a>.</p>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">progress_percent</code>
</span>
</dt>
<dd>
(integer) The progress that the data frame analytics job has made expressed in
percentage.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">state</code>
</span>
</dt>
<dd>
(string) The status of the data frame analytics job, which can be one of the following
values: <code class="literal">analyzing</code>, <code class="literal">failed</code>, <code class="literal">reindexing</code>, <code class="literal">started</code>, <code class="literal">starting</code>, <code class="literal">stopped</code>,
<code class="literal">stopping</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-stats-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics-stats.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">404</code> (Missing resources)
</span>
</dt>
<dd>
If <code class="literal">allow_no_match</code> is <code class="literal">false</code>, this code indicates that there are no
resources that match the request or only partial matches for the request.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-dfanalytics-stats-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-dfanalytics-stats.asciidoc">edit</a></h3>
</div></div></div>
<p>The following API retrieves usage information for the
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ecommerce-outliers.html" class="ulink" target="_top">outlier detection data frame analytics job example</a>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _ml/data_frame/analytics/ecommerce/_stats</pre>
</div>
<div class="console_widget" data-snippet="snippets/2114.console"></div>
<p>The API returns the following results:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "count" : 1,
  "data_frame_analytics" : [
    {
      "id" : "ecommerce",
      "state" : "stopped",
      "progress" : [
        {
          "phase" : "reindexing",
          "progress_percent" : 100
        },
        {
          "phase" : "loading_data",
          "progress_percent" : 100
        },
        {
          "phase" : "analyzing",
          "progress_percent" : 100
        },
        {
          "phase" : "writing_results",
          "progress_percent" : 100
        }
      ],
      "data_counts" : {
        "training_docs_count" : 3321,
        "test_docs_count" : 0,
        "skipped_docs_count" : 0
      },
      "memory_usage" : {
        "timestamp" : 1586905058000,
        "peak_usage_bytes" : 279484
      },
      "analysis_stats" : {
        "outlier_detection_stats" : {
          "timestamp" : 1586905058000,
          "parameters" : {
            "n_neighbors" : 0,
            "method" : "ensemble",
            "compute_feature_influence" : true,
            "feature_influence_threshold" : 0.1,
            "outlier_fraction" : 0.05,
            "standardization_enabled" : true
          },
          "timing_stats" : {
            "elapsed_time" : 245
          }
        }
      }
    }
  ]
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-trained-models"></a>Get trained models API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves configuration information for a trained model.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET _ml/trained_models/</code><br></p>
<p><code class="literal">GET _ml/trained_models/&lt;model_id&gt;</code><br></p>
<p><code class="literal">GET _ml/trained_models/_all</code><br></p>
<p><code class="literal">GET _ml/trained_models/&lt;model_id1&gt;,&lt;model_id2&gt;</code><br></p>
<p><code class="literal">GET _ml/trained_models/&lt;model_id_pattern*&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following
privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
cluster: <code class="literal">monitor_ml</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a> and
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p>You can get information for multiple trained models in a single API request by
using a comma-separated list of model IDs or a wildcard expression.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;model_id&gt;</code>
</span>
</dt>
<dd>
(Optional, string)
The unique identifier of the trained model.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">allow_no_match</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
Specifies what to do when the request:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Contains wildcard expressions and there are no models that match.
</li>
<li class="listitem">
Contains the <code class="literal">_all</code> string or no identifiers and there are no matches.
</li>
<li class="listitem">
Contains wildcard expressions and there are only partial matches.
</li>
</ul>
</div>
<p>The default value is <code class="literal">true</code>, which returns an empty array when there are no
matches and the subset of results when there are partial matches. If this
parameter is <code class="literal">false</code>, the request returns a <code class="literal">404</code> status code when there are no
matches or only partial matches.</p>
</dd>
<dt>
<span class="term">
<code class="literal">decompress_definition</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Specifies whether the included model definition should be returned as a JSON map
(<code class="literal">true</code>) or in a custom compressed format (<code class="literal">false</code>). Defaults to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">for_export</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Indicates if certain fields should be removed from the model configuration on
retrieval. This allows the model to be in an acceptable format to be retrieved
and then added to another cluster. Default is false.
</dd>
<dt>
<span class="term">
<code class="literal">from</code>
</span>
</dt>
<dd>
(Optional, integer)
Skips the specified number of models. The default value is <code class="literal">0</code>.
</dd>
<dt>
<span class="term">
<code class="literal">include</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
A comma delimited string of optional fields to include in the response body. The
default value is empty, indicating no optional fields are included. Valid
options are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">definition</code>: Includes the model definition
</li>
<li class="listitem">
<code class="literal">feature_importance_baseline</code>: Includes the baseline for feature importance values.
</li>
<li class="listitem">
<code class="literal">total_feature_importance</code>: Includes the total feature importance for the training
   data set.
The baseline and total feature importance values are returned in the <code class="literal">metadata</code> field
in the response body.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of models to obtain. The default value
is <code class="literal">100</code>.
</dd>
<dt>
<span class="term">
<code class="literal">tags</code>
</span>
</dt>
<dd>
(Optional, string)
A comma delimited string of tags. A trained model can have many tags, or none.
When supplied, only trained models that contain all the supplied tags are
returned.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-results"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">trained_model_configs</code>
</span>
</dt>
<dd>
<p>
(array)
An array of trained model resources, which are sorted by the <code class="literal">model_id</code> value in
ascending order.
</p>
<details open>
<summary class="title">Properties of trained model resources</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">created_by</code>
</span>
</dt>
<dd>
(string)
Information on the creator of the trained model.
</dd>
<dt>
<span class="term">
<code class="literal">create_time</code>
</span>
</dt>
<dd>
(<a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
The time when the trained model was created.
</dd>
<dt>
<span class="term">
<code class="literal">default_field_map</code>
</span>
</dt>
<dd>
<p>
(object)
A string to string object that contains the default field map to use
when inferring against the model. For example, data frame analytics
may train the model on a specific multi-field <code class="literal">foo.keyword</code>.
The analytics job would then supply a default field map entry for
<code class="literal">"foo" : "foo.keyword"</code>.
</p>
<p>Any field map described in the inference configuration takes precedence.</p>
</dd>
<dt>
<span class="term">
<code class="literal">description</code>
</span>
</dt>
<dd>
(string)
The free-text description of the trained model.
</dd>
<dt>
<span class="term">
<code class="literal">estimated_heap_memory_usage_bytes</code>
</span>
</dt>
<dd>
(integer)
The estimated heap usage in bytes to keep the trained model in memory.
</dd>
<dt>
<span class="term">
<code class="literal">estimated_operations</code>
</span>
</dt>
<dd>
(integer)
The estimated number of operations to use the trained model.
</dd>
<dt>
<span class="term">
<code class="literal">inference_config</code>
</span>
</dt>
<dd>
<p>
(object)
The default configuration for inference. This can be either a <code class="literal">regression</code>
or <code class="literal">classification</code> configuration. It must match the underlying
<code class="literal">definition.trained_model</code>'s <code class="literal">target_type</code>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">inference_config</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">classification</code>
</span>
</dt>
<dd>
<p>
(object)
Classification configuration for inference.
</p>
<details open>
<summary class="title">Properties of classification inference</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">num_top_classes</code>
</span>
</dt>
<dd>
(integer)
Specifies the number of top class predictions to return. Defaults to 0.
</dd>
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(integer)
Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document. By
default, it is zero and no feature importance calculation occurs.
</dd>
<dt>
<span class="term">
<code class="literal">prediction_field_type</code>
</span>
</dt>
<dd>
(string)
Specifies the type of the predicted field to write.
Acceptable values are: <code class="literal">string</code>, <code class="literal">number</code>, <code class="literal">boolean</code>. When <code class="literal">boolean</code> is provided
<code class="literal">1.0</code> is transformed to <code class="literal">true</code> and <code class="literal">0.0</code> to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to <code class="literal">predicted_value</code>.
</dd>
<dt>
<span class="term">
<code class="literal">top_classes_results_field</code>
</span>
</dt>
<dd>
(string)
Specifies the field to which the top classes are written. Defaults to
<code class="literal">top_classes</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">regression</code>
</span>
</dt>
<dd>
<p>
(object)
Regression configuration for inference.
</p>
<details open>
<summary class="title">Properties of regression inference</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(integer)
Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document.
By default, it is zero and no feature importance calculation occurs.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to <code class="literal">predicted_value</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">input</code>
</span>
</dt>
<dd>
<p>
(object)
The input field names for the model definition.+
</p>
<details open>
<summary class="title">Properties of <code class="literal">input</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field_names</code>
</span>
</dt>
<dd>
(string)
An array of input field names for the model.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">license_level</code>
</span>
</dt>
<dd>
(string)
The license level of the trained model.
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
<p>
(object)
An object containing metadata about the trained model. For example, models
created by data frame analytics contain <code class="literal">analysis_config</code> and <code class="literal">input</code> objects.
</p>
<details open>
<summary class="title">Properties of metadata</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feature_importance_baseline</code>
</span>
</dt>
<dd>
(object)
An object that contains the baseline for feature importance values. For regression analysis,
it is a single value. For classification analysis, there is a value for each class.
</dd>
<dt>
<span class="term">
<code class="literal">total_feature_importance</code>
</span>
</dt>
<dd>
<p>
(array)
An array of the total feature importance for each feature used from
the training data set. This array of objects is returned if data frame analytics trained
the model and the request includes <code class="literal">total_feature_importance</code> in the <code class="literal">include</code>
request parameter.
</p>
<details open>
<summary class="title">Properties of total feature importance</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feature_name</code>
</span>
</dt>
<dd>
(string)
The feature for which this importance was calculated.
</dd>
<dt>
<span class="term">
<code class="literal">importance</code>
</span>
</dt>
<dd>
<p>
(object)
A collection of feature importance statistics related to the training data set for this particular feature.
</p>
<details open>
<summary class="title">Properties of feature importance</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">mean_magnitude</code>
</span>
</dt>
<dd>
(double)
The average magnitude of this feature across all the training data.
This value is the average of the absolute values of the importance
for this feature.
</dd>
<dt>
<span class="term">
<code class="literal">max</code>
</span>
</dt>
<dd>
(int)
The maximum importance value across all the training data for this
feature.
</dd>
<dt>
<span class="term">
<code class="literal">min</code>
</span>
</dt>
<dd>
(int)
The minimum importance value across all the training data for this
feature.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">classes</code>
</span>
</dt>
<dd>
<p>
(array)
If the trained model is a classification model, feature importance statistics are gathered
per target class value.
</p>
<details open>
<summary class="title">Properties of class feature importance</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">class_name</code>
</span>
</dt>
<dd>
(string)
The target class value. Could be a string, boolean, or number.
</dd>
<dt>
<span class="term">
<code class="literal">importance</code>
</span>
</dt>
<dd>
<p>
(object)
A collection of feature importance statistics related to the training data set for this particular feature.
</p>
<details open>
<summary class="title">Properties of feature importance</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">mean_magnitude</code>
</span>
</dt>
<dd>
(double)
The average magnitude of this feature across all the training data.
This value is the average of the absolute values of the importance
for this feature.
</dd>
<dt>
<span class="term">
<code class="literal">max</code>
</span>
</dt>
<dd>
(int)
The maximum importance value across all the training data for this
feature.
</dd>
<dt>
<span class="term">
<code class="literal">min</code>
</span>
</dt>
<dd>
(int)
The minimum importance value across all the training data for this
feature.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">model_id</code>
</span>
</dt>
<dd>
(string)
Idetifier for the trained model.
</dd>
<dt>
<span class="term">
<code class="literal">tags</code>
</span>
</dt>
<dd>
(string)
A comma delimited string of tags. A trained model can have many tags, or none.
</dd>
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
(string)
The Elasticsearch version number in which the trained model was created.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">400</code>
</span>
</dt>
<dd>
If <code class="literal">include_model_definition</code> is <code class="literal">true</code>, this code indicates that more than
one models match the ID pattern.
</dd>
<dt>
<span class="term">
<code class="literal">404</code> (Missing resources)
</span>
</dt>
<dd>
If <code class="literal">allow_no_match</code> is <code class="literal">false</code>, this code indicates that there are no
resources that match the request or only partial matches for the request.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example gets configuration information for all the trained models:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _ml/trained_models/</pre>
</div>
<div class="console_widget" data-snippet="snippets/2115.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-trained-models-stats"></a>Get trained models statistics API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models-stats.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves usage information for trained models.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-stats-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models-stats.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET _ml/trained_models/_stats</code><br></p>
<p><code class="literal">GET _ml/trained_models/_all/_stats</code><br></p>
<p><code class="literal">GET _ml/trained_models/&lt;model_id&gt;/_stats</code><br></p>
<p><code class="literal">GET _ml/trained_models/&lt;model_id&gt;,&lt;model_id_2&gt;/_stats</code><br></p>
<p><code class="literal">GET _ml/trained_models/&lt;model_id_pattern*&gt;,&lt;model_id_2&gt;/_stats</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-stats-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models-stats.asciidoc">edit</a></h3>
</div></div></div>
<p>Required privileges which should be added to a custom role:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
cluster: <code class="literal">monitor_ml</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a> and <a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-stats-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models-stats.asciidoc">edit</a></h3>
</div></div></div>
<p>You can get usage information for multiple trained models in a single API
request by using a comma-separated list of model IDs or a wildcard expression.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-stats-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models-stats.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;model_id&gt;</code>
</span>
</dt>
<dd>
(Optional, string)
The unique identifier of the trained model.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-stats-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models-stats.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">allow_no_match</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
Specifies what to do when the request:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Contains wildcard expressions and there are no models that match.
</li>
<li class="listitem">
Contains the <code class="literal">_all</code> string or no identifiers and there are no matches.
</li>
<li class="listitem">
Contains wildcard expressions and there are only partial matches.
</li>
</ul>
</div>
<p>The default value is <code class="literal">true</code>, which returns an empty array when there are no
matches and the subset of results when there are partial matches. If this
parameter is <code class="literal">false</code>, the request returns a <code class="literal">404</code> status code when there are no
matches or only partial matches.</p>
</dd>
<dt>
<span class="term">
<code class="literal">from</code>
</span>
</dt>
<dd>
(Optional, integer)
Skips the specified number of models. The default value is <code class="literal">0</code>.
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of models to obtain. The default value
is <code class="literal">100</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-stats-results"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models-stats.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">count</code>
</span>
</dt>
<dd>
(integer)
The total number of trained model statistics that matched the requested ID
patterns. Could be higher than the number of items in the <code class="literal">trained_model_stats</code>
array as the size of the array is restricted by the supplied <code class="literal">size</code> parameter.
</dd>
<dt>
<span class="term">
<code class="literal">trained_model_stats</code>
</span>
</dt>
<dd>
<p>
(array)
An array of trained model statistics, which are sorted by the <code class="literal">model_id</code> value
in ascending order.
</p>
<details open>
<summary class="title">Properties of trained model stats</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">model_id</code>
</span>
</dt>
<dd>
(string)
The unique identifier of the trained model.
</dd>
<dt>
<span class="term">
<code class="literal">pipeline_count</code>
</span>
</dt>
<dd>
(integer)
The number of ingest pipelines that currently refer to the model.
</dd>
<dt>
<span class="term">
<code class="literal">inference_stats</code>
</span>
</dt>
<dd>
<p>
(object)
A collection of inference stats fields.
</p>
<details open>
<summary class="title">Properties of inference stats</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">missing_all_fields_count</code>
</span>
</dt>
<dd>
(integer)
The number of inference calls where all the training features for the model
were missing.
</dd>
<dt>
<span class="term">
<code class="literal">inference_count</code>
</span>
</dt>
<dd>
(integer)
The total number of times the model has been called for inference.
This is across all inference contexts, including all pipelines.
</dd>
<dt>
<span class="term">
<code class="literal">cache_miss_count</code>
</span>
</dt>
<dd>
(integer)
The number of times the model was loaded for inference and was not retrieved
from the cache. If this number is close to the <code class="literal">inference_count</code>, then the cache
is not being appropriately used. This can be solved by increasing the cache size
or its time-to-live (TTL). See <a class="xref" href="settings.html#general-ml-settings" title="General machine learning settings">General machine learning settings</a> for the appropriate
settings.
</dd>
<dt>
<span class="term">
<code class="literal">failure_count</code>
</span>
</dt>
<dd>
(integer)
The number of failures when using the model for inference.
</dd>
<dt>
<span class="term">
<code class="literal">timestamp</code>
</span>
</dt>
<dd>
(<a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
The time when the statistics were last updated.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">ingest</code>
</span>
</dt>
<dd>
(object)
A collection of ingest stats for the model across all nodes. The values are
summations of the individual node statistics. The format matches the <code class="literal">ingest</code>
section in <a class="xref" href="cluster.html#cluster-nodes-stats" title="Nodes stats API">Nodes stats</a>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-stats-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models-stats.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">404</code> (Missing resources)
</span>
</dt>
<dd>
If <code class="literal">allow_no_match</code> is <code class="literal">false</code>, this code indicates that there are no
resources that match the request or only partial matches for the request.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-get-trained-models-stats-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/get-trained-models-stats.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example gets usage information for all the trained models:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _ml/trained_models/_stats</pre>
</div>
<div class="console_widget" data-snippet="snippets/2116.console"></div>
<p>The API returns the following results:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "count": 2,
  "trained_model_stats": [
    {
      "model_id": "flight-delay-prediction-1574775339910",
      "pipeline_count": 0,
      "inference_stats": {
        "failure_count": 0,
        "inference_count": 4,
        "cache_miss_count": 3,
        "missing_all_fields_count": 0,
        "timestamp": 1592399986979
      }
    },
    {
      "model_id": "regression-job-one-1574775307356",
      "pipeline_count": 1,
      "inference_stats": {
        "failure_count": 0,
        "inference_count": 178,
        "cache_miss_count": 3,
        "missing_all_fields_count": 0,
        "timestamp": 1592399986979
      },
      "ingest": {
        "total": {
          "count": 178,
          "time_in_millis": 8,
          "current": 0,
          "failed": 0
        },
        "pipelines": {
          "flight-delay": {
            "count": 178,
            "time_in_millis": 8,
            "current": 0,
            "failed": 0,
            "processors": [
              {
                "inference": {
                  "type": "inference",
                  "stats": {
                    "count": 178,
                    "time_in_millis": 7,
                    "current": 0,
                    "failed": 0
                  }
                }
              }
            ]
          }
        }
      }
    }
  ]
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="start-dfanalytics"></a>Start data frame analytics jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/start-dfanalytics.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Starts a data frame analytics job.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-start-dfanalytics-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/start-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;/_start</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-start-dfanalytics-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/start-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following built-in roles and privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">machine_learning_admin</code>
</li>
<li class="listitem">
source indices: <code class="literal">read</code>, <code class="literal">view_index_metadata</code>
</li>
<li class="listitem">
destination index: <code class="literal">read</code>, <code class="literal">create_index</code>, <code class="literal">manage</code> and <code class="literal">index</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#built-in-roles" title="Built-in roles">Built-in roles</a>, <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>, and
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-start-dfanalytics-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/start-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>A data frame analytics job can be started and stopped multiple times throughout its
lifecycle.</p>
<p>If the destination index does not exist, it is created automatically the first
time you start the data frame analytics job. The <code class="literal">index.number_of_shards</code> and
<code class="literal">index.number_of_replicas</code> settings for the destination index are copied from
the source index. If there are multiple source indices, the destination index
copies the highest setting values. The mappings for the destination index are
also copied from the source indices. If there are any mapping conflicts, the job
fails to start.</p>
<p>If the destination index exists, it is used as is. You can therefore set up the
destination index in advance with custom settings and mappings.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>When Elasticsearch security features are enabled, the data frame analytics job
remembers which user created it and runs the job using those credentials. If you
provided <a class="xref" href="ccs-clients-integrations.html#http-clients-secondary-authorization" title="Secondary authorization">secondary authorization headers</a>
when you created the job, those credentials are used.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-start-dfanalytics-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/start-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;data_frame_analytics_id&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Identifier for the data frame analytics job. This identifier can contain lowercase
alphanumeric characters (a-z and 0-9), hyphens, and underscores. It must start
and end with alphanumeric characters.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-start-dfanalytics-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/start-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Controls the amount of time to wait until the data frame analytics job starts. Defaults
to 20 seconds.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-start-dfanalytics-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/start-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">acknowledged</code>
</span>
</dt>
<dd>
(Boolean) For a successful response, this value is always <code class="literal">true</code>. On failure, an
exception is returned instead.
</dd>
<dt>
<span class="term">
<code class="literal">node</code>
</span>
</dt>
<dd>
(string) The ID of the node that the job was started on.
If the job is allowed to open lazily and has not yet been assigned to a node, this value is an empty string.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-start-dfanalytics-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/start-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example starts the <code class="literal">loganalytics</code> data frame analytics job:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/analytics/loganalytics/_start</pre>
</div>
<div class="console_widget" data-snippet="snippets/2117.console"></div>
<p>When the data frame analytics job starts, you receive the following results:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "acknowledged" : true,
  "node" : "node-1"
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="stop-dfanalytics"></a>Stop data frame analytics jobs API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/stop-dfanalytics.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Stops one or more data frame analytics jobs.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-stop-dfanalytics-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/stop-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;/_stop</code><br></p>
<p><code class="literal">POST _ml/data_frame/analytics/&lt;data_frame_analytics_id&gt;,&lt;data_frame_analytics_id&gt;/_stop</code><br></p>
<p><code class="literal">POST _ml/data_frame/analytics/_all/_stop</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-stop-dfanalytics-prereq"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/stop-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>If the Elasticsearch security features are enabled, you must have the following built-in roles or equivalent privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">machine_learning_admin</code>
</li>
</ul>
</div>
<p>For more information, see <a class="xref" href="authorization.html#built-in-roles" title="Built-in roles">Built-in roles</a> and <a href="https://www.elastic.co/guide/en/machine-learning/7.10/setup.html#setup-privileges" class="ulink" target="_top">Machine learning security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-stop-dfanalytics-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/stop-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>A data frame analytics job can be started and stopped multiple times throughout its
lifecycle.</p>
<p>You can stop multiple data frame analytics jobs in a single API request by using a
comma-separated list of data frame analytics jobs or a wildcard expression. You can
stop all data frame analytics job by using _all or by specifying * as the
&lt;data_frame_analytics_id&gt;.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-stop-dfanalytics-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/stop-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;data_frame_analytics_id&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Identifier for the data frame analytics job. This identifier can contain lowercase
alphanumeric characters (a-z and 0-9), hyphens, and underscores. It must start
and end with alphanumeric characters.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-stop-dfanalytics-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/stop-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">allow_no_match</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
 Specifies what to do when the request:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Contains wildcard expressions and there are no data frame analytics jobs that match.
</li>
<li class="listitem">
Contains the <code class="literal">_all</code> string or no identifiers and there are no matches.
</li>
<li class="listitem">
Contains wildcard expressions and there are only partial matches.
</li>
</ul>
</div>
<p>The default value is <code class="literal">true</code>, which returns an empty <code class="literal">data_frame_analytics</code> array
when there are no matches and the subset of results when there are partial
matches. If this parameter is <code class="literal">false</code>, the request returns a <code class="literal">404</code> status code
when there are no matches or only partial matches.</p>
</dd>
<dt>
<span class="term">
<code class="literal">force</code>
</span>
</dt>
<dd>
(Optional, Boolean) If true, the data frame analytics job is stopped forcefully.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Controls the amount of time to wait until the data frame analytics job stops. Defaults
to 20 seconds.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ml-stop-dfanalytics-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ml/df-analytics/apis/stop-dfanalytics.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example stops the <code class="literal">loganalytics</code> data frame analytics job:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/data_frame/analytics/loganalytics/_stop</pre>
</div>
<div class="console_widget" data-snippet="snippets/2118.console"></div>
<p>When the data frame analytics job stops, you receive the following results:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "stopped" : true
}</pre>
</div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ml-apis.html">« Machine learning anomaly detection APIs</a>
</span>
<span class="next">
<a href="migration-api.html">Migration APIs »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
