<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Metadata fields | Elasticsearch Guide | Elastic</title>
<meta class="elastic" name="content" content="Metadata fields | Elasticsearch Guide">

<link rel="home" href="index.html" title="Elasticsearch Guide"/>
<link rel="up" href="mapping.html" title="Mapping"/>
<link rel="prev" href="mapping-types.html" title="Field data types"/>
<link rel="next" href="mapping-params.html" title="Mapping parameters"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="mapping.html">Mapping</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="mapping-types.html">« Field data types</a>
</span>
<span class="next">
<a href="mapping-params.html">Mapping parameters »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-fields"></a>Metadata fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields.asciidoc">edit</a></h2>
</div></div></div>
<p>Each document has metadata associated with it, such as the <code class="literal">_index</code>
and <code class="literal">_id</code> metadata fields. The behavior of some of these metadata
fields can be customized when a mapping is created.</p>
<h3><a id="_identity_metadata_fields"></a>Identity metadata fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-fields.html#mapping-index-field" title="_index field"><code class="literal">_index</code></a>
</p>
</td>
<td valign="top">
<p>
The index to which the document belongs.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-fields.html#mapping-id-field" title="_id field"><code class="literal">_id</code></a>
</p>
</td>
<td valign="top">
<p>
The document&#8217;s ID.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<h3><a id="_document_source_metadata_fields"></a>Document source metadata fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields.asciidoc">edit</a></h3>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a>
</span>
</dt>
<dd>
The original JSON representing the body of the document.
</dd>
<dt>
<span class="term">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/8.9/mapper-size.html" class="ulink" target="_top"><code class="literal">_size</code></a>
</span>
</dt>
<dd>
The size of the <code class="literal">_source</code> field in bytes, provided by the
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/8.9/mapper-size.html" class="ulink" target="_top"><code class="literal">mapper-size</code> plugin</a>.
</dd>
</dl>
</div>
<h3><a id="_doc_count_metadata_field"></a>Doc count metadata field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields.asciidoc">edit</a></h3>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-fields.html#mapping-doc-count-field" title="_doc_count field"><code class="literal">_doc_count</code></a>
</span>
</dt>
<dd>
A custom field used for storing doc counts when a document represents pre-aggregated data.
</dd>
</dl>
</div>
<h3><a id="_indexing_metadata_fields"></a>Indexing metadata fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields.asciidoc">edit</a></h3>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-fields.html#mapping-field-names-field" title="_field_names field"><code class="literal">_field_names</code></a>
</span>
</dt>
<dd>
All fields in the document which contain non-null values.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-fields.html#mapping-ignored-field" title="_ignored field"><code class="literal">_ignored</code></a>
</span>
</dt>
<dd>
All fields in the document that have been ignored at index time because of
<a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>.
</dd>
</dl>
</div>
<h3><a id="_routing_metadata_field"></a>Routing metadata field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields.asciidoc">edit</a></h3>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-fields.html#mapping-routing-field" title="_routing field"><code class="literal">_routing</code></a>
</span>
</dt>
<dd>
A custom routing value which routes a document to a particular shard.
</dd>
</dl>
</div>
<h3><a id="_other_metadata_field"></a>Other metadata field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields.asciidoc">edit</a></h3>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-fields.html#mapping-meta-field" title="_meta field"><code class="literal">_meta</code></a>
</span>
</dt>
<dd>
Application specific metadata.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-fields.html#mapping-tier-field" title="_tier field"><code class="literal">_tier</code></a>
</span>
</dt>
<dd>
The current data tier preference of the index to which the document belongs.
</dd>
</dl>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-doc-count-field"></a><code class="literal">_doc_count</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/doc-count-field.asciidoc">edit</a></h2>
</div></div></div>
<p>Bucket aggregations always return a field named <code class="literal">doc_count</code> showing the number of documents that were aggregated and partitioned
in each bucket. Computation of the value of <code class="literal">doc_count</code> is very simple. <code class="literal">doc_count</code> is incremented by 1 for every document collected
in each bucket.</p>
<p>While this simple approach is effective when computing aggregations over individual documents, it fails to accurately represent
documents that store pre-aggregated data (such as <code class="literal">histogram</code> or <code class="literal">aggregate_metric_double</code> fields), because one summary field may
represent multiple documents.</p>
<p>To allow for correct computation of the number of documents when working with pre-aggregated data, we have introduced a
metadata field type named <code class="literal">_doc_count</code>. <code class="literal">_doc_count</code> must always be a positive integer representing the number of documents
aggregated in a single summary field.</p>
<p>When field <code class="literal">_doc_count</code> is added to a document, all bucket aggregations will respect its value and increment the bucket <code class="literal">doc_count</code>
by the value of the field. If a document does not contain any <code class="literal">_doc_count</code> field, <code class="literal">_doc_count = 1</code> is implied by default.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A <code class="literal">_doc_count</code> field can only store a single positive integer per document. Nested arrays are not allowed.
</li>
<li class="listitem">
If a document contains no <code class="literal">_doc_count</code> fields, aggregators will increment by 1, which is the default behavior.
</li>
</ul>
</div>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="mapping-doc-count-field-example"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/doc-count-field.asciidoc">edit</a></h3>
</div></div></div>
<p>The following <a class="xref" href="indices.html#indices-create-index" title="Create index API">create index</a> API request creates a new index with the following field mappings:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">my_histogram</code>, a <code class="literal">histogram</code> field used to store percentile data
</li>
<li class="listitem">
<code class="literal">my_text</code>, a <code class="literal">keyword</code> field used to store a title for the histogram
</li>
</ul>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my_index
{
  "mappings" : {
    "properties" : {
      "my_histogram" : {
        "type" : "histogram"
      },
      "my_text" : {
        "type" : "keyword"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/304.console"></div>
<p>The following <a class="xref" href="docs.html#docs-index_" title="Index API">index</a> API requests store pre-aggregated data for
two histograms: <code class="literal">histogram_1</code> and <code class="literal">histogram_2</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my_index/_doc/1
{
  "my_text" : "histogram_1",
  "my_histogram" : {
      "values" : [0.1, 0.2, 0.3, 0.4, 0.5],
      "counts" : [3, 7, 23, 12, 6]
   },
  "_doc_count": 45 <a id="CO83-1"></a><i class="conum" data-value="1"></i>
}

PUT my_index/_doc/2
{
  "my_text" : "histogram_2",
  "my_histogram" : {
      "values" : [0.1, 0.25, 0.35, 0.4, 0.45, 0.5],
      "counts" : [8, 17, 8, 7, 6, 2]
   },
  "_doc_count": 62 <a id="CO83-2"></a><i class="conum" data-value="1"></i>
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/305.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO83-1"><i class="conum" data-value="1"></i></a><a href="#CO83-2"></a></p>
</td>
<td align="left" valign="top">
<p>Field <code class="literal">_doc_count</code> must be a positive integer storing the number of documents aggregated to produce each histogram.</p>
</td>
</tr>
</table>
</div>
<p>If we run the following <a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-terms-aggregation" title="Terms aggregation">terms aggregation</a> on <code class="literal">my_index</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
    "aggs" : {
        "histogram_titles" : {
            "terms" : { "field" : "my_text" }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/306.console"></div>
<p>We will get the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
    ...
    "aggregations" : {
        "histogram_titles" : {
            "doc_count_error_upper_bound": 0,
            "sum_other_doc_count": 0,
            "buckets" : [
                {
                    "key" : "histogram_2",
                    "doc_count" : 62
                },
                {
                    "key" : "histogram_1",
                    "doc_count" : 45
                }
            ]
        }
    }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-field-names-field"></a><code class="literal">_field_names</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/field-names-field.asciidoc">edit</a></h2>
</div></div></div>
<p>The <code class="literal">_field_names</code> field used to index the names of every field in a document that
contains any value other than <code class="literal">null</code>. This field was used by the
<a class="xref" href="term-level-queries.html#query-dsl-exists-query" title="Exists query"><code class="literal">exists</code></a> query to find documents that
either have or don&#8217;t have any non-<code class="literal">null</code> value for a particular field.</p>
<p>Now the <code class="literal">_field_names</code> field only indexes the names of fields that have
<code class="literal">doc_values</code> and <code class="literal">norms</code> disabled. For fields which have either <code class="literal">doc_values</code>
or <code class="literal">norm</code> enabled the <a class="xref" href="term-level-queries.html#query-dsl-exists-query" title="Exists query"><code class="literal">exists</code></a> query will still
be available but will not use the <code class="literal">_field_names</code> field.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="disable-field-names"></a>Disabling <code class="literal">_field_names</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/field-names-field.asciidoc">edit</a></h3>
</div></div></div>
<p>Disabling <code class="literal">_field_names</code> is no longer possible. It is now enabled by default
because it no longer carries the index overhead it once did.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Support for disabling <code class="literal">_field_names</code> has been removed. Using it on new
indices will throw an error. Using it in pre-8.0 indices is still allowed but
issues a deprecation warning.</p>
</div>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-ignored-field"></a><code class="literal">_ignored</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/ignored-field.asciidoc">edit</a></h2>
</div></div></div>
<p>The <code class="literal">_ignored</code> field indexes and stores the names of every field in a document
that has been ignored when the document was indexed. This can, for example,
be the case when the field was malformed and <a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>
was turned on, or when a <code class="literal">keyword</code> fields value exceeds its optional
<a class="xref" href="mapping-params.html#ignore-above" title="ignore_above"><code class="literal">ignore_above</code></a> setting.</p>
<p>This field is searchable with <a class="xref" href="term-level-queries.html#query-dsl-term-query" title="Term query"><code class="literal">term</code></a>,
<a class="xref" href="term-level-queries.html#query-dsl-terms-query" title="Terms query"><code class="literal">terms</code></a> and <a class="xref" href="term-level-queries.html#query-dsl-exists-query" title="Exists query"><code class="literal">exists</code></a>
queries, and is returned as part of the search hits.</p>
<p>For instance the below query matches all documents that have one or more fields
that got ignored:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _search
{
  "query": {
    "exists": {
      "field": "_ignored"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/307.console"></div>
<p>Similarly, the below query finds all documents whose <code class="literal">@timestamp</code> field was
ignored at index time:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _search
{
  "query": {
    "term": {
      "_ignored": "@timestamp"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/308.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-id-field"></a><code class="literal">_id</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/id-field.asciidoc">edit</a></h2>
</div></div></div>
<p>Each document has an <code class="literal">_id</code> that uniquely identifies it, which is indexed
so that documents can be looked up either with the <a class="xref" href="docs.html#docs-get" title="Get API">GET API</a> or the
<a class="xref" href="term-level-queries.html#query-dsl-ids-query" title="IDs"><code class="literal">ids</code> query</a>. The <code class="literal">_id</code> can either be assigned at
indexing time, or a unique <code class="literal">_id</code> can be generated by Elasticsearch. This field is not
configurable in the mappings.</p>
<p>The value of the <code class="literal">_id</code> field is accessible in queries such as <code class="literal">term</code>,
<code class="literal">terms</code>, <code class="literal">match</code>, and <code class="literal">query_string</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console"># Example documents
PUT my-index-000001/_doc/1
{
  "text": "Document with ID 1"
}

PUT my-index-000001/_doc/2?refresh=true
{
  "text": "Document with ID 2"
}

GET my-index-000001/_search
{
  "query": {
    "terms": {
      "_id": [ "1", "2" ] <a id="CO84-1"></a><i class="conum" data-value="1"></i>
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/309.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO84-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Querying on the <code class="literal">_id</code> field (also see the <a class="xref" href="term-level-queries.html#query-dsl-ids-query" title="IDs"><code class="literal">ids</code> query</a>)</p>
</td>
</tr>
</table>
</div>
<p>The <code class="literal">_id</code> field is restricted from use in aggregations, sorting, and scripting.
In case sorting or aggregating on the <code class="literal">_id</code> field is required, it is advised to
duplicate the content of the <code class="literal">_id</code> field into another field that has
<code class="literal">doc_values</code> enabled.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">_id</code> is limited to 512 bytes in size and larger values will be rejected.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-index-field"></a><code class="literal">_index</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/index-field.asciidoc">edit</a></h2>
</div></div></div>
<p>When performing queries across multiple indexes, it is sometimes desirable to
add query clauses that are associated with documents of only certain indexes.
The <code class="literal">_index</code> field allows matching on the index a document was indexed into.
Its value is accessible in certain queries and aggregations, and when sorting
or scripting:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT index_1/_doc/1
{
  "text": "Document in index 1"
}

PUT index_2/_doc/2?refresh=true
{
  "text": "Document in index 2"
}

GET index_1,index_2/_search
{
  "query": {
    "terms": {
      "_index": ["index_1", "index_2"] <a id="CO85-1"></a><i class="conum" data-value="1"></i>
    }
  },
  "aggs": {
    "indices": {
      "terms": {
        "field": "_index", <a id="CO85-2"></a><i class="conum" data-value="2"></i>
        "size": 10
      }
    }
  },
  "sort": [
    {
      "_index": { <a id="CO85-3"></a><i class="conum" data-value="3"></i>
        "order": "asc"
      }
    }
  ],
  "script_fields": {
    "index_name": {
      "script": {
        "lang": "painless",
        "source": "doc['_index']" <a id="CO85-4"></a><i class="conum" data-value="4"></i>
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/310.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO85-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Querying on the <code class="literal">_index</code> field</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO85-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Aggregating on the <code class="literal">_index</code> field</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO85-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Sorting on the <code class="literal">_index</code> field</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO85-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Accessing the <code class="literal">_index</code> field in scripts</p>
</td>
</tr>
</table>
</div>
<p>The <code class="literal">_index</code> field is exposed virtually&#8201;&#8212;&#8201;it is not added to the Lucene index
as a real field. This means that you can use the <code class="literal">_index</code> field in a <code class="literal">term</code> or
<code class="literal">terms</code> query (or any query that is rewritten to a <code class="literal">term</code> query, such as the
<code class="literal">match</code>,  <code class="literal">query_string</code> or <code class="literal">simple_query_string</code> query), as well as <code class="literal">prefix</code>
and <code class="literal">wildcard</code> queries. However, it does not support <code class="literal">regexp</code> and <code class="literal">fuzzy</code>
queries.</p>
<p>Queries on the <code class="literal">_index</code> field accept index aliases in addition to concrete
index names.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When specifying a remote index name such as <code class="literal">cluster_1:index_3</code>, the
query must contain the separator character <code class="literal">:</code>. For example, a <code class="literal">wildcard</code> query
on <code class="literal">cluster_*:index_3</code> would match documents from the remote index. However, a
query on <code class="literal">cluster*index_1</code> is only matched against local indices, since no
separator is present. This behavior aligns with the usual resolution rules for
remote index names.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-meta-field"></a><code class="literal">_meta</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/meta-field.asciidoc">edit</a></h2>
</div></div></div>
<p>A mapping type can have custom meta data associated with it. These are not
used at all by Elasticsearch, but can be used to store application-specific
metadata, such as the class that a document belongs to:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "_meta": { <a id="CO86-1"></a><i class="conum" data-value="1"></i>
      "class": "MyApp::User",
      "version": {
        "min": "1.0",
        "max": "1.3"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/311.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO86-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This <code class="literal">_meta</code> info can be retrieved with the
<a class="xref" href="indices.html#indices-get-mapping" title="Get mapping API">GET mapping</a> API.</p>
</td>
</tr>
</table>
</div>
<p>The <code class="literal">_meta</code> field can be updated on an existing type using the
<a class="xref" href="indices.html#indices-put-mapping" title="Update mapping API">update mapping</a> API:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_mapping
{
  "_meta": {
    "class": "MyApp2::User3",
    "version": {
      "min": "1.3",
      "max": "1.5"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/312.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-routing-field"></a><code class="literal">_routing</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/routing-field.asciidoc">edit</a></h2>
</div></div></div>
<p>A document is routed to a particular shard in an index using the following
formulas:</p>
<pre class="literallayout">routing_factor = num_routing_shards / num_primary_shards
shard_num = (hash(_routing) % num_routing_shards) / routing_factor</pre>

<p><code class="literal">num_routing_shards</code> is the value of the
<a class="xref" href="index-modules.html#index-number-of-routing-shards"><code class="literal">index.number_of_routing_shards</code></a> index
setting. <code class="literal">num_primary_shards</code> is the value of the
<a class="xref" href="index-modules.html#index-number-of-shards"><code class="literal">index.number_of_shards</code></a> index setting.</p>
<p>The default <code class="literal">_routing</code> value is the document&#8217;s <a class="xref" href="mapping-fields.html#mapping-id-field" title="_id field"><code class="literal">_id</code></a>.
Custom routing patterns can be implemented by specifying a custom <code class="literal">routing</code>
value per document. For instance:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/1?routing=user1&amp;refresh=true <a id="CO87-1"></a><i class="conum" data-value="1"></i>
{
  "title": "This is a document"
}

GET my-index-000001/_doc/1?routing=user1 <a id="CO87-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="console_widget" data-snippet="snippets/313.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO87-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document uses <code class="literal">user1</code> as its routing value, instead of its ID.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO87-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The same <code class="literal">routing</code> value needs to be provided when
<a class="xref" href="docs.html#docs-get" title="Get API">getting</a>, <a class="xref" href="docs.html#docs-delete" title="Delete API">deleting</a>, or <a class="xref" href="docs.html#docs-update" title="Update API">updating</a>
the document.</p>
</td>
</tr>
</table>
</div>
<p>The value of the <code class="literal">_routing</code> field is accessible in queries:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search
{
  "query": {
    "terms": {
      "_routing": [ "user1" ] <a id="CO88-1"></a><i class="conum" data-value="1"></i>
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/314.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO88-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Querying on the <code class="literal">_routing</code> field (also see the <a class="xref" href="term-level-queries.html#query-dsl-ids-query" title="IDs"><code class="literal">ids</code> query</a>)</p>
</td>
</tr>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Data streams do not support custom routing unless they were created with
the <a class="xref" href="indices.html#put-index-template-api-request-body" title="Request body"><code class="literal">allow_custom_routing</code></a> setting
enabled in the template.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_searching_with_custom_routing"></a>Searching with custom routing<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/routing-field.asciidoc">edit</a></h3>
</div></div></div>
<p>Custom routing can reduce the impact of searches. Instead of having to fan
out a search request to all the shards in an index, the request can be sent to
just the shard that matches the specific routing value (or values):</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search?routing=user1,user2 <a id="CO89-1"></a><i class="conum" data-value="1"></i>
{
  "query": {
    "match": {
      "title": "document"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/315.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO89-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This search request will only be executed on the shards associated with the <code class="literal">user1</code> and <code class="literal">user2</code> routing values.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_making_a_routing_value_required"></a>Making a routing value required<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/routing-field.asciidoc">edit</a></h3>
</div></div></div>
<p>When using custom routing, it is important to provide the routing value
whenever <a class="xref" href="docs.html#docs-index_" title="Index API">indexing</a>, <a class="xref" href="docs.html#docs-get" title="Get API">getting</a>,
<a class="xref" href="docs.html#docs-delete" title="Delete API">deleting</a>, or <a class="xref" href="docs.html#docs-update" title="Update API">updating</a> a document.</p>
<p>Forgetting the routing value can lead to a document being indexed on more than
one shard. As a safeguard, the <code class="literal">_routing</code> field can be configured to make a
custom <code class="literal">routing</code> value required for all CRUD operations:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000002
{
  "mappings": {
    "_routing": {
      "required": true <a id="CO90-1"></a><i class="conum" data-value="1"></i>
    }
  }
}

PUT my-index-000002/_doc/1 <a id="CO90-2"></a><i class="conum" data-value="2"></i>
{
  "text": "No routing value provided"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/316.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO90-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Routing is required for all documents.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO90-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This index request throws a <code class="literal">routing_missing_exception</code>.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_unique_ids_with_custom_routing"></a>Unique IDs with custom routing<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/routing-field.asciidoc">edit</a></h3>
</div></div></div>
<p>When indexing documents specifying a custom <code class="literal">_routing</code>, the uniqueness of the
<code class="literal">_id</code> is not guaranteed across all of the shards in the index. In fact,
documents with the same <code class="literal">_id</code> might end up on different shards if indexed with
different <code class="literal">_routing</code> values.</p>
<p>It is up to the user to ensure that IDs are unique across the index.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="routing-index-partition"></a>Routing to an index partition<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/routing-field.asciidoc">edit</a></h3>
</div></div></div>
<p>An index can be configured such that custom routing values will go to a subset of the shards rather
than a single shard. This helps mitigate the risk of ending up with an imbalanced cluster while still
reducing the impact of searches.</p>
<p>This is done by providing the index level setting <a class="xref" href="index-modules.html#routing-partition-size"><code class="literal">index.routing_partition_size</code></a> at index creation.
As the partition size increases, the more evenly distributed the data will become at the
expense of having to search more shards per request.</p>
<p>When this setting is present, the formulas for calculating the shard become:</p>
<pre class="literallayout">routing_value = hash(_routing) + hash(_id) % routing_partition_size
shard_num = (routing_value % num_routing_shards) / routing_factor</pre>

<p>That is, the <code class="literal">_routing</code> field is used to calculate a set of shards within the index and then the
<code class="literal">_id</code> is used to pick a shard within that set.</p>
<p>To enable this feature, the <code class="literal">index.routing_partition_size</code> should have a value greater than 1 and
less than <code class="literal">index.number_of_shards</code>.</p>
<p>Once enabled, the partitioned index will have the following limitations:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Mappings with <a class="xref" href="mapping-types.html#parent-join" title="Join field type"><code class="literal">join</code> field</a> relationships cannot be created within it.
</li>
<li class="listitem">
All mappings within the index must have the <code class="literal">_routing</code> field marked as required.
</li>
</ul>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-source-field"></a><code class="literal">_source</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/source-field.asciidoc">edit</a></h2>
</div></div></div>
<p>The <code class="literal">_source</code> field contains the original JSON document body that was passed
at index time. The <code class="literal">_source</code> field itself is not indexed (and thus is not
searchable), but it is stored so that it can be returned when executing
<em>fetch</em> requests, like <a class="xref" href="docs.html#docs-get" title="Get API">get</a> or <a class="xref" href="search.html#search-search" title="Search API">search</a>.</p>
<p>If disk usage is important to you then have a look at
<a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> which shrinks disk usage at the cost of
only supporting a subset of mappings and slower fetches or (not recommended)
<a class="xref" href="mapping-fields.html#disable-source-field" title="Disabling the _source field">disabling the <code class="literal">_source</code> field</a> which also shrinks disk
usage but disables many features.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/synthetic-source.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p>Though very handy to have around, the source field takes up a significant amount
of space on disk. Instead of storing source documents on disk exactly as you
send them, Elasticsearch can reconstruct source content on the fly upon retrieval.
Enable this by setting <code class="literal">mode: synthetic</code> in <code class="literal">_source</code>:</p>
<a id="enable-synthetic-source-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": {
      "mode": "synthetic"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/317.console"></div>
<p>While this on the fly reconstruction is <span class="strong strong"><strong>generally</strong></span> slower than saving the source
documents verbatim and loading them at query time, it saves a lot of storage
space.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="synthetic-source-restrictions"></a>Synthetic <code class="literal">_source</code> restrictions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/synthetic-source.asciidoc">edit</a></h4>
</div></div></div>
<p>There are a couple of restrictions to be aware of:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
When you retrieve synthetic <code class="literal">_source</code> content it undergoes minor
<a class="xref" href="mapping-fields.html#synthetic-source-modifications" title="Synthetic _source modifications">modifications</a> compared to the original JSON.
</li>
<li class="listitem">
The <code class="literal">params._source</code> is unavailable in scripts. Instead use the
<a href="https://www.elastic.co/guide/en/elasticsearch/painless/8.9/painless-field-context.html" class="ulink" target="_top"><code class="literal">doc</code></a> API or the <a class="xref" href="script-fields-api.html" title="Access fields in a document with the field API"><code class="literal">field</code> API</a>.
</li>
<li class="listitem">
Runtime fields <a class="xref" href="runtime.html#runtime-fields-scriptless" title="Define runtime fields without a script">without a script</a>, and runtime
fields that access <code class="literal">_source</code> are currently not supported for indices that use
synthetic <code class="literal">_source</code>. Use a scripted runtime field that accesses fields <a class="xref" href="modules-scripting-fields.html#modules-scripting-doc-vals" title="Doc values">using doc values</a> or the
<a class="xref" href="script-fields-api.html" title="Access fields in a document with the field API"><code class="literal">field</code> API</a> instead.
</li>
<li class="listitem">
<p>Synthetic <code class="literal">_source</code> can be used with indices that contain only these field
types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="mapping-types.html#aggregate-metric-double-synthetic-source" title="Synthetic _source"><code class="literal">aggregate_metric_double</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#boolean-synthetic-source" title="Synthetic _source"><code class="literal">boolean</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#numeric-synthetic-source" title="Synthetic _source"><code class="literal">byte</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#date-synthetic-source" title="Synthetic _source"><code class="literal">date</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#date-nanos-synthetic-source" title="Synthetic _source"><code class="literal">date_nanos</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#dense-vector-synthetic-source" title="Synthetic _source"><code class="literal">dense_vector</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#numeric-synthetic-source" title="Synthetic _source"><code class="literal">double</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#flattened-synthetic-source" title="Synthetic _source"><code class="literal">flattened</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#numeric-synthetic-source" title="Synthetic _source"><code class="literal">float</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#geo-point-synthetic-source" title="Synthetic source"><code class="literal">geo_point</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#numeric-synthetic-source" title="Synthetic _source"><code class="literal">half_float</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#histogram-synthetic-source" title="Synthetic _source"><code class="literal">histogram</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#numeric-synthetic-source" title="Synthetic _source"><code class="literal">integer</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#ip-synthetic-source" title="Synthetic _source"><code class="literal">ip</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#keyword-synthetic-source" title="Synthetic _source"><code class="literal">keyword</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#numeric-synthetic-source" title="Synthetic _source"><code class="literal">long</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#numeric-synthetic-source" title="Synthetic _source"><code class="literal">scaled_float</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#numeric-synthetic-source" title="Synthetic _source"><code class="literal">short</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#text-synthetic-source" title="Synthetic _source"><code class="literal">text</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#version-synthetic-source" title="Synthetic _source"><code class="literal">version</code></a>
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#wildcard-synthetic-source" title="Synthetic _source"><code class="literal">wildcard</code></a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="synthetic-source-modifications"></a>Synthetic <code class="literal">_source</code> modifications<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/synthetic-source.asciidoc">edit</a></h4>
</div></div></div>
<p>When synthetic <code class="literal">_source</code> is enabled, retrieved documents undergo some
modifications compared to the original JSON.</p>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="synthetic-source-modifications-leaf-arrays"></a>Arrays moved to leaf fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/synthetic-source.asciidoc">edit</a></h5>
</div></div></div>
<p>Synthetic <code class="literal">_source</code> arrays are moved to leaves. For example:</p>
<a id="synthetic-source-leaf-arrays-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx/_doc/1
{
  "foo": [
    {
      "bar": 1
    },
    {
      "bar": 2
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/318.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "foo": {
    "bar": [1, 2]
  }
}</pre>
</div>
<p>This can cause some arrays to vanish:</p>
<a id="synthetic-source-leaf-arrays-example-sneaky"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx/_doc/1
{
  "foo": [
    {
      "bar": 1
    },
    {
      "baz": 2
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/319.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "foo": {
    "bar": 1,
    "baz": 2
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="synthetic-source-modifications-field-names"></a>Fields named as they are mapped<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/synthetic-source.asciidoc">edit</a></h5>
</div></div></div>
<p>Synthetic source names fields as they are named in the mapping. When used
with <a class="xref" href="mapping-params.html#dynamic" title="dynamic">dynamic mapping</a>, fields with dots (<code class="literal">.</code>) in their names are, by
default, interpreted as multiple objects, while dots in field names are
preserved within objects that have <a class="xref" href="mapping-params.html#subobjects" title="subobjects"><code class="literal">subobjects</code></a> disabled. For example:</p>
<a id="synthetic-source-objecty-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx/_doc/1
{
  "foo.bar.baz": 1
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/320.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "foo": {
    "bar": {
      "baz": 1
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="synthetic-source-modifications-alphabetical"></a>Alphabetical sorting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/synthetic-source.asciidoc">edit</a></h5>
</div></div></div>
<p>Synthetic <code class="literal">_source</code> fields are sorted alphabetically. The
<a href="https://www.rfc-editor.org/rfc/rfc7159.html" class="ulink" target="_top">JSON RFC</a> defines objects as
"an unordered collection of zero or more name/value pairs" so applications
shouldn&#8217;t care but without synthetic <code class="literal">_source</code> the original ordering is
preserved and some applications may, counter to the spec, do something with
that ordering.</p>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="disable-source-field"></a>Disabling the <code class="literal">_source</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/source-field.asciidoc">edit</a></h3>
</div></div></div>
<p>Though very handy to have around, the source field does incur storage overhead
within the index. For this reason, it can be disabled as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "_source": {
      "enabled": false
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/321.console"></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Think before disabling the <code class="literal">_source</code> field</h3>
<p>Users often disable the <code class="literal">_source</code> field without thinking about the
consequences, and then live to regret it. If the <code class="literal">_source</code> field isn&#8217;t
available then a number of features are not supported:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <a class="xref" href="docs.html#docs-update" title="Update API"><code class="literal">update</code></a>, <a class="xref" href="docs.html#docs-update-by-query" title="Update By Query API"><code class="literal">update_by_query</code></a>,
and <a class="xref" href="docs.html#docs-reindex" title="Reindex API"><code class="literal">reindex</code></a> APIs.
</li>
<li class="listitem">
On the fly <a class="xref" href="highlighting.html" title="Highlighting">highlighting</a>.
</li>
<li class="listitem">
The ability to reindex from one Elasticsearch index to another, either
to change mappings or analysis, or to upgrade an index to a new major
version.
</li>
<li class="listitem">
The ability to debug queries or aggregations by viewing the original
document used at index time.
</li>
<li class="listitem">
Potentially in the future, the ability to repair index corruption
automatically.
</li>
</ul>
</div>
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If disk space is a concern, rather increase the
<a class="xref" href="index-modules.html#index-codec">compression level</a> instead of disabling the <code class="literal">_source</code>.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="include-exclude"></a>Including / Excluding fields from <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/source-field.asciidoc">edit</a></h3>
</div></div></div>
<p>An expert-only feature is the ability to prune the contents of the <code class="literal">_source</code>
field after the document has been indexed, but before the <code class="literal">_source</code> field is
stored.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Removing fields from the <code class="literal">_source</code> has similar downsides to disabling
<code class="literal">_source</code>, especially the fact that you cannot reindex documents from one
Elasticsearch index to another. Consider using
<a class="xref" href="search-fields.html#source-filtering" title="The _source option">source filtering</a> instead.</p>
</div>
</div>
<p>The <code class="literal">includes</code>/<code class="literal">excludes</code> parameters (which also accept wildcards) can be used
as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT logs
{
  "mappings": {
    "_source": {
      "includes": [
        "*.count",
        "meta.*"
      ],
      "excludes": [
        "meta.description",
        "meta.other.*"
      ]
    }
  }
}

PUT logs/_doc/1
{
  "requests": {
    "count": 10,
    "foo": "bar" <a id="CO91-1"></a><i class="conum" data-value="1"></i>
  },
  "meta": {
    "name": "Some metric",
    "description": "Some metric description", <a id="CO91-2"></a><i class="conum" data-value="1"></i>
    "other": {
      "foo": "one", <a id="CO91-3"></a><i class="conum" data-value="1"></i>
      "baz": "two" <a id="CO91-4"></a><i class="conum" data-value="1"></i>
    }
  }
}

GET logs/_search
{
  "query": {
    "match": {
      "meta.other.foo": "one" <a id="CO91-5"></a><i class="conum" data-value="2"></i>
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/322.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO91-1"><i class="conum" data-value="1"></i></a><a href="#CO91-2"></a><a href="#CO91-3"></a><a href="#CO91-4"></a></p>
</td>
<td align="left" valign="top">
<p>These fields will be removed from the stored <code class="literal">_source</code> field.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO91-5"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>We can still search on this field, even though it is not in the stored <code class="literal">_source</code>.</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-tier-field"></a><code class="literal">_tier</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/fields/tier-field.asciidoc">edit</a></h2>
</div></div></div>
<p>When performing queries across multiple indexes, it is sometimes desirable to
target indexes held on nodes of a given data tier (<code class="literal">data_hot</code>, <code class="literal">data_warm</code>, <code class="literal">data_cold</code> or <code class="literal">data_frozen</code>).
The <code class="literal">_tier</code> field allows matching on the <code class="literal">tier_preference</code> setting of the index a document was indexed into.
The preferred value is accessible in certain queries :</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT index_1/_doc/1
{
  "text": "Document in index 1"
}

PUT index_2/_doc/2?refresh=true
{
  "text": "Document in index 2"
}

GET index_1,index_2/_search
{
  "query": {
    "terms": {
      "_tier": ["data_hot", "data_warm"] <a id="CO92-1"></a><i class="conum" data-value="1"></i>
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/323.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO92-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Querying on the <code class="literal">_tier</code> field</p>
</td>
</tr>
</table>
</div>
<p>Typically a query will use a <code class="literal">terms</code> query to list the tiers of interest but you can use
the <code class="literal">_tier</code> field in any query that is rewritten to a <code class="literal">term</code> query, such as the
<code class="literal">match</code>,  <code class="literal">query_string</code>, <code class="literal">term</code>, <code class="literal">terms</code>, or <code class="literal">simple_query_string</code> query, as well as <code class="literal">prefix</code>
and <code class="literal">wildcard</code> queries. However, it does not support <code class="literal">regexp</code> and <code class="literal">fuzzy</code>
queries.</p>
<p>The <code class="literal">tier_preference</code> setting of the index is a comma-delimited list of tier names
in order of preference i.e. the preferred tier for hosting an index is listed first followed
by potentially many fall-back options. Query matching only considers the first preference
(the first value of a list).</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="mapping-types.html">« Field data types</a>
</span>
<span class="next">
<a href="mapping-params.html">Mapping parameters »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
