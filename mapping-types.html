<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Field data types | Elasticsearch Guide | Elastic</title>
<meta class="elastic" name="content" content="Field data types | Elasticsearch Guide">

<link rel="home" href="index.html" title="Elasticsearch Guide"/>
<link rel="up" href="mapping.html" title="Mapping"/>
<link rel="prev" href="runtime.html" title="Runtime fields"/>
<link rel="next" href="mapping-fields.html" title="Metadata fields"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="mapping.html">Mapping</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="runtime.html">« Runtime fields</a>
</span>
<span class="next">
<a href="mapping-fields.html">Metadata fields »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="mapping-types"></a>Field data types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h2>
</div></div></div>
<p>Each field has a <em>field data type</em>, or <em>field type</em>. This type indicates the
kind of data the field contains, such as strings or boolean values, and its
intended use. For example, you can index strings to both <code class="literal">text</code> and <code class="literal">keyword</code>
fields. However, <code class="literal">text</code> field values are <a class="xref" href="analysis.html" title="Text analysis">analyzed</a> for full-text
search while <code class="literal">keyword</code> strings are left as-is for filtering and sorting.</p>
<p>Field types are grouped by <em>family</em>. Types in the same family have exactly the
same search behavior but may have different space usage or performance
characteristics.</p>
<p>Currently, there are two type families, <code class="literal">keyword</code> and <code class="literal">text</code>. Other type
families have only a single field type. For example, the <code class="literal">boolean</code> type family
consists of one field type: <code class="literal">boolean</code>.</p>
<h4><a id="_core_datatypes"></a>Common types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#binary" title="Binary field type"><code class="literal">binary</code></a>
</span>
</dt>
<dd>
Binary value encoded as a Base64 string.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#boolean" title="Boolean field type"><code class="literal">boolean</code></a>
</span>
</dt>
<dd>
<code class="literal">true</code> and <code class="literal">false</code> values.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#keyword" title="Keyword type family">Keywords</a>
</span>
</dt>
<dd>
The keyword family, including <code class="literal">keyword</code>, <code class="literal">constant_keyword</code>,
and <code class="literal">wildcard</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#number" title="Numeric field types">Numbers</a>
</span>
</dt>
<dd>
Numeric types, such as <code class="literal">long</code> and <code class="literal">double</code>, used to
express amounts.
</dd>
<dt>
<span class="term">
Dates
</span>
</dt>
<dd>
Date types, including <a class="xref" href="mapping-types.html#date" title="Date field type"><code class="literal">date</code></a> and
<a class="xref" href="mapping-types.html#date_nanos" title="Date nanoseconds field type"><code class="literal">date_nanos</code></a>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#field-alias" title="Alias field type"><code class="literal">alias</code></a>
</span>
</dt>
<dd>
Defines an alias for an existing field.
</dd>
</dl>
</div>
<h4><a id="object-types"></a>Objects and relational types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#object" title="Object field type"><code class="literal">object</code></a>
</span>
</dt>
<dd>
A JSON object.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#flattened" title="Flattened field type"><code class="literal">flattened</code></a>
</span>
</dt>
<dd>
An entire JSON object as a single field value.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#nested" title="Nested field type"><code class="literal">nested</code></a>
</span>
</dt>
<dd>
A JSON object that preserves the relationship
between its subfields.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#parent-join" title="Join field type"><code class="literal">join</code></a>
</span>
</dt>
<dd>
Defines a parent/child relationship for documents
in the same index.
</dd>
</dl>
</div>
<h4><a id="structured-data-types"></a>Structured data types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#range" title="Range field types">Range</a>
</span>
</dt>
<dd>
Range types, such as <code class="literal">long_range</code>, <code class="literal">double_range</code>,
<code class="literal">date_range</code>, and <code class="literal">ip_range</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#ip" title="IP field type"><code class="literal">ip</code></a>
</span>
</dt>
<dd>
IPv4 and IPv6 addresses.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#version" title="Version field type"><code class="literal">version</code></a>
</span>
</dt>
<dd>
Software versions. Supports <a href="https://semver.org/" class="ulink" target="_top">Semantic Versioning</a>
precedence rules.
</dd>
<dt>
<span class="term">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/8.9/mapper-murmur3.html" class="ulink" target="_top"><code class="literal">murmur3</code></a>
</span>
</dt>
<dd>
Compute and stores hashes of
values.
</dd>
</dl>
</div>
<h4><a id="aggregated-data-types"></a>Aggregate data types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#aggregate-metric-double" title="Aggregate metric field type"><code class="literal">aggregate_metric_double</code></a>
</span>
</dt>
<dd>
Pre-aggregated metric values.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#histogram" title="Histogram field type"><code class="literal">histogram</code></a>
</span>
</dt>
<dd>
Pre-aggregated numerical values in the form of a histogram.
</dd>
</dl>
</div>
<h4><a id="text-search-types"></a>Text search types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#text" title="Text type family"><code class="literal">text</code> fields</a>
</span>
</dt>
<dd>
The text family, including <code class="literal">text</code> and <code class="literal">match_only_text</code>.
Analyzed, unstructured text.
</dd>
<dt>
<span class="term">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/8.9/mapper-annotated-text.html" class="ulink" target="_top"><code class="literal">annotated-text</code></a>
</span>
</dt>
<dd>
Text containing special
markup. Used for identifying named entities.
</dd>
<dt>
<span class="term">
<a class="xref" href="search.html#completion-suggester" title="Completion Suggester"><code class="literal">completion</code></a>
</span>
</dt>
<dd>
Used for auto-complete suggestions.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#search-as-you-type" title="Search-as-you-type field type"><code class="literal">search_as_you_type</code></a>
</span>
</dt>
<dd>
<code class="literal">text</code>-like type for
as-you-type completion.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#token-count" title="Token count field type"><code class="literal">token_count</code></a>
</span>
</dt>
<dd>
A count of tokens in a text.
</dd>
</dl>
</div>
<h4><a id="document-ranking-types"></a>Document ranking types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#dense-vector" title="Dense vector field type"><code class="literal">dense_vector</code></a>
</span>
</dt>
<dd>
Records dense vectors of float values.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#rank-feature" title="Rank feature field type"><code class="literal">rank_feature</code></a>
</span>
</dt>
<dd>
Records a numeric feature to boost hits at
query time.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#rank-features" title="Rank features field type"><code class="literal">rank_features</code></a>
</span>
</dt>
<dd>
Records numeric features to boost hits at
query time.
</dd>
</dl>
</div>
<h4><a id="spatial_datatypes"></a>Spatial data types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#geo-point" title="Geopoint field type"><code class="literal">geo_point</code></a>
</span>
</dt>
<dd>
Latitude and longitude points.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#geo-shape" title="Geoshape field type"><code class="literal">geo_shape</code></a>
</span>
</dt>
<dd>
Complex shapes, such as polygons.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#point" title="Point field type"><code class="literal">point</code></a>
</span>
</dt>
<dd>
Arbitrary cartesian points.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#shape" title="Shape field type"><code class="literal">shape</code></a>
</span>
</dt>
<dd>
Arbitrary cartesian geometries.
</dd>
</dl>
</div>
<h4><a id="other-types"></a>Other types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-types.html#percolator" title="Percolator field type"><code class="literal">percolator</code></a>
</span>
</dt>
<dd>
Indexes queries written in <a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a>.
</dd>
</dl>
</div>
<h3><a id="types-array-handling"></a>Arrays<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h3>
<p>In Elasticsearch, arrays do not require a dedicated field data type. Any field can contain
zero or more values by default, however, all values in the array must be of the
same field type. See <a class="xref" href="mapping-types.html#array" title="Arrays">Arrays</a>.</p>
<h3><a id="types-multi-fields"></a>Multi-fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types.asciidoc">edit</a></h3>
<p>It is often useful to index the same field in different ways for different
purposes. For instance, a <code class="literal">string</code> field could be mapped as
a <code class="literal">text</code> field for full-text search, and as a <code class="literal">keyword</code> field for
sorting or aggregations. Alternatively, you could index a text field with
the <a class="xref" href="analysis-analyzers.html#analysis-standard-analyzer" title="Standard analyzer"><code class="literal">standard</code> analyzer</a>, the
<a class="xref" href="analysis-analyzers.html#english-analyzer" title="english analyzer"><code class="literal">english</code></a> analyzer, and the
<a class="xref" href="analysis-analyzers.html#french-analyzer" title="french analyzer"><code class="literal">french</code> analyzer</a>.</p>
<p>This is the purpose of <em>multi-fields</em>. Most field types support multi-fields
via the <a class="xref" href="mapping-params.html#multi-fields" title="fields"><code class="literal">fields</code></a> parameter.</p>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="aggregate-metric-double"></a>Aggregate metric field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/aggregate-metric-double.asciidoc">edit</a></h2>
</div></div></div>

<p>Stores pre-aggregated numeric values for <a class="xref" href="search-aggregations-metrics.html" title="Metrics aggregations">metric
aggregations</a>. An <code class="literal">aggregate_metric_double</code> field is an object containing one
or more of the following metric sub-fields: <code class="literal">min</code>, <code class="literal">max</code>, <code class="literal">sum</code>, and
<code class="literal">value_count</code>.</p>
<p>When you run certain metric aggregations on an <code class="literal">aggregate_metric_double</code> field,
the aggregation uses the related sub-field&#8217;s values. For example, a
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-min-aggregation" title="Min aggregation"><code class="literal">min</code></a> aggregation on an
<code class="literal">aggregate_metric_double</code> field returns the minimum value of all <code class="literal">min</code>
sub-fields.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>An <code class="literal">aggregate_metric_double</code> field stores a single numeric
<a class="xref" href="mapping-params.html#doc-values" title="doc_values">doc value</a> for each metric sub-field. Array values are not
supported. <code class="literal">min</code>, <code class="literal">max</code>, and <code class="literal">sum</code> values are <code class="literal">double</code> numbers. <code class="literal">value_count</code>
is a positive <code class="literal">long</code> number.</p>
</div>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index
{
  "mappings": {
    "properties": {
      "my-agg-metric-field": {
        "type": "aggregate_metric_double",
        "metrics": [ "min", "max", "sum", "value_count" ],
        "default_metric": "max"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/153.console"></div>
<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="aggregate-metric-double-params"></a>Parameters for <code class="literal">aggregate_metric_double</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/aggregate-metric-double.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">metrics</code>
</span>
</dt>
<dd>
(Required, array of strings)
Array of metric sub-fields to store. Each value corresponds to a
<a class="xref" href="search-aggregations-metrics.html" title="Metrics aggregations">metric aggregation</a>. Valid values are
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-min-aggregation" title="Min aggregation"><code class="literal">min</code></a>,
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-max-aggregation" title="Max aggregation"><code class="literal">max</code></a>,
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-sum-aggregation" title="Sum aggregation"><code class="literal">sum</code></a>, and
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-valuecount-aggregation" title="Value count aggregation"><code class="literal">value_count</code></a>. You must
specify at least one value.
</dd>
<dt>
<span class="term">
<code class="literal">default_metric</code>
</span>
</dt>
<dd>
(Required, string)
Default metric sub-field to use for queries, scripts, and aggregations that
don&#8217;t use a sub-field. Must be a value from the <code class="literal">metrics</code> array.
</dd>
<dt>
<span class="term">
<code class="literal">time_series_metric</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Marks the field as a <a class="xref" href="tsds.html#time-series-metric" title="Metrics">time series metric</a>. The value is the
metric type. You can&#8217;t update this parameter for existing fields.
</p>
<details open>
<summary class="title">Valid <code class="literal">time_series_metric</code> values for <code class="literal">aggregate_metric_double</code> fields</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">gauge</code>
</span>
</dt>
<dd>
A metric that represents a single numeric that can arbitrarily increase or decrease. For example, a temperature or
available disk space.
</dd>
<dt>
<span class="term">
<code class="literal">null</code> (Default)
</span>
</dt>
<dd>
Not a time series metric.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="aggregate-metric-double-uses"></a>Uses<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/aggregate-metric-double.asciidoc">edit</a></h3>
</div></div></div>
<p>We designed <code class="literal">aggregate_metric_double</code> fields for use with the following aggregations:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A <a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-min-aggregation" title="Min aggregation"><code class="literal">min</code></a> aggregation returns the
minimum value of all <code class="literal">min</code> sub-fields.
</li>
<li class="listitem">
A <a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-max-aggregation" title="Max aggregation"><code class="literal">max</code></a> aggregation returns the
maximum value of all <code class="literal">max</code> sub-fields.
</li>
<li class="listitem">
A <a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-sum-aggregation" title="Sum aggregation"><code class="literal">sum</code></a> aggregation returns the
sum of the values of all <code class="literal">sum</code> sub-fields.
</li>
<li class="listitem">
A <a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-valuecount-aggregation" title="Value count aggregation"><code class="literal">value_count</code></a>
aggregation returns the sum of the values of all <code class="literal">value_count</code> sub-fields.
</li>
<li class="listitem">
A <a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-avg-aggregation" title="Avg aggregation"><code class="literal">avg</code></a> aggregation. There is no
<code class="literal">avg</code> sub-field; the result of the <code class="literal">avg</code> aggregation is computed using the <code class="literal">sum</code>
and <code class="literal">value_count</code> metrics. To run an <code class="literal">avg</code> aggregation, the field must contain
both <code class="literal">sum</code> and <code class="literal">value_count</code> metric sub-field.
</li>
</ul>
</div>
<p>Running any other aggregation on an <code class="literal">aggregate_metric_double</code> field will fail with
an "unsupported aggregation" error.</p>
<p>Finally, an <code class="literal">aggregate_metric_double</code> field supports the following queries for which
it behaves as a <code class="literal">double</code> by delegating its behavior to its <code class="literal">default_metric</code> sub-field:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="term-level-queries.html#query-dsl-exists-query" title="Exists query"><code class="literal">exists</code></a>
</li>
<li class="listitem">
<a class="xref" href="term-level-queries.html#query-dsl-range-query" title="Range query"><code class="literal">range</code></a>
</li>
<li class="listitem">
<a class="xref" href="term-level-queries.html#query-dsl-term-query" title="Term query"><code class="literal">term</code></a>
</li>
<li class="listitem">
<a class="xref" href="term-level-queries.html#query-dsl-terms-query" title="Terms query"><code class="literal">terms</code></a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="aggregate-metric-double-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/aggregate-metric-double.asciidoc">edit</a></h3>
</div></div></div>
<p>The following <a class="xref" href="indices.html#indices-create-index" title="Create index API">create index</a> API request creates an
index with an <code class="literal">aggregate_metric_double</code> field named <code class="literal">agg_metric</code>. The request
sets <code class="literal">max</code> as the field&#8217;s <code class="literal">default_metric</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT stats-index
{
  "mappings": {
    "properties": {
      "agg_metric": {
        "type": "aggregate_metric_double",
        "metrics": [ "min", "max", "sum", "value_count" ],
        "default_metric": "max"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/154.console"></div>
<p>The following <a class="xref" href="docs.html#docs-index_" title="Index API">index</a> API request adds documents with
pre-aggregated data in the <code class="literal">agg_metric</code> field.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT stats-index/_doc/1
{
  "agg_metric": {
    "min": -302.50,
    "max": 702.30,
    "sum": 200.0,
    "value_count": 25
  }
}

PUT stats-index/_doc/2
{
  "agg_metric": {
    "min": -93.00,
    "max": 1702.30,
    "sum": 300.00,
    "value_count": 25
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/155.console"></div>
<p>You can run <code class="literal">min</code>, <code class="literal">max</code>, <code class="literal">sum</code>, <code class="literal">value_count</code>, and <code class="literal">avg</code> aggregations on a
<code class="literal">agg_metric</code> field.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST stats-index/_search?size=0
{
  "aggs": {
    "metric_min": { "min": { "field": "agg_metric" } },
    "metric_max": { "max": { "field": "agg_metric" } },
    "metric_value_count": { "value_count": { "field": "agg_metric" } },
    "metric_sum": { "sum": { "field": "agg_metric" } },
    "metric_avg": { "avg": { "field": "agg_metric" } }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/156.console"></div>
<p>The aggregation results are based on related metric sub-field values.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
...
  "aggregations": {
    "metric_min": {
      "value": -302.5
    },
    "metric_max": {
      "value": 1702.3
    },
    "metric_value_count": {
      "value": 50
    },
    "metric_sum": {
      "value": 500.0
    },
    "metric_avg": {
      "value": 10.0
    }
  }
}</pre>
</div>
<p>Queries on a <code class="literal">aggregate_metric_double</code> field use the <code class="literal">default_metric</code> value.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET stats-index/_search
{
  "query": {
    "term": {
      "agg_metric": {
        "value": 702.30
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/157.console"></div>
<p>The search returns the following hit. The value of the <code class="literal">default_metric</code> field,
<code class="literal">max</code>, matches the query value.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  ...
    "hits": {
    "total": {
      "value": 1,
      "relation": "eq"
    },
    "max_score": 1.0,
    "hits": [
      {
        "_index": "stats-index",
        "_id": "1",
        "_score": 1.0,
        "_source": {
          "agg_metric": {
            "min": -302.5,
            "max": 702.3,
            "sum": 200.0,
            "value_count": 25
          }
        }
      }
    ]
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="aggregate-metric-double-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/aggregate-metric-double.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">aggregate_metric-double</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> in their default
configuration. Synthetic <code class="literal">_source</code> cannot be used together with <a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>.</p>
<p>For example:</p>
<a id="synthetic-source-aggregate-metric-double-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "agg_metric": {
        "type": "aggregate_metric_double",
        "metrics": [ "min", "max", "sum", "value_count" ],
        "default_metric": "max"
      }
    }
  }
}

PUT idx/_doc/1
{
  "agg_metric": {
    "min": -302.50,
    "max": 702.30,
    "sum": 200.0,
    "value_count": 25
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/158.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "agg_metric": {
    "min": -302.50,
    "max": 702.30,
    "sum": 200.0,
    "value_count": 25
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="field-alias"></a>Alias field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/alias.asciidoc">edit</a></h2>
</div></div></div>

<p>An <code class="literal">alias</code> mapping defines an alternate name for a field in the index.
The alias can be used in place of the target field in <a class="xref" href="search.html" title="Search APIs">search</a> requests,
and selected other APIs like <a class="xref" href="search.html#search-field-caps" title="Field capabilities API">field capabilities</a>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT trips
{
  "mappings": {
    "properties": {
      "distance": {
        "type": "long"
      },
      "route_length_miles": {
        "type": "alias",
        "path": "distance" <a id="CO45-1"></a><i class="conum" data-value="1"></i>
      },
      "transit_mode": {
        "type": "keyword"
      }
    }
  }
}

GET _search
{
  "query": {
    "range" : {
      "route_length_miles" : {
        "gte" : 39
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/159.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO45-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The path to the target field. Note that this must be the full path, including any parent
objects (e.g. <code class="literal">object1.object2.field</code>).</p>
</td>
</tr>
</table>
</div>
<p>Almost all components of the search request accept field aliases. In particular, aliases can be
used in queries, aggregations, and sort fields, as well as when requesting <code class="literal">docvalue_fields</code>,
<code class="literal">stored_fields</code>, suggestions, and highlights. Scripts also support aliases when accessing
field values. Please see the section on <a class="xref" href="mapping-types.html#unsupported-apis" title="Unsupported APIs">unsupported APIs</a> for exceptions.</p>
<p>In some parts of the search request and when requesting field capabilities, field wildcard patterns can be
provided. In these cases, the wildcard pattern will match field aliases in addition to concrete fields:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET trips/_field_caps?fields=route_*,transit_mode</pre>
</div>
<div class="console_widget" data-snippet="snippets/160.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="alias-targets"></a>Alias targets<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/alias.asciidoc">edit</a></h3>
</div></div></div>
<p>There are a few restrictions on the target of an alias:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The target must be a concrete field, and not an object or another field alias.
</li>
<li class="listitem">
The target field must exist at the time the alias is created.
</li>
<li class="listitem">
If nested objects are defined, a field alias must have the same nested scope as its target.
</li>
</ul>
</div>
<p>Additionally, a field alias can only have one target. This means that it is not possible to use a
field alias to query over multiple target fields in a single clause.</p>
<p>An alias can be changed to refer to a new target through a mappings update. A known limitation is that
if any stored percolator queries contain the field alias, they will still refer to its original target.
More information can be found in the <a class="xref" href="mapping-types.html#percolator" title="Percolator field type">percolator documentation</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="unsupported-apis"></a>Unsupported APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/alias.asciidoc">edit</a></h3>
</div></div></div>
<p>Writes to field aliases are not supported: attempting to use an alias in an index or update request
will result in a failure. Likewise, aliases cannot be used as the target of <code class="literal">copy_to</code> or in multi-fields.</p>
<p>Because alias names are not present in the document source, aliases cannot be used when performing
source filtering. For example, the following request will return an empty result for <code class="literal">_source</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "query" : {
    "match_all": {}
  },
  "_source": "route_length_miles"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/161.console"></div>
<p>Currently only the search and field capabilities APIs will accept and resolve field aliases.
Other APIs that accept field names, such as <a class="xref" href="docs.html#docs-termvectors" title="Term vectors API">term vectors</a>, cannot be used
with field aliases.</p>
<p>Finally, some queries, such as <code class="literal">terms</code>, <code class="literal">geo_shape</code>, and <code class="literal">more_like_this</code>, allow for fetching query
information from an indexed document. Because field aliases aren&#8217;t supported when fetching documents,
the part of the query that specifies the lookup path cannot refer to a field by its alias.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="array"></a>Arrays<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/array.asciidoc">edit</a></h2>
</div></div></div>
<p>In Elasticsearch, there is no dedicated <code class="literal">array</code> data type. Any field can contain
zero or more values by default, however, all values in the array must be of the
same data type. For instance:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
an array of strings: [ <code class="literal">"one"</code>, <code class="literal">"two"</code> ]
</li>
<li class="listitem">
an array of integers: [ <code class="literal">1</code>, <code class="literal">2</code> ]
</li>
<li class="listitem">
an array of arrays: [ <code class="literal">1</code>, [ <code class="literal">2</code>, <code class="literal">3</code> ]] which is the equivalent of [ <code class="literal">1</code>, <code class="literal">2</code>, <code class="literal">3</code> ]
</li>
<li class="listitem">
an array of objects: [ <code class="literal">{ "name": "Mary", "age": 12 }</code>, <code class="literal">{ "name": "John", "age": 10 }</code>]
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Arrays of objects</h3>
<p>Arrays of objects do not work as you would expect: you cannot query each
object independently of the other objects in the array. If you need to be
able to do this then you should use the <a class="xref" href="mapping-types.html#nested" title="Nested field type"><code class="literal">nested</code></a> data type instead
of the <a class="xref" href="mapping-types.html#object" title="Object field type"><code class="literal">object</code></a> data type.</p>
<p>This is explained in more detail in <a class="xref" href="mapping-types.html#nested" title="Nested field type">Nested</a>.</p>
</div>
</div>
<p>When adding a field dynamically, the first value in the array determines the
field <code class="literal">type</code>. All subsequent values must be of the same data type or it must
at least be possible to <a class="xref" href="mapping-params.html#coerce" title="coerce">coerce</a> subsequent values to the same
data type.</p>
<p>Arrays with a mixture of data types are <em>not</em> supported: [ <code class="literal">10</code>, <code class="literal">"some string"</code> ]</p>
<p>An array may contain <code class="literal">null</code> values, which are either replaced by the
configured <a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a> or skipped entirely. An empty array
<code class="literal">[]</code> is treated as a missing field&#8201;&#8212;&#8201;a field with no values.</p>
<p>Nothing needs to be pre-configured in order to use arrays in documents, they
are supported out of the box:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/1
{
  "message": "some arrays in this document...",
  "tags":  [ "elasticsearch", "wow" ], <a id="CO46-1"></a><i class="conum" data-value="1"></i>
  "lists": [ <a id="CO46-2"></a><i class="conum" data-value="2"></i>
    {
      "name": "prog_list",
      "description": "programming list"
    },
    {
      "name": "cool_list",
      "description": "cool stuff list"
    }
  ]
}

PUT my-index-000001/_doc/2 <a id="CO46-3"></a><i class="conum" data-value="3"></i>
{
  "message": "no arrays in this document...",
  "tags":  "elasticsearch",
  "lists": {
    "name": "prog_list",
    "description": "programming list"
  }
}

GET my-index-000001/_search
{
  "query": {
    "match": {
      "tags": "elasticsearch" <a id="CO46-4"></a><i class="conum" data-value="4"></i>
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/162.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO46-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">tags</code> field is dynamically added as a <code class="literal">string</code> field.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO46-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">lists</code> field is dynamically added as an <code class="literal">object</code> field.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO46-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The second document contains no arrays, but can be indexed into the same fields.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO46-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>The query looks for <code class="literal">elasticsearch</code> in the <code class="literal">tags</code> field, and matches both documents.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="binary"></a>Binary field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/binary.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">binary</code> type accepts a binary value as a
<a href="https://en.wikipedia.org/wiki/Base64" class="ulink" target="_top">Base64</a> encoded string. The field is not
stored by default and is not searchable:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "name": {
        "type": "text"
      },
      "blob": {
        "type": "binary"
      }
    }
  }
}

PUT my-index-000001/_doc/1
{
  "name": "Some binary blob",
  "blob": "U29tZSBiaW5hcnkgYmxvYg==" <a id="CO47-1"></a><i class="conum" data-value="1"></i>
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/163.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO47-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The Base64 encoded binary value must not have embedded newlines <code class="literal">\n</code>.</p>
</td>
</tr>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="binary-params"></a>Parameters for <code class="literal">binary</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/binary.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">binary</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be stored on disk in a column-stride fashion, so that it
can later be used for sorting, aggregations, or scripting? Accepts <code class="literal">true</code>
or <code class="literal">false</code> (default).
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</p>
</td>
<td valign="top">
<p>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="boolean"></a>Boolean field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/boolean.asciidoc">edit</a></h2>
</div></div></div>

<p>Boolean fields accept JSON <code class="literal">true</code> and <code class="literal">false</code> values, but can also accept
strings which are interpreted as either true or false:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
False values
</p>
</td>
<td valign="top">
<p>
<code class="literal">false</code>, <code class="literal">"false"</code>, <code class="literal">""</code> (empty string)
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
True values
</p>
</td>
<td valign="top">
<p>
<code class="literal">true</code>, <code class="literal">"true"</code>
</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>For example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "is_published": {
        "type": "boolean"
      }
    }
  }
}

POST my-index-000001/_doc/1?refresh
{
  "is_published": "true" <a id="CO48-1"></a><i class="conum" data-value="1"></i>
}

GET my-index-000001/_search
{
  "query": {
    "term": {
      "is_published": true <a id="CO48-2"></a><i class="conum" data-value="2"></i>
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/164.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO48-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Indexing a document with <code class="literal">"true"</code>, which is interpreted as <code class="literal">true</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO48-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Searching for documents with a JSON <code class="literal">true</code>.</p>
</td>
</tr>
</table>
</div>
<p>Aggregations like the <a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-terms-aggregation" title="Terms aggregation"><code class="literal">terms</code>
aggregation</a>  use <code class="literal">1</code> and <code class="literal">0</code> for the <code class="literal">key</code>, and the strings <code class="literal">"true"</code> and
<code class="literal">"false"</code> for the <code class="literal">key_as_string</code>. Boolean fields when used in scripts,
return <code class="literal">true</code> and <code class="literal">false</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST my-index-000001/_doc/1?refresh
{
  "is_published": true
}

POST my-index-000001/_doc/2?refresh
{
  "is_published": false
}

GET my-index-000001/_search
{
  "aggs": {
    "publish_state": {
      "terms": {
        "field": "is_published"
      }
    }
  },
  "sort": [ "is_published" ],
  "fields": [
    {"field": "weight"}
  ],
  "runtime_mappings": {
    "weight": {
      "type": "long",
      "script": "emit(doc['is_published'].value ? 10 : 0)"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/165.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="boolean-params"></a>Parameters for <code class="literal">boolean</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/boolean.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">boolean</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be stored on disk in a column-stride fashion, so that it
can later be used for sorting, aggregations, or scripting? Accepts <code class="literal">true</code>
(default) or <code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be quickly searchable? Accepts <code class="literal">true</code> (default) and
<code class="literal">false</code>. Fields that only have <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
enabled can still be queried using term or range-based queries,
albeit slower.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>
</p>
</td>
<td valign="top">
<p>
Trying to index the wrong data type into a field throws an exception by
default, and rejects the whole document. If this parameter is set to true,
it allows the exception to be ignored. The malformed field is not indexed,
but other fields in the document are processed normally. Accepts <code class="literal">true</code> or <code class="literal">false</code>.
Note that this cannot be set if the <code class="literal">script</code> parameter is used.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</p>
</td>
<td valign="top">
<p>
Accepts any of the true or false values listed above. The value is
substituted for any explicit <code class="literal">null</code> values. Defaults to <code class="literal">null</code>, which
means the field is treated as missing. Note that this cannot be set
if the <code class="literal">script</code> parameter is used.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">on_script_error</code>
</p>
</td>
<td valign="top">
<p>
Defines what to do if the script defined by the <code class="literal">script</code> parameter
throws an error at indexing time. Accepts <code class="literal">fail</code> (default), which
will cause the entire document to be rejected, and <code class="literal">continue</code>, which
will register the field in the document&#8217;s
<a class="xref" href="mapping-fields.html#mapping-ignored-field" title="_ignored field"><code class="literal">_ignored</code></a> metadata field and continue
indexing. This parameter can only be set if the <code class="literal">script</code> field is
also set.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">script</code>
</p>
</td>
<td valign="top">
<p>
If this parameter is set, then the field will index values generated
by this script, rather than reading the values directly from the
source. If a value is set for this field on the input document, then
the document will be rejected with an error.
Scripts are in the same format as their
<a class="xref" href="runtime.html#runtime-mapping-fields" title="Map a runtime field">runtime equivalent</a>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</p>
</td>
<td valign="top">
<p>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-field-meta" title="meta"><code class="literal">meta</code></a>
</p>
</td>
<td valign="top">
<p>
Metadata about the field.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="boolean-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/boolean.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">boolean</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> in their
default configuration. Synthetic <code class="literal">_source</code> cannot be used together with
<a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a> or with <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a> disabled.</p>
<p>Synthetic source always sorts <code class="literal">boolean</code> fields. For example:</p>
<a id="synthetic-source-boolean-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "bool": { "type": "boolean" }
    }
  }
}
PUT idx/_doc/1
{
  "bool": [true, false, true, false]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/166.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "bool": [false, false, true, true]
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="completion"></a>Completion field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/completion.asciidoc">edit</a></h2>
</div></div></div>

<p>To use the <a class="xref" href="search.html#completion-suggester" title="Completion Suggester"><code class="literal">completion</code> suggester</a>, map the field from
which you want to generate suggestions as type <code class="literal">completion</code>. This indexes the
field values for fast completions.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT music
{
  "mappings": {
    "properties": {
      "suggest": {
        "type": "completion"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/167.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_parameters_for_completion_fields"></a>Parameters for <code class="literal">completion</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/completion.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">completion</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#analyzer" title="analyzer"><code class="literal">analyzer</code></a>
</p>
</td>
<td valign="top">
<p>
The index analyzer to use, defaults to <code class="literal">simple</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#search-analyzer" title="search_analyzer"><code class="literal">search_analyzer</code></a>
</p>
</td>
<td valign="top">
<p>
The search analyzer to use, defaults to value of <code class="literal">analyzer</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">preserve_separators</code>
</p>
</td>
<td valign="top">
<p>
Preserves the separators, defaults to <code class="literal">true</code>.
If disabled, you could find a field starting with <code class="literal">Foo Fighters</code>, if you
suggest for <code class="literal">foof</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">preserve_position_increments</code>
</p>
</td>
<td valign="top">
<p>
Enables position increments, defaults to <code class="literal">true</code>.
If disabled and using stopwords analyzer, you could get a
field starting with <code class="literal">The Beatles</code>, if you suggest for <code class="literal">b</code>. <span class="strong strong"><strong>Note</strong></span>: You
could also achieve this by indexing two inputs, <code class="literal">Beatles</code> and
<code class="literal">The Beatles</code>, no need to change a simple analyzer, if you are able to
enrich your data.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">max_input_length</code>
</p>
</td>
<td valign="top">
<p>
Limits the length of a single input, defaults to <code class="literal">50</code> UTF-16 code points.
This limit is only used at index time to reduce the total number of
characters per input string in order to prevent massive inputs from
bloating the underlying datastructure. Most use cases won&#8217;t be influenced
by the default value since prefix completions seldom grow beyond prefixes longer
than a handful of characters.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="date"></a>Date field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/date.asciidoc">edit</a></h2>
</div></div></div>

<p>JSON doesn&#8217;t have a date data type, so dates in Elasticsearch can either be:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
strings containing formatted dates, e.g. <code class="literal">"2015-01-01"</code> or <code class="literal">"2015/01/01 12:10:30"</code>.
</li>
<li class="listitem">
a number representing <em>milliseconds-since-the-epoch</em>.
</li>
<li class="listitem">
a number representing <em>seconds-since-the-epoch</em> (<a class="xref" href="mapping-types.html#date-epoch-seconds" title="Epoch seconds">configuration</a>).
</li>
</ul>
</div>
<p>Internally, dates are converted to UTC (if the time-zone is specified) and
stored as a long number representing milliseconds-since-the-epoch.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Use the <a class="xref" href="mapping-types.html#date_nanos" title="Date nanoseconds field type">date_nanos</a> field type if a nanosecond resolution is expected.</p>
</div>
</div>
<p>Queries on dates are internally converted to range queries on this long
representation, and the result of aggregations and stored fields is converted
back to a string depending on the date format that is associated with the field.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Dates will always be rendered as strings, even if they were initially
supplied as a long in the JSON document.</p>
</div>
</div>
<p>Date formats can be customised, but if no <code class="literal">format</code> is specified then it uses
the default:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">    "strict_date_optional_time||epoch_millis"</pre>
</div>
<p>This means that it will accept dates with optional timestamps, which conform
to the formats supported by <a class="xref" href="mapping-params.html#strict-date-time"><code class="literal">strict_date_optional_time</code></a>
or milliseconds-since-the-epoch.</p>
<p>For instance:</p>
<a id="date-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "date": {
        "type": "date" <a id="CO49-1"></a><i class="conum" data-value="1"></i>
      }
    }
  }
}

PUT my-index-000001/_doc/1
{ "date": "2015-01-01" } <a id="CO49-2"></a><i class="conum" data-value="2"></i>

PUT my-index-000001/_doc/2
{ "date": "2015-01-01T12:10:30Z" } <a id="CO49-3"></a><i class="conum" data-value="3"></i>

PUT my-index-000001/_doc/3
{ "date": 1420070400001 } <a id="CO49-4"></a><i class="conum" data-value="4"></i>

GET my-index-000001/_search
{
  "sort": { "date": "asc"} <a id="CO49-5"></a><i class="conum" data-value="5"></i>
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/168.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO49-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">date</code> field uses the default <code class="literal">format</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO49-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document uses a plain date.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO49-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document includes a time.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO49-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document uses milliseconds-since-the-epoch.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO49-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Note that the <code class="literal">sort</code> values that are returned are all in milliseconds-since-the-epoch.</p>
</td>
</tr>
</table>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Dates
will accept numbers with a decimal point like <code class="literal">{"date": 1618249875.123456}</code>
but there are some cases (<a href="https://github.com/elastic/elasticsearch/issues/70085" class="ulink" target="_top">#70085</a>) where we&#8217;ll lose precision
on those dates so they should be avoided.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="multiple-date-formats"></a>Multiple date formats<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/date.asciidoc">edit</a></h3>
</div></div></div>
<p>Multiple formats can be specified by separating them with <code class="literal">||</code> as a separator.
Each format will be tried in turn until a matching format is found. The first
format will be used to convert the <em>milliseconds-since-the-epoch</em> value back
into a string.</p>
<a id="date-format-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "date": {
        "type":   "date",
        "format": "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/169.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="date-params"></a>Parameters for <code class="literal">date</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/date.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">date</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be stored on disk in a column-stride fashion, so that it
can later be used for sorting, aggregations, or scripting? Accepts <code class="literal">true</code>
(default) or <code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-date-format" title="format"><code class="literal">format</code></a>
</p>
</td>
<td valign="top">
<p>
The date format(s) that can be parsed. Defaults to
<code class="literal">strict_date_optional_time||epoch_millis</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">locale</code>
</p>
</td>
<td valign="top">
<p>
The locale to use when parsing dates since months do not have the same names
and/or abbreviations in all languages. The default is the
<a href="https://docs.oracle.com/javase/8/docs/api/java/util/Locale.html#ROOT" class="ulink" target="_top"><code class="literal">ROOT</code> locale</a>,
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>
</p>
</td>
<td valign="top">
<p>
If <code class="literal">true</code>, malformed numbers are ignored. If <code class="literal">false</code> (default), malformed
numbers throw an exception and reject the whole document.  Note that this
cannot be set if the <code class="literal">script</code> parameter is used.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be quickly searchable? Accepts <code class="literal">true</code> (default) and
<code class="literal">false</code>. Date fields that only have <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
enabled can also be queried, albeit slower.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</p>
</td>
<td valign="top">
<p>
Accepts a date value in one of the configured <code class="literal">format</code>'s as the field
which is substituted for any explicit <code class="literal">null</code> values. Defaults to <code class="literal">null</code>,
which means the field is treated as missing.  Note that this cannot be
set of the <code class="literal">script</code> parameter is used.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">on_script_error</code>
</p>
</td>
<td valign="top">
<p>
Defines what to do if the script defined by the <code class="literal">script</code> parameter
throws an error at indexing time. Accepts <code class="literal">fail</code> (default), which
will cause the entire document to be rejected, and <code class="literal">continue</code>, which
will register the field in the document&#8217;s
<a class="xref" href="mapping-fields.html#mapping-ignored-field" title="_ignored field"><code class="literal">_ignored</code></a> metadata field and continue
indexing. This parameter can only be set if the <code class="literal">script</code> field is
also set.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">script</code>
</p>
</td>
<td valign="top">
<p>
If this parameter is set, then the field will index values generated
by this script, rather than reading the values directly from the
source. If a value is set for this field on the input document, then
the document will be rejected with an error.
Scripts are in the same format as their
<a class="xref" href="runtime.html#runtime-mapping-fields" title="Map a runtime field">runtime equivalent</a>, and should emit
long-valued timestamps.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</p>
</td>
<td valign="top">
<p>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-field-meta" title="meta"><code class="literal">meta</code></a>
</p>
</td>
<td valign="top">
<p>
Metadata about the field.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="date-epoch-seconds"></a>Epoch seconds<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/date.asciidoc">edit</a></h3>
</div></div></div>
<p>If you need to send dates as <em>seconds-since-the-epoch</em> then make sure the
<code class="literal">format</code> lists <code class="literal">epoch_second</code>:</p>
<a id="date-epoch-seconds-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "date": {
        "type":   "date",
        "format": "strict_date_optional_time||epoch_second"
      }
    }
  }
}

PUT my-index-000001/_doc/example?refresh
{ "date": 1618321898 }

POST my-index-000001/_search
{
  "fields": [ {"field": "date"}],
  "_source": false
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/170.console"></div>
<p>Which will reply with a date like:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "hits": {
    "hits": [
      {
        "_id": "example",
        "_index": "my-index-000001",
        "_score": 1.0,
        "fields": {
          "date": ["2021-04-13T13:51:38.000Z"]
        }
      }
    ]
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="date-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/date.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">date</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> in their
default configuration. Synthetic <code class="literal">_source</code> cannot be used together with
<a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a>, <a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a> set to true
or with <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a> disabled.</p>
<p>Synthetic source always sorts <code class="literal">date</code> fields. For example:</p>
<a id="synthetic-source-date-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "date": { "type": "date" }
    }
  }
}
PUT idx/_doc/1
{
  "date": ["2015-01-01T12:10:30Z", "2014-01-01T12:10:30Z"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/171.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "date": ["2014-01-01T12:10:30.000Z", "2015-01-01T12:10:30.000Z"]
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="date_nanos"></a>Date nanoseconds field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/date_nanos.asciidoc">edit</a></h2>
</div></div></div>

<p>This data type is an addition to the <code class="literal">date</code> data type. However there is an
important distinction between the two. The existing <code class="literal">date</code> data type stores
dates in millisecond resolution. The <code class="literal">date_nanos</code> data type stores dates
in nanosecond resolution, which limits its range of dates from roughly
1970 to 2262, as dates are still stored as a long representing nanoseconds
since the epoch.</p>
<p>Queries on nanoseconds are internally converted to range queries on this long
representation, and the result of aggregations and stored fields is converted
back to a string depending on the date format that is associated with the field.</p>
<p>Date formats can be customised, but if no <code class="literal">format</code> is specified then it uses
the default:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">    "strict_date_optional_time_nanos||epoch_millis"</pre>
</div>
<p>For instance:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "date": {
        "type": "date_nanos" <a id="CO50-1"></a><i class="conum" data-value="1"></i>
      }
    }
  }
}

PUT my-index-000001/_bulk?refresh
{ "index" : { "_id" : "1" } }
{ "date": "2015-01-01" } <a id="CO50-2"></a><i class="conum" data-value="2"></i>
{ "index" : { "_id" : "2" } }
{ "date": "2015-01-01T12:10:30.123456789Z" } <a id="CO50-3"></a><i class="conum" data-value="3"></i>
{ "index" : { "_id" : "3" } }
{ "date": 1420070400000 } <a id="CO50-4"></a><i class="conum" data-value="4"></i>

GET my-index-000001/_search
{
  "sort": { "date": "asc"}, <a id="CO50-5"></a><i class="conum" data-value="5"></i>
  "runtime_mappings": {
    "date_has_nanos": {
      "type": "boolean",
      "script": "emit(doc['date'].value.nano != 0)" <a id="CO50-6"></a><i class="conum" data-value="6"></i>
    }
  },
  "fields": [
    {
      "field": "date",
      "format": "strict_date_optional_time_nanos" <a id="CO50-7"></a><i class="conum" data-value="7"></i>
    },
    {
      "field": "date_has_nanos"
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/172.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO50-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">date</code> field uses the default <code class="literal">format</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO50-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document uses a plain date.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO50-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document includes a time.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO50-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document uses milliseconds-since-the-epoch.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO50-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Note that the <code class="literal">sort</code> values that are returned are all in
nanoseconds-since-the-epoch.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO50-6"><i class="conum" data-value="6"></i></a></p>
</td>
<td align="left" valign="top">
<p>Use <code class="literal">.nano</code> in scripts to return the nanosecond component of the date.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO50-7"><i class="conum" data-value="7"></i></a></p>
</td>
<td align="left" valign="top">
<p>You can specify the format when fetching data using the <a class="xref" href="search-fields.html#search-fields-param" title="The fields option"><code class="literal">fields</code> parameter</a>.
Use <a class="xref" href="mapping-params.html#strict-date-time-nanos"><code class="literal">strict_date_optional_time_nanos</code></a> or you&#8217;ll get a rounded result.</p>
</td>
</tr>
</table>
</div>
<p>You can also specify multiple date formats separated by <code class="literal">||</code>. The
same mapping parameters than with the <code class="literal">date</code> field can be used.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Date nanoseconds
will accept numbers with a decimal point like <code class="literal">{"date": 1618249875.123456}</code>
but there are some cases (<a href="https://github.com/elastic/elasticsearch/issues/70085" class="ulink" target="_top">#70085</a>) where we&#8217;ll lose precision
on those dates so they should be avoided.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="date-nanos-limitations"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/date_nanos.asciidoc">edit</a></h3>
</div></div></div>
<p>Aggregations are still on millisecond resolution, even when using a <code class="literal">date_nanos</code>
field. This limitation also affects <a class="xref" href="transforms.html" title="Transforming data">transforms</a>.</p>
<hr>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="date-nanos-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/date_nanos.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">date_nanos</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> in their
default configuration. Synthetic <code class="literal">_source</code> cannot be used together with
<a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a>, <a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a> set to true
or with <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a> disabled.</p>
<p>Synthetic source always sorts <code class="literal">date_nanos</code> fields. For example:</p>
<a id="synthetic-source-date-nanos-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "date": { "type": "date_nanos" }
    }
  }
}
PUT idx/_doc/1
{
  "date": ["2015-01-01T12:10:30.000Z", "2014-01-01T12:10:30.000Z"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/173.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "date": ["2014-01-01T12:10:30.000Z", "2015-01-01T12:10:30.000Z"]
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="dense-vector"></a>Dense vector field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/dense-vector.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">dense_vector</code> field type stores dense vectors of numeric values. Dense
vector fields are primarily used for <a class="xref" href="knn-search.html" title="k-nearest neighbor (kNN) search">k-nearest neighbor (kNN) search</a>.</p>
<p>The <code class="literal">dense_vector</code> type does not support aggregations or sorting.</p>
<p>You add a <code class="literal">dense_vector</code> field as an array of numeric values
based on <a class="xref" href="mapping-types.html#dense-vector-params" title="Parameters for dense vector fields"><code class="literal">element_type</code></a> with
<code class="literal">float</code> by default:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index
{
  "mappings": {
    "properties": {
      "my_vector": {
        "type": "dense_vector",
        "dims": 3
      },
      "my_text" : {
        "type" : "keyword"
      }
    }
  }
}

PUT my-index/_doc/1
{
  "my_text" : "text1",
  "my_vector" : [0.5, 10, 6]
}

PUT my-index/_doc/2
{
  "my_text" : "text2",
  "my_vector" : [-0.5, 10, 10]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/174.console"></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Unlike most other data types, dense vectors are always single-valued.
It is not possible to store multiple values in one <code class="literal">dense_vector</code> field.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="index-vectors-knn-search"></a>Index vectors for kNN search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/dense-vector.asciidoc">edit</a></h3>
</div></div></div>
<p>A <em>k-nearest neighbor</em> (kNN) search finds the <em>k</em> nearest vectors to a query
vector, as measured by a similarity metric.</p>
<p>Dense vector fields can be used to rank documents in
<a class="xref" href="specialized-queries.html#query-dsl-script-score-query" title="Script score query"><code class="literal">script_score</code> queries</a>. This lets you perform
a brute-force kNN search by scanning all documents and ranking them by
similarity.</p>
<p>In many cases, a brute-force kNN search is not efficient enough. For this
reason, the <code class="literal">dense_vector</code> type supports indexing vectors into a specialized
data structure to support fast kNN retrieval through the <a class="xref" href="search.html#search-api-knn"><code class="literal">knn</code> option</a> in the search API</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Indexing vectors for approximate kNN search is an expensive process. It
can take substantial time to ingest documents that contain vector fields with
<code class="literal">index</code> enabled. See <a class="xref" href="tune-knn-search.html" title="Tune approximate kNN search">k-nearest neighbor (kNN) search</a> to
learn more about the memory requirements.</p>
</div>
</div>
<p>You can enable indexing by setting the <code class="literal">index</code> parameter:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-2
{
  "mappings": {
    "properties": {
      "my_vector": {
        "type": "dense_vector",
        "dims": 3,
        "index": true,
        "similarity": "dot_product" <a id="CO51-1"></a><i class="conum" data-value="1"></i>
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/175.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO51-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>When <code class="literal">index</code> is enabled, you must define the vector similarity to use in kNN search</p>
</td>
</tr>
</table>
</div>
<p>Elasticsearch uses the <a href="https://arxiv.org/abs/1603.09320" class="ulink" target="_top">HNSW algorithm</a> to support
efficient kNN search. Like most kNN algorithms, HNSW is an approximate method
that sacrifices result accuracy for improved speed.</p>
<p>Dense vector fields cannot be indexed if they are within
<a class="xref" href="mapping-types.html#nested" title="Nested field type"><code class="literal">nested</code></a> mappings.</p>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dense-vector-params"></a>Parameters for dense vector fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/dense-vector.asciidoc">edit</a></h3>
</div></div></div>
<p>The following mapping parameters are accepted:</p>
<div class="variablelist">
<a id="dense-vector-element-type"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">element_type</code>
</span>
</dt>
<dd>
(Optional, string)
The data type used to encode vectors. The supported data types are
<code class="literal">float</code> (default) and <code class="literal">byte</code>. <code class="literal">float</code> indexes a 4-byte floating-point
value per dimension. <code class="literal">byte</code> indexes a 1-byte integer value per dimension.
Using <code class="literal">byte</code> can result in a substantially smaller index size with the
trade off of lower precision. Vectors using <code class="literal">byte</code> require dimensions with
integer values between -128 to 127, inclusive for both indexing and searching.
</dd>
<dt>
<span class="term">
<code class="literal">dims</code>
</span>
</dt>
<dd>
<p>
(Required, integer)
Number of vector dimensions. Can&#8217;t exceed <code class="literal">1024</code> for indexed vectors
(<code class="literal">"index": true</code>), or <code class="literal">2048</code> for non-indexed vectors.
</p>
<p><span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span>
The number of dimensions for indexed vectors can be extended up to <code class="literal">2048</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, you can search this field using the <a class="xref" href="search.html#knn-search-api" title="kNN search API">kNN search
API</a>. Defaults to <code class="literal">false</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="dense-vector-similarity"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">similarity</code>
</span>
</dt>
<dd>
<p>
(Required<sup>*</sup>, string)
The vector similarity metric to use in kNN search. Documents are ranked by
their vector field&#8217;s similarity to the query vector. The <code class="literal">_score</code> of each
document will be derived from the similarity, in a way that ensures scores are
positive and that a larger score corresponds to a higher ranking.
</p>
<p><sup>*</sup> If <code class="literal">index</code> is <code class="literal">true</code>, this parameter is required.</p>
<details open>
<summary class="title">Valid values for <code class="literal">similarity</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">l2_norm</code>
</span>
</dt>
<dd>
Computes similarity based on the L<sup>2</sup> distance (also known as Euclidean
distance) between the vectors. The document <code class="literal">_score</code> is computed as
<code class="literal">1 / (1 + l2_norm(query, vector)^2)</code>.
</dd>
<dt>
<span class="term">
<code class="literal">dot_product</code>
</span>
</dt>
<dd>
<p>
Computes the dot product of two vectors. This option provides an optimized way
to perform cosine similarity. The constraints and computed score are defined
by <code class="literal">element_type</code>.
</p>
<p>When <code class="literal">element_type</code> is <code class="literal">float</code>, all vectors must be unit length, including both
document and query vectors. The document <code class="literal">_score</code> is computed as
<code class="literal">(1 + dot_product(query, vector)) / 2</code>.</p>
<p>When <code class="literal">element_type</code> is <code class="literal">byte</code>, all vectors must have the same
length including both document and query vectors or results will be inaccurate.
The document <code class="literal">_score</code> is computed as
<code class="literal">0.5 + (dot_product(query, vector) / (32768 * dims))</code>
where <code class="literal">dims</code> is the number of dimensions per vector.</p>
</dd>
<dt>
<span class="term">
<code class="literal">cosine</code>
</span>
</dt>
<dd>
Computes the cosine similarity. Note that the most efficient way to perform
cosine similarity is to normalize all vectors to unit length, and instead use
<code class="literal">dot_product</code>. You should only use <code class="literal">cosine</code> if you need to preserve the
original vectors and cannot normalize them in advance. The document <code class="literal">_score</code>
is computed as <code class="literal">(1 + cosine(query, vector)) / 2</code>. The <code class="literal">cosine</code> similarity does
not allow vectors with zero magnitude, since cosine is not defined in this
case.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Although they are conceptually related, the <code class="literal">similarity</code> parameter is
different from <a class="xref" href="mapping-types.html#text" title="Text type family"><code class="literal">text</code></a> field <a class="xref" href="mapping-params.html#similarity" title="similarity"><code class="literal">similarity</code></a> and accepts
a distinct set of options.</p>
</div>
</div>
<div class="variablelist">
<a id="dense-vector-index-options"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index_options</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
An optional section that configures the kNN indexing algorithm. The HNSW
algorithm has two internal parameters that influence how the data structure is
built. These can be adjusted to improve the accuracy of results, at the
expense of slower indexing speed. When <code class="literal">index_options</code> is provided, all of its
properties must be defined.
</p>
<details open>
<summary class="title">Properties of <code class="literal">index_options</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
(Required, string)
The type of kNN algorithm to use. Currently only <code class="literal">hnsw</code> is supported.
</dd>
<dt>
<span class="term">
<code class="literal">m</code>
</span>
</dt>
<dd>
(Required, integer)
The number of neighbors each node will be connected to in the HNSW graph.
Defaults to <code class="literal">16</code>.
</dd>
<dt>
<span class="term">
<code class="literal">ef_construction</code>
</span>
</dt>
<dd>
(Required, integer)
The number of candidates to track while assembling the list of nearest
neighbors for each new node. Defaults to <code class="literal">100</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dense-vector-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/dense-vector.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">dense_vector</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> .</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="flattened"></a>Flattened field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/flattened.asciidoc">edit</a></h2>
</div></div></div>

<p>By default, each subfield in an object is mapped and indexed separately. If
the names or types of the subfields are not known in advance, then they are
<a class="xref" href="dynamic-mapping.html" title="Dynamic mapping">mapped dynamically</a>.</p>
<p>The <code class="literal">flattened</code> type provides an alternative approach, where the entire
object is mapped as a single field. Given an object, the <code class="literal">flattened</code>
mapping will parse out its leaf values and index them into one field as
keywords. The object&#8217;s contents can then be searched through simple queries
and aggregations.</p>
<p>This data type can be useful for indexing objects with a large or unknown
number of unique keys. Only one field mapping is created for the whole JSON
object, which can help prevent a <a class="xref" href="mapping.html#mapping-limit-settings" title="Settings to prevent mapping explosion">mappings explosion</a>
from having too many distinct field mappings.</p>
<p>On the other hand, flattened object fields present a trade-off in terms of
search functionality. Only basic queries are allowed, with no support for
numeric range queries or highlighting. Further information on the limitations
can be found in the <a class="xref" href="mapping-types.html#supported-operations" title="Supported operations">Supported operations</a> section.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">flattened</code> mapping type should <span class="strong strong"><strong>not</strong></span> be used for indexing all
document content, as it treats all values as keywords and does not provide full
search functionality. The default approach, where each subfield has its own
entry in the mappings, works well in the majority of cases.</p>
</div>
</div>
<p>A flattened object field can be created as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT bug_reports
{
  "mappings": {
    "properties": {
      "title": {
        "type": "text"
      },
      "labels": {
        "type": "flattened"
      }
    }
  }
}

POST bug_reports/_doc/1
{
  "title": "Results are not sorted correctly.",
  "labels": {
    "priority": "urgent",
    "release": ["v1.2.5", "v1.3.0"],
    "timestamp": {
      "created": 1541458026,
      "closed": 1541457010
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/176.console"></div>
<p>During indexing, tokens are created for each leaf value in the JSON object. The
values are indexed as string keywords, without analysis or special handling for
numbers or dates.</p>
<p>Querying the top-level <code class="literal">flattened</code> field searches all leaf values in the
object:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST bug_reports/_search
{
  "query": {
    "term": {"labels": "urgent"}
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/177.console"></div>
<p>To query on a specific key in the flattened object, object dot notation is used:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST bug_reports/_search
{
  "query": {
    "term": {"labels.release": "v1.3.0"}
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/178.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="supported-operations"></a>Supported operations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/flattened.asciidoc">edit</a></h3>
</div></div></div>
<p>Because of the similarities in the way values are indexed, <code class="literal">flattened</code>
fields share much of the same mapping and search functionality as
<a class="xref" href="mapping-types.html#keyword" title="Keyword type family"><code class="literal">keyword</code></a> fields.</p>
<p>Currently, flattened object fields can be used with the following query types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">term</code>, <code class="literal">terms</code>, and <code class="literal">terms_set</code>
</li>
<li class="listitem">
<code class="literal">prefix</code>
</li>
<li class="listitem">
<code class="literal">range</code>
</li>
<li class="listitem">
<code class="literal">match</code> and <code class="literal">multi_match</code>
</li>
<li class="listitem">
<code class="literal">query_string</code> and <code class="literal">simple_query_string</code>
</li>
<li class="listitem">
<code class="literal">exists</code>
</li>
</ul>
</div>
<p>When querying, it is not possible to refer to field keys using wildcards, as in
<code class="literal">{ "term": {"labels.time*": 1541457010}}</code>. Note that all queries, including
<code class="literal">range</code>, treat the values as string keywords. Highlighting is not supported on
<code class="literal">flattened</code> fields.</p>
<p>It is possible to sort on a flattened object field, as well as perform simple
keyword-style aggregations such as <code class="literal">terms</code>. As with queries, there is no
special support for numerics&#8201;&#8212;&#8201;all values in the JSON object are treated as
keywords. When sorting, this implies that values are compared
lexicographically.</p>
<p>Flattened object fields currently cannot be stored. It is not possible to
specify the <a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a> parameter in the mapping.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-fields-flattened"></a>Retrieving flattened fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/flattened.asciidoc">edit</a></h3>
</div></div></div>
<p>Field values and concrete subfields can be retrieved using the
<a class="xref" href="search-fields.html#search-fields-param" title="The fields option">fields parameter</a>. content. Since the <code class="literal">flattened</code> field maps an
entire object with potentially many subfields as a single field, the response contains
the unaltered structure from <code class="literal">_source</code>.</p>
<p>Single subfields, however, can be fetched by specifying them explicitly in the request.
This only works for concrete paths, but not using wildcards:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "flattened_field": {
        "type": "flattened"
      }
    }
  }
}

PUT my-index-000001/_doc/1?refresh=true
{
  "flattened_field" : {
    "subfield" : "value"
  }
}

POST my-index-000001/_search
{
  "fields": ["flattened_field.subfield"],
  "_source": false
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/179.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took": 2,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "skipped": 0,
    "failed": 0
  },
  "hits": {
    "total": {
      "value": 1,
      "relation": "eq"
    },
    "max_score": 1.0,
    "hits": [{
      "_index": "my-index-000001",
      "_id": "1",
      "_score": 1.0,
      "fields": {
        "flattened_field.subfield" : [ "value" ]
      }
    }]
  }
}</pre>
</div>
<p>You can also use a <a class="xref" href="modules-scripting-painless.html" title="Painless scripting language">Painless script</a> to retrieve
values from sub-fields of flattened fields. Instead of including
<code class="literal">doc['&lt;field_name&gt;'].value</code> in your Painless script, use
<code class="literal">doc['&lt;field_name&gt;.&lt;sub-field_name&gt;'].value</code>. For example, if you have a
flattened field called <code class="literal">label</code> with a <code class="literal">release</code> sub-field, your Painless script
would be <code class="literal">doc['labels.release'].value</code>.</p>
<p>For example, let&#8217;s say your mapping contains two fields, one of which is of the
<code class="literal">flattened</code> type:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "title": {
        "type": "text"
      },
      "labels": {
        "type": "flattened"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/180.console"></div>
<p>Index a few documents containing your mapped fields. The <code class="literal">labels</code> field has
three sub-fields:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /my-index-000001/_bulk?refresh
{"index":{}}
{"title":"Something really urgent","labels":{"priority":"urgent","release":["v1.2.5","v1.3.0"],"timestamp":{"created":1541458026,"closed":1541457010}}}
{"index":{}}
{"title":"Somewhat less urgent","labels":{"priority":"high","release":["v1.3.0"],"timestamp":{"created":1541458026,"closed":1541457010}}}
{"index":{}}
{"title":"Not urgent","labels":{"priority":"low","release":["v1.2.0"],"timestamp":{"created":1541458026,"closed":1541457010}}}</pre>
</div>
<div class="console_widget" data-snippet="snippets/181.console"></div>
<p>Because <code class="literal">labels</code> is a <code class="literal">flattened</code> field type, the entire object is mapped as a
single field. To retrieve values from this sub-field in a Painless script, use
the <code class="literal">doc['&lt;field_name&gt;.&lt;sub-field_name&gt;'].value</code> format.</p>
<div class="pre_wrapper lang-painless">
<pre class="programlisting prettyprint lang-painless">"script": {
  "source": """
    if (doc['labels.release'].value.equals('v1.3.0'))
    {emit(doc['labels.release'].value)}
    else{emit('Version mismatch')}
  """</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="flattened-params"></a>Parameters for flattened object fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/flattened.asciidoc">edit</a></h3>
</div></div></div>
<p>The following mapping parameters are accepted:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<code class="literal">depth_limit</code>
</p>
</td>
<td valign="top">
<p>
The maximum allowed depth of the flattened object field, in terms of nested
inner objects. If a flattened object field exceeds this limit, then an
error will be thrown. Defaults to <code class="literal">20</code>. Note that <code class="literal">depth_limit</code> can be
updated dynamically through the <a class="xref" href="indices.html#indices-put-mapping" title="Update mapping API">update mapping</a> API.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be stored on disk in a column-stride fashion, so that it
can later be used for sorting, aggregations, or scripting? Accepts <code class="literal">true</code>
(default) or <code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#eager-global-ordinals" title="eager_global_ordinals"><code class="literal">eager_global_ordinals</code></a>
</p>
</td>
<td valign="top">
<p>
Should global ordinals be loaded eagerly on refresh? Accepts <code class="literal">true</code> or
<code class="literal">false</code> (default). Enabling this is a good idea on fields that are
frequently used for terms aggregations.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#ignore-above" title="ignore_above"><code class="literal">ignore_above</code></a>
</p>
</td>
<td valign="top">
<p>
Leaf values longer than this limit will not be indexed. By default, there
is no limit and all values will be indexed. Note that this limit applies
to the leaf values within the flattened object field, and not the length of
the entire field.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</p>
</td>
<td valign="top">
<p>
Determines if the field should be searchable. Accepts <code class="literal">true</code> (default) or
<code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#index-options" title="index_options"><code class="literal">index_options</code></a>
</p>
</td>
<td valign="top">
<p>
What information should be stored in the index for scoring purposes.
Defaults to <code class="literal">docs</code> but can also be set to <code class="literal">freqs</code> to take term frequency
into account when computing scores.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</p>
</td>
<td valign="top">
<p>
A string value which is substituted for any explicit <code class="literal">null</code> values within
the flattened object field. Defaults to <code class="literal">null</code>, which means null sields are
treated as if it were missing.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#similarity" title="similarity"><code class="literal">similarity</code></a>
</p>
</td>
<td valign="top">
<p>
Which scoring algorithm or <em>similarity</em> should be used. Defaults
to <code class="literal">BM25</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">split_queries_on_whitespace</code>
</p>
</td>
<td valign="top">
<p>
Whether <a class="xref" href="full-text-queries.html" title="Full text queries">full text queries</a> should split the input on
whitespace when building a query for this field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">time_series_dimensions</code>
</p>
</td>
<td valign="top">
<p>
(Optional, array of strings) A list of fields inside the flattened object, where each field is a dimension
of the time series. Each field is specified using the relative path from the
root field and does not include the root field name.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="flattened-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/flattened.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p>Flattened fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic`_source`</a> in their default
configuration. Synthetic <code class="literal">_source</code> cannot be used with <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
disabled.</p>
<p>Synthetic source always sorts alphabetically and de-duplicates flattened fields.
For example:</p>
<a id="synthetic-source-flattened-sorting-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "flattened": { "type": "flattened" }
    }
  }
}
PUT idx/_doc/1
{
  "flattened": {
    "field": [ "apple", "apple", "banana", "avocado", "10", "200", "AVOCADO", "Banana", "Tangerine" ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/182.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "flattened": {
    "field": [ "10", "200", "AVOCADO", "Banana", "Tangerine", "apple", "avocado", "banana" ]
  }
}</pre>
</div>
<p>Synthetic source always uses nested objects instead of array of objects.
For example:</p>
<a id="synthetic-source-flattened-array-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "flattened": { "type": "flattened" }
    }
  }
}
PUT idx/_doc/1
{
  "flattened": {
      "field": [
        { "id": 1, "name": "foo" },
        { "id": 2, "name": "bar" },
        { "id": 3, "name": "baz" }
      ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/183.console"></div>
<p>Will become (note the nested objects instead of the "flattened" array):</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
    "flattened": {
      "field": {
          "id": [ "1", "2", "3" ],
          "name": [ "bar", "baz", "foo" ]
      }
    }
}</pre>
</div>
<p>Synthetic source always uses single-valued fields for one-element arrays.
For example:</p>
<a id="synthetic-source-flattened-single-value-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "flattened": { "type": "flattened" }
    }
  }
}
PUT idx/_doc/1
{
  "flattened": {
    "field": [ "foo" ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/184.console"></div>
<p>Will become (note the nested objects instead of the "flattened" array):</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "flattened": {
    "field": "foo"
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="geo-point"></a>Geopoint field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-point.asciidoc">edit</a></h2>
</div></div></div>

<p>Fields of type <code class="literal">geo_point</code> accept latitude-longitude pairs, which can be used:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
to find geopoints within a <a class="xref" href="geo-queries.html#query-dsl-geo-bounding-box-query" title="Geo-bounding box query">bounding box</a>,
within a certain <a class="xref" href="geo-queries.html#query-dsl-geo-distance-query" title="Geo-distance query">distance</a> of a central point,
or within a <a class="xref" href="geo-queries.html#query-dsl-geo-shape-query" title="Geoshape query"><code class="literal">geo_shape</code> query</a> (for example, points in a polygon).
</li>
<li class="listitem">
to aggregate documents by <a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-geodistance-aggregation" title="Geo-distance aggregation">distance</a> from a central point.
</li>
<li class="listitem">
to aggregate documents by geographic grids: either
<a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-geohashgrid-aggregation" title="Geohash grid aggregation"><code class="literal">geo_hash</code></a>,
<a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-geotilegrid-aggregation" title="Geotile grid aggregation"><code class="literal">geo_tile</code></a> or
<a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-geohexgrid-aggregation" title="Geohex grid aggregation"><code class="literal">geo_hex</code></a>.
</li>
<li class="listitem">
to aggregate geopoints into a track using the metrics aggregation
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-geo-line" title="Geo-line aggregation"><code class="literal">geo_line</code></a>.
</li>
<li class="listitem">
to integrate distance into a document&#8217;s <a class="xref" href="compound-queries.html#query-dsl-function-score-query" title="Function score query">relevance score</a>.
</li>
<li class="listitem">
to <a class="xref" href="sort-search-results.html#geo-sorting" title="Geo Distance Sorting">sort</a> documents by distance.
</li>
</ul>
</div>
<p>As with <a class="xref" href="mapping-types.html#geo-shape" title="Geoshape field type">geo_shape</a> and <a class="xref" href="mapping-types.html#point" title="Point field type">point</a>, <code class="literal">geo_point</code> can be specified in <a href="http://geojson.org" class="ulink" target="_top">GeoJSON</a>
and <a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">Well-Known Text</a> formats.
However, there are a number of additional formats that are supported for convenience and historical reasons.
In total there are six ways that a geopoint may be specified, as demonstrated below:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "location": {
        "type": "geo_point"
      }
    }
  }
}

PUT my-index-000001/_doc/1
{
  "text": "Geopoint as an object using GeoJSON format",
  "location": { <a id="CO52-1"></a><i class="conum" data-value="1"></i>
    "type": "Point",
    "coordinates": [-71.34, 41.12]
  }
}

PUT my-index-000001/_doc/2
{
  "text": "Geopoint as a WKT POINT primitive",
  "location" : "POINT (-71.34 41.12)" <a id="CO52-2"></a><i class="conum" data-value="2"></i>
}

PUT my-index-000001/_doc/3
{
  "text": "Geopoint as an object with 'lat' and 'lon' keys",
  "location": { <a id="CO52-3"></a><i class="conum" data-value="3"></i>
    "lat": 41.12,
    "lon": -71.34
  }
}

PUT my-index-000001/_doc/4
{
  "text": "Geopoint as an array",
  "location": [ -71.34, 41.12 ] <a id="CO52-4"></a><i class="conum" data-value="4"></i>
}

PUT my-index-000001/_doc/5
{
  "text": "Geopoint as a string",
  "location": "41.12,-71.34" <a id="CO52-5"></a><i class="conum" data-value="5"></i>
}

PUT my-index-000001/_doc/6
{
  "text": "Geopoint as a geohash",
  "location": "drm3btev3e86" <a id="CO52-6"></a><i class="conum" data-value="6"></i>
}

GET my-index-000001/_search
{
  "query": {
    "geo_bounding_box": { <a id="CO52-7"></a><i class="conum" data-value="7"></i>
      "location": {
        "top_left": {
          "lat": 42,
          "lon": -72
        },
        "bottom_right": {
          "lat": 40,
          "lon": -74
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/185.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO52-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Geopoint expressed as an object, in <a href="https://geojson.org/" class="ulink" target="_top">GeoJSON</a> format, with <code class="literal">type</code> and <code class="literal">coordinates</code> keys.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO52-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Geopoint expressed as a <a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">Well-Known Text</a>
POINT with the format: <code class="literal">"POINT(lon lat)"</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO52-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Geopoint expressed as an object, with <code class="literal">lat</code> and <code class="literal">lon</code> keys.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO52-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Geopoint expressed as an array with the format: [ <code class="literal">lon</code>, <code class="literal">lat</code>]</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO52-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Geopoint expressed as a string with the format: <code class="literal">"lat,lon"</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO52-6"><i class="conum" data-value="6"></i></a></p>
</td>
<td align="left" valign="top">
<p>Geopoint expressed as a geohash.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO52-7"><i class="conum" data-value="7"></i></a></p>
</td>
<td align="left" valign="top">
<p>A geo-bounding box query which finds all geopoints that fall inside the box.</p>
</td>
</tr>
</table>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Geopoints expressed as an array or string</h3>
<p>Please note that string geopoints are ordered as <code class="literal">lat,lon</code>, while array
geopoints, GeoJSON and WKT are ordered as the reverse: <code class="literal">lon,lat</code>.</p>
<p>The reasons for this are historical. Geographers traditionally write <code class="literal">latitude</code>
before <code class="literal">longitude</code>, while recent formats specified for geographic data like
<a href="https://geojson.org/" class="ulink" target="_top">GeoJSON</a> and <a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">Well-Known Text</a>
order <code class="literal">longitude</code> before <code class="literal">latitude</code> (easting before northing) in order to match
the mathematical convention of ordering <code class="literal">x</code> before <code class="literal">y</code>.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>A point can be expressed as a <a href="https://en.wikipedia.org/wiki/Geohash" class="ulink" target="_top">geohash</a>.
Geohashes are <a href="https://en.wikipedia.org/wiki/Base32" class="ulink" target="_top">base32</a> encoded strings of
the bits of the latitude and longitude interleaved. Each character in a geohash
adds additional 5 bits to the precision. So the longer the hash, the more
precise it is. For the indexing purposed geohashs are translated into
latitude-longitude pairs. During this process only first 12 characters are
used, so specifying more than 12 characters in a geohash doesn&#8217;t increase the
precision. The 12 characters provide 60 bits, which should reduce a possible
error to less than 2cm.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="geo-point-params"></a>Parameters for <code class="literal">geo_point</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-point.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">geo_point</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>
</p>
</td>
<td valign="top">
<p>
If <code class="literal">true</code>, malformed geopoints are ignored. If <code class="literal">false</code> (default),
malformed geopoints throw an exception and reject the whole document.
A geopoint is considered malformed if its latitude is outside the range
-90 &#8656; latitude &#8656; 90, or if its longitude is outside the range -180 &#8656; longitude &#8656; 180.
Note that this cannot be set if the <code class="literal">script</code> parameter is used.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">ignore_z_value</code>
</p>
</td>
<td valign="top">
<p>
If <code class="literal">true</code> (default) three dimension points will be accepted (stored in source)
but only latitude and longitude values will be indexed; the third dimension is
ignored. If <code class="literal">false</code>, geopoints containing any more than latitude and longitude
(two dimensions) values throw an exception and reject the whole document. Note
that this cannot be set if the <code class="literal">script</code> parameter is used.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be quickly searchable? Accepts <code class="literal">true</code> (default) and
<code class="literal">false</code>. Fields that only have <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
enabled can still be queried, albeit slower.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</p>
</td>
<td valign="top">
<p>
Accepts an geopoint value which is substituted for any explicit <code class="literal">null</code> values.
Defaults to <code class="literal">null</code>, which means the field is treated as missing. Note that this
cannot be set if the <code class="literal">script</code> parameter is used.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">on_script_error</code>
</p>
</td>
<td valign="top">
<p>
Defines what to do if the script defined by the <code class="literal">script</code> parameter
throws an error at indexing time. Accepts <code class="literal">fail</code> (default), which
will cause the entire document to be rejected, and <code class="literal">continue</code>, which
will register the field in the document&#8217;s
<a class="xref" href="mapping-fields.html#mapping-ignored-field" title="_ignored field"><code class="literal">_ignored</code></a> metadata field and continue
indexing. This parameter can only be set if the <code class="literal">script</code> field is
also set.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">script</code>
</p>
</td>
<td valign="top">
<p>
If this parameter is set, then the field will index values generated
by this script, rather than reading the values directly from the
source. If a value is set for this field on the input document, then
the document will be rejected with an error.
Scripts are in the same format as their
<a class="xref" href="runtime.html#runtime-mapping-fields" title="Map a runtime field">runtime equivalent</a>, and should emit points
as a pair of (lat, lon) double values.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_using_geopoints_in_scripts"></a>Using geopoints in scripts<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-point.asciidoc">edit</a></h3>
</div></div></div>
<p>When accessing the value of a geopoint in a script, the value is returned as
a <code class="literal">GeoPoint</code> object, which allows access to the <code class="literal">.lat</code> and <code class="literal">.lon</code> values
respectively:</p>
<div class="pre_wrapper lang-painless">
<pre class="programlisting prettyprint lang-painless">def geopoint = doc['location'].value;
def lat      = geopoint.lat;
def lon      = geopoint.lon;</pre>
</div>
<p>For performance reasons, it is better to access the lat/lon values directly:</p>
<div class="pre_wrapper lang-painless">
<pre class="programlisting prettyprint lang-painless">def lat      = doc['location'].lat;
def lon      = doc['location'].lon;</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="geo-point-synthetic-source"></a>Synthetic source<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-point.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">geo_point</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> in their
default configuration. Synthetic <code class="literal">_source</code> cannot be used together with
<a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>, <a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a>, or with
<a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a> disabled.</p>
<p>Synthetic source always sorts <code class="literal">geo_point</code> fields (first by latitude and then
longitude) and reduces them to their stored precision. For example:</p>
<a id="synthetic-source-geo-point-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "point": { "type": "geo_point" }
    }
  }
}
PUT idx/_doc/1
{
  "point": [
    {"lat":-90, "lon":-80},
    {"lat":10, "lon":30}
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/186.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "point": [
    {"lat":-90.0, "lon":-80.00000000931323},
    {"lat":9.999999990686774, "lon":29.999999972060323}
   ]
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="geo-shape"></a>Geoshape field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">geo_shape</code> data type facilitates the indexing of and searching
with arbitrary geoshapes such as rectangles, lines and polygons. If the data being
indexed contains shapes other than just points, it is necessary to use this mapping.
If the data contains only points, it can be indexed as either
<a class="xref" href="mapping-types.html#geo-point" title="Geopoint field type"><code class="literal">geo_point</code></a> or <code class="literal">geo_shape</code>.</p>
<p>Documents using this type can be used:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>to find geoshapes within:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
a <a class="xref" href="geo-queries.html#query-dsl-geo-bounding-box-query" title="Geo-bounding box query">bounding box</a>
</li>
<li class="listitem">
a certain <a class="xref" href="geo-queries.html#query-dsl-geo-distance-query" title="Geo-distance query">distance</a> of a central point
</li>
<li class="listitem">
a <a class="xref" href="geo-queries.html#query-dsl-geo-shape-query" title="Geoshape query"><code class="literal">geo_shape</code> query</a> (for example, intersecting polygons).
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>to aggregate documents by geographic grids:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
either <a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-geohashgrid-aggregation" title="Geohash grid aggregation"><code class="literal">geo_hash</code></a>
</li>
<li class="listitem">
or <a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-geotilegrid-aggregation" title="Geotile grid aggregation"><code class="literal">geo_tile</code></a>.
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>Grid aggregations over <code class="literal">geo_hex</code> grids are not supported for <code class="literal">geo_shape</code> fields.</p>
<h4><a id="geo-shape-mapping-options"></a>Mapping Options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h4>
<p>The <code class="literal">geo_shape</code> mapping maps GeoJSON or WKT geometry objects to the <code class="literal">geo_shape</code>
type. To enable it, users must explicitly map fields to the <code class="literal">geo_shape</code>
type.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Option</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">orientation</code></p></td>
<td align="left" valign="top">
<p>Optional. Default <a class="xref" href="mapping-types.html#polygon-orientation" title="Polygon orientation">orientation</a> for the field&#8217;s
WKT polygons.</p>
<p>This parameter sets and returns only a <code class="literal">RIGHT</code> (counterclockwise) or <code class="literal">LEFT</code>
(clockwise) value. However, you can specify either value in multiple ways.</p>
<p>To set <code class="literal">RIGHT</code>, use one of the following arguments or its uppercase
variant:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">right</code>
</li>
<li class="listitem">
<code class="literal">counterclockwise</code>
</li>
<li class="listitem">
<code class="literal">ccw</code>
</li>
</ul>
</div>
<p>To set <code class="literal">LEFT</code>, use one of the following arguments or its uppercase
variant:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">left</code>
</li>
<li class="listitem">
<code class="literal">clockwise</code>
</li>
<li class="listitem">
<code class="literal">cw</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><code class="literal">RIGHT</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_malformed</code></p></td>
<td align="left" valign="top"><p>If true, malformed GeoJSON or WKT shapes are ignored. If
false (default), malformed GeoJSON and WKT shapes throw an exception and reject the
entire document.</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_z_value</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> (default) three dimension points will be accepted (stored in source)
but only latitude and longitude values will be indexed; the third dimension is ignored. If <code class="literal">false</code>,
geopoints containing any more than latitude and longitude (two dimensions) values throw an exception
and reject the whole document.</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">coerce</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> unclosed linear rings in polygons will be automatically closed.</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">index</code></p></td>
<td align="left" valign="top"><p>Should the field be quickly searchable? Accepts <code class="literal">true</code> (default) and <code class="literal">false</code>.
Fields that only have <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a> enabled can still be queried, albeit slower.</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">doc_values</code></p></td>
<td align="left" valign="top"><p>Should the field be stored on disk in a column-stride fashion,
so that it can later be used for aggregations or scripting?</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="geoshape-indexing-approach"></a>Indexing approach<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h4>
<p>Geoshape types are indexed by decomposing the shape into a triangular mesh and
indexing each triangle as a 7 dimension point in a BKD tree. This provides
near perfect spatial resolution (down to 1e-7 decimal degree precision) since all
spatial relations are computed using an encoded vector representation of the
original shape. Performance of the tessellator primarily
depends on the number of vertices that define the polygon/multi-polygon.</p>
<h5><a id="_example"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /example
{
  "mappings": {
    "properties": {
      "location": {
        "type": "geo_shape"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/187.console"></div>
<h4><a id="input-structure"></a>Input Structure<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h4>
<p>Shapes can be represented using either the <a href="http://geojson.org" class="ulink" target="_top">GeoJSON</a>
or <a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">Well-Known Text</a>
(WKT) format. The following table provides a mapping of GeoJSON and WKT
to Elasticsearch types:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">GeoJSON Type</th>
<th align="left" valign="top">WKT Type</th>
<th align="left" valign="top">Elasticsearch Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">Point</code></p></td>
<td align="left" valign="top"><p><code class="literal">POINT</code></p></td>
<td align="left" valign="top"><p><code class="literal">point</code></p></td>
<td align="left" valign="top"><p>A single geographic coordinate. Note: Elasticsearch uses WGS-84 coordinates only.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">LineString</code></p></td>
<td align="left" valign="top"><p><code class="literal">LINESTRING</code></p></td>
<td align="left" valign="top"><p><code class="literal">linestring</code></p></td>
<td align="left" valign="top"><p>An arbitrary line given two or more points.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">Polygon</code></p></td>
<td align="left" valign="top"><p><code class="literal">POLYGON</code></p></td>
<td align="left" valign="top"><p><code class="literal">polygon</code></p></td>
<td align="left" valign="top"><p>A <em>closed</em> polygon whose first and last point
must match, thus requiring <code class="literal">n + 1</code> vertices to create an <code class="literal">n</code>-sided
polygon and a minimum of <code class="literal">4</code> vertices.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">MultiPoint</code></p></td>
<td align="left" valign="top"><p><code class="literal">MULTIPOINT</code></p></td>
<td align="left" valign="top"><p><code class="literal">multipoint</code></p></td>
<td align="left" valign="top"><p>An array of unconnected, but likely related
points.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">MultiLineString</code></p></td>
<td align="left" valign="top"><p><code class="literal">MULTILINESTRING</code></p></td>
<td align="left" valign="top"><p><code class="literal">multilinestring</code></p></td>
<td align="left" valign="top"><p>An array of separate linestrings.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">MultiPolygon</code></p></td>
<td align="left" valign="top"><p><code class="literal">MULTIPOLYGON</code></p></td>
<td align="left" valign="top"><p><code class="literal">multipolygon</code></p></td>
<td align="left" valign="top"><p>An array of separate polygons.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">GeometryCollection</code></p></td>
<td align="left" valign="top"><p><code class="literal">GEOMETRYCOLLECTION</code></p></td>
<td align="left" valign="top"><p><code class="literal">geometrycollection</code></p></td>
<td align="left" valign="top"><p>A GeoJSON shape similar to the
<code class="literal">multi*</code> shapes except that multiple types can coexist (e.g., a Point
and a LineString).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">N/A</code></p></td>
<td align="left" valign="top"><p><code class="literal">BBOX</code></p></td>
<td align="left" valign="top"><p><code class="literal">envelope</code></p></td>
<td align="left" valign="top"><p>A bounding rectangle, or envelope, specified by
specifying only the top left and bottom right points.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For all types, both the inner <code class="literal">type</code> and <code class="literal">coordinates</code> fields are
required.</p>
<p>In GeoJSON and WKT, and therefore Elasticsearch, the correct <span class="strong strong"><strong>coordinate
order is longitude, latitude (X, Y)</strong></span> within coordinate arrays. This
differs from many Geospatial APIs (e.g., Google Maps) that generally
use the colloquial latitude, longitude (Y, X).</p>
</div>
</div>
<h5><a id="geo-point-type"></a><a href="http://geojson.org/geojson-spec.html#id2" class="ulink" target="_top">Point</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>A point is a single geographic coordinate, such as the location of a
building or the current position given by a smartphone&#8217;s Geolocation
API. The following is an example of a point in GeoJSON.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "Point",
    "coordinates" : [-77.03653, 38.897676]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/188.console"></div>
<p>The following is an example of a point in WKT:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "POINT (-77.03653 38.897676)"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/189.console"></div>
<h5><a id="geo-linestring"></a><a href="http://geojson.org/geojson-spec.html#id3" class="ulink" target="_top">LineString</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>A linestring defined by an array of two or more positions. By
specifying only two points, the linestring will represent a straight
line. Specifying more than two points creates an arbitrary path. The
following is an example of a linestring in GeoJSON.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "LineString",
    "coordinates" : [[-77.03653, 38.897676], [-77.009051, 38.889939]]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/190.console"></div>
<p>The following is an example of a linestring in WKT:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "LINESTRING (-77.03653 38.897676, -77.009051 38.889939)"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/191.console"></div>
<p>The above linestring would draw a straight line starting at the White
House to the US Capitol Building.</p>
<h5><a id="geo-polygon"></a><a href="http://geojson.org/geojson-spec.html#id4" class="ulink" target="_top">Polygon</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>A polygon is defined by a list of a list of points. The first and last
points in each (outer) list must be the same (the polygon must be
closed). The following is an example of a polygon in GeoJSON.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "Polygon",
    "coordinates" : [
      [ [100.0, 0.0], [101.0, 0.0], [101.0, 1.0], [100.0, 1.0], [100.0, 0.0] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/192.console"></div>
<p>The following is an example of a polygon in WKT:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "POLYGON ((100.0 0.0, 101.0 0.0, 101.0 1.0, 100.0 1.0, 100.0 0.0))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/193.console"></div>
<p>The first array represents the outer boundary of the polygon, the other
arrays represent the interior shapes ("holes"). The following is a GeoJSON example
of a polygon with a hole:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "Polygon",
    "coordinates" : [
      [ [100.0, 0.0], [101.0, 0.0], [101.0, 1.0], [100.0, 1.0], [100.0, 0.0] ],
      [ [100.2, 0.2], [100.8, 0.2], [100.8, 0.8], [100.2, 0.8], [100.2, 0.2] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/194.console"></div>
<p>The following is an example of a polygon with a hole in WKT:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "POLYGON ((100.0 0.0, 101.0 0.0, 101.0 1.0, 100.0 1.0, 100.0 0.0), (100.2 0.2, 100.8 0.2, 100.8 0.8, 100.2 0.8, 100.2 0.2))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/195.console"></div>
<h5><a id="polygon-orientation"></a>Polygon orientation<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>A polygon&#8217;s orientation indicates the order of its vertices: <code class="literal">RIGHT</code>
(counterclockwise) or <code class="literal">LEFT</code> (clockwise). Elasticsearch uses a polygon’s orientation to
determine if it crosses the international dateline (+/-180° longitude).</p>
<p>You can set a default orientation for WKT polygons using the
<a class="xref" href="mapping-types.html#geo-shape-mapping-options" title="Mapping Options"><code class="literal">orientation</code> mapping parameter</a>. This is because
the WKT specification doesn&#8217;t specify or enforce a default orientation.</p>
<p>GeoJSON polygons use a default orientation of <code class="literal">RIGHT</code>, regardless of
<code class="literal">orientation</code> mapping parameter&#8217;s value. This is because the
<a href="https://tools.ietf.org/html/rfc7946#section-3.1.6" class="ulink" target="_top">GeoJSON specification</a>
mandates that an outer polygon use a counterclockwise orientation and interior
shapes use a clockwise orientation.</p>
<p>You can override the default orientation for GeoJSON polygons using the
document-level <code class="literal">orientation</code> parameter. For example, the following indexing
request specifies a document-level <code class="literal">orientation</code> of <code class="literal">LEFT</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "Polygon",
    "orientation" : "LEFT",
    "coordinates" : [
      [ [-177.0, 10.0], [176.0, 15.0], [172.0, 0.0], [176.0, -15.0], [-177.0, -10.0], [-177.0, 10.0] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/196.console"></div>
<p>Elasticsearch only uses a polygon’s orientation to determine if it crosses the
international dateline. If the difference between a polygon’s minimum longitude
and the maximum longitude is less than 180°, the polygon doesn&#8217;t cross the
dateline and its orientation has no effect.</p>
<p>If the difference between a polygon’s minimum longitude and the maximum
longitude is 180° or greater, Elasticsearch checks whether the polygon&#8217;s document-level
<code class="literal">orientation</code> differs from the default orientation. If the orientation differs,
Elasticsearch considers the polygon to cross the international dateline and splits the
polygon at the dateline.</p>
<h5><a id="geo-multipoint"></a><a href="http://geojson.org/geojson-spec.html#id5" class="ulink" target="_top">MultiPoint</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>The following is an example of a list of GeoJSON points:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "MultiPoint",
    "coordinates" : [
      [102.0, 2.0], [103.0, 2.0]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/197.console"></div>
<p>The following is an example of a list of WKT points:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "MULTIPOINT (102.0 2.0, 103.0 2.0)"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/198.console"></div>
<h5><a id="geo-multilinestring"></a><a href="http://geojson.org/geojson-spec.html#id6" class="ulink" target="_top">MultiLineString</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>The following is an example of a list of GeoJSON linestrings:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "MultiLineString",
    "coordinates" : [
      [ [102.0, 2.0], [103.0, 2.0], [103.0, 3.0], [102.0, 3.0] ],
      [ [100.0, 0.0], [101.0, 0.0], [101.0, 1.0], [100.0, 1.0] ],
      [ [100.2, 0.2], [100.8, 0.2], [100.8, 0.8], [100.2, 0.8] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/199.console"></div>
<p>The following is an example of a list of WKT linestrings:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "MULTILINESTRING ((102.0 2.0, 103.0 2.0, 103.0 3.0, 102.0 3.0), (100.0 0.0, 101.0 0.0, 101.0 1.0, 100.0 1.0), (100.2 0.2, 100.8 0.2, 100.8 0.8, 100.2 0.8))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/200.console"></div>
<h5><a id="geo-multipolygon"></a><a href="http://geojson.org/geojson-spec.html#id7" class="ulink" target="_top">MultiPolygon</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>The following is an example of a list of GeoJSON polygons (second polygon contains a hole):</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "MultiPolygon",
    "coordinates" : [
      [ [[102.0, 2.0], [103.0, 2.0], [103.0, 3.0], [102.0, 3.0], [102.0, 2.0]] ],
      [ [[100.0, 0.0], [101.0, 0.0], [101.0, 1.0], [100.0, 1.0], [100.0, 0.0]],
        [[100.2, 0.2], [100.8, 0.2], [100.8, 0.8], [100.2, 0.8], [100.2, 0.2]] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/201.console"></div>
<p>The following is an example of a list of WKT polygons (second polygon contains a hole):</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "MULTIPOLYGON (((102.0 2.0, 103.0 2.0, 103.0 3.0, 102.0 3.0, 102.0 2.0)), ((100.0 0.0, 101.0 0.0, 101.0 1.0, 100.0 1.0, 100.0 0.0), (100.2 0.2, 100.8 0.2, 100.8 0.8, 100.2 0.8, 100.2 0.2)))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/202.console"></div>
<h5><a id="geo-geometry_collection"></a><a href="http://geojson.org/geojson-spec.html#geometrycollection" class="ulink" target="_top">Geometry Collection</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>The following is an example of a collection of GeoJSON geometry objects:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type": "GeometryCollection",
    "geometries": [
      {
        "type": "Point",
        "coordinates": [100.0, 0.0]
      },
      {
        "type": "LineString",
        "coordinates": [ [101.0, 0.0], [102.0, 1.0] ]
      }
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/203.console"></div>
<p>The following is an example of a collection of WKT geometry objects:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "GEOMETRYCOLLECTION (POINT (100.0 0.0), LINESTRING (101.0 0.0, 102.0 1.0))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/204.console"></div>
<h5><a id="_envelope"></a>Envelope<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>Elasticsearch supports an <code class="literal">envelope</code> type, which consists of coordinates
for upper left and lower right points of the shape to represent a
bounding rectangle in the format <code class="literal">[[minLon, maxLat], [maxLon, minLat]]</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "envelope",
    "coordinates" : [ [100.0, 1.0], [101.0, 0.0] ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/205.console"></div>
<p>The following is an example of an envelope using the WKT BBOX format:</p>
<p><span class="strong strong"><strong>NOTE:</strong></span> WKT specification expects the following order: minLon, maxLon, maxLat, minLat.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "BBOX (100.0, 102.0, 2.0, 0.0)"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/206.console"></div>
<h5><a id="_circle"></a>Circle<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h5>
<p>Neither GeoJSON nor WKT supports a point-radius circle type. Instead, use a
<a class="xref" href="processors.html#ingest-circle-processor" title="Circle processor">circle ingest processor</a> to approximate the circle as
a <a class="xref" href="mapping-types.html#geo-polygon" title="Polygon"><code class="literal">polygon</code></a>.</p>
<h4><a id="_sorting_and_retrieving_index_shapes"></a>Sorting and Retrieving index Shapes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/geo-shape.asciidoc">edit</a></h4>
<p>Due to the complex input structure and index representation of shapes,
it is not currently possible to sort shapes or retrieve their fields
directly. The <code class="literal">geo_shape</code> value is only retrievable through the <code class="literal">_source</code>
field.</p>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="histogram"></a>Histogram field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/histogram.asciidoc">edit</a></h2>
</div></div></div>

<p>A field to store pre-aggregated numerical data representing a histogram.
This data is defined using two paired arrays:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A <code class="literal">values</code> array of <a class="xref" href="mapping-types.html#number" title="Numeric field types"><code class="literal">double</code></a> numbers, representing the buckets for
the histogram. These values must be provided in ascending order.
</li>
<li class="listitem">
A corresponding <code class="literal">counts</code> array of <a class="xref" href="mapping-types.html#number" title="Numeric field types"><code class="literal">integer</code></a> numbers, representing how
many values fall into each bucket. These numbers must be positive or zero.
</li>
</ul>
</div>
<p>Because the elements in the <code class="literal">values</code> array correspond to the elements in the
same position of the <code class="literal">count</code> array, these two arrays must have the same length.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A <code class="literal">histogram</code> field can only store a single pair of <code class="literal">values</code> and <code class="literal">count</code> arrays
per document. Nested arrays are not supported.
</li>
<li class="listitem">
<code class="literal">histogram</code> fields do not support sorting.
</li>
</ul>
</div>
</div>
</div>
<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="histogram-uses"></a>Uses<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/histogram.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">histogram</code> fields are primarily intended for use with aggregations. To make it
more readily accessible for aggregations, <code class="literal">histogram</code> field data is stored as a
binary <a class="xref" href="mapping-params.html#doc-values" title="doc_values">doc values</a> and not indexed. Its size in bytes is at most
<code class="literal">13 * numValues</code>, where <code class="literal">numValues</code> is the length of the provided arrays.</p>
<p>Because the data is not indexed, you only can use <code class="literal">histogram</code> fields for the
following aggregations and queries:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-min-aggregation-histogram-fields" title="Histogram fields">min</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-max-aggregation-histogram-fields" title="Histogram fields">max</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-sum-aggregation-histogram-fields" title="Histogram fields">sum</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-valuecount-aggregation-histogram-fields" title="Histogram fields">value_count</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-avg-aggregation-histogram-fields" title="Histogram fields">avg</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-percentile-aggregation" title="Percentiles aggregation">percentiles</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-percentile-rank-aggregation" title="Percentile ranks aggregation">percentile ranks</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-boxplot-aggregation" title="Boxplot aggregation">boxplot</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-histogram-aggregation-histogram-fields" title="Histogram fields">histogram</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-range-aggregation-histogram-fields" title="Histogram fields">range</a> aggregation
</li>
<li class="listitem">
<a class="xref" href="term-level-queries.html#query-dsl-exists-query" title="Exists query">exists</a> query
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="mapping-types-histogram-building-histogram"></a>Building a histogram<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/histogram.asciidoc">edit</a></h3>
</div></div></div>
<p>When using a histogram as part of an aggregation, the accuracy of the results will depend on how the
histogram was constructed. It is important to consider the percentiles aggregation mode that will be used
to build it. Some possibilities include:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For the <a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-percentile-aggregation" title="Percentiles aggregation">T-Digest</a> mode, the <code class="literal">values</code> array represents
the mean centroid positions and the <code class="literal">counts</code> array represents the number of values that are attributed to each
centroid. If the algorithm has already started to approximate the percentiles, this inaccuracy is
carried over in the histogram.
</li>
<li class="listitem">
For the <a class="xref" href="search-aggregations-metrics.html#_hdr_histogram" title="HDR Histogram">High Dynamic Range (HDR)</a> histogram mode, the <code class="literal">values</code> array represents fixed upper
limits of each bucket interval, and the <code class="literal">counts</code> array represents the number of values that are attributed to each
interval. This implementation maintains a fixed worse-case percentage error (specified as a number of significant digits),
therefore the value used when generating the histogram would be the maximum accuracy you can achieve at aggregation time.
</li>
</ul>
</div>
<p>The histogram field is "algorithm agnostic" and does not store data specific to either T-Digest or HDRHistogram. While this
means the field can technically be aggregated with either algorithm, in practice the user should chose one algorithm and
index data in that manner (e.g. centroids for T-Digest or intervals for HDRHistogram) to ensure best accuracy.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="histogram-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/histogram.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">histogram</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> in their
default configuration. Synthetic <code class="literal">_source</code> cannot be used together with
<a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a> or <a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To save space, zero-count buckets are not stored in the histogram doc values.
As a result, when indexing a histogram field in an index with synthetic source enabled,
indexing a histogram including zero-count buckets will result in missing buckets when
fetching back the histogram.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="histogram-ex"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/histogram.asciidoc">edit</a></h3>
</div></div></div>
<p>The following <a class="xref" href="indices.html#indices-create-index" title="Create index API">create index</a> API request creates a new index with two field mappings:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">my_histogram</code>, a <code class="literal">histogram</code> field used to store percentile data
</li>
<li class="listitem">
<code class="literal">my_text</code>, a <code class="literal">keyword</code> field used to store a title for the histogram
</li>
</ul>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings" : {
    "properties" : {
      "my_histogram" : {
        "type" : "histogram"
      },
      "my_text" : {
        "type" : "keyword"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/207.console"></div>
<p>The following <a class="xref" href="docs.html#docs-index_" title="Index API">index</a> API requests store pre-aggregated for
two histograms: <code class="literal">histogram_1</code> and <code class="literal">histogram_2</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/1
{
  "my_text" : "histogram_1",
  "my_histogram" : {
      "values" : [0.1, 0.2, 0.3, 0.4, 0.5], <a id="CO53-1"></a><i class="conum" data-value="1"></i>
      "counts" : [3, 7, 23, 12, 6] <a id="CO53-2"></a><i class="conum" data-value="2"></i>
   }
}

PUT my-index-000001/_doc/2
{
  "my_text" : "histogram_2",
  "my_histogram" : {
      "values" : [0.1, 0.25, 0.35, 0.4, 0.45, 0.5], <a id="CO53-3"></a><i class="conum" data-value="1"></i>
      "counts" : [8, 17, 8, 7, 6, 2] <a id="CO53-4"></a><i class="conum" data-value="2"></i>
   }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/208.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO53-1"><i class="conum" data-value="1"></i></a><a href="#CO53-3"></a></p>
</td>
<td align="left" valign="top">
<p>Values for each bucket. Values in the array are treated as doubles and must be given in
increasing order. For <a class="xref" href="search-aggregations-metrics.html#search-aggregations-metrics-percentile-aggregation-approximation" title="Percentiles are (usually) approximate">T-Digest</a>
histograms this value represents the mean value. In case of HDR histograms this represents the value iterated to.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO53-2"><i class="conum" data-value="2"></i></a><a href="#CO53-4"></a></p>
</td>
<td align="left" valign="top">
<p>Count for each bucket. Values in the arrays are treated as integers and must be positive or zero.
Negative values will be rejected. The relation between a bucket and a count is given by the position in the array.</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ip"></a>IP field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/ip.asciidoc">edit</a></h2>
</div></div></div>

<p>An <code class="literal">ip</code> field can index/store either <a href="https://en.wikipedia.org/wiki/IPv4" class="ulink" target="_top">IPv4</a> or
<a href="https://en.wikipedia.org/wiki/IPv6" class="ulink" target="_top">IPv6</a> addresses.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "ip_addr": {
        "type": "ip"
      }
    }
  }
}

PUT my-index-000001/_doc/1
{
  "ip_addr": "192.168.1.1"
}

GET my-index-000001/_search
{
  "query": {
    "term": {
      "ip_addr": "192.168.0.0/16"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/209.console"></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also store ip ranges in a single field using an <a class="xref" href="mapping-types.html#range" title="Range field types">ip_range data type</a>.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ip-params"></a>Parameters for <code class="literal">ip</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/ip.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">ip</code> fields:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
</span>
</dt>
<dd>
Should the field be stored on disk in a column-stride fashion, so that it
can later be used for sorting, aggregations, or scripting? Accepts <code class="literal">true</code>
(default) or <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>
</span>
</dt>
<dd>
If <code class="literal">true</code>, malformed IP addresses are ignored. If <code class="literal">false</code> (default), malformed
IP addresses throw an exception and reject the whole document. Note that this
cannot be set if the <code class="literal">script</code> parameter is used.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</span>
</dt>
<dd>
Should the field be quickly searchable? Accepts <code class="literal">true</code> (default) and
<code class="literal">false</code>. Fields that only have <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
enabled can still be queried using term or range-based queries,
albeit slower.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</span>
</dt>
<dd>
Accepts an IPv4 or IPv6 value which is substituted for any explicit <code class="literal">null</code> values.
Defaults to <code class="literal">null</code>, which means the field is treated as missing. Note that
this cannot be set if the <code class="literal">script</code> parameter is used.
</dd>
<dt>
<span class="term">
<code class="literal">on_script_error</code>
</span>
</dt>
<dd>
Defines what to do if the script defined by the <code class="literal">script</code> parameter
throws an error at indexing time. Accepts <code class="literal">reject</code> (default), which
will cause the entire document to be rejected, and <code class="literal">ignore</code>, which
will register the field in the document&#8217;s
<a class="xref" href="mapping-fields.html#mapping-ignored-field" title="_ignored field"><code class="literal">_ignored</code></a> metadata field and continue
indexing. This parameter can only be set if the <code class="literal">script</code> field is
also set.
</dd>
<dt>
<span class="term">
<code class="literal">script</code>
</span>
</dt>
<dd>
If this parameter is set, then the field will index values generated
by this script, rather than reading the values directly from the
source. If a value is set for this field on the input document, then
the document will be rejected with an error.
Scripts are in the same format as their
<a class="xref" href="runtime.html#runtime-mapping-fields" title="Map a runtime field">runtime equivalent</a>, and should emit strings
containing IPv4 or IPv6 formatted addresses.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</span>
</dt>
<dd>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</dd>
<dt>
<span class="term">
<code class="literal">time_series_dimension</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
</p>
<p>Marks the field as a <a class="xref" href="tsds.html#time-series-dimension" title="Dimensions">time series dimension</a>. Defaults
to <code class="literal">false</code>.</p>
<p>The
<a class="xref" href="tsds.html#index-mapping-dimension-fields-limit"><code class="literal">index.mapping.dimension_fields.limit</code></a>
index setting limits the number of dimensions in an index.</p>
<p>Dimension fields have the following constraints:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">doc_values</code> and <code class="literal">index</code> mapping parameters must be <code class="literal">true</code>.
</li>
<li class="listitem">
Field values cannot be an <a class="xref" href="mapping-types.html#array" title="Arrays">array or multi-value</a>.
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="query-ip-fields"></a>Querying <code class="literal">ip</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/ip.asciidoc">edit</a></h3>
</div></div></div>
<p>The most common way to query ip addresses is to use the
<a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation" class="ulink" target="_top">CIDR</a>
notation: <code class="literal">[ip_address]/[prefix_length]</code>. For instance:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search
{
  "query": {
    "term": {
      "ip_addr": "192.168.0.0/16"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/210.console"></div>
<p>or</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search
{
  "query": {
    "term": {
      "ip_addr": "2001:db8::/48"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/211.console"></div>
<p>Also beware that colons are special characters to the
<a class="xref" href="full-text-queries.html#query-dsl-query-string-query" title="Query string query"><code class="literal">query_string</code></a> query, so ipv6 addresses will
need to be escaped. The easiest way to do so is to put quotes around the
searched value:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search
{
  "query": {
    "query_string" : {
      "query": "ip_addr:\"2001:db8::/48\""
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/212.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ip-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/ip.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">ip</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> in their default
configuration. Synthetic <code class="literal">_source</code> cannot be used together with
<a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a> or with <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a> disabled.</p>
<p>Synthetic source always sorts <code class="literal">ip</code> fields and removes duplicates. For example:</p>
<a id="synthetic-source-ip-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "ip": { "type": "ip" }
    }
  }
}
PUT idx/_doc/1
{
  "ip": ["192.168.0.1", "192.168.0.1", "10.10.12.123",
         "2001:db8::1:0:0:1", "::afff:4567:890a"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/213.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "ip": ["::afff:4567:890a", "10.10.12.123", "192.168.0.1", "2001:db8::1:0:0:1"]
}</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>IPv4 addresses are sorted as though they were IPv6 addresses prefixed by
      <code class="literal">::ffff:0:0:0/96</code> as specified by
      <a href="https://datatracker.ietf.org/doc/html/rfc6144" class="ulink" target="_top">rfc6144</a>.</p>
</div>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="parent-join"></a>Join field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/parent-join.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">join</code> data type is a special field that creates
parent/child relation within documents of the same index.
The <code class="literal">relations</code> section defines a set of possible relations within the documents,
each relation being a parent name and a child name.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>We don&#8217;t recommend using multiple levels of relations to replicate a
relational model. Each level of relation adds an overhead at query time in terms
of memory and computation. For better search performance, denormalize your data
instead.</p>
</div>
</div>
<p>A parent/child relation can be defined as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "my_id": {
        "type": "keyword"
      },
      "my_join_field": { <a id="CO54-1"></a><i class="conum" data-value="1"></i>
        "type": "join",
        "relations": {
          "question": "answer" <a id="CO54-2"></a><i class="conum" data-value="2"></i>
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/214.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO54-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The name for the field</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO54-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Defines a single relation where <code class="literal">question</code> is parent of <code class="literal">answer</code>.</p>
</td>
</tr>
</table>
</div>
<p>To index a document with a join, the name of the relation and the optional parent
of the document must be provided in the <code class="literal">source</code>.
For instance the following example creates two <code class="literal">parent</code> documents in the <code class="literal">question</code> context:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/1?refresh
{
  "my_id": "1",
  "text": "This is a question",
  "my_join_field": {
    "name": "question" <a id="CO55-1"></a><i class="conum" data-value="1"></i>
  }
}

PUT my-index-000001/_doc/2?refresh
{
  "my_id": "2",
  "text": "This is another question",
  "my_join_field": {
    "name": "question"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/215.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO55-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document is a <code class="literal">question</code> document.</p>
</td>
</tr>
</table>
</div>
<p>When indexing parent documents, you can choose to specify just the name of the relation
as a shortcut instead of encapsulating it in the normal object notation:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/1?refresh
{
  "my_id": "1",
  "text": "This is a question",
  "my_join_field": "question" <a id="CO56-1"></a><i class="conum" data-value="1"></i>
}

PUT my-index-000001/_doc/2?refresh
{
  "my_id": "2",
  "text": "This is another question",
  "my_join_field": "question"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/216.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO56-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Simpler notation for a parent document just uses the relation name.</p>
</td>
</tr>
</table>
</div>
<p>When indexing a child, the name of the relation as well as the parent id of the document
must be added in the <code class="literal">_source</code>.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>It is required to index the lineage of a parent in the same shard so you must
always route child documents using their greater parent id.</p>
</div>
</div>
<p>For instance the following example shows how to index two <code class="literal">child</code> documents:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/3?routing=1&amp;refresh <a id="CO57-1"></a><i class="conum" data-value="1"></i>
{
  "my_id": "3",
  "text": "This is an answer",
  "my_join_field": {
    "name": "answer", <a id="CO57-2"></a><i class="conum" data-value="2"></i>
    "parent": "1" <a id="CO57-3"></a><i class="conum" data-value="3"></i>
  }
}

PUT my-index-000001/_doc/4?routing=1&amp;refresh
{
  "my_id": "4",
  "text": "This is another answer",
  "my_join_field": {
    "name": "answer",
    "parent": "1"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/217.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO57-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The routing value is mandatory because parent and child documents must be indexed on the same shard</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO57-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">answer</code> is the name of the join for this document</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO57-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The parent id of this child document</p>
</td>
</tr>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_parent_join_and_performance"></a>Parent-join and performance<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/parent-join.asciidoc">edit</a></h3>
</div></div></div>
<p>The join field shouldn&#8217;t be used like joins in a relation database. In Elasticsearch the key to good performance
is to de-normalize your data into documents. Each join field, <code class="literal">has_child</code> or <code class="literal">has_parent</code> query adds a
significant tax to your query performance. It can also trigger <a class="xref" href="mapping-params.html#eager-global-ordinals" title="eager_global_ordinals">global ordinals</a> to be built.</p>
<p>The only case where the join field makes sense is if your data contains a one-to-many relationship where
one entity significantly outnumbers the other entity. An example of such case is a use case with products
and offers for these products. In the case that offers significantly outnumbers the number of products then
it makes sense to model the product as parent document and the offer as child document.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_parent_join_restrictions"></a>Parent-join restrictions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/parent-join.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Only one <code class="literal">join</code> field mapping is allowed per index.
</li>
<li class="listitem">
Parent and child documents must be indexed on the same shard.
This means that the same <code class="literal">routing</code> value needs to be provided when
<a class="xref" href="docs.html#docs-get" title="Get API">getting</a>, <a class="xref" href="docs.html#docs-delete" title="Delete API">deleting</a>, or <a class="xref" href="docs.html#docs-update" title="Update API">updating</a>
a child document.
</li>
<li class="listitem">
An element can have multiple children but only one parent.
</li>
<li class="listitem">
It is possible to add a new relation to an existing <code class="literal">join</code> field.
</li>
<li class="listitem">
It is also possible to add a child to an existing element
but only if the element is already a parent.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_searching_with_parent_join"></a>Searching with parent-join<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/parent-join.asciidoc">edit</a></h3>
</div></div></div>
<p>The parent-join creates one field to index the name of the relation
within the document (<code class="literal">my_parent</code>, <code class="literal">my_child</code>, &#8230;&#8203;).</p>
<p>It also creates one field per parent/child relation.
The name of this field is the name of the <code class="literal">join</code> field followed by <code class="literal">#</code> and the
name of the parent in the relation.
So for instance for the <code class="literal">my_parent</code> &#8594; [<code class="literal">my_child</code>, <code class="literal">another_child</code>] relation,
the <code class="literal">join</code> field creates an additional field named <code class="literal">my_join_field#my_parent</code>.</p>
<p>This field contains the parent <code class="literal">_id</code> that the document links to
if the document is a child (<code class="literal">my_child</code> or <code class="literal">another_child</code>) and the <code class="literal">_id</code> of
document if it&#8217;s a parent (<code class="literal">my_parent</code>).</p>
<p>When searching an index that contains a <code class="literal">join</code> field, these two fields are always
returned in the search response:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search
{
  "query": {
    "match_all": {}
  },
  "sort": ["my_id"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/218.console"></div>
<p>Will return:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  ...,
  "hits": {
    "total": {
      "value": 4,
      "relation": "eq"
    },
    "max_score": null,
    "hits": [
      {
        "_index": "my-index-000001",
        "_id": "1",
        "_score": null,
        "_source": {
          "my_id": "1",
          "text": "This is a question",
          "my_join_field": "question"         <a id="CO58-1"></a><i class="conum" data-value="1"></i>
        },
        "sort": [
          "1"
        ]
      },
      {
        "_index": "my-index-000001",
        "_id": "2",
        "_score": null,
        "_source": {
          "my_id": "2",
          "text": "This is another question",
          "my_join_field": "question"          <a id="CO58-2"></a><i class="conum" data-value="2"></i>
        },
        "sort": [
          "2"
        ]
      },
      {
        "_index": "my-index-000001",
        "_id": "3",
        "_score": null,
        "_routing": "1",
        "_source": {
          "my_id": "3",
          "text": "This is an answer",
          "my_join_field": {
            "name": "answer",                 <a id="CO58-3"></a><i class="conum" data-value="3"></i>
            "parent": "1"                     <a id="CO58-4"></a><i class="conum" data-value="4"></i>
          }
        },
        "sort": [
          "3"
        ]
      },
      {
        "_index": "my-index-000001",
        "_id": "4",
        "_score": null,
        "_routing": "1",
        "_source": {
          "my_id": "4",
          "text": "This is another answer",
          "my_join_field": {
            "name": "answer",
            "parent": "1"
          }
        },
        "sort": [
          "4"
        ]
      }
    ]
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO58-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document belongs to the <code class="literal">question</code> join</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO58-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document belongs to the <code class="literal">question</code> join</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO58-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>This document belongs to the <code class="literal">answer</code> join</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO58-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>The linked parent id for the child document</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_parent_join_queries_and_aggregations"></a>Parent-join queries and aggregations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/parent-join.asciidoc">edit</a></h3>
</div></div></div>
<p>See the <a class="xref" href="joining-queries.html#query-dsl-has-child-query" title="Has child query"><code class="literal">has_child</code></a> and
<a class="xref" href="joining-queries.html#query-dsl-has-parent-query" title="Has parent query"><code class="literal">has_parent</code></a> queries,
the <a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-children-aggregation" title="Children aggregation"><code class="literal">children</code></a> aggregation,
and <a class="xref" href="inner-hits.html#parent-child-inner-hits" title="Parent/child inner hits">inner hits</a> for more information.</p>
<p>The value of the <code class="literal">join</code> field is accessible in aggregations
and scripts, and may be queried with the
<a class="xref" href="joining-queries.html#query-dsl-parent-id-query" title="Parent ID query"><code class="literal">parent_id</code> query</a>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search
{
  "query": {
    "parent_id": { <a id="CO59-1"></a><i class="conum" data-value="1"></i>
      "type": "answer",
      "id": "1"
    }
  },
  "aggs": {
    "parents": {
      "terms": {
        "field": "my_join_field#question", <a id="CO59-2"></a><i class="conum" data-value="2"></i>
        "size": 10
      }
    }
  },
  "runtime_mappings": {
    "parent": {
      "type": "long",
      "script": """
        emit(Integer.parseInt(doc['my_join_field#question'].value)) <a id="CO59-3"></a><i class="conum" data-value="3"></i>
      """
    }
  },
  "fields": [
    { "field": "parent" }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/219.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO59-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Querying the <code class="literal">parent id</code> field (also see the <a class="xref" href="joining-queries.html#query-dsl-has-parent-query" title="Has parent query"><code class="literal">has_parent</code> query</a> and the <a class="xref" href="joining-queries.html#query-dsl-has-child-query" title="Has child query"><code class="literal">has_child</code> query</a>)</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO59-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Aggregating on the <code class="literal">parent id</code> field (also see the <a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-children-aggregation" title="Children aggregation"><code class="literal">children</code></a> aggregation)</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO59-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Accessing the <code class="literal">parent id</code> field in scripts.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_global_ordinals"></a>Global ordinals<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/parent-join.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">join</code> field uses <a class="xref" href="mapping-params.html#eager-global-ordinals" title="eager_global_ordinals">global ordinals</a> to speed up joins.
Global ordinals need to be rebuilt after any change to a shard. The more
parent id values are stored in a shard, the longer it takes to rebuild the
global ordinals for the <code class="literal">join</code> field.</p>
<p>Global ordinals, by default, are built eagerly: if the index has changed,
global ordinals for the <code class="literal">join</code> field will be rebuilt as part of the refresh.
This can add significant time to the refresh. However most of the times this is the
right trade-off, otherwise global ordinals are rebuilt when the first parent-join
query or aggregation is used. This can introduce a significant latency spike for
your users and usually this is worse as multiple global ordinals for the <code class="literal">join</code>
field may be attempt rebuilt within a single refresh interval when many writes
are occurring.</p>
<p>When the <code class="literal">join</code> field is used infrequently and writes occur frequently it may
make sense to disable eager loading:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "my_join_field": {
        "type": "join",
        "relations": {
           "question": "answer"
        },
        "eager_global_ordinals": false
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/220.console"></div>
<p>The amount of heap used by global ordinals can be checked per parent relation
as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console"># Per-index
GET _stats/fielddata?human&amp;fields=my_join_field#question

# Per-node per-index
GET _nodes/stats/indices/fielddata?human&amp;fields=my_join_field#question</pre>
</div>
<div class="console_widget" data-snippet="snippets/221.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_multiple_children_per_parent"></a>Multiple children per parent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/parent-join.asciidoc">edit</a></h3>
</div></div></div>
<p>It is also possible to define multiple children for a single parent:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "my_join_field": {
        "type": "join",
        "relations": {
          "question": ["answer", "comment"]  <a id="CO60-1"></a><i class="conum" data-value="1"></i>
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/222.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO60-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">question</code> is parent of <code class="literal">answer</code> and <code class="literal">comment</code>.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_multiple_levels_of_parent_join"></a>Multiple levels of parent join<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/parent-join.asciidoc">edit</a></h3>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>We don&#8217;t recommend using multiple levels of relations to replicate a
relational model. Each level of relation adds an overhead at query time in terms
of memory and computation. For better search performance, denormalize your data
instead.</p>
</div>
</div>
<p>Multiple levels of parent/child:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "my_join_field": {
        "type": "join",
        "relations": {
          "question": ["answer", "comment"],  <a id="CO61-1"></a><i class="conum" data-value="1"></i>
          "answer": "vote" <a id="CO61-2"></a><i class="conum" data-value="2"></i>
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/223.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO61-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">question</code> is parent of <code class="literal">answer</code> and <code class="literal">comment</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO61-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">answer</code> is parent of <code class="literal">vote</code></p>
</td>
</tr>
</table>
</div>
<p>The mapping above represents the following tree:</p>
<pre class="literallayout">   question
    /    \
   /      \
comment  answer
           |
           |
          vote</pre>

<p>Indexing a grandchild document requires a <code class="literal">routing</code> value equals
to the grand-parent (the greater parent of the lineage):</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/3?routing=1&amp;refresh <a id="CO62-1"></a><i class="conum" data-value="1"></i>
{
  "text": "This is a vote",
  "my_join_field": {
    "name": "vote",
    "parent": "2" <a id="CO62-2"></a><i class="conum" data-value="2"></i>
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/224.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO62-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This child document must be on the same shard than its grand-parent and parent</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO62-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The parent id of this document (must points to an <code class="literal">answer</code> document)</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="keyword"></a>Keyword type family<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/keyword.asciidoc">edit</a></h2>
</div></div></div>

<p>The keyword family includes the following field types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="mapping-types.html#keyword-field-type" title="Keyword field type"><code class="literal">keyword</code></a>, which is used for structured content such as IDs, email
addresses, hostnames, status codes, zip codes, or tags.
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#constant-keyword-field-type" title="Constant keyword field type"><code class="literal">constant_keyword</code></a> for keyword fields that always contain
the same value.
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#wildcard-field-type" title="Wildcard field type"><code class="literal">wildcard</code></a> for unstructured machine-generated content.
The <code class="literal">wildcard</code> type is optimized for fields with large values or high
cardinality.
</li>
</ul>
</div>
<p>Keyword fields are often used in <a class="xref" href="sort-search-results.html" title="Sort search results">sorting</a>,
<a class="xref" href="search-aggregations.html" title="Aggregations">aggregations</a>, and <a class="xref" href="term-level-queries.html" title="Term-level queries">term-level
queries</a>, such as <a class="xref" href="term-level-queries.html#query-dsl-term-query" title="Term query"><code class="literal">term</code></a>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Avoid using keyword fields for full-text search. Use the <a class="xref" href="mapping-types.html#text" title="Text type family"><code class="literal">text</code></a>
field type instead.</p>
</div>
</div>
<h3><a id="keyword-field-type"></a>Keyword field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/keyword.asciidoc">edit</a></h3>
<p>Below is an example of a mapping for a basic <code class="literal">keyword</code> field:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "tags": {
        "type":  "keyword"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/225.console"></div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Mapping numeric identifiers</h3>
<p>Not all numeric data should be mapped as a <a class="xref" href="mapping-types.html#number" title="Numeric field types">numeric</a> field data type.
Elasticsearch optimizes numeric fields, such as <code class="literal">integer</code> or <code class="literal">long</code>, for
<a class="xref" href="term-level-queries.html#query-dsl-range-query" title="Range query"><code class="literal">range</code></a> queries. However, <a class="xref" href="mapping-types.html#keyword" title="Keyword type family"><code class="literal">keyword</code></a> fields
are better for <a class="xref" href="term-level-queries.html#query-dsl-term-query" title="Term query"><code class="literal">term</code></a> and other
<a class="xref" href="term-level-queries.html" title="Term-level queries">term-level</a> queries.</p>
<p>Identifiers, such as an ISBN or a product ID, are rarely used in <code class="literal">range</code>
queries. However, they are often retrieved using term-level queries.</p>
<p>Consider mapping a numeric identifier as a <code class="literal">keyword</code> if:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You don&#8217;t plan to search for the identifier data using
<a class="xref" href="term-level-queries.html#query-dsl-range-query" title="Range query"><code class="literal">range</code></a> queries.
</li>
<li class="listitem">
Fast retrieval is important. <code class="literal">term</code> query searches on <code class="literal">keyword</code> fields are
often faster than <code class="literal">term</code> searches on numeric fields.
</li>
</ul>
</div>
<p>If you&#8217;re unsure which to use, you can use a <a class="xref" href="mapping-params.html#multi-fields" title="fields">multi-field</a> to map
the data as both a <code class="literal">keyword</code> <em>and</em> a numeric data type.</p>
</div>
</div>
<h4><a id="keyword-params"></a>Parameters for basic keyword fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/keyword.asciidoc">edit</a></h4>
<p>The following parameters are accepted by <code class="literal">keyword</code> fields:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
</span>
</dt>
<dd>
Should the field be stored on disk in a column-stride fashion, so that it
can later be used for sorting, aggregations, or scripting? Accepts <code class="literal">true</code>
(default) or <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#eager-global-ordinals" title="eager_global_ordinals"><code class="literal">eager_global_ordinals</code></a>
</span>
</dt>
<dd>
Should global ordinals be loaded eagerly on refresh? Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default). Enabling this is a good idea on fields that are frequently used for
terms aggregations.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#multi-fields" title="fields"><code class="literal">fields</code></a>
</span>
</dt>
<dd>
Multi-fields allow the same string value to be indexed in multiple ways for
different purposes, such as one field for search and a multi-field for
sorting and aggregations.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#ignore-above" title="ignore_above"><code class="literal">ignore_above</code></a>
</span>
</dt>
<dd>
Do not index any string longer than this value. Defaults to <code class="literal">2147483647</code>
so that all values would be accepted. Please however note that default
dynamic mapping rules create a sub <code class="literal">keyword</code> field that overrides this
default by setting <code class="literal">ignore_above: 256</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</span>
</dt>
<dd>
Should the field be quickly searchable? Accepts <code class="literal">true</code> (default) and
 <code class="literal">false</code>. <code class="literal">keyword</code> fields that only have <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
 enabled can still be queried, albeit slower.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#index-options" title="index_options"><code class="literal">index_options</code></a>
</span>
</dt>
<dd>
What information should be stored in the index, for scoring purposes.
Defaults to <code class="literal">docs</code> but can also be set to <code class="literal">freqs</code> to take term frequency into account
when computing scores.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-field-meta" title="meta"><code class="literal">meta</code></a>
</span>
</dt>
<dd>
Metadata about the field.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#norms" title="norms"><code class="literal">norms</code></a>
</span>
</dt>
<dd>
Whether field-length should be taken into account when scoring queries.
Accepts <code class="literal">true</code> or <code class="literal">false</code> (default).
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</span>
</dt>
<dd>
Accepts a string value which is substituted for any explicit <code class="literal">null</code>
values. Defaults to <code class="literal">null</code>, which means the field is treated as missing.
Note that this cannot be set if the <code class="literal">script</code> value is used.
</dd>
<dt>
<span class="term">
<code class="literal">on_script_error</code>
</span>
</dt>
<dd>
Defines what to do if the script defined by the <code class="literal">script</code> parameter
throws an error at indexing time. Accepts <code class="literal">fail</code> (default), which
will cause the entire document to be rejected, and <code class="literal">continue</code>, which
will register the field in the document&#8217;s
<a class="xref" href="mapping-fields.html#mapping-ignored-field" title="_ignored field"><code class="literal">_ignored</code></a> metadata field and continue
indexing. This parameter can only be set if the <code class="literal">script</code> field is
also set.
</dd>
<dt>
<span class="term">
<code class="literal">script</code>
</span>
</dt>
<dd>
If this parameter is set, then the field will index values generated
by this script, rather than reading the values directly from the
source. If a value is set for this field on the input document, then
the document will be rejected with an error.
Scripts are in the same format as their
<a class="xref" href="runtime.html#runtime-mapping-fields" title="Map a runtime field">runtime equivalent</a>. Values emitted by the
script are normalized as usual, and will be ignored if they are longer
that the value set on <code class="literal">ignore_above</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</span>
</dt>
<dd>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#similarity" title="similarity"><code class="literal">similarity</code></a>
</span>
</dt>
<dd>
Which scoring algorithm or <em>similarity</em> should be used. Defaults
to <code class="literal">BM25</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#normalizer" title="normalizer"><code class="literal">normalizer</code></a>
</span>
</dt>
<dd>
How to pre-process the keyword prior to indexing. Defaults to <code class="literal">null</code>,
meaning the keyword is kept as-is.
</dd>
<dt>
<span class="term">
<code class="literal">split_queries_on_whitespace</code>
</span>
</dt>
<dd>
Whether <a class="xref" href="full-text-queries.html" title="Full text queries">full text queries</a> should split the input on whitespace
when building a query for this field.
Accepts <code class="literal">true</code> or <code class="literal">false</code> (default).
</dd>
<dt>
<span class="term">
<code class="literal">time_series_dimension</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
</p>
<p>Marks the field as a <a class="xref" href="tsds.html#time-series-dimension" title="Dimensions">time series dimension</a>. Defaults
to <code class="literal">false</code>.</p>
<p>The
<a class="xref" href="tsds.html#index-mapping-dimension-fields-limit"><code class="literal">index.mapping.dimension_fields.limit</code></a>
index setting limits the number of dimensions in an index.</p>
<p>Dimension fields have the following constraints:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">doc_values</code> and <code class="literal">index</code> mapping parameters must be <code class="literal">true</code>.
</li>
<li class="listitem">
Field values cannot be an <a class="xref" href="mapping-types.html#array" title="Arrays">array or multi-value</a>.
</li>
<li class="listitem">
Field values cannot be larger than 1024 bytes.
</li>
<li class="listitem">
The field cannot use a <a class="xref" href="mapping-params.html#normalizer" title="normalizer"><code class="literal">normalizer</code></a>.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="keyword-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/keyword.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">keyword</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> in their
default configuration. Synthetic <code class="literal">_source</code> cannot be used together with
a <a class="xref" href="mapping-params.html#normalizer" title="normalizer"><code class="literal">normalizer</code></a> or <a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a>.</p>
<p>By default, synthetic source sorts <code class="literal">keyword</code> fields and removes duplicates.
For example:</p>
<a id="synthetic-source-keyword-example-default"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "kwd": { "type": "keyword" }
    }
  }
}
PUT idx/_doc/1
{
  "kwd": ["foo", "foo", "bar", "baz"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/226.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "kwd": ["bar", "baz", "foo"]
}</pre>
</div>
<p>If a <code class="literal">keyword</code> field sets <code class="literal">store</code> to <code class="literal">true</code> then order and duplicates
are preserved. For example:</p>
<a id="synthetic-source-keyword-example-stored"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "kwd": { "type": "keyword", "store": true }
    }
  }
}
PUT idx/_doc/1
{
  "kwd": ["foo", "foo", "bar", "baz"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/227.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "kwd": ["foo", "foo", "bar", "baz"]
}</pre>
</div>
<p>Values longer than <code class="literal">ignore_above</code> are preserved but sorted to the end.
For example:</p>
<a id="synthetic-source-keyword-example-ignore-above"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "kwd": { "type": "keyword", "ignore_above": 3 }
    }
  }
}
PUT idx/_doc/1
{
  "kwd": ["foo", "foo", "bang", "bar", "baz"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/228.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "kwd": ["bar", "baz", "foo", "bang"]
}</pre>
</div>
<h3 class="xpack"><a id="constant-keyword-field-type"></a>Constant keyword field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/constant-keyword.asciidoc">edit</a></h3>
<p>Constant keyword is a specialization of the <code class="literal">keyword</code> field for
the case that all documents in the index have the same value.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT logs-debug
{
  "mappings": {
    "properties": {
      "@timestamp": {
        "type": "date"
      },
      "message": {
        "type": "text"
      },
      "level": {
        "type": "constant_keyword",
        "value": "debug"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/229.console"></div>
<p><code class="literal">constant_keyword</code> supports the same queries and aggregations as <code class="literal">keyword</code>
fields do, but takes advantage of the fact that all documents have the same
value per index to execute queries more efficiently.</p>
<p>It is both allowed to submit documents that don&#8217;t have a value for the field or
that have a value equal to the value configured in mappings. The two below
indexing requests are equivalent:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST logs-debug/_doc
{
  "date": "2019-12-12",
  "message": "Starting up Elasticsearch",
  "level": "debug"
}

POST logs-debug/_doc
{
  "date": "2019-12-12",
  "message": "Starting up Elasticsearch"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/230.console"></div>
<p>However providing a value that is different from the one configured in the
mapping is disallowed.</p>
<p>In case no <code class="literal">value</code> is provided in the mappings, the field will automatically
configure itself based on the value contained in the first indexed document.
While this behavior can be convenient, note that it means that a single
poisonous document can cause all other documents to be rejected if it had a
wrong value.</p>
<p>Before a value has been provided (either through the mappings or from a
document), queries on the field will not match any documents. This includes
 <a class="xref" href="term-level-queries.html#query-dsl-exists-query" title="Exists query"><code class="literal">exists</code></a> queries.</p>
<p>The <code class="literal">value</code> of the field cannot be changed after it has been set.</p>
<h4><a id="constant-keyword-params"></a>Parameters for constant keyword fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/constant-keyword.asciidoc">edit</a></h4>
<p>The following mapping parameters are accepted:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-field-meta" title="meta"><code class="literal">meta</code></a>
</p>
</td>
<td valign="top">
<p>
Metadata about the field.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">value</code>
</p>
</td>
<td valign="top">
<p>
The value to associate with all documents in the index. If this parameter
is not provided, it is set based on the first document that gets indexed.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<h3 class="xpack"><a id="wildcard-field-type"></a>Wildcard field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/wildcard.asciidoc">edit</a></h3>
<p>The <code class="literal">wildcard</code> field type is a specialized keyword field for unstructured
machine-generated content you plan to search using grep-like
<a class="xref" href="term-level-queries.html#query-dsl-wildcard-query" title="Wildcard query"><code class="literal">wildcard</code></a> and <a class="xref" href="term-level-queries.html#query-dsl-regexp-query" title="Regexp query"><code class="literal">regexp</code></a>
queries. The <code class="literal">wildcard</code> type is optimized for fields with large values or high
cardinality.</p>
<div class="sidebar">
<a id="mapping-unstructured-content"></a>
<div class="titlepage"><div><div>
<p class="title"><strong>Mapping unstructured content</strong></p>
</div></div></div>
<p>You can map a field containing unstructured content to either a <code class="literal">text</code> or
keyword family field. The best field type depends on the nature of the content
and how you plan to search the field.</p>
<p>Use the <code class="literal">text</code> field type if:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The content is human-readable, such as an email body or product description.
</li>
<li class="listitem">
You plan to search the field for individual words or phrases, such as <code class="literal">the
brown fox jumped</code>, using <a class="xref" href="full-text-queries.html" title="Full text queries">full text queries</a>. Elasticsearch
<a class="xref" href="analysis.html" title="Text analysis">analyzes</a> <code class="literal">text</code> fields to return the most relevant results for
these queries.
</li>
</ul>
</div>
<p>Use a keyword family field type if:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The content is machine-generated, such as a log message or HTTP request
information.
</li>
<li class="listitem">
You plan to search the field for exact full values, such as <code class="literal">org.foo.bar</code>, or
partial character sequences, such as <code class="literal">org.foo.*</code>, using
<a class="xref" href="term-level-queries.html" title="Term-level queries">term-level queries</a>.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Choosing a keyword family field type</strong></span></p>
<p>If you choose a keyword family field type, you can map the field as a <code class="literal">keyword</code>
or <code class="literal">wildcard</code> field depending on the cardinality and size of the field&#8217;s values.
Use the <code class="literal">wildcard</code> type if you plan to regularly search the field using a
<a class="xref" href="term-level-queries.html#query-dsl-wildcard-query" title="Wildcard query"><code class="literal">wildcard</code></a> or <a class="xref" href="term-level-queries.html#query-dsl-regexp-query" title="Regexp query"><code class="literal">regexp</code></a>
query and meet one of the following criteria:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The field contains more than a million unique values.<br>
AND<br>
You plan to regularly search the field using a pattern with leading wildcards,
such as <code class="literal">*foo</code> or <code class="literal">*baz</code>.
</li>
<li class="listitem">
The field contains values larger than 32KB.<br>
AND<br>
You plan to regularly search the field using any wildcard pattern.
</li>
</ul>
</div>
<p>Otherwise, use the <code class="literal">keyword</code> field type for faster searches, faster indexing,
and lower storage costs. For an in-depth comparison and decision flowchart, see
our
<a href="https://www.elastic.co/blog/find-strings-within-strings-faster-with-the-new-elasticsearch-wildcard-field" class="ulink" target="_top">related
blog post</a>.</p>
<p><span class="strong strong"><strong>Switching from a <code class="literal">text</code> field to a keyword field</strong></span></p>
<p>If you previously used a <code class="literal">text</code> field to index unstructured machine-generated
content, you can <a class="xref" href="explicit-mapping.html#update-mapping" title="Update the mapping of a field">reindex to update the mapping</a> to a <code class="literal">keyword</code>
or <code class="literal">wildcard</code> field. We also recommend you update your application or workflow
to replace any word-based <a class="xref" href="full-text-queries.html" title="Full text queries">full text queries</a> on the field
to equivalent <a class="xref" href="term-level-queries.html" title="Term-level queries">term-level queries</a>.</p>
</div>
<p>Internally the <code class="literal">wildcard</code> field indexes the whole field value using ngrams and stores the full string.
The index is used as a rough filter to cut down the number of values that are then checked by retrieving and checking the full values.
This field is especially well suited to run grep-like queries on log lines. Storage costs are typically lower than those of <code class="literal">keyword</code>
fields but search speeds for exact matches on full terms are slower. If the
field values share many prefixes, such as URLs for the same website, storage
costs for a <code class="literal">wildcard</code> field may be higher than an equivalent <code class="literal">keyword</code> field.</p>
<p>You index and search a wildcard field as follows</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "my_wildcard": {
        "type": "wildcard"
      }
    }
  }
}

PUT my-index-000001/_doc/1
{
  "my_wildcard" : "This string can be quite lengthy"
}

GET my-index-000001/_search
{
  "query": {
    "wildcard": {
      "my_wildcard": {
        "value": "*quite*lengthy"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/231.console"></div>
<h4><a id="wildcard-params"></a>Parameters for wildcard fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/wildcard.asciidoc">edit</a></h4>
<p>The following parameters are accepted by <code class="literal">wildcard</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</p>
</td>
<td valign="top">
<p>
Accepts a string value which is substituted for any explicit <code class="literal">null</code>
values. Defaults to <code class="literal">null</code>, which means the field is treated as missing.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#ignore-above" title="ignore_above"><code class="literal">ignore_above</code></a>
</p>
</td>
<td valign="top">
<p>
Do not index any string longer than this value. Defaults to <code class="literal">2147483647</code>
so that all values would be accepted.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<h4><a id="_limitations"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/wildcard.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">wildcard</code> fields are untokenized like keyword fields, so do not support queries that rely on word positions such as phrase queries.
</li>
<li class="listitem">
When running <code class="literal">wildcard</code> queries any <code class="literal">rewrite</code> parameter is ignored. The scoring is always a constant score.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="wildcard-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/wildcard.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">wildcard</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> so long as they don&#8217;t
declare <a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a>.</p>
<p>Synthetic source always sorts <code class="literal">wildcard</code> fields. For example:</p>
<a id="synthetic-source-wildcard-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "card": { "type": "wildcard" }
    }
  }
}
PUT idx/_doc/1
{
  "card": ["king", "ace", "ace", "jack"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/232.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "card": ["ace", "jack", "king"]
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="nested"></a>Nested field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/nested.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">nested</code> type is a specialised version of the <a class="xref" href="mapping-types.html#object" title="Object field type"><code class="literal">object</code></a> data type
that allows arrays of objects to be indexed in a way that they can be queried
independently of each other.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>When ingesting key-value pairs with a large, arbitrary set of keys, you might consider modeling each key-value pair as its own nested document with <code class="literal">key</code> and <code class="literal">value</code> fields. Instead, consider using the <a class="xref" href="mapping-types.html#flattened" title="Flattened field type">flattened</a> data type, which maps an entire object as a single field and allows for simple searches over its contents.
Nested documents and queries are typically expensive, so using the <code class="literal">flattened</code> data type for this use case is a better option.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="nested-arrays-flattening-objects"></a>How arrays of objects are flattened<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/nested.asciidoc">edit</a></h3>
</div></div></div>
<p>Elasticsearch has no concept of inner objects. Therefore, it flattens object
hierarchies into a simple list of field names and values. For instance, consider the
following document:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/1
{
  "group" : "fans",
  "user" : [ <a id="CO63-1"></a><i class="conum" data-value="1"></i>
    {
      "first" : "John",
      "last" :  "Smith"
    },
    {
      "first" : "Alice",
      "last" :  "White"
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/233.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO63-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">user</code> field is dynamically added as a field of type <code class="literal">object</code>.</p>
</td>
</tr>
</table>
</div>
<p>The previous document would be transformed internally into a document that looks more like this:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "group" :        "fans",
  "user.first" : [ "alice", "john" ],
  "user.last" :  [ "smith", "white" ]
}</pre>
</div>
<p>The <code class="literal">user.first</code> and <code class="literal">user.last</code> fields are flattened into multi-value fields,
and the association between <code class="literal">alice</code> and <code class="literal">white</code> is lost. This document would
incorrectly match a query for <code class="literal">alice AND smith</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search
{
  "query": {
    "bool": {
      "must": [
        { "match": { "user.first": "Alice" }},
        { "match": { "user.last":  "Smith" }}
      ]
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/234.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="nested-fields-array-objects"></a>Using <code class="literal">nested</code> fields for arrays of objects<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/nested.asciidoc">edit</a></h3>
</div></div></div>
<p>If you need to index arrays of objects and to maintain the independence of
each object in the array, use the <code class="literal">nested</code> data type instead of the
<a class="xref" href="mapping-types.html#object" title="Object field type"><code class="literal">object</code></a> data type.</p>
<p>Internally, nested objects index each object in
the array as a separate hidden document, meaning that each nested object can be
queried independently of the others with the <a class="xref" href="joining-queries.html#query-dsl-nested-query" title="Nested query"><code class="literal">nested</code> query</a>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "user": {
        "type": "nested" <a id="CO64-1"></a><i class="conum" data-value="1"></i>
      }
    }
  }
}

PUT my-index-000001/_doc/1
{
  "group" : "fans",
  "user" : [
    {
      "first" : "John",
      "last" :  "Smith"
    },
    {
      "first" : "Alice",
      "last" :  "White"
    }
  ]
}

GET my-index-000001/_search
{
  "query": {
    "nested": {
      "path": "user",
      "query": {
        "bool": {
          "must": [
            { "match": { "user.first": "Alice" }},
            { "match": { "user.last":  "Smith" }} <a id="CO64-2"></a><i class="conum" data-value="2"></i>
          ]
        }
      }
    }
  }
}

GET my-index-000001/_search
{
  "query": {
    "nested": {
      "path": "user",
      "query": {
        "bool": {
          "must": [
            { "match": { "user.first": "Alice" }},
            { "match": { "user.last":  "White" }} <a id="CO64-3"></a><i class="conum" data-value="3"></i>
          ]
        }
      },
      "inner_hits": { <a id="CO64-4"></a><i class="conum" data-value="4"></i>
        "highlight": {
          "fields": {
            "user.first": {}
          }
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/235.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO64-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">user</code> field is mapped as type <code class="literal">nested</code> instead of type <code class="literal">object</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO64-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This query doesn&#8217;t match because <code class="literal">Alice</code> and <code class="literal">Smith</code> are not in the same nested object.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO64-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>This query matches because <code class="literal">Alice</code> and <code class="literal">White</code> are in the same nested object.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO64-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">inner_hits</code> allow us to highlight the matching nested documents.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="nested-accessing-documents"></a>Interacting with <code class="literal">nested</code> documents<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/nested.asciidoc">edit</a></h3>
</div></div></div>
<p>Nested documents can be:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
queried with the <a class="xref" href="joining-queries.html#query-dsl-nested-query" title="Nested query"><code class="literal">nested</code></a> query.
</li>
<li class="listitem">
analyzed with the <a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-nested-aggregation" title="Nested aggregation"><code class="literal">nested</code></a>
and <a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-reverse-nested-aggregation" title="Reverse nested aggregation"><code class="literal">reverse_nested</code></a>
aggregations.
</li>
<li class="listitem">
sorted with <a class="xref" href="sort-search-results.html#nested-sorting" title="Sorting within nested objects.">nested sorting</a>.
</li>
<li class="listitem">
retrieved and highlighted with <a class="xref" href="inner-hits.html#nested-inner-hits" title="Nested inner hits">nested inner hits</a>.
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Because nested documents are indexed as separate documents, they can only be
accessed within the scope of the <code class="literal">nested</code> query, the
<code class="literal">nested</code>/<code class="literal">reverse_nested</code> aggregations, or <a class="xref" href="inner-hits.html#nested-inner-hits" title="Nested inner hits">nested inner hits</a>.</p>
<p>For instance, if a string field within a nested document has
<a class="xref" href="mapping-params.html#index-options" title="index_options"><code class="literal">index_options</code></a> set to <code class="literal">offsets</code> to allow use of the postings
during the highlighting, these offsets will not be available during the main highlighting
phase. Instead, highlighting needs to be performed via
<a class="xref" href="inner-hits.html#nested-inner-hits" title="Nested inner hits">nested inner hits</a>. The same consideration applies when loading
fields during a search through <a class="xref" href="search-fields.html#docvalue-fields" title="Doc value fields"><code class="literal">docvalue_fields</code></a> or <a class="xref" href="search-fields.html#stored-fields" title="Stored fields"><code class="literal">stored_fields</code></a>.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="nested-params"></a>Parameters for <code class="literal">nested</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/nested.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">nested</code> fields:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#dynamic" title="dynamic"><code class="literal">dynamic</code></a>
</span>
</dt>
<dd>
(Optional, string)
Whether or not new <code class="literal">properties</code> should be added dynamically to an existing
nested object. Accepts <code class="literal">true</code> (default), <code class="literal">false</code> and <code class="literal">strict</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#properties" title="properties"><code class="literal">properties</code></a>
</span>
</dt>
<dd>
(Optional, object)
The fields within the nested object, which can be of any
<a class="xref" href="mapping-types.html" title="Field data types">data type</a>, including <code class="literal">nested</code>. New properties
may be added to an existing nested object.
</dd>
<dt>
<span class="term">
<code class="literal">include_in_parent</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, all fields in the nested object are also added to the parent document
as standard (flat) fields. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">include_in_root</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, all fields in the nested object are also added to the root
document as standard (flat) fields. Defaults to <code class="literal">false</code>.
</dd>
</dl>
</div>
<h3><a id="_limits_on_nested_mappings_and_objects"></a>Limits on <code class="literal">nested</code> mappings and objects<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/nested.asciidoc">edit</a></h3>
<p>As described earlier, each nested object is indexed as a separate Lucene document.
Continuing with the previous example, if we indexed a single document containing 100 <code class="literal">user</code> objects,
then 101 Lucene documents would be created: one for the parent document, and one for each
nested object. Because of the expense associated with <code class="literal">nested</code> mappings, Elasticsearch puts
settings in place to guard against performance problems:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index.mapping.nested_fields.limit</code>
</span>
</dt>
<dd>
The maximum number of distinct <code class="literal">nested</code> mappings in an index. The <code class="literal">nested</code> type should only be used in special cases, when arrays of objects need to be queried independently of each other. To safeguard against poorly designed mappings, this setting
limits the number of unique <code class="literal">nested</code> types per index. Default is <code class="literal">50</code>.
</dd>
</dl>
</div>
<p>In the previous example, the <code class="literal">user</code> mapping would count as only 1 towards this limit.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index.mapping.nested_objects.limit</code>
</span>
</dt>
<dd>
The maximum number of nested JSON objects that a single document can contain across all
<code class="literal">nested</code> types. This limit helps to prevent out of memory errors when a document contains too many nested
objects. Default is <code class="literal">10000</code>.
</dd>
</dl>
</div>
<p>To illustrate how this setting works, consider adding another <code class="literal">nested</code> type called <code class="literal">comments</code>
to the previous example mapping. For each document, the combined number of <code class="literal">user</code> and <code class="literal">comment</code>
objects it contains must be below the limit.</p>
<p>See <a class="xref" href="mapping.html#mapping-limit-settings" title="Settings to prevent mapping explosion">Settings to prevent mapping explosion</a> regarding additional settings for preventing mappings explosion.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="number"></a>Numeric field types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/numeric.asciidoc">edit</a></h2>
</div></div></div>

<p>The following numeric types are supported:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<code class="literal">long</code>
</p>
</td>
<td valign="top">
<p>
A signed 64-bit integer with a minimum value of <code class="literal">-2<sup>63</sup></code> and a maximum value of <code class="literal">2<sup>63</sup>-1</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">integer</code>
</p>
</td>
<td valign="top">
<p>
A signed 32-bit integer with a minimum value of <code class="literal">-2<sup>31</sup></code> and a maximum value of <code class="literal">2<sup>31</sup>-1</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">short</code>
</p>
</td>
<td valign="top">
<p>
A signed 16-bit integer with a minimum value of <code class="literal">-32,768</code> and a maximum value of <code class="literal">32,767</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">byte</code>
</p>
</td>
<td valign="top">
<p>
A signed 8-bit integer with a minimum value of <code class="literal">-128</code> and a maximum value of <code class="literal">127</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">double</code>
</p>
</td>
<td valign="top">
<p>
A double-precision 64-bit IEEE 754 floating point number, restricted to finite values.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">float</code>
</p>
</td>
<td valign="top">
<p>
A single-precision 32-bit IEEE 754 floating point number, restricted to finite values.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">half_float</code>
</p>
</td>
<td valign="top">
<p>
A half-precision 16-bit IEEE 754 floating point number, restricted to finite values.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">scaled_float</code>
</p>
</td>
<td valign="top">
<p>
A floating point number that is backed by a <code class="literal">long</code>, scaled by a fixed <code class="literal">double</code> scaling factor.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">unsigned_long</code>
</p>
</td>
<td valign="top">
<p>
An unsigned 64-bit integer with a minimum value of 0 and a maximum value of <code class="literal">2<sup>64</sup>-1</code>.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Below is an example of configuring a mapping with numeric fields:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "number_of_bytes": {
        "type": "integer"
      },
      "time_in_seconds": {
        "type": "float"
      },
      "price": {
        "type": "scaled_float",
        "scaling_factor": 100
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/236.console"></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">double</code>, <code class="literal">float</code> and <code class="literal">half_float</code> types consider that <code class="literal">-0.0</code> and
<code class="literal">+0.0</code> are different values. As a consequence, doing a <code class="literal">term</code> query on
<code class="literal">-0.0</code> will not match <code class="literal">+0.0</code> and vice-versa. Same is true for range queries:
if the upper bound is <code class="literal">-0.0</code> then <code class="literal">+0.0</code> will not match, and if the lower
bound is <code class="literal">+0.0</code> then <code class="literal">-0.0</code> will not match.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_which_type_should_i_use"></a>Which type should I use?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/numeric.asciidoc">edit</a></h3>
</div></div></div>
<p>As far as integer types (<code class="literal">byte</code>, <code class="literal">short</code>, <code class="literal">integer</code> and <code class="literal">long</code>) are concerned,
you should pick the smallest type which is enough for your use-case. This will
help indexing and searching be more efficient. Note however that storage is
optimized based on the actual values that are stored, so picking one type over
another one will have no impact on storage requirements.</p>
<p>For floating-point types, it is often more efficient to store floating-point
data into an integer using a scaling factor, which is what the <code class="literal">scaled_float</code>
type does under the hood. For instance, a <code class="literal">price</code> field could be stored in a
<code class="literal">scaled_float</code> with a <code class="literal">scaling_factor</code> of <code class="literal">100</code>. All APIs would work as if
the field was stored as a double, but under the hood Elasticsearch would be
working with the number of cents, <code class="literal">price*100</code>, which is an integer. This is
mostly helpful to save disk space since integers are way easier to compress
than floating points. <code class="literal">scaled_float</code> is also fine to use in order to trade
accuracy for disk space. For instance imagine that you are tracking cpu
utilization as a number between <code class="literal">0</code> and <code class="literal">1</code>. It usually does not matter much
whether cpu utilization is <code class="literal">12.7%</code> or <code class="literal">13%</code>, so you could use a <code class="literal">scaled_float</code>
with a <code class="literal">scaling_factor</code> of <code class="literal">100</code> in order to round cpu utilization to the
closest percent in order to save space.</p>
<p>If <code class="literal">scaled_float</code> is not a good fit, then you should pick the smallest type
that is enough for the use-case among the floating-point types: <code class="literal">double</code>,
<code class="literal">float</code> and <code class="literal">half_float</code>. Here is a table that compares these types in order
to help make a decision.</p>
<div class="informaltable">
<a id="floating_point"></a>
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Minimum value</th>
<th align="left" valign="top">Maximum value</th>
<th align="left" valign="top">Significant<br>
                                                     bits / digits</th>
<th align="left" valign="top">Example precision loss</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">double</code></p></td>
<td align="left" valign="top"><p><code class="literal">2<sup>-1074</sup></code></p></td>
<td align="left" valign="top"><p><code class="literal">(2-2<sup>-52</sup>)·2<sup>1023</sup></code></p></td>
<td align="left" valign="top"><p><code class="literal">53</code> / <code class="literal">15.95</code></p></td>
<td align="left" valign="top"><p><code class="literal">1.2345678912345678</code>&#8594;<br>
                                                                      <code class="literal">1.234567891234568</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">float</code></p></td>
<td align="left" valign="top"><p><code class="literal">2<sup>-149</sup></code></p></td>
<td align="left" valign="top"><p><code class="literal">(2-2<sup>-23</sup>)·2<sup>127</sup></code></p></td>
<td align="left" valign="top"><p><code class="literal">24</code> / <code class="literal">7.22</code></p></td>
<td align="left" valign="top"><p><code class="literal">1.23456789</code>&#8594;<br>
                                                                      <code class="literal">1.2345679</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">half_float</code></p></td>
<td align="left" valign="top"><p><code class="literal">2<sup>-24</sup></code></p></td>
<td align="left" valign="top"><p><code class="literal">65504</code></p></td>
<td align="left" valign="top"><p><code class="literal">11</code> / <code class="literal">3.31</code></p></td>
<td align="left" valign="top"><p><code class="literal">1.2345</code>&#8594;<br>
                                                                      <code class="literal">1.234375</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Mapping numeric identifiers</h3>
<p>Not all numeric data should be mapped as a <a class="xref" href="mapping-types.html#number" title="Numeric field types">numeric</a> field data type.
Elasticsearch optimizes numeric fields, such as <code class="literal">integer</code> or <code class="literal">long</code>, for
<a class="xref" href="term-level-queries.html#query-dsl-range-query" title="Range query"><code class="literal">range</code></a> queries. However, <a class="xref" href="mapping-types.html#keyword" title="Keyword type family"><code class="literal">keyword</code></a> fields
are better for <a class="xref" href="term-level-queries.html#query-dsl-term-query" title="Term query"><code class="literal">term</code></a> and other
<a class="xref" href="term-level-queries.html" title="Term-level queries">term-level</a> queries.</p>
<p>Identifiers, such as an ISBN or a product ID, are rarely used in <code class="literal">range</code>
queries. However, they are often retrieved using term-level queries.</p>
<p>Consider mapping a numeric identifier as a <code class="literal">keyword</code> if:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You don&#8217;t plan to search for the identifier data using
<a class="xref" href="term-level-queries.html#query-dsl-range-query" title="Range query"><code class="literal">range</code></a> queries.
</li>
<li class="listitem">
Fast retrieval is important. <code class="literal">term</code> query searches on <code class="literal">keyword</code> fields are
often faster than <code class="literal">term</code> searches on numeric fields.
</li>
</ul>
</div>
<p>If you&#8217;re unsure which to use, you can use a <a class="xref" href="mapping-params.html#multi-fields" title="fields">multi-field</a> to map
the data as both a <code class="literal">keyword</code> <em>and</em> a numeric data type.</p>
</div>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="number-params"></a>Parameters for numeric fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/numeric.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by numeric types:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#coerce" title="coerce"><code class="literal">coerce</code></a>
</span>
</dt>
<dd>
Try to convert strings to numbers and truncate fractions for integers.
Accepts <code class="literal">true</code> (default) and <code class="literal">false</code>. Not applicable for <code class="literal">unsigned_long</code>.
Note that this cannot be set if the <code class="literal">script</code> parameter is used.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
</span>
</dt>
<dd>
Should the field be stored on disk in a column-stride fashion, so that it
can later be used for sorting, aggregations, or scripting? Accepts <code class="literal">true</code>
(default) or <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>
</span>
</dt>
<dd>
If <code class="literal">true</code>, malformed numbers are ignored. If <code class="literal">false</code> (default), malformed
numbers throw an exception and reject the whole document.  Note that this
cannot be set if the <code class="literal">script</code> parameter is used.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</span>
</dt>
<dd>
Should the field be quickly searchable? Accepts <code class="literal">true</code> (default) and
<code class="literal">false</code>. Numeric fields that only have <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
enabled can also be queried, albeit slower.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-field-meta" title="meta"><code class="literal">meta</code></a>
</span>
</dt>
<dd>
Metadata about the field.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</span>
</dt>
<dd>
Accepts a numeric value of the same <code class="literal">type</code> as the field which is
substituted for any explicit <code class="literal">null</code> values. Defaults to <code class="literal">null</code>, which
means the field is treated as missing. Note that this cannot be set
if the <code class="literal">script</code> parameter is used.
</dd>
<dt>
<span class="term">
<code class="literal">on_script_error</code>
</span>
</dt>
<dd>
Defines what to do if the script defined by the <code class="literal">script</code> parameter
throws an error at indexing time. Accepts <code class="literal">fail</code> (default), which
will cause the entire document to be rejected, and <code class="literal">continue</code>, which
will register the field in the document&#8217;s
<a class="xref" href="mapping-fields.html#mapping-ignored-field" title="_ignored field"><code class="literal">_ignored</code></a> metadata field and continue
indexing. This parameter can only be set if the <code class="literal">script</code> field is
also set.
</dd>
<dt>
<span class="term">
<code class="literal">script</code>
</span>
</dt>
<dd>
If this parameter is set, then the field will index values generated
by this script, rather than reading the values directly from the
source. If a value is set for this field on the input document, then
the document will be rejected with an error.
Scripts are in the same format as their
<a class="xref" href="runtime.html#runtime-mapping-fields" title="Map a runtime field">runtime equivalent</a>. Scripts can only be
configured on <code class="literal">long</code> and <code class="literal">double</code> field types.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</span>
</dt>
<dd>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</dd>
<dt>
<span class="term">
<code class="literal">time_series_dimension</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
</p>
<p>Marks the field as a <a class="xref" href="tsds.html#time-series-dimension" title="Dimensions">time series dimension</a>. Defaults
to <code class="literal">false</code>.</p>
<p>The
<a class="xref" href="tsds.html#index-mapping-dimension-fields-limit"><code class="literal">index.mapping.dimension_fields.limit</code></a>
index setting limits the number of dimensions in an index.</p>
<p>Dimension fields have the following constraints:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">doc_values</code> and <code class="literal">index</code> mapping parameters must be <code class="literal">true</code>.
</li>
<li class="listitem">
Field values cannot be an <a class="xref" href="mapping-types.html#array" title="Arrays">array or multi-value</a>.
</li>
</ul>
</div>
<p>Of the numeric field types, only <code class="literal">byte</code>, <code class="literal">short</code>, <code class="literal">integer</code>, <code class="literal">long</code>, and
<code class="literal">unsigned_long</code> fields support this parameter.</p>
<p>A numeric field can&#8217;t be both a time series dimension and a time series metric.</p>
</dd>
<dt>
<span class="term">
<code class="literal">time_series_metric</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Marks the field as a <a class="xref" href="tsds.html#time-series-metric" title="Metrics">time series metric</a>. The value is the
metric type. You can&#8217;t update this parameter for existing fields.
</p>
<details open>
<summary class="title">Valid <code class="literal">time_series_metric</code> values for numeric fields</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">counter</code>
</span>
</dt>
<dd>
A cumulative metric that only monotonically increases or resets to <code class="literal">0</code> (zero). For
example, a count of errors or completed tasks.
</dd>
<dt>
<span class="term">
<code class="literal">gauge</code>
</span>
</dt>
<dd>
A metric that represents a single numeric that can arbitrarily increase or decrease. For example, a temperature or
available disk space.
</dd>
<dt>
<span class="term">
<code class="literal">null</code> (Default)
</span>
</dt>
<dd>
Not a time series metric.
</dd>
</dl>
</div>
</div>
</details>
<p>For a numeric time series metric, the <code class="literal">doc_values</code> parameter must be <code class="literal">true</code>. A
numeric field can&#8217;t be both a time series dimension and a time series metric.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="scaled-float-params"></a>Parameters for <code class="literal">scaled_float</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/numeric.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">scaled_float</code> accepts an additional parameter:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<code class="literal">scaling_factor</code>
</p>
</td>
<td valign="top">
<p>
The scaling factor to use when encoding values. Values will be multiplied
by this factor at index time and rounded to the closest long value. For
instance, a <code class="literal">scaled_float</code> with a <code class="literal">scaling_factor</code> of <code class="literal">10</code> would internally
store <code class="literal">2.34</code> as <code class="literal">23</code> and all search-time operations (queries, aggregations,
sorting) will behave as if the document had a value of <code class="literal">2.3</code>. High values
of <code class="literal">scaling_factor</code> improve accuracy but also increase space requirements.
This parameter is required.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="numeric-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/numeric.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p>All numeric fields except <code class="literal">unsigned_long</code> support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic
<code class="literal">_source</code></a> in their default configuration. Synthetic <code class="literal">_source</code> cannot be used
together with <a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>, <a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a>, or
with <a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a> disabled.</p>
<p>Synthetic source always sorts numeric fields. For example:</p>
<a id="synthetic-source-numeric-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "long": { "type": "long" }
    }
  }
}
PUT idx/_doc/1
{
  "long": [0, 0, -123466, 87612]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/237.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "long": [-123466, 0, 0, 87612]
}</pre>
</div>
<p>Scaled floats will always apply their scaling factor so:</p>
<a id="synthetic-source-scaled-float-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "f": { "type": "scaled_float", "scaling_factor": 0.01 }
    }
  }
}
PUT idx/_doc/1
{
  "f": 123
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/238.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "f": 100.0
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="object"></a>Object field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/object.asciidoc">edit</a></h2>
</div></div></div>

<p>JSON documents are hierarchical in nature: the document may contain inner
objects which, in turn, may contain inner objects themselves:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/1
{ <a id="CO65-1"></a><i class="conum" data-value="1"></i>
  "region": "US",
  "manager": { <a id="CO65-2"></a><i class="conum" data-value="2"></i>
    "age":     30,
    "name": { <a id="CO65-3"></a><i class="conum" data-value="3"></i>
      "first": "John",
      "last":  "Smith"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/239.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO65-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The outer document is also a JSON object.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO65-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>It contains an inner object called <code class="literal">manager</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO65-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Which in turn contains an inner object called <code class="literal">name</code>.</p>
</td>
</tr>
</table>
</div>
<p>Internally, this document is indexed as a simple, flat list of key-value
pairs, something like this:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "region":             "US",
  "manager.age":        30,
  "manager.name.first": "John",
  "manager.name.last":  "Smith"
}</pre>
</div>
<p>An explicit mapping for the above document could look like this:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": { <a id="CO66-1"></a><i class="conum" data-value="1"></i>
      "region": {
        "type": "keyword"
      },
      "manager": { <a id="CO66-2"></a><i class="conum" data-value="2"></i>
        "properties": {
          "age":  { "type": "integer" },
          "name": { <a id="CO66-3"></a><i class="conum" data-value="3"></i>
            "properties": {
              "first": { "type": "text" },
              "last":  { "type": "text" }
            }
          }
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/240.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO66-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Properties in the top-level mappings definition.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO66-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">manager</code> field is an inner <code class="literal">object</code> field.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO66-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">manager.name</code> field is an inner <code class="literal">object</code> field within the <code class="literal">manager</code> field.</p>
</td>
</tr>
</table>
</div>
<p>You are not required to set the field <code class="literal">type</code> to <code class="literal">object</code> explicitly, as this is the default value.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="object-params"></a>Parameters for <code class="literal">object</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/object.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">object</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#dynamic" title="dynamic"><code class="literal">dynamic</code></a>
</p>
</td>
<td valign="top">
<p>
Whether or not new <code class="literal">properties</code> should be added dynamically
to an existing object. Accepts <code class="literal">true</code> (default), <code class="literal">runtime</code>, <code class="literal">false</code>
and <code class="literal">strict</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#enabled" title="enabled"><code class="literal">enabled</code></a>
</p>
</td>
<td valign="top">
<p>
Whether the JSON value given for the object field should be
parsed and indexed (<code class="literal">true</code>, default) or completely ignored (<code class="literal">false</code>).
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#subobjects" title="subobjects"><code class="literal">subobjects</code></a>
</p>
</td>
<td valign="top">
<p>
Whether the object can hold subobjects (<code class="literal">true</code>, default) or not (<code class="literal">false</code>). If not, sub-fields
with dots in their names will be treated as leaves instead, otherwise their field names
would be expanded to their corresponding object structure.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#properties" title="properties"><code class="literal">properties</code></a>
</p>
</td>
<td valign="top">
<p>
The fields within the object, which can be of any
<a class="xref" href="mapping-types.html" title="Field data types">data type</a>, including <code class="literal">object</code>. New properties
may be added to an existing object.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you need to index arrays of objects instead of single objects,
read <a class="xref" href="mapping-types.html#nested" title="Nested field type">Nested</a> first.</p>
</div>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="percolator"></a>Percolator field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">percolator</code> field type parses a json structure into a native query and
stores that query, so that the <a class="xref" href="specialized-queries.html#query-dsl-percolate-query" title="Percolate query">percolate query</a>
can use it to match provided documents.</p>
<p>Any field that contains a json object can be configured to be a percolator
field. The percolator field type has no settings. Just configuring the <code class="literal">percolator</code>
field type is sufficient to instruct Elasticsearch to treat a field as a
query.</p>
<p>If the following mapping configures the <code class="literal">percolator</code> field type for the
<code class="literal">query</code> field:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "query": {
        "type": "percolator"
      },
      "field": {
        "type": "text"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/241.console"></div>
<p>Then you can index a query:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/match_value
{
  "query": {
    "match": {
      "field": "value"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/242.console"></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Fields referred to in a percolator query must <span class="strong strong"><strong>already</strong></span> exist in the mapping
associated with the index used for percolation. In order to make sure these fields exist,
add or update a mapping via the <a class="xref" href="indices.html#indices-create-index" title="Create index API">create index</a> or <a class="xref" href="indices.html#indices-put-mapping" title="Update mapping API">update mapping</a> APIs.</p>
</div>
</div>
<h4><a id="_reindexing_your_percolator_queries"></a>Reindexing your percolator queries<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h4>
<p>Reindexing percolator queries is sometimes required to benefit from improvements made to the <code class="literal">percolator</code> field type in
new releases.</p>
<p>Reindexing percolator queries can be reindexed by using the <a class="xref" href="docs.html#docs-reindex" title="Reindex API">reindex api</a>.
Lets take a look at the following index with a percolator field type:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT index
{
  "mappings": {
    "properties": {
      "query" : {
        "type" : "percolator"
      },
      "body" : {
        "type": "text"
      }
    }
  }
}

POST _aliases
{
  "actions": [
    {
      "add": {
        "index": "index",
        "alias": "queries" <a id="CO67-1"></a><i class="conum" data-value="1"></i>
      }
    }
  ]
}

PUT queries/_doc/1?refresh
{
  "query" : {
    "match" : {
      "body" : "quick brown fox"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/243.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO67-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>It is always recommended to define an alias for your index, so that in case of a reindex systems / applications
don&#8217;t need to be changed to know that the percolator queries are now in a different index.</p>
</td>
</tr>
</table>
</div>
<p>Lets say you&#8217;re going to upgrade to a new major version and in order for the new Elasticsearch version to still be able
to read your queries you need to reindex your queries into a new index on the current Elasticsearch version:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT new_index
{
  "mappings": {
    "properties": {
      "query" : {
        "type" : "percolator"
      },
      "body" : {
        "type": "text"
      }
    }
  }
}

POST /_reindex?refresh
{
  "source": {
    "index": "index"
  },
  "dest": {
    "index": "new_index"
  }
}

POST _aliases
{
  "actions": [ <a id="CO68-1"></a><i class="conum" data-value="1"></i>
    {
      "remove": {
        "index" : "index",
        "alias": "queries"
      }
    },
    {
      "add": {
        "index": "new_index",
        "alias": "queries"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/244.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO68-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>If you have an alias don&#8217;t forget to point it to the new index.</p>
</td>
</tr>
</table>
</div>
<p>Executing the <code class="literal">percolate</code> query via the <code class="literal">queries</code> alias:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /queries/_search
{
  "query": {
    "percolate" : {
      "field" : "query",
      "document" : {
        "body" : "fox jumps over the lazy dog"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/245.console"></div>
<p>now returns matches from the new index:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took": 3,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "skipped" : 0,
    "failed": 0
  },
  "hits": {
    "total" : {
        "value": 1,
        "relation": "eq"
    },
    "max_score": 0.13076457,
    "hits": [
      {
        "_index": "new_index", <a id="CO69-1"></a><i class="conum" data-value="1"></i>
        "_id": "1",
        "_score": 0.13076457,
        "_source": {
          "query": {
            "match": {
              "body": "quick brown fox"
            }
          }
        },
        "fields" : {
          "_percolator_document_slot" : [0]
        }
      }
    ]
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO69-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Percolator query hit is now being presented from the new index.</p>
</td>
</tr>
</table>
</div>
<h4><a id="_optimizing_query_time_text_analysis"></a>Optimizing query time text analysis<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h4>
<p>When the percolator verifies a percolator candidate match it is going to parse, perform query time text analysis and actually run
the percolator query on the document being percolated. This is done for each candidate match and every time the <code class="literal">percolate</code> query executes.
If your query time text analysis is relatively expensive part of query parsing then text analysis can become the
dominating factor time is being spent on when percolating. This query parsing overhead can become noticeable when the
percolator ends up verifying many candidate percolator query matches.</p>
<p>To avoid the most expensive part of text analysis at percolate time. One can choose to do the expensive part of text analysis
when indexing the percolator query. This requires using two different analyzers. The first analyzer actually performs
text analysis that needs be performed (expensive part). The second analyzer (usually whitespace) just splits the generated tokens
that the first analyzer has produced. Then before indexing a percolator query, the analyze api should be used to analyze the query
text with the more expensive analyzer. The result of the analyze api, the tokens, should be used to substitute the original query
text in the percolator query. It is important that the query should now be configured to override the analyzer from the mapping and
just the second analyzer. Most text based queries support an <code class="literal">analyzer</code> option (<code class="literal">match</code>, <code class="literal">query_string</code>, <code class="literal">simple_query_string</code>).
Using this approach the expensive text analysis is performed once instead of many times.</p>
<p>Lets demonstrate this workflow via a simplified example.</p>
<p>Lets say we want to index the following percolator query:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "query" : {
    "match" : {
      "body" : {
        "query" : "missing bicycles"
      }
    }
  }
}</pre>
</div>
<p>with these settings and mapping:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /test_index
{
  "settings": {
    "analysis": {
      "analyzer": {
        "my_analyzer" : {
          "tokenizer": "standard",
          "filter" : ["lowercase", "porter_stem"]
        }
      }
    }
  },
  "mappings": {
    "properties": {
      "query" : {
        "type": "percolator"
      },
      "body" : {
        "type": "text",
        "analyzer": "my_analyzer" <a id="CO70-1"></a><i class="conum" data-value="1"></i>
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/246.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO70-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>For the purpose of this example, this analyzer is considered expensive.</p>
</td>
</tr>
</table>
</div>
<p>First we need to use the analyze api to perform the text analysis prior to indexing:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /test_index/_analyze
{
  "analyzer" : "my_analyzer",
  "text" : "missing bicycles"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/247.console"></div>
<p>This results the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "tokens": [
    {
      "token": "miss",
      "start_offset": 0,
      "end_offset": 7,
      "type": "&lt;ALPHANUM&gt;",
      "position": 0
    },
    {
      "token": "bicycl",
      "start_offset": 8,
      "end_offset": 16,
      "type": "&lt;ALPHANUM&gt;",
      "position": 1
    }
  ]
}</pre>
</div>
<p>All the tokens in the returned order need to replace the query text in the percolator query:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /test_index/_doc/1?refresh
{
  "query" : {
    "match" : {
      "body" : {
        "query" : "miss bicycl",
        "analyzer" : "whitespace" <a id="CO71-1"></a><i class="conum" data-value="1"></i>
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/248.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO71-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>It is important to select a whitespace analyzer here, otherwise the analyzer defined in the mapping will be used,
which defeats the point of using this workflow. Note that <code class="literal">whitespace</code> is a built-in analyzer, if a different analyzer
needs to be used, it needs to be configured first in the index&#8217;s settings.</p>
</td>
</tr>
</table>
</div>
<p>The analyze api prior to the indexing the percolator flow should be done for each percolator query.</p>
<p>At percolate time nothing changes and the <code class="literal">percolate</code> query can be defined normally:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /test_index/_search
{
  "query": {
    "percolate" : {
      "field" : "query",
      "document" : {
        "body" : "Bycicles are missing"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/249.console"></div>
<p>This results in a response like this:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took": 6,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "skipped" : 0,
    "failed": 0
  },
  "hits": {
    "total" : {
        "value": 1,
        "relation": "eq"
    },
    "max_score": 0.13076457,
    "hits": [
      {
        "_index": "test_index",
        "_id": "1",
        "_score": 0.13076457,
        "_source": {
          "query": {
            "match": {
              "body": {
                "query": "miss bicycl",
                "analyzer": "whitespace"
              }
            }
          }
        },
        "fields" : {
          "_percolator_document_slot" : [0]
        }
      }
    ]
  }
}</pre>
</div>
<h4><a id="_optimizing_wildcard_queries"></a>Optimizing wildcard queries.<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h4>
<p>Wildcard queries are more expensive than other queries for the percolator,
especially if the wildcard expressions are large.</p>
<p>In the case of <code class="literal">wildcard</code> queries with prefix wildcard expressions or just the <code class="literal">prefix</code> query,
the <code class="literal">edge_ngram</code> token filter can be used to replace these queries with regular <code class="literal">term</code>
query on a field where the <code class="literal">edge_ngram</code> token filter is configured.</p>
<p>Creating an index with custom analysis settings:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my_queries1
{
  "settings": {
    "analysis": {
      "analyzer": {
        "wildcard_prefix": { <a id="CO72-1"></a><i class="conum" data-value="1"></i>
          "type": "custom",
          "tokenizer": "standard",
          "filter": [
            "lowercase",
            "wildcard_edge_ngram"
          ]
        }
      },
      "filter": {
        "wildcard_edge_ngram": { <a id="CO72-2"></a><i class="conum" data-value="2"></i>
          "type": "edge_ngram",
          "min_gram": 1,
          "max_gram": 32
        }
      }
    }
  },
  "mappings": {
    "properties": {
      "query": {
        "type": "percolator"
      },
      "my_field": {
        "type": "text",
        "fields": {
          "prefix": { <a id="CO72-3"></a><i class="conum" data-value="3"></i>
            "type": "text",
            "analyzer": "wildcard_prefix",
            "search_analyzer": "standard"
          }
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/250.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO72-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The analyzer that generates the prefix tokens to be used at index time only.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO72-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Increase the <code class="literal">min_gram</code> and decrease <code class="literal">max_gram</code> settings based on your prefix search needs.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO72-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>This multifield should be used to do the prefix search
with a <code class="literal">term</code> or <code class="literal">match</code> query instead of a <code class="literal">prefix</code> or <code class="literal">wildcard</code> query.</p>
</td>
</tr>
</table>
</div>
<p>Then instead of indexing the following query:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "query": {
    "wildcard": {
      "my_field": "abc*"
    }
  }
}</pre>
</div>
<p>this query below should be indexed:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /my_queries1/_doc/1?refresh
{
  "query": {
    "term": {
      "my_field.prefix": "abc"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/251.console"></div>
<p>This way can handle the second query more efficiently than the first query.</p>
<p>The following search request will match with the previously indexed
percolator query:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my_queries1/_search
{
  "query": {
    "percolate": {
      "field": "query",
      "document": {
        "my_field": "abcd"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/252.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took": 6,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "skipped": 0,
    "failed": 0
  },
  "hits": {
    "total" : {
        "value": 1,
        "relation": "eq"
    },
    "max_score": 0.18864399,
    "hits": [
      {
        "_index": "my_queries1",
        "_id": "1",
        "_score": 0.18864399,
        "_source": {
          "query": {
            "term": {
              "my_field.prefix": "abc"
            }
          }
        },
        "fields": {
          "_percolator_document_slot": [
            0
          ]
        }
      }
    ]
  }
}</pre>
</div>
<p>The same technique can also be used to speed up suffix
wildcard searches. By using the <code class="literal">reverse</code> token filter
before the <code class="literal">edge_ngram</code> token filter.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my_queries2
{
  "settings": {
    "analysis": {
      "analyzer": {
        "wildcard_suffix": {
          "type": "custom",
          "tokenizer": "standard",
          "filter": [
            "lowercase",
            "reverse",
            "wildcard_edge_ngram"
          ]
        },
        "wildcard_suffix_search_time": {
          "type": "custom",
          "tokenizer": "standard",
          "filter": [
            "lowercase",
            "reverse"
          ]
        }
      },
      "filter": {
        "wildcard_edge_ngram": {
          "type": "edge_ngram",
          "min_gram": 1,
          "max_gram": 32
        }
      }
    }
  },
  "mappings": {
    "properties": {
      "query": {
        "type": "percolator"
      },
      "my_field": {
        "type": "text",
        "fields": {
          "suffix": {
            "type": "text",
            "analyzer": "wildcard_suffix",
            "search_analyzer": "wildcard_suffix_search_time" <a id="CO73-1"></a><i class="conum" data-value="1"></i>
          }
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/253.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO73-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>A custom analyzer is needed at search time too, because otherwise
the query terms are not being reversed and would otherwise not match
with the reserved suffix tokens.</p>
</td>
</tr>
</table>
</div>
<p>Then instead of indexing the following query:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "query": {
    "wildcard": {
      "my_field": "*xyz"
    }
  }
}</pre>
</div>
<p>the following query below should be indexed:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /my_queries2/_doc/2?refresh
{
  "query": {
    "match": { <a id="CO74-1"></a><i class="conum" data-value="1"></i>
      "my_field.suffix": "xyz"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/254.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO74-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">match</code> query should be used instead of the <code class="literal">term</code> query,
because text analysis needs to reverse the query terms.</p>
</td>
</tr>
</table>
</div>
<p>The following search request will match with the previously indexed
percolator query:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my_queries2/_search
{
  "query": {
    "percolate": {
      "field": "query",
      "document": {
        "my_field": "wxyz"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/255.console"></div>
<h4><a id="_dedicated_percolator_index"></a>Dedicated Percolator Index<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h4>
<p>Percolate queries can be added to any index. Instead of adding percolate queries to the index the data resides in,
these queries can also be added to a dedicated index. The advantage of this is that this dedicated percolator index
can have its own index settings (For example the number of primary and replica shards). If you choose to have a dedicated
percolate index, you need to make sure that the mappings from the normal index are also available on the percolate index.
Otherwise percolate queries can be parsed incorrectly.</p>
<h4><a id="_forcing_unmapped_fields_to_be_handled_as_strings"></a>Forcing Unmapped Fields to be Handled as Strings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h4>
<p>In certain cases it is unknown what kind of percolator queries do get registered, and if no field mapping exists for fields
that are referred by percolator queries then adding a percolator query fails. This means the mapping needs to be updated
to have the field with the appropriate settings, and then the percolator query can be added. But sometimes it is sufficient
if all unmapped fields are handled as if these were default text fields. In those cases one can configure the
<code class="literal">index.percolator.map_unmapped_fields_as_text</code> setting to <code class="literal">true</code> (default to <code class="literal">false</code>) and then if a field referred in
a percolator query does not exist, it will be handled as a default text field so that adding the percolator query doesn&#8217;t
fail.</p>
<h4><a id="_limitations_2"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h4>
<h5><a id="parent-child"></a>Parent/child<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h5>
<p>Because the <code class="literal">percolate</code> query is processing one document at a time, it doesn&#8217;t support queries and filters that run
against child documents such as <code class="literal">has_child</code> and <code class="literal">has_parent</code>.</p>
<h5><a id="_fetching_queries"></a>Fetching queries<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h5>
<p>There are a number of queries that fetch data via a get call during query parsing. For example the <code class="literal">terms</code> query when
using terms lookup, <code class="literal">template</code> query when using indexed scripts and <code class="literal">geo_shape</code> when using pre-indexed shapes. When these
queries are indexed by the <code class="literal">percolator</code> field type then the get call is executed once. So each time the <code class="literal">percolator</code>
query evaluates these queries, the fetches terms, shapes etc. as the were upon index time will be used. Important to note
is that fetching of terms that these queries do, happens both each time the percolator query gets indexed on both primary
and replica shards, so the terms that are actually indexed can be different between shard copies, if the source index
changed while indexing.</p>
<h5><a id="_script_query"></a>Script query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h5>
<p>The script inside a <code class="literal">script</code> query can only access doc values fields. The <code class="literal">percolate</code> query indexes the provided document
into an in-memory index. This in-memory index doesn&#8217;t support stored fields and because of that the <code class="literal">_source</code> field and
other stored fields are not stored. This is the reason why in the <code class="literal">script</code> query the <code class="literal">_source</code> and other stored fields
aren&#8217;t available.</p>
<h5><a id="_field_aliases"></a>Field aliases<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/percolator.asciidoc">edit</a></h5>
<p>Percolator queries that contain <a class="xref" href="mapping-types.html#field-alias" title="Alias field type">field aliases</a> may not always behave as expected. In particular, if a
percolator query is registered that contains a field alias, and then that alias is updated in the mappings to refer
to a different field, the stored query will still refer to the original target field. To pick up the change to
the field alias, the percolator query must be explicitly reindexed.</p>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="point"></a>Point field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/point.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">point</code> data type facilitates the indexing of and searching
arbitrary <code class="literal">x, y</code> pairs that fall in a 2-dimensional planar
coordinate system.</p>
<p>You can query documents using this type using
<a class="xref" href="shape-queries.html#query-dsl-shape-query" title="Shape query">shape Query</a>.</p>
<p>As with <a class="xref" href="mapping-types.html#geo-shape" title="Geoshape field type">geo_shape</a> and <a class="xref" href="mapping-types.html#geo-point" title="Geopoint field type">geo_point</a>, <code class="literal">point</code> can be specified in <a href="http://geojson.org" class="ulink" target="_top">GeoJSON</a>
and <a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">Well-Known Text</a> formats.
However, there are a number of additional formats that are supported for convenience and historical reasons.
In total there are five ways that a cartesian point may be specified, as demonstrated below:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "location": {
        "type": "point"
      }
    }
  }
}

PUT my-index-000001/_doc/1
{
  "text": "Point as an object using GeoJSON format",
  "location": { <a id="CO75-1"></a><i class="conum" data-value="1"></i>
    "type": "Point",
    "coordinates": [-71.34, 41.12]
  }
}

PUT my-index-000001/_doc/2
{
  "text": "Point as a WKT POINT primitive",
  "location" : "POINT (-71.34 41.12)" <a id="CO75-2"></a><i class="conum" data-value="2"></i>
}

PUT my-index-000001/_doc/3
{
  "text": "Point as an object with 'x' and 'y' keys",
  "location": { <a id="CO75-3"></a><i class="conum" data-value="3"></i>
    "x": -71.34,
    "y": 41.12
  }
}

PUT my-index-000001/_doc/4
{
  "text": "Point as an array",
  "location": [ -71.34, 41.12 ] <a id="CO75-4"></a><i class="conum" data-value="4"></i>
}

PUT my-index-000001/_doc/5
{
  "text": "Point as a string",
  "location": "-71.34,41.12" <a id="CO75-5"></a><i class="conum" data-value="5"></i>
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/256.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO75-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Point expressed as an object, in <a href="https://geojson.org/" class="ulink" target="_top">GeoJSON</a> format, with <code class="literal">type</code> and <code class="literal">coordinates</code> keys.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO75-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Point expressed as a <a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">Well-Known Text</a>
POINT with the format: <code class="literal">"POINT(x y)"</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO75-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Point expressed as an object, with <code class="literal">x</code> and <code class="literal">y</code> keys.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO75-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Point expressed as an array with the format: [ <code class="literal">x</code>, <code class="literal">y</code>]</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO75-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Point expressed as a string with the format: <code class="literal">"x,y"</code>.</p>
</td>
</tr>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Unlike the case with the <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.9/geo-point.html" class="ulink" target="_top">geo-point</a> field type,
the order of the coordinates <code class="literal">x</code> and <code class="literal">y</code> is the same for all formats above.</p>
</div>
</div>
<p>The coordinates provided to the indexer are single precision floating point values so
the field guarantees the same accuracy provided by the java virtual machine (typically
<code class="literal">1E-38</code>).</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="point-params"></a>Parameters for <code class="literal">point</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/point.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">point</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#ignore-malformed" title="ignore_malformed"><code class="literal">ignore_malformed</code></a>
</p>
</td>
<td valign="top">
<p>
If <code class="literal">true</code>, malformed points are ignored. If <code class="literal">false</code> (default),
malformed points throw an exception and reject the whole document.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">ignore_z_value</code>
</p>
</td>
<td valign="top">
<p>
If <code class="literal">true</code> (default) three dimension points will be accepted (stored in source)
but only x and y values will be indexed; the third dimension is
ignored. If <code class="literal">false</code>, points containing any more than x and y
(two dimensions) values throw an exception and reject the whole document.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</p>
</td>
<td valign="top">
<p>
Accepts an point value which is substituted for any explicit <code class="literal">null</code> values.
Defaults to <code class="literal">null</code>, which means the field is treated as missing.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_sorting_and_retrieving_points"></a>Sorting and retrieving points<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/point.asciidoc">edit</a></h3>
</div></div></div>
<p>It is currently not possible to sort points or retrieve their fields
directly. The <code class="literal">point</code> value is only retrievable through the <code class="literal">_source</code>
field.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="range"></a>Range field types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/range.asciidoc">edit</a></h2>
</div></div></div>

<p>Range field types represent a continuous range of values between an upper and lower
bound. For example, a range can represent <em>any date in October</em> or <em>any
integer from 0 to 9</em>. They are defined using the operators
<code class="literal">gt</code> or <code class="literal">gte</code> for the lower bound, and <code class="literal">lt</code> or <code class="literal">lte</code> for the upper bound.
They can be used for querying, and have
limited support for aggregations. The only supported aggregations are
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.9/search-aggregations-bucket-histogram-aggregation.html" class="ulink" target="_top">histogram</a>,
<a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.9/search-aggregations-metrics-cardinality-aggregation.html" class="ulink" target="_top">cardinality</a>.</p>
<p>The following range types are supported:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<code class="literal">integer_range</code>
</p>
</td>
<td valign="top">
<p>
A range of signed 32-bit integers with a minimum value of <code class="literal">-2<sup>31</sup></code> and maximum of <code class="literal">2<sup>31</sup>-1</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">float_range</code>
</p>
</td>
<td valign="top">
<p>
A range of single-precision 32-bit IEEE 754 floating point values.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">long_range</code>
</p>
</td>
<td valign="top">
<p>
A range of signed 64-bit integers with a minimum value of <code class="literal">-2<sup>63</sup></code> and maximum of <code class="literal">2<sup>63</sup>-1</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">double_range</code>
</p>
</td>
<td valign="top">
<p>
A range of double-precision 64-bit IEEE 754 floating point values.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">date_range</code>
</p>
</td>
<td valign="top">
<p>
A range of <a class="xref" href="mapping-types.html#date" title="Date field type"><code class="literal">date</code></a> values. Date ranges support various date formats
through the <a class="xref" href="mapping-params.html#mapping-date-format" title="format"><code class="literal">format</code></a> mapping parameter. Regardless of
the format used, date values are parsed into an unsigned 64-bit integer
representing milliseconds since the Unix epoch in UTC. Values containing the
<code class="literal">now</code> <a class="xref" href="common-options.html#date-math" title="Date Math">date math</a> expression are not supported.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">ip_range</code>
</p>
</td>
<td valign="top">
<p>
A range of ip values supporting either <a href="https://en.wikipedia.org/wiki/IPv4" class="ulink" target="_top">IPv4</a> or
<a href="https://en.wikipedia.org/wiki/IPv6" class="ulink" target="_top">IPv6</a> (or mixed) addresses.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>Below is an example of configuring a mapping with various range fields followed by an example that indexes several range types.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT range_index
{
  "settings": {
    "number_of_shards": 2
  },
  "mappings": {
    "properties": {
      "expected_attendees": {
        "type": "integer_range"
      },
      "time_frame": {
        "type": "date_range", <a id="CO76-1"></a><i class="conum" data-value="1"></i>
        "format": "yyyy-MM-dd HH:mm:ss||yyyy-MM-dd||epoch_millis"
      }
    }
  }
}

PUT range_index/_doc/1?refresh
{
  "expected_attendees" : { <a id="CO76-2"></a><i class="conum" data-value="2"></i>
    "gte" : 10,
    "lt" : 20
  },
  "time_frame" : {
    "gte" : "2015-10-31 12:00:00", <a id="CO76-3"></a><i class="conum" data-value="3"></i>
    "lte" : "2015-11-01"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/257.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO76-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">date_range</code> types accept the same field parameters defined by the <a class="xref" href="mapping-types.html#date" title="Date field type"><code class="literal">date</code></a> type.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO76-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Example indexing a meeting with 10 to 20 attendees, not including 20.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO76-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Example date range using date time stamp.</p>
</td>
</tr>
</table>
</div>
<p>The following is an example of a <a class="xref" href="term-level-queries.html#query-dsl-term-query" title="Term query">term query</a> on the <code class="literal">integer_range</code> field named "expected_attendees".
12 is a value inside the range, so it will match.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET range_index/_search
{
  "query" : {
    "term" : {
      "expected_attendees" : {
        "value": 12
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/258.console"></div>
<p>The result produced by the above query.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took": 13,
  "timed_out": false,
  "_shards" : {
    "total": 2,
    "successful": 2,
    "skipped" : 0,
    "failed": 0
  },
  "hits" : {
    "total" : {
        "value": 1,
        "relation": "eq"
    },
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "range_index",
        "_id" : "1",
        "_score" : 1.0,
        "_source" : {
          "expected_attendees" : {
            "gte" : 10, "lt" : 20
          },
          "time_frame" : {
            "gte" : "2015-10-31 12:00:00", "lte" : "2015-11-01"
          }
        }
      }
    ]
  }
}</pre>
</div>
<p>The following is an example of a <code class="literal">date_range</code> query over the <code class="literal">date_range</code> field named "time_frame".</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET range_index/_search
{
  "query" : {
    "range" : {
      "time_frame" : { <a id="CO77-1"></a><i class="conum" data-value="1"></i>
        "gte" : "2015-10-31",
        "lte" : "2015-11-01",
        "relation" : "within" <a id="CO77-2"></a><i class="conum" data-value="2"></i>
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/259.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO77-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Range queries work the same as described in <a class="xref" href="term-level-queries.html#query-dsl-range-query" title="Range query">range query</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO77-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Range queries over range <a class="xref" href="mapping-types.html" title="Field data types">fields</a> support a <code class="literal">relation</code> parameter which can be one of <code class="literal">WITHIN</code>, <code class="literal">CONTAINS</code>,
<code class="literal">INTERSECTS</code> (default).</p>
</td>
</tr>
</table>
</div>
<p>This query produces a similar result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took": 13,
  "timed_out": false,
  "_shards" : {
    "total": 2,
    "successful": 2,
    "skipped" : 0,
    "failed": 0
  },
  "hits" : {
    "total" : {
        "value": 1,
        "relation": "eq"
    },
    "max_score" : 1.0,
    "hits" : [
      {
        "_index" : "range_index",
        "_id" : "1",
        "_score" : 1.0,
        "_source" : {
          "expected_attendees" : {
            "gte" : 10, "lt" : 20
          },
          "time_frame" : {
            "gte" : "2015-10-31 12:00:00", "lte" : "2015-11-01"
          }
        }
      }
    ]
  }
}</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ip-range"></a>IP Range<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/range.asciidoc">edit</a></h3>
</div></div></div>
<p>In addition to the range format above, IP ranges can be provided in
<a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing#CIDR_notation" class="ulink" target="_top">CIDR</a> notation:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT range_index/_mapping
{
  "properties": {
    "ip_allowlist": {
      "type": "ip_range"
    }
  }
}

PUT range_index/_doc/2
{
  "ip_allowlist" : "192.168.0.0/16"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/260.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="range-params"></a>Parameters for range fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/range.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by range types:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#coerce" title="coerce"><code class="literal">coerce</code></a>
</p>
</td>
<td valign="top">
<p>
Try to convert strings to numbers and truncate fractions for integers.
Accepts <code class="literal">true</code> (default) and <code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be searchable? Accepts <code class="literal">true</code> (default) and <code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</p>
</td>
<td valign="top">
<p>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rank-feature"></a>Rank feature field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/rank-feature.asciidoc">edit</a></h2>
</div></div></div>

<p>A <code class="literal">rank_feature</code> field can index numbers so that they can later be used to boost
documents in queries with a <a class="xref" href="specialized-queries.html#query-dsl-rank-feature-query" title="Rank feature query"><code class="literal">rank_feature</code></a> query.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "pagerank": {
        "type": "rank_feature" <a id="CO78-1"></a><i class="conum" data-value="1"></i>
      },
      "url_length": {
        "type": "rank_feature",
        "positive_score_impact": false <a id="CO78-2"></a><i class="conum" data-value="2"></i>
      }
    }
  }
}

PUT my-index-000001/_doc/1
{
  "pagerank": 8,
  "url_length": 22
}

GET my-index-000001/_search
{
  "query": {
    "rank_feature": {
      "field": "pagerank"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/261.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO78-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Rank feature fields must use the <code class="literal">rank_feature</code> field type</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO78-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Rank features that correlate negatively with the score need to declare it</p>
</td>
</tr>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">rank_feature</code> fields only support single-valued fields and strictly positive
values. Multi-valued fields and negative values will be rejected.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">rank_feature</code> fields do not support querying, sorting or aggregating. They may
only be used within <a class="xref" href="specialized-queries.html#query-dsl-rank-feature-query" title="Rank feature query"><code class="literal">rank_feature</code></a> queries.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">rank_feature</code> fields only preserve 9 significant bits for the precision, which
translates to a relative error of about 0.4%.</p>
</div>
</div>
<p>Rank features that correlate negatively with the score should set
<code class="literal">positive_score_impact</code> to <code class="literal">false</code> (defaults to <code class="literal">true</code>). This will be used by
the <a class="xref" href="specialized-queries.html#query-dsl-rank-feature-query" title="Rank feature query"><code class="literal">rank_feature</code></a> query to modify the scoring formula
in such a way that the score decreases with the value of the feature instead of
increasing. For instance in web search, the url length is a commonly used
feature which correlates negatively with scores.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rank-features"></a>Rank features field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/rank-features.asciidoc">edit</a></h2>
</div></div></div>

<p>A <code class="literal">rank_features</code> field can index numeric feature vectors, so that they can
later be used to boost documents in queries with a
<a class="xref" href="specialized-queries.html#query-dsl-rank-feature-query" title="Rank feature query"><code class="literal">rank_feature</code></a> query.</p>
<p>It is analogous to the <a class="xref" href="mapping-types.html#rank-feature" title="Rank feature field type"><code class="literal">rank_feature</code></a> data type but is better suited
when the list of features is sparse so that it wouldn&#8217;t be reasonable to add
one field to the mappings for each of them.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "topics": {
        "type": "rank_features" <a id="CO79-1"></a><i class="conum" data-value="1"></i>
      },
      "negative_reviews" : {
        "type": "rank_features",
        "positive_score_impact": false <a id="CO79-2"></a><i class="conum" data-value="2"></i>
      }
    }
  }
}

PUT my-index-000001/_doc/1
{
  "topics": { <a id="CO79-3"></a><i class="conum" data-value="3"></i>
    "politics": 20,
    "economics": 50.8
  },
  "negative_reviews": {
    "1star": 10,
    "2star": 100
  }
}

PUT my-index-000001/_doc/2
{
  "topics": {
    "politics": 5.2,
    "sports": 80.1
  },
  "negative_reviews": {
    "1star": 1,
    "2star": 10
  }
}

GET my-index-000001/_search
{
  "query": { <a id="CO79-4"></a><i class="conum" data-value="4"></i>
    "rank_feature": {
      "field": "topics.politics"
    }
  }
}

GET my-index-000001/_search
{
  "query": { <a id="CO79-5"></a><i class="conum" data-value="5"></i>
    "rank_feature": {
      "field": "negative_reviews.1star"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/262.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO79-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Rank features fields must use the <code class="literal">rank_features</code> field type</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO79-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Rank features that correlate negatively with the score need to declare it</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO79-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Rank features fields must be a hash with string keys and strictly positive numeric values</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO79-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>This query ranks documents by how much they are about the "politics" topic.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO79-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>This query ranks documents inversely to the number of "1star" reviews they received.</p>
</td>
</tr>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">rank_features</code> fields only support single-valued features and strictly
positive values. Multi-valued fields and zero or negative values will be rejected.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">rank_features</code> fields do not support sorting or aggregating and may
only be queried using <a class="xref" href="specialized-queries.html#query-dsl-rank-feature-query" title="Rank feature query"><code class="literal">rank_feature</code></a> or <a class="xref" href="term-level-queries.html#query-dsl-term-query" title="Term query"><code class="literal">term</code></a> queries.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><a class="xref" href="term-level-queries.html#query-dsl-term-query" title="Term query"><code class="literal">term</code></a> queries on <code class="literal">rank_features</code> fields are scored by multiplying the matched
stored feature value by the provided <code class="literal">boost</code>.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">rank_features</code> fields only preserve 9 significant bits for the
precision, which translates to a relative error of about 0.4%.</p>
</div>
</div>
<p>Rank features that correlate negatively with the score should set
<code class="literal">positive_score_impact</code> to <code class="literal">false</code> (defaults to <code class="literal">true</code>). This will be used by
the <a class="xref" href="specialized-queries.html#query-dsl-rank-feature-query" title="Rank feature query"><code class="literal">rank_feature</code></a> query to modify the scoring formula
in such a way that the score decreases with the value of the feature instead of
increasing.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="search-as-you-type"></a>Search-as-you-type field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/search-as-you-type.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">search_as_you_type</code> field type is a text-like field that is optimized to
provide out-of-the-box support for queries that serve an as-you-type completion
use case. It creates a series of subfields that are analyzed to index terms
that can be efficiently matched by a query that partially matches the entire
indexed text value. Both prefix completion (i.e matching terms starting at the
beginning of the input) and infix completion (i.e. matching terms at any
position within the input) are supported.</p>
<p>When adding a field of this type to a mapping</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "my_field": {
        "type": "search_as_you_type"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/263.console"></div>
<p>This creates the following fields</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<code class="literal">my_field</code>
</p>
</td>
<td valign="top">
<p>
Analyzed as configured in the mapping. If an analyzer is not configured,
the default analyzer for the index is used
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">my_field._2gram</code>
</p>
</td>
<td valign="top">
<p>
Wraps the analyzer of <code class="literal">my_field</code> with a shingle token filter of shingle
size 2
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">my_field._3gram</code>
</p>
</td>
<td valign="top">
<p>
Wraps the analyzer of <code class="literal">my_field</code> with a shingle token filter of shingle
size 3
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">my_field._index_prefix</code>
</p>
</td>
<td valign="top">
<p>
Wraps the analyzer of <code class="literal">my_field._3gram</code> with an edge ngram token filter
</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>The size of shingles in subfields can be configured with the <code class="literal">max_shingle_size</code>
mapping parameter. The default is 3, and valid values for this parameter are
integer values 2 - 4 inclusive. Shingle subfields will be created for each
shingle size from 2 up to and including the <code class="literal">max_shingle_size</code>. The
<code class="literal">my_field._index_prefix</code> subfield will always use the analyzer from the shingle
subfield with the <code class="literal">max_shingle_size</code> when constructing its own analyzer.</p>
<p>Increasing the <code class="literal">max_shingle_size</code> will improve matches for queries with more
consecutive terms, at the cost of larger index size. The default
<code class="literal">max_shingle_size</code> should usually be sufficient.</p>
<p>The same input text is indexed into each of these fields automatically, with
their differing analysis chains, when an indexed document has a value for the
root field <code class="literal">my_field</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_doc/1?refresh
{
  "my_field": "quick brown fox jump lazy dog"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/264.console"></div>
<p>The most efficient way of querying to serve a search-as-you-type use case is
usually a <a class="xref" href="full-text-queries.html#query-dsl-multi-match-query" title="Multi-match query"><code class="literal">multi_match</code></a> query of type
<a class="xref" href="full-text-queries.html#query-dsl-match-bool-prefix-query" title="Match boolean prefix query"><code class="literal">bool_prefix</code></a> that targets the root
<code class="literal">search_as_you_type</code> field and its shingle subfields. This can match the query
terms in any order, but will score documents higher if they contain the terms
in order in a shingle subfield.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search
{
  "query": {
    "multi_match": {
      "query": "brown f",
      "type": "bool_prefix",
      "fields": [
        "my_field",
        "my_field._2gram",
        "my_field._3gram"
      ]
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/265.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took" : 44,
  "timed_out" : false,
  "_shards" : {
    "total" : 1,
    "successful" : 1,
    "skipped" : 0,
    "failed" : 0
  },
  "hits" : {
    "total" : {
      "value" : 1,
      "relation" : "eq"
    },
    "max_score" : 0.8630463,
    "hits" : [
      {
        "_index" : "my-index-000001",
        "_id" : "1",
        "_score" : 0.8630463,
        "_source" : {
          "my_field" : "quick brown fox jump lazy dog"
        }
      }
    ]
  }
}</pre>
</div>
<p>To search for documents that strictly match the query terms in order, or to
search using other properties of phrase queries, use a
<a class="xref" href="full-text-queries.html#query-dsl-match-query-phrase-prefix" title="Match phrase prefix query"><code class="literal">match_phrase_prefix</code> query</a> on the root
field. A <a class="xref" href="full-text-queries.html#query-dsl-match-query-phrase" title="Match phrase query"><code class="literal">match_phrase</code> query</a> can also be used
if the last term should be matched exactly, and not as a prefix. Using phrase
queries may be less efficient than using the <code class="literal">match_bool_prefix</code> query.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET my-index-000001/_search
{
  "query": {
    "match_phrase_prefix": {
      "my_field": "brown f"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/266.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="specific-params"></a>Parameters specific to the <code class="literal">search_as_you_type</code> field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/search-as-you-type.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted in a mapping for the <code class="literal">search_as_you_type</code>
field and are specific to this field type</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">max_shingle_size</code>
</span>
</dt>
<dd>
<p>(Optional, integer)
Largest shingle size to create. Valid values are <code class="literal">2</code> (inclusive) to <code class="literal">4</code>
(inclusive). Defaults to <code class="literal">3</code>.</p>
<p>A subfield is created for each integer between <code class="literal">2</code> and this value. For example,
a value of <code class="literal">3</code> creates two subfields: <code class="literal">my_field._2gram</code> and <code class="literal">my_field._3gram</code></p>
<p>More subfields enables more specific queries but increases index size.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="general-params"></a>Parameters of the field type as a text field<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/search-as-you-type.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted in a mapping for the <code class="literal">search_as_you_type</code>
field due to its nature as a text-like field, and behave similarly to their
behavior when configuring a field of the <a class="xref" href="mapping-types.html#text" title="Text type family"><code class="literal">text</code></a> data type. Unless
otherwise noted, these options configure the root fields subfields in
the same way.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#analyzer" title="analyzer"><code class="literal">analyzer</code></a>
</span>
</dt>
<dd>
The <a class="xref" href="analysis.html" title="Text analysis">analyzer</a> which should be used for
<code class="literal">text</code> fields, both at index-time and at
search-time (unless overridden by the
<a class="xref" href="mapping-params.html#search-analyzer" title="search_analyzer"><code class="literal">search_analyzer</code></a>). Defaults to the default index
analyzer, or the <a class="xref" href="analysis-analyzers.html#analysis-standard-analyzer" title="Standard analyzer"><code class="literal">standard</code> analyzer</a>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</span>
</dt>
<dd>
Should the field be searchable? Accepts <code class="literal">true</code> (default) or <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#index-options" title="index_options"><code class="literal">index_options</code></a>
</span>
</dt>
<dd>
What information should be stored in the index, for search and highlighting
purposes. Defaults to <code class="literal">positions</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#norms" title="norms"><code class="literal">norms</code></a>
</span>
</dt>
<dd>
Whether field-length should be taken into account when scoring queries.
Accepts <code class="literal">true</code> or <code class="literal">false</code>. This option configures the root field
and shingle subfields, where its default is <code class="literal">true</code>. It does not configure
the prefix subfield, where it is <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</span>
</dt>
<dd>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default). This option only configures the root field, and does not
configure any subfields.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#search-analyzer" title="search_analyzer"><code class="literal">search_analyzer</code></a>
</span>
</dt>
<dd>
The <a class="xref" href="mapping-params.html#analyzer" title="analyzer"><code class="literal">analyzer</code></a> that should be used at search time on
<a class="xref" href="mapping-types.html#text" title="Text type family"><code class="literal">text</code></a> fields. Defaults to the <code class="literal">analyzer</code> setting.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#search-quote-analyzer" title="search_quote_analyzer"><code class="literal">search_quote_analyzer</code></a>
</span>
</dt>
<dd>
The <a class="xref" href="mapping-params.html#analyzer" title="analyzer"><code class="literal">analyzer</code></a> that should be used at search time when a
phrase is encountered. Defaults to the <code class="literal">search_analyzer</code> setting.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#similarity" title="similarity"><code class="literal">similarity</code></a>
</span>
</dt>
<dd>
Which scoring algorithm or <em>similarity</em> should be used. Defaults
to <code class="literal">BM25</code>.
</dd>
<dt>
<span class="term">
<a class="xref" href="mapping-params.html#term-vector" title="term_vector"><code class="literal">term_vector</code></a>
</span>
</dt>
<dd>
Whether term vectors should be stored for the field. Defaults to <code class="literal">no</code>. This option configures the root field and shingle
subfields, but not the prefix subfield.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="prefix-queries"></a>Optimization of prefix queries<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/search-as-you-type.asciidoc">edit</a></h3>
</div></div></div>
<p>When making a <a class="xref" href="term-level-queries.html#query-dsl-prefix-query" title="Prefix query"><code class="literal">prefix</code></a> query to the root field or
any of its subfields, the query will be rewritten to a
<a class="xref" href="term-level-queries.html#query-dsl-term-query" title="Term query"><code class="literal">term</code></a> query on the <code class="literal">._index_prefix</code> subfield. This
matches more efficiently than is typical of <code class="literal">prefix</code> queries on text fields,
as prefixes up to a certain length of each shingle are indexed directly as
terms in the <code class="literal">._index_prefix</code> subfield.</p>
<p>The analyzer of the <code class="literal">._index_prefix</code> subfield slightly modifies the
shingle-building behavior to also index prefixes of the terms at the end of the
field&#8217;s value that normally would not be produced as shingles. For example, if
the value <code class="literal">quick brown fox</code> is indexed into a <code class="literal">search_as_you_type</code> field with
<code class="literal">max_shingle_size</code> of 3, prefixes for <code class="literal">brown fox</code> and <code class="literal">fox</code> are also indexed
into the <code class="literal">._index_prefix</code> subfield even though they do not appear as terms in
the <code class="literal">._3gram</code> subfield. This allows for completion of all the terms in the
field&#8217;s input.</p>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="shape"></a>Shape field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">shape</code> data type facilitates the indexing of and searching
with arbitrary <code class="literal">x, y</code> cartesian shapes such as rectangles and polygons. It can be
used to index and query geometries whose coordinates fall in a 2-dimensional planar
coordinate system.</p>
<p>You can query documents using this type using
<a class="xref" href="shape-queries.html#query-dsl-shape-query" title="Shape query">shape Query</a>.</p>
<h4><a id="shape-mapping-options"></a>Mapping Options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h4>
<p>Like the <a class="xref" href="mapping-types.html#geo-shape" title="Geoshape field type"><code class="literal">geo_shape</code></a> field type, the <code class="literal">shape</code> field mapping maps
<a href="http://geojson.org" class="ulink" target="_top">GeoJSON</a> or <a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">Well-Known Text</a>
(WKT) geometry objects to the shape type. To enable it, users must explicitly map
fields to the shape type.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Option</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">orientation</code></p></td>
<td align="left" valign="top"><p>Optionally define how to interpret vertex order for
polygons / multipolygons. This parameter defines one of two coordinate
system rules (Right-hand or Left-hand) each of which can be specified in three
different ways. 1. Right-hand rule: <code class="literal">right</code>, <code class="literal">ccw</code>, <code class="literal">counterclockwise</code>,
2. Left-hand rule: <code class="literal">left</code>, <code class="literal">cw</code>, <code class="literal">clockwise</code>. The default orientation
(<code class="literal">counterclockwise</code>) complies with the OGC standard which defines
outer ring vertices in counterclockwise order with inner ring(s) vertices (holes)
in clockwise order. Setting this parameter in the <code class="literal">geo_shape</code> mapping explicitly
sets vertex order for the coordinate list of a <code class="literal">geo_shape</code> field but can be
overridden in each individual GeoJSON or WKT document.</p></td>
<td align="left" valign="top"><p><code class="literal">ccw</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_malformed</code></p></td>
<td align="left" valign="top"><p>If true, malformed GeoJSON or WKT shapes are ignored. If
false (default), malformed GeoJSON and WKT shapes throw an exception and reject the
entire document.</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_z_value</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> (default) three dimension points will be accepted (stored in source)
but only latitude and longitude values will be indexed; the third dimension is ignored. If <code class="literal">false</code>,
geopoints containing any more than latitude and longitude (two dimensions) values throw an exception
and reject the whole document.</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">coerce</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> unclosed linear rings in polygons will be automatically closed.</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="shape-indexing-approach"></a>Indexing approach<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h4>
<p>Like <code class="literal">geo_shape</code>, the <code class="literal">shape</code> field type is indexed by decomposing geometries into
a triangular mesh and indexing each triangle as a 7 dimension point in a BKD tree.
The coordinates provided to the indexer are single precision floating point values so
the field guarantees the same accuracy provided by the java virtual machine (typically
<code class="literal">1E-38</code>). For polygons/multi-polygons the performance of the tessellator primarily
depends on the number of vertices that define the geometry.</p>
<p><span class="strong strong"><strong>IMPORTANT NOTES</strong></span></p>
<p><code class="literal">CONTAINS</code> relation query - <code class="literal">shape</code> queries with <code class="literal">relation</code> defined as <code class="literal">contains</code> are supported
for indices created with ElasticSearch 7.5.0 or higher.</p>
<h5><a id="_example_2"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /example
{
  "mappings": {
    "properties": {
      "geometry": {
        "type": "shape"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/267.console"></div>
<p>This mapping definition maps the geometry field to the shape type. The indexer uses single
precision floats for the vertex values so accuracy is guaranteed to the same precision as
<code class="literal">float</code> values provided by the java virtual machine approximately (typically 1E-38).</p>
<h4><a id="shape-input-structure"></a>Input Structure<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h4>
<p>Shapes can be represented using either the <a href="http://geojson.org" class="ulink" target="_top">GeoJSON</a>
or <a href="https://docs.opengeospatial.org/is/12-063r5/12-063r5.html" class="ulink" target="_top">Well-Known Text</a>
(WKT) format. The following table provides a mapping of GeoJSON and WKT
to Elasticsearch types:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">GeoJSON Type</th>
<th align="left" valign="top">WKT Type</th>
<th align="left" valign="top">Elasticsearch Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">Point</code></p></td>
<td align="left" valign="top"><p><code class="literal">POINT</code></p></td>
<td align="left" valign="top"><p><code class="literal">point</code></p></td>
<td align="left" valign="top"><p>A single <code class="literal">x, y</code> coordinate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">LineString</code></p></td>
<td align="left" valign="top"><p><code class="literal">LINESTRING</code></p></td>
<td align="left" valign="top"><p><code class="literal">linestring</code></p></td>
<td align="left" valign="top"><p>An arbitrary line given two or more points.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">Polygon</code></p></td>
<td align="left" valign="top"><p><code class="literal">POLYGON</code></p></td>
<td align="left" valign="top"><p><code class="literal">polygon</code></p></td>
<td align="left" valign="top"><p>A <em>closed</em> polygon whose first and last point
must match, thus requiring <code class="literal">n + 1</code> vertices to create an <code class="literal">n</code>-sided
polygon and a minimum of <code class="literal">4</code> vertices.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">MultiPoint</code></p></td>
<td align="left" valign="top"><p><code class="literal">MULTIPOINT</code></p></td>
<td align="left" valign="top"><p><code class="literal">multipoint</code></p></td>
<td align="left" valign="top"><p>An array of unconnected, but likely related
points.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">MultiLineString</code></p></td>
<td align="left" valign="top"><p><code class="literal">MULTILINESTRING</code></p></td>
<td align="left" valign="top"><p><code class="literal">multilinestring</code></p></td>
<td align="left" valign="top"><p>An array of separate linestrings.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">MultiPolygon</code></p></td>
<td align="left" valign="top"><p><code class="literal">MULTIPOLYGON</code></p></td>
<td align="left" valign="top"><p><code class="literal">multipolygon</code></p></td>
<td align="left" valign="top"><p>An array of separate polygons.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">GeometryCollection</code></p></td>
<td align="left" valign="top"><p><code class="literal">GEOMETRYCOLLECTION</code></p></td>
<td align="left" valign="top"><p><code class="literal">geometrycollection</code></p></td>
<td align="left" valign="top"><p>A shape collection similar to the
<code class="literal">multi*</code> shapes except that multiple types can coexist (e.g., a Point and a LineString).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">N/A</code></p></td>
<td align="left" valign="top"><p><code class="literal">BBOX</code></p></td>
<td align="left" valign="top"><p><code class="literal">envelope</code></p></td>
<td align="left" valign="top"><p>A bounding rectangle, or envelope, specified by
specifying only the top left and bottom right points.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For all types, both the inner <code class="literal">type</code> and <code class="literal">coordinates</code> fields are required.</p>
<p>In GeoJSON and WKT, and therefore Elasticsearch, the correct <span class="strong strong"><strong>coordinate order is (X, Y)</strong></span>
within coordinate arrays. This differs from many Geospatial APIs (e.g., <code class="literal">geo_shape</code>) that
typically use the colloquial latitude, longitude (Y, X) ordering.</p>
</div>
</div>
<h5><a id="point-shape"></a><a href="http://geojson.org/geojson-spec.html#id2" class="ulink" target="_top">Point</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h5>
<p>A point is a single coordinate in cartesian <code class="literal">x, y</code> space. It may represent the
location of an item of interest in a virtual world or projected space. The
following is an example of a point in GeoJSON.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "point",
    "coordinates" : [-377.03653, 389.897676]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/268.console"></div>
<p>The following is an example of a point in WKT:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "POINT (-377.03653 389.897676)"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/269.console"></div>
<h5><a id="linestring"></a><a href="http://geojson.org/geojson-spec.html#id3" class="ulink" target="_top">LineString</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h5>
<p>A <code class="literal">linestring</code> defined by an array of two or more positions. By
specifying only two points, the <code class="literal">linestring</code> will represent a straight
line. Specifying more than two points creates an arbitrary path. The
following is an example of a LineString in GeoJSON.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "linestring",
    "coordinates" : [[-377.03653, 389.897676], [-377.009051, 389.889939]]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/270.console"></div>
<p>The following is an example of a LineString in WKT:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "LINESTRING (-377.03653 389.897676, -377.009051 389.889939)"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/271.console"></div>
<h5><a id="polygon"></a><a href="http://geojson.org/geojson-spec.html#id4" class="ulink" target="_top">Polygon</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h5>
<p>A polygon is defined by a list of a list of points. The first and last
points in each (outer) list must be the same (the polygon must be
closed). The following is an example of a Polygon in GeoJSON.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "polygon",
    "coordinates" : [
      [ [1000.0, -1001.0], [1001.0, -1001.0], [1001.0, -1000.0], [1000.0, -1000.0], [1000.0, -1001.0] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/272.console"></div>
<p>The following is an example of a Polygon in WKT:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "POLYGON ((1000.0 -1001.0, 1001.0 -1001.0, 1001.0 -1000.0, 1000.0 -1000.0, 1000.0 -1001.0))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/273.console"></div>
<p>The first array represents the outer boundary of the polygon, the other
arrays represent the interior shapes ("holes"). The following is a GeoJSON example
of a polygon with a hole:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "polygon",
    "coordinates" : [
      [ [1000.0, -1001.0], [1001.0, -1001.0], [1001.0, -1000.0], [1000.0, -1000.0], [1000.0, -1001.0] ],
      [ [1000.2, -1001.2], [1000.8, -1001.2], [1000.8, -1001.8], [1000.2, -1001.8], [1000.2, -1001.2] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/274.console"></div>
<p>The following is an example of a Polygon with a hole in WKT:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "POLYGON ((1000.0 1000.0, 1001.0 1000.0, 1001.0 1001.0, 1000.0 1001.0, 1000.0 1000.0), (1000.2 1000.2, 1000.8 1000.2, 1000.8 1000.8, 1000.2 1000.8, 1000.2 1000.2))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/275.console"></div>
<p><span class="strong strong"><strong>IMPORTANT NOTE:</strong></span> WKT does not enforce a specific order for vertices.
<a href="https://tools.ietf.org/html/rfc7946#section-3.1.6" class="ulink" target="_top">GeoJSON</a> mandates that the
outer polygon must be counterclockwise and interior shapes must be clockwise,
which agrees with the Open Geospatial Consortium (OGC)
<a href="https://www.opengeospatial.org/standards/sfa" class="ulink" target="_top">Simple Feature Access</a>
specification for vertex ordering.</p>
<p>By default Elasticsearch expects vertices in counterclockwise (right hand rule)
order. If data is provided in clockwise order (left hand rule) the user can change
the <code class="literal">orientation</code> parameter either in the field mapping, or as a parameter provided
with the document.</p>
<p>The following is an example of overriding the <code class="literal">orientation</code> parameters on a document:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "polygon",
    "orientation" : "clockwise",
    "coordinates" : [
      [ [1000.0, 1000.0], [1000.0, 1001.0], [1001.0, 1001.0], [1001.0, 1000.0], [1000.0, 1000.0] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/276.console"></div>
<h5><a id="multipoint"></a><a href="http://geojson.org/geojson-spec.html#id5" class="ulink" target="_top">MultiPoint</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h5>
<p>The following is an example of a list of GeoJSON points:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "multipoint",
    "coordinates" : [
      [1002.0, 1002.0], [1003.0, 2000.0]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/277.console"></div>
<p>The following is an example of a list of WKT points:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "MULTIPOINT (1002.0 2000.0, 1003.0 2000.0)"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/278.console"></div>
<h5><a id="multilinestring"></a><a href="http://geojson.org/geojson-spec.html#id6" class="ulink" target="_top">MultiLineString</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h5>
<p>The following is an example of a list of GeoJSON linestrings:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "multilinestring",
    "coordinates" : [
      [ [1002.0, 200.0], [1003.0, 200.0], [1003.0, 300.0], [1002.0, 300.0] ],
      [ [1000.0, 100.0], [1001.0, 100.0], [1001.0, 100.0], [1000.0, 100.0] ],
      [ [1000.2, 100.2], [1000.8, 100.2], [1000.8, 100.8], [1000.2, 100.8] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/279.console"></div>
<p>The following is an example of a list of WKT linestrings:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "MULTILINESTRING ((1002.0 200.0, 1003.0 200.0, 1003.0 300.0, 1002.0 300.0), (1000.0 100.0, 1001.0 100.0, 1001.0 100.0, 1000.0 100.0), (1000.2 0.2, 1000.8 100.2, 1000.8 100.8, 1000.2 100.8))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/280.console"></div>
<h5><a id="multipolygon"></a><a href="http://geojson.org/geojson-spec.html#id7" class="ulink" target="_top">MultiPolygon</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h5>
<p>The following is an example of a list of GeoJSON polygons (second polygon contains a hole):</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "multipolygon",
    "coordinates" : [
      [ [[1002.0, 200.0], [1003.0, 200.0], [1003.0, 300.0], [1002.0, 300.0], [1002.0, 200.0]] ],
      [ [[1000.0, 200.0], [1001.0, 100.0], [1001.0, 100.0], [1000.0, 100.0], [1000.0, 100.0]],
        [[1000.2, 200.2], [1000.8, 100.2], [1000.8, 100.8], [1000.2, 100.8], [1000.2, 100.2]] ]
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/281.console"></div>
<p>The following is an example of a list of WKT polygons (second polygon contains a hole):</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "MULTIPOLYGON (((1002.0 200.0, 1003.0 200.0, 1003.0 300.0, 1002.0 300.0, 102.0 200.0)), ((1000.0 100.0, 1001.0 100.0, 1001.0 100.0, 1000.0 100.0, 1000.0 100.0), (1000.2 100.2, 1000.8 100.2, 1000.8 100.8, 1000.2 100.8, 1000.2 100.2)))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/282.console"></div>
<h5><a id="geometry_collection"></a><a href="http://geojson.org/geojson-spec.html#geometrycollection" class="ulink" target="_top">Geometry Collection</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h5>
<p>The following is an example of a collection of GeoJSON geometry objects:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type": "geometrycollection",
    "geometries": [
      {
        "type": "point",
        "coordinates": [1000.0, 100.0]
      },
      {
        "type": "linestring",
        "coordinates": [ [1001.0, 100.0], [1002.0, 100.0] ]
      }
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/283.console"></div>
<p>The following is an example of a collection of WKT geometry objects:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "GEOMETRYCOLLECTION (POINT (1000.0 100.0), LINESTRING (1001.0 100.0, 1002.0 100.0))"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/284.console"></div>
<h5><a id="_envelope_2"></a>Envelope<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h5>
<p>Elasticsearch supports an <code class="literal">envelope</code> type, which consists of coordinates
for upper left and lower right points of the shape to represent a
bounding rectangle in the format <code class="literal">[[minX, maxY], [maxX, minY]]</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : {
    "type" : "envelope",
    "coordinates" : [ [1000.0, 100.0], [1001.0, 100.0] ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/285.console"></div>
<p>The following is an example of an envelope using the WKT BBOX format:</p>
<p><span class="strong strong"><strong>NOTE:</strong></span> WKT specification expects the following order: minLon, maxLon, maxLat, minLat.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /example/_doc
{
  "location" : "BBOX (1000.0, 1002.0, 2000.0, 1000.0)"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/286.console"></div>
<h4><a id="_sorting_and_retrieving_index_shapes_2"></a>Sorting and Retrieving index Shapes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/shape.asciidoc">edit</a></h4>
<p>Due to the complex input structure and index representation of shapes,
it is not currently possible to sort shapes or retrieve their fields
directly. The <code class="literal">shape</code> value is only retrievable through the <code class="literal">_source</code>
field.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="text"></a>Text type family<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/text.asciidoc">edit</a></h2>
</div></div></div>

<p>The text family includes the following field types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="mapping-types.html#text-field-type" title="Text field type"><code class="literal">text</code></a>, the traditional field type for full-text content
such as the body of an email or the description of a product.
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html#match-only-text-field-type" title="Match-only text field type"><code class="literal">match_only_text</code></a>, a space-optimized variant
of <code class="literal">text</code> that disables scoring and performs slower on queries that need
positions. It is best suited for indexing log messages.
</li>
</ul>
</div>
<h3><a id="text-field-type"></a>Text field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/text.asciidoc">edit</a></h3>
<p>A field to index full-text values, such as the body of an email or the
description of a product. These fields are <code class="literal">analyzed</code>, that is they are passed through an
<a class="xref" href="analysis.html" title="Text analysis">analyzer</a> to convert the string into a list of individual terms
before being indexed. The analysis process allows Elasticsearch to search for
individual words <em>within</em> each full text field. Text fields are not
used for sorting and seldom used for aggregations (although the
<a class="xref" href="search-aggregations-bucket.html#search-aggregations-bucket-significanttext-aggregation" title="Significant text aggregation">significant text aggregation</a>
is a notable exception).</p>
<p><code class="literal">text</code> fields are best suited for unstructured but human-readable content. If
you need to index unstructured machine-generated content, see
<a class="xref" href="mapping-types.html#mapping-unstructured-content" title="Mapping unstructured content">Mapping unstructured content</a>.</p>
<p>If you need to index structured content such as email addresses, hostnames, status
codes, or tags, it is likely that you should rather use a <a class="xref" href="mapping-types.html#keyword" title="Keyword type family"><code class="literal">keyword</code></a> field.</p>
<p>Below is an example of a mapping for a text field:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "full_name": {
        "type":  "text"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/287.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="text-multi-fields"></a>Use a field as both text and keyword<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/text.asciidoc">edit</a></h3>
</div></div></div>
<p>Sometimes it is useful to have both a full text (<code class="literal">text</code>) and a keyword
(<code class="literal">keyword</code>) version of the same field: one for full text search and the
other for aggregations and sorting. This can be achieved with
<a class="xref" href="mapping-params.html#multi-fields" title="fields">multi-fields</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="text-params"></a>Parameters for text fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/text.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">text</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#analyzer" title="analyzer"><code class="literal">analyzer</code></a>
</p>
</td>
<td valign="top">
<p>
The <a class="xref" href="analysis.html" title="Text analysis">analyzer</a> which should be used for
the <code class="literal">text</code> field, both at index-time and at
search-time (unless overridden by the  <a class="xref" href="mapping-params.html#search-analyzer" title="search_analyzer"><code class="literal">search_analyzer</code></a>).
Defaults to the default index analyzer, or the
<a class="xref" href="analysis-analyzers.html#analysis-standard-analyzer" title="Standard analyzer"><code class="literal">standard</code> analyzer</a>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#eager-global-ordinals" title="eager_global_ordinals"><code class="literal">eager_global_ordinals</code></a>
</p>
</td>
<td valign="top">
<p>
Should global ordinals be loaded eagerly on refresh? Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default). Enabling this is a good idea on fields that are frequently used for
(significant) terms aggregations.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-types.html#fielddata-mapping-param" title="fielddata mapping parameter"><code class="literal">fielddata</code></a>
</p>
</td>
<td valign="top">
<p>
Can the field use in-memory fielddata for sorting, aggregations,
or scripting? Accepts <code class="literal">true</code> or <code class="literal">false</code> (default).
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-types.html#field-data-filtering" title="fielddata_frequency_filter mapping parameter"><code class="literal">fielddata_frequency_filter</code></a>
</p>
</td>
<td valign="top">
<p>
Expert settings which allow to decide which values to load in memory when <code class="literal">fielddata</code>
is enabled. By default all values are loaded.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#multi-fields" title="fields"><code class="literal">fields</code></a>
</p>
</td>
<td valign="top">
<p>
Multi-fields allow the same string value to be indexed in multiple ways for
different purposes, such as one field for search and a multi-field for
sorting and aggregations, or the same string value analyzed by different
analyzers.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be searchable? Accepts <code class="literal">true</code> (default) or <code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#index-options" title="index_options"><code class="literal">index_options</code></a>
</p>
</td>
<td valign="top">
<p>
What information should be stored in the index, for search and highlighting purposes.
Defaults to <code class="literal">positions</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#index-prefixes" title="index_prefixes"><code class="literal">index_prefixes</code></a>
</p>
</td>
<td valign="top">
<p>
If enabled, term prefixes of between 2 and 5 characters are indexed into a
separate field. This allows prefix searches to run more efficiently, at
the expense of a larger index.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#index-phrases" title="index_phrases"><code class="literal">index_phrases</code></a>
</p>
</td>
<td valign="top">
<p>
If enabled, two-term word combinations (<em>shingles</em>) are indexed into a separate
field. This allows exact phrase queries (no slop) to run more efficiently, at the expense
of a larger index. Note that this works best when stopwords are not removed,
as phrases containing stopwords will not use the subsidiary field and will fall
back to a standard phrase query. Accepts <code class="literal">true</code> or <code class="literal">false</code> (default).
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#norms" title="norms"><code class="literal">norms</code></a>
</p>
</td>
<td valign="top">
<p>
Whether field-length should be taken into account when scoring queries.
Accepts <code class="literal">true</code> (default) or <code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#position-increment-gap" title="position_increment_gap"><code class="literal">position_increment_gap</code></a>
</p>
</td>
<td valign="top">
<p>
The number of fake term position which should be inserted between each
element of an array of strings. Defaults to the <code class="literal">position_increment_gap</code>
configured on the analyzer which defaults to <code class="literal">100</code>. <code class="literal">100</code> was chosen because it
prevents phrase queries with reasonably large slops (less than 100) from
matching terms across field values.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</p>
</td>
<td valign="top">
<p>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#search-analyzer" title="search_analyzer"><code class="literal">search_analyzer</code></a>
</p>
</td>
<td valign="top">
<p>
The <a class="xref" href="mapping-params.html#analyzer" title="analyzer"><code class="literal">analyzer</code></a> that should be used at search time on
the <code class="literal">text</code> field. Defaults to the <code class="literal">analyzer</code> setting.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#search-quote-analyzer" title="search_quote_analyzer"><code class="literal">search_quote_analyzer</code></a>
</p>
</td>
<td valign="top">
<p>
The <a class="xref" href="mapping-params.html#analyzer" title="analyzer"><code class="literal">analyzer</code></a> that should be used at search time when a
phrase is encountered. Defaults to the <code class="literal">search_analyzer</code> setting.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#similarity" title="similarity"><code class="literal">similarity</code></a>
</p>
</td>
<td valign="top">
<p>
Which scoring algorithm or <em>similarity</em> should be used. Defaults
to <code class="literal">BM25</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#term-vector" title="term_vector"><code class="literal">term_vector</code></a>
</p>
</td>
<td valign="top">
<p>
Whether term vectors should be stored for the field. Defaults to <code class="literal">no</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-field-meta" title="meta"><code class="literal">meta</code></a>
</p>
</td>
<td valign="top">
<p>
Metadata about the field.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="text-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/text.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">text</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> if they have
a <a class="xref" href="mapping-types.html#keyword-synthetic-source" title="Synthetic _source"><code class="literal">keyword</code></a> sub-field that supports synthetic
<code class="literal">_source</code> or if the <code class="literal">text</code> field sets <code class="literal">store</code> to <code class="literal">true</code>. Either way, it may
not have <a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a>.</p>
<p>If using a sub-<code class="literal">keyword</code> field then the values are sorted in the same way as
a <code class="literal">keyword</code> field&#8217;s values are sorted. By default, that means sorted with
duplicates removed. So:</p>
<a id="synthetic-source-text-example-default"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "text": {
        "type": "text",
        "fields": {
          "raw": {
            "type": "keyword"
          }
        }
      }
    }
  }
}
PUT idx/_doc/1
{
  "text": [
    "the quick brown fox",
    "the quick brown fox",
    "jumped over the lazy dog"
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/288.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "text": [
    "jumped over the lazy dog",
    "the quick brown fox"
  ]
}</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Reordering text fields can have an effect on <a class="xref" href="full-text-queries.html#query-dsl-match-query-phrase" title="Match phrase query">phrase</a>
      and <a class="xref" href="span-queries.html" title="Span queries">span</a> queries. See the discussion about
      <a class="xref" href="mapping-params.html#position-increment-gap" title="position_increment_gap"><code class="literal">position_increment_gap</code></a> for more detail. You
      can avoid this by making sure the <code class="literal">slop</code> parameter on the phrase queries
      is lower than the <code class="literal">position_increment_gap</code>. This is the default.</p>
</div>
</div>
<p>If the <code class="literal">text</code> field sets <code class="literal">store</code> to true then order and duplicates
are preserved.</p>
<a id="synthetic-source-text-example-stored"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "text": { "type": "text", "store": true }
    }
  }
}
PUT idx/_doc/1
{
  "text": [
    "the quick brown fox",
    "the quick brown fox",
    "jumped over the lazy dog"
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/289.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "text": [
    "the quick brown fox",
    "the quick brown fox",
    "jumped over the lazy dog"
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="fielddata-mapping-param"></a><code class="literal">fielddata</code> mapping parameter<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/text.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">text</code> fields are searchable by default, but by default are not available for
aggregations, sorting, or scripting. If you try to sort, aggregate, or access
values from a <code class="literal">text</code> field using a script, you&#8217;ll see an exception indicating
that field data is disabled by default on text fields. To load field data in
memory, set <code class="literal">fielddata=true</code> on your field.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Loading field data in memory can consume significant memory.</p>
</div>
</div>
<p>Field data is the only way to access the analyzed tokens from a full text field
in aggregations, sorting, or scripting. For example, a full text field like <code class="literal">New York</code>
would get analyzed as <code class="literal">new</code> and <code class="literal">york</code>. To aggregate on these tokens requires field data.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="before-enabling-fielddata"></a>Before enabling fielddata<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/text.asciidoc">edit</a></h3>
</div></div></div>
<p>It usually doesn&#8217;t make sense to enable fielddata on text fields. Field data
is stored in the heap with the <a class="xref" href="settings.html#modules-fielddata" title="Field data cache settings">field data cache</a> because it
is expensive to calculate. Calculating the field data can cause latency spikes, and
increasing heap usage is a cause of cluster performance issues.</p>
<p>Most users who want to do more with text fields use <a class="xref" href="mapping-params.html#multi-fields" title="fields">multi-field mappings</a>
by having both a <code class="literal">text</code> field for full text searches, and an
unanalyzed <a class="xref" href="mapping-types.html#keyword" title="Keyword type family"><code class="literal">keyword</code></a> field for aggregations, as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "my_field": { <a id="CO80-1"></a><i class="conum" data-value="1"></i>
        "type": "text",
        "fields": {
          "keyword": { <a id="CO80-2"></a><i class="conum" data-value="2"></i>
            "type": "keyword"
          }
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/290.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO80-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Use the <code class="literal">my_field</code> field for searches.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO80-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Use the <code class="literal">my_field.keyword</code> field for aggregations, sorting, or in scripts.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="enable-fielddata-text-fields"></a>Enabling fielddata on <code class="literal">text</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/text.asciidoc">edit</a></h3>
</div></div></div>
<p>You can enable fielddata on an existing <code class="literal">text</code> field using the
<a class="xref" href="indices.html#indices-put-mapping" title="Update mapping API">update mapping API</a> as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001/_mapping
{
  "properties": {
    "my_field": { <a id="CO81-1"></a><i class="conum" data-value="1"></i>
      "type":     "text",
      "fielddata": true
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/291.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO81-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The mapping that you specify for <code class="literal">my_field</code> should consist of the existing
mapping for that field, plus the <code class="literal">fielddata</code> parameter.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="field-data-filtering"></a><code class="literal">fielddata_frequency_filter</code> mapping parameter<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/text.asciidoc">edit</a></h3>
</div></div></div>
<p>Fielddata filtering can be used to reduce the number of terms loaded into
memory, and thus reduce memory usage. Terms can be filtered by <em>frequency</em>:</p>
<p>The frequency filter allows you to only load terms whose document frequency falls
between a <code class="literal">min</code> and <code class="literal">max</code> value, which can be expressed an absolute
number (when the number is bigger than 1.0) or as a percentage
(eg <code class="literal">0.01</code> is <code class="literal">1%</code> and <code class="literal">1.0</code> is <code class="literal">100%</code>). Frequency is calculated
<span class="strong strong"><strong>per segment</strong></span>. Percentages are based on the number of docs which have a
value for the field, as opposed to all docs in the segment.</p>
<p>Small segments can be excluded completely by specifying the minimum
number of docs that the segment should contain with <code class="literal">min_segment_size</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "tag": {
        "type": "text",
        "fielddata": true,
        "fielddata_frequency_filter": {
          "min": 0.001,
          "max": 0.1,
          "min_segment_size": 500
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/292.console"></div>
<h3><a id="match-only-text-field-type"></a>Match-only text field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/match-only-text.asciidoc">edit</a></h3>
<p>A variant of <a class="xref" href="mapping-types.html#text-field-type" title="Text field type"><code class="literal">text</code></a> that trades scoring and efficiency of
positional queries for space efficiency. This field effectively stores data the
same way as a <code class="literal">text</code> field that only indexes documents (<code class="literal">index_options: docs</code>)
and disables norms (<code class="literal">norms: false</code>). Term queries perform as fast if not faster
as on <code class="literal">text</code> fields, however queries that need positions such as the
<a class="xref" href="full-text-queries.html#query-dsl-match-query-phrase" title="Match phrase query"><code class="literal">match_phrase</code> query</a> perform slower as they
need to look at the <code class="literal">_source</code> document to verify whether a phrase matches. All
queries return constant scores that are equal to 1.0.</p>
<p>Analysis is not configurable: text is always analyzed with the
<a class="xref" href="configure-text-analysis.html#specify-index-time-default-analyzer" title="Specify the default analyzer for an index">default analyzer</a>
(<a class="xref" href="analysis-analyzers.html#analysis-standard-analyzer" title="Standard analyzer"><code class="literal">standard</code></a> by default).</p>
<p><a class="xref" href="span-queries.html" title="Span queries">span queries</a> are not supported with this field, use
<a class="xref" href="full-text-queries.html#query-dsl-intervals-query" title="Intervals query">interval queries</a> instead, or the
<a class="xref" href="mapping-types.html#text-field-type" title="Text field type"><code class="literal">text</code></a> field type if you absolutely need span queries.</p>
<p>Other than that, <code class="literal">match_only_text</code> supports the same queries as <code class="literal">text</code>. And
like <code class="literal">text</code>, it does not support sorting and has only limited support for aggregations.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT logs
{
  "mappings": {
    "properties": {
      "@timestamp": {
        "type": "date"
      },
      "message": {
        "type": "match_only_text"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/293.console"></div>
<h4><a id="match-only-text-params"></a>Parameters for match-only text fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/match-only-text.asciidoc">edit</a></h4>
<p>The following mapping parameters are accepted:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#multi-fields" title="fields"><code class="literal">fields</code></a>
</p>
</td>
<td valign="top">
<p>
Multi-fields allow the same string value to be indexed in multiple ways for
different purposes, such as one field for search and a multi-field for
sorting and aggregations, or the same string value analyzed by different
analyzers.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-field-meta" title="meta"><code class="literal">meta</code></a>
</p>
</td>
<td valign="top">
<p>
Metadata about the field.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="token-count"></a>Token count field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/token-count.asciidoc">edit</a></h2>
</div></div></div>

<p>A field of type <code class="literal">token_count</code> is really an <a class="xref" href="mapping-types.html#number" title="Numeric field types"><code class="literal">integer</code></a> field which
accepts string values, analyzes them, then indexes the number of tokens in the
string.</p>
<p>For instance:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "name": { <a id="CO82-1"></a><i class="conum" data-value="1"></i>
        "type": "text",
        "fields": {
          "length": { <a id="CO82-2"></a><i class="conum" data-value="2"></i>
            "type":     "token_count",
            "analyzer": "standard"
          }
        }
      }
    }
  }
}

PUT my-index-000001/_doc/1
{ "name": "John Smith" }

PUT my-index-000001/_doc/2
{ "name": "Rachel Alice Williams" }

GET my-index-000001/_search
{
  "query": {
    "term": {
      "name.length": 3 <a id="CO82-3"></a><i class="conum" data-value="3"></i>
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/294.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO82-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">name</code> field is a <a class="xref" href="mapping-types.html#text" title="Text type family"><code class="literal">text</code></a> field which uses the default
<code class="literal">standard</code> analyzer.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO82-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">name.length</code> field is a <code class="literal">token_count</code> <a class="xref" href="mapping-params.html#multi-fields" title="fields">multi-field</a> which will index the number of tokens in the <code class="literal">name</code> field.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO82-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>This query matches only the document containing <code class="literal">Rachel Alice Williams</code>, as it contains three tokens.</p>
</td>
</tr>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="token-count-params"></a>Parameters for <code class="literal">token_count</code> fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/token-count.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters are accepted by <code class="literal">token_count</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#analyzer" title="analyzer"><code class="literal">analyzer</code></a>
</p>
</td>
<td valign="top">
<p>
The <a class="xref" href="analysis.html" title="Text analysis">analyzer</a> which should be used to analyze the string
value. Required. For best performance, use an analyzer without token
filters.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">enable_position_increments</code>
</p>
</td>
<td valign="top">
<p>
Indicates if position increments should be counted.
Set to <code class="literal">false</code> if you don&#8217;t want to count tokens removed by analyzer filters (like <a class="xref" href="analysis-tokenfilters.html#analysis-stop-tokenfilter" title="Stop token filter"><code class="literal">stop</code></a>).
Defaults to <code class="literal">true</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#doc-values" title="doc_values"><code class="literal">doc_values</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be stored on disk in a column-stride fashion, so that it
can later be used for sorting, aggregations, or scripting? Accepts <code class="literal">true</code>
(default) or <code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-index" title="index"><code class="literal">index</code></a>
</p>
</td>
<td valign="top">
<p>
Should the field be searchable? Accepts <code class="literal">true</code> (default) and <code class="literal">false</code>.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#null-value" title="null_value"><code class="literal">null_value</code></a>
</p>
</td>
<td valign="top">
<p>
Accepts a numeric value of the same <code class="literal">type</code> as the field which is
substituted for any explicit <code class="literal">null</code> values. Defaults to <code class="literal">null</code>, which
means the field is treated as missing.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-store" title="store"><code class="literal">store</code></a>
</p>
</td>
<td valign="top">
<p>
Whether the field value should be stored and retrievable separately from
the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code></a> field. Accepts <code class="literal">true</code> or <code class="literal">false</code>
(default).
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="unsigned-long"></a>Unsigned long field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/unsigned_long.asciidoc">edit</a></h2>
</div></div></div>

<p>Unsigned long is a numeric field type that represents an unsigned 64-bit
integer with a minimum value of 0 and a maximum value of <code class="literal">2<sup>64</sup>-1</code>
(from 0 to 18446744073709551615 inclusive).</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my_index
{
  "mappings": {
    "properties": {
      "my_counter": {
        "type": "unsigned_long"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/295.console"></div>
<p>Unsigned long can be indexed in a numeric or string form,
representing integer values in the range [0, 18446744073709551615].
They can&#8217;t have a decimal part.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /my_index/_bulk?refresh
{"index":{"_id":1}}
{"my_counter": 0}
{"index":{"_id":2}}
{"my_counter": 9223372036854775808}
{"index":{"_id":3}}
{"my_counter": 18446744073709551614}
{"index":{"_id":4}}
{"my_counter": 18446744073709551615}</pre>
</div>
<div class="console_widget" data-snippet="snippets/296.console"></div>
<p>Term queries accept any numbers in a numeric or string form.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my_index/_search
{
    "query": {
        "term" : {
            "my_counter" : 18446744073709551615
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/297.console"></div>
<p>Range query terms can contain values with decimal parts.
In this case Elasticsearch converts them to integer values:
<code class="literal">gte</code> and <code class="literal">gt</code> terms are converted to the nearest integer up inclusive,
and <code class="literal">lt</code> and <code class="literal">lte</code> ranges are converted to the nearest integer down inclusive.</p>
<p>It is recommended to pass ranges as strings to ensure they are parsed
without any loss of precision.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my_index/_search
{
    "query": {
        "range" : {
            "my_counter" : {
                "gte" : "9223372036854775808",
                "lte" : "18446744073709551615"
            }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/298.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_sort_values"></a>Sort values<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/unsigned_long.asciidoc">edit</a></h3>
</div></div></div>
<p>For queries with sort on an <code class="literal">unsigned_long</code> field,
for a particular document Elasticsearch returns a sort value of the type <code class="literal">long</code>
if the value of this document is within the range of long values,
or of the type <code class="literal">BigInteger</code> if the value exceeds this range.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>REST clients need to be able to handle big integer values
in JSON to support this field type correctly.</p>
</div>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my_index/_search
{
    "query": {
        "match_all" : {}
    },
    "sort" : {"my_counter" : "desc"}
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/299.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_stored_fields"></a>Stored fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/unsigned_long.asciidoc">edit</a></h3>
</div></div></div>
<p>A stored field of <code class="literal">unsigned_long</code> is stored and returned as <code class="literal">String</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_aggregations"></a>Aggregations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/unsigned_long.asciidoc">edit</a></h3>
</div></div></div>
<p>For <code class="literal">terms</code> aggregations, similarly to sort values, <code class="literal">Long</code> or
<code class="literal">BigInteger</code> values are used. For other aggregations,
values are converted to the <code class="literal">double</code> type.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_script_values"></a>Script values<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/unsigned_long.asciidoc">edit</a></h3>
</div></div></div>
<p>By default, script values of an <code class="literal">unsigned_long</code> field are returned as
Java signed <code class="literal">Long</code>, which means that values that are greater than
<code class="literal">Long.MAX_VALUE</code> are shown as negative values. You can use
<code class="literal">Long.compareUnsigned(long, long)</code>, <code class="literal">Long.divideUnsigned(long, long)</code>
and <code class="literal">Long.remainderUnsigned(long, long)</code> to correctly work with
these values.</p>
<p>For example, the script below returns a value of the counter
divided by 10.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my_index/_search
{
    "query": {
        "match_all" : {}
    },
    "script_fields": {
        "count10" : {
          "script": {
            "source": "Long.divideUnsigned(doc['my_counter'].value, 10)"
          }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/300.console"></div>
<p>Alternatively, you can treat the unsigned long type as <code class="literal">BigInteger</code>
in your scripts by using the field API. For example, this script
treats <code class="literal">my_counter</code> as <code class="literal">BigInteger</code> with a default value of <code class="literal">BigInteger.ZERO</code>:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"script": {
    "source": "field('my_counter').asBigInteger(BigInteger.ZERO)"
}</pre>
</div>
<p>For scripts that need to return float or double values, you
can further convert <code class="literal">BigInteger</code> values to double or float:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my_index/_search
{
    "query": {
        "script_score": {
          "query": {"match_all": {}},
          "script": {
            "source": "field('my_counter').asBigInteger(BigInteger.ZERO).floatValue()"
          }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/301.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_queries_with_mixed_numeric_types"></a>Queries with mixed numeric types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/unsigned_long.asciidoc">edit</a></h3>
</div></div></div>
<p>Searches with mixed numeric types one of which is <code class="literal">unsigned_long</code> are
supported, except queries with sort. Thus, a sort query across two indexes
where the same field name has an <code class="literal">unsigned_long</code> type in one index,
and <code class="literal">long</code> type in another, doesn&#8217;t produce correct results and must
be avoided. If there is a need for such kind of sorting, script based sorting
can be used instead.</p>
<p>Aggregations across several numeric types one of which is <code class="literal">unsigned_long</code> are
supported. In this case, values are converted to the <code class="literal">double</code> type.</p>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="version"></a>Version field type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/version.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">version</code> field type is a specialization of the <code class="literal">keyword</code> field for
handling software version values and to support specialized precedence
rules for them. Precedence is defined following the rules outlined by
<a href="https://semver.org/" class="ulink" target="_top">Semantic Versioning</a>, which for example means that
major, minor and patch version parts are sorted numerically (i.e.
"2.1.0" &lt; "2.4.1" &lt; "2.11.2") and pre-release versions are sorted before
release versions (i.e. "1.0.0-alpha" &lt; "1.0.0").</p>
<p>You index a <code class="literal">version</code> field as follows</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my-index-000001
{
  "mappings": {
    "properties": {
      "my_version": {
        "type": "version"
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/302.console"></div>
<p>The field offers the same search capabilities as a regular keyword field. It
can e.g. be searched for exact matches using <code class="literal">match</code> or <code class="literal">term</code> queries and
supports prefix and wildcard searches. The main benefit is that <code class="literal">range</code> queries
will honor Semver ordering, so a <code class="literal">range</code> query between "1.0.0" and "1.5.0"
will include versions of "1.2.3" but not "1.11.2" for example. Note that this
would be different when using a regular <code class="literal">keyword</code> field for indexing where ordering
is alphabetical.</p>
<p>Software versions are expected to follow the
<a href="https://semver.org/" class="ulink" target="_top">Semantic Versioning rules</a> schema and precedence rules with
the notable exception that more or less than three main version identifiers are
allowed (i.e. "1.2" or "1.2.3.4" qualify as valid versions while they wouldn&#8217;t under
strict Semver rules). Version strings that are not valid under the Semver definition
(e.g. "1.2.alpha.4") can still be indexed and retrieved as exact matches, however they
will all appear <em>after</em> any valid version with regular alphabetical ordering. The empty
String "" is considered invalid and sorted after all valid versions, but before other
invalid ones.</p>
<h4><a id="version-params"></a>Parameters for version fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/version.asciidoc">edit</a></h4>
<p>The following parameters are accepted by <code class="literal">version</code> fields:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="mapping-params.html#mapping-field-meta" title="meta"><code class="literal">meta</code></a>
</p>
</td>
<td valign="top">
<p>
Metadata about the field.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<h4><a id="_limitations_3"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/version.asciidoc">edit</a></h4>
<p>This field type isn&#8217;t optimized for heavy wildcard, regex or fuzzy searches. While those
type of queries work in this field, you should consider using a regular <code class="literal">keyword</code> field if
you strongly rely on these kind of queries.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="version-synthetic-source"></a>Synthetic <code class="literal">_source</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/mapping/types/version.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synthetic <code class="literal">_source</code> is Generally Available only for TSDB indices
(indices that have <code class="literal">index.mode</code> set to <code class="literal">time_series</code>). For other indices
synthetic <code class="literal">_source</code> is in technical preview. Features in technical preview may
be changed or removed in a future release. Elastic will apply best effort to fix
any issues, but features in technical preview are not subject to the support SLA
of official GA features.</p>
</div>
</div>
<p><code class="literal">version</code> fields support <a class="xref" href="mapping-fields.html#synthetic-source" title="Synthetic _source">synthetic <code class="literal">_source</code></a> so long as they don&#8217;t
declare <a class="xref" href="mapping-params.html#copy-to" title="copy_to"><code class="literal">copy_to</code></a>.</p>
<p>Synthetic source always sorts <code class="literal">version</code> fields and removes duplicates. For example:</p>
<a id="synthetic-source-version-example"></a><div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT idx
{
  "mappings": {
    "_source": { "mode": "synthetic" },
    "properties": {
      "versions": { "type": "version" }
    }
  }
}
PUT idx/_doc/1
{
  "versions": ["8.0.0-beta1", "8.5.0", "0.90.12", "2.6.1", "1.3.4", "1.3.4"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/303.console"></div>
<p>Will become:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "versions": ["0.90.12", "1.3.4", "2.6.1", "8.0.0-beta1", "8.5.0"]
}</pre>
</div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="runtime.html">« Runtime fields</a>
</span>
<span class="next">
<a href="mapping-fields.html">Metadata fields »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
