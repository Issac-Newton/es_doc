<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Snapshot and restore APIs | Elasticsearch Guide | Elastic</title>
<meta class="elastic" name="content" content="Snapshot and restore APIs | Elasticsearch Guide">

<link rel="home" href="index.html" title="Elasticsearch Guide"/>
<link rel="up" href="rest-apis.html" title="REST APIs"/>
<link rel="prev" href="security-api.html" title="Security APIs"/>
<link rel="next" href="snapshot-lifecycle-management-api.html" title="Snapshot lifecycle management APIs"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="security-api.html">« Security APIs</a>
</span>
<span class="next">
<a href="snapshot-lifecycle-management-api.html">Snapshot lifecycle management APIs »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="snapshot-restore-apis"></a>Snapshot and restore APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/snapshot-restore-apis.asciidoc">edit</a></h2>
</div></div></div>
<p>You can use the following APIs to set up snapshot repositories, manage snapshot
backups, and restore snapshots to a running cluster.</p>
<p>For more information, see <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">Snapshot and restore</a>.</p>
<h3><a id="snapshot-restore-repo-apis"></a>Snapshot repository management APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/snapshot-restore-apis.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api" title="Put snapshot repository API">Put snapshot repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#verify-snapshot-repo-api" title="Verify snapshot repository API">Verify snapshot repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#get-snapshot-repo-api" title="Get snapshot repository API">Get snapshot repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#delete-snapshot-repo-api" title="Delete snapshot repository API">Delete snapshot repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#clean-up-snapshot-repo-api" title="Clean up snapshot repository API">Clean up snapshot repository</a>
</li>
</ul>
</div>
<h3><a id="snapshot-management-apis"></a>Snapshot management APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/snapshot-restore-apis.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#create-snapshot-api" title="Create snapshot API">Create snapshot</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#clone-snapshot-api" title="Clone snapshot API">Clone snapshot</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#get-snapshot-api" title="Get snapshot API">Get snapshot</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-api" title="Get snapshot status API">Get snapshot status</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#restore-snapshot-api" title="Restore snapshot API">Restore snapshot</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#delete-snapshot-api" title="Delete snapshot API">Delete snapshot</a>
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="put-snapshot-repo-api"></a>Put snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Registers or updates a <a class="xref" href="snapshots-register-repository.html" title="Register a snapshot repository">snapshot repository</a>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_snapshot/my_repository
{
  "type": "fs",
  "settings": {
    "location": "my_backup_location"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2314.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_snapshot/&lt;repository&gt;</code></p>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p>A snapshot repository must be registered before you can perform
<a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshot and restore</a> operations. You can use the put
snapshot repository API to register new repositories and update existing ones.
See <a class="xref" href="snapshots-register-repository.html" title="Register a snapshot repository"><em>Register repository</em></a>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Because snapshot formats can change between major versions of
Elasticsearch, we recommend registering a new snapshot repository for each major version.
See <a class="xref" href="snapshot-restore.html#snapshot-restore-version-compatibility" title="Version compatibility">Version compatibility</a>.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository to register or update.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Several options for this API can be specified using a query parameter
or a request body parameter. If both parameters are specified, only the query
parameter is used.</p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a response. If no response is received before the timeout expires, the request
fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">verify</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">true</code>, the request verifies the repository is functional on all master and
data nodes in the cluster. If <code class="literal">false</code>, this verification is skipped. Defaults to
<code class="literal">true</code>.
</p>
<p>You can manually perform this verification using the
<a class="xref" href="snapshot-restore-apis.html#verify-snapshot-repo-api" title="Verify snapshot repository API">verify snapshot repository API</a>.</p>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<a id="put-snapshot-repo-api-request-type"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>(Required, string)
Repository type.</p>
<details open>
<summary class="title">Valid values for <code class="literal">type</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">fs</code>
</span>
</dt>
<dd>
<p>
Shared file system repository. Repositories of this type use a shared file
system to store snapshots. This file system must accessible to all master and
data nodes in the cluster.
</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To register a shared file system repository, you must mount the same
shared filesystem to the same location on all master and data nodes. This
location must be registered in the <code class="literal">path.repo</code> setting on all master and data
nodes in the cluster.</p>
</div>
</div>
<p>See <a class="xref" href="snapshots-register-repository.html#snapshots-filesystem-repository" title="Shared file system repository">Shared file system repository</a>.</p>
</dd>
<dt>
<span class="term">
<span class="xpack"><code class="literal">source</code></span><a class="xpack_tag" href="/subscriptions"></a>
</span>
</dt>
<dd>
<p>
Source-only repository. You can use source-only repositories to create minimal,
source-only snapshots that take up to 50% less space on disk.
</p>
<p>Source-only snapshots are only supported if the <a class="xref" href="mapping-fields.html#mapping-source-field" title="_source field"><code class="literal">_source</code>
field</a> is enabled and no
<a class="xref" href="search-fields.html#source-filtering" title="Source filtering">source-filtering</a> is applied.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Source-only snapshots contain stored fields and index metadata. They do
not include index or doc values structures and are not searchable when restored.
After restoring a source-only snapshot, you must <a class="xref" href="docs.html#docs-reindex" title="Reindex API">reindex</a> the
data into a new index.</p>
</div>
</div>
<p>See <a class="xref" href="snapshots-register-repository.html#snapshots-source-only-repository" title="Source only repository">Source only repository</a>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">url</code>
</span>
</dt>
<dd>
<p>
URL repository. Repositories of this type are read-only
for the cluster. This means the cluster can retrieve or restore snapshots from
the repository but cannot write or create snapshots in it.
</p>
<p>You can use URL repositories as an alternative way to give a cluster read-only
access to a shared file system (<code class="literal">fs</code>) repository.</p>
<p>See <a class="xref" href="snapshots-register-repository.html#snapshots-read-only-repository" title="Read-only URL repository">Read-only URL repository</a>.</p>
</dd>
</dl>
</div>
</div>
</details>
<p>More repository types are available through these official
plugins:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/repository-s3.html" class="ulink" target="_top">repository-s3</a> for S3 repository support
</li>
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/repository-hdfs.html" class="ulink" target="_top">repository-hdfs</a> for HDFS repository support in
Hadoop environments
</li>
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/repository-azure.html" class="ulink" target="_top">repository-azure</a> for Azure storage
repositories
</li>
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/repository-gcs.html" class="ulink" target="_top">repository-gcs</a> for Google Cloud Storage
repositories
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="put-snapshot-repo-api-settings-param"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">settings</code>
</span>
</dt>
<dd>
<p>(Required, object)
Contains settings for the repository.</p>
<p>The following <code class="literal">settings</code> properties are valid for all repository types:</p>
<details open>
<summary class="title">Properties of <code class="literal">settings</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">chunk_size</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
Maximum size of files in snapshots. In snapshots, files larger than this are
broken down into chunks of this size or smaller. Defaults to <code class="literal">null</code> (unlimited
file size).
</dd>
<dt>
<span class="term">
<code class="literal">compress</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, metadata files, such as index mappings and settings, are compressed
in snapshots. Data files are not compressed. Defaults to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">max_restore_bytes_per_sec</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
Maximum snapshot restore rate per node. Defaults to unlimited. Note
that restores are also throttled through <a class="xref" href="settings.html#recovery" title="Index recovery settings">recovery settings</a>.
</dd>
<dt>
<span class="term">
<code class="literal">max_snapshot_bytes_per_sec</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
Maximum snapshot creation rate per node. Defaults to <code class="literal">40mb</code> per second.
</dd>
<dt>
<span class="term">
<code class="literal">readonly</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">true</code>, the repository is read-only. The cluster can retrieve and restore
snapshots from the repository but not write to the repository or create
snapshots in it.
</p>
<p>If <code class="literal">false</code>, the cluster can write to the repository and create snapshots in it.
Defaults to <code class="literal">false</code>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you register the same snapshot repository with multiple clusters, only
one cluster should have write access to the repository. Having multiple clusters
write to the repository at the same time risks corrupting the contents of the
repository.</p>
<p>Only a cluster with write access can create snapshots in the repository. All
other clusters connected to the repository should have the <code class="literal">readonly</code> parameter
set to <code class="literal">true</code>. This means those clusters can retrieve or restore snapshots from
the repository but not create snapshots in it.</p>
</div>
</div>
</dd>
</dl>
</div>
</div>
</details>
<p>Other accepted <code class="literal">settings</code> properties depend on the repository type, set using the
<a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api-request-type"><code class="literal">type</code></a> parameter.</p>
<details open>
<summary class="title">Valid <code class="literal">settings</code> properties for <code class="literal">fs</code> repositories</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">location</code>
</span>
</dt>
<dd>
(Required, string)
Location of the shared filesystem used to store and retrieve snapshots. This
location must be registered in the <code class="literal">path.repo</code> setting on all master and data
nodes in the cluster.
</dd>
</dl>
</div>
</div>
</details>
<details open>
<summary class="title">Valid <code class="literal">settings</code> properties for <code class="literal">source</code> repositories</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">delegate_type</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Delegated repository type. For valid values, see the
<a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api-request-type"><code class="literal">type</code> parameter</a>.
</p>
<p><code class="literal">source</code> repositories can use <code class="literal">settings</code> properties for its delegated repository
type. See <a class="xref" href="snapshots-register-repository.html#snapshots-source-only-repository" title="Source only repository">Source only repository</a>.</p>
</dd>
</dl>
</div>
</div>
</details>
<details open>
<summary class="title">Valid <code class="literal">settings</code> properties for <code class="literal">url</code> repositories</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">url</code>
</span>
</dt>
<dd>
<p>
(Required, string)
URL location of the root of the shared filesystem repository. The following
protocols are supported:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">file</code>
</li>
<li class="listitem">
<code class="literal">ftp</code>
</li>
<li class="listitem">
<code class="literal">http</code>
</li>
<li class="listitem">
<code class="literal">https</code>
</li>
<li class="listitem">
<code class="literal">jar</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>URLs using the <code class="literal">file</code> protocol must point to the location of a shared filesystem
accessible to all master and data nodes in the cluster. This location must be
registered in the <code class="literal">path.repo</code> setting.</p>
<p>URLs using the <code class="literal">http</code>, <code class="literal">https</code>, or <code class="literal">ftp</code> protocols must be explicitly allowed with the
<code class="literal">repositories.url.allowed_urls</code> setting. This setting supports wildcards in the
place of a host, path, query, or fragment in the URL.</p>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">verify</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">true</code>, the request verifies the repository is functional on all master and
data nodes in the cluster. If <code class="literal">false</code>, this verification is skipped. Defaults to
<code class="literal">true</code>.
</p>
<p>You can manually perform this verification using the
<a class="xref" href="snapshots-register-repository.html#snapshots-repository-verification" title="Repository verification">verify snapshot repository API</a>.</p>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="verify-snapshot-repo-api"></a>Verify snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Verifies that a snapshot repository is functional.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/_verify</pre>
</div>
<div class="console_widget" data-snippet="snippets/2315.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;/_verify</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p>By default, <a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api" title="Put snapshot repository API">put snapshot repository API</a> requests
verify that a snapshot is functional on all master and data nodes in the
cluster.</p>
<p>You can skip this verification using the put snapshot repository API&#8217;s <code class="literal">verify</code>
parameter. You can then use the verify snapshot repository API to manually
verify the repository.</p>
<p>If verification is successful, the verify snapshot repository API returns a list
of nodes connected to the snapshot repository. If verification failed, the API
returns an error.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository to verify.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a response. If no response is received before the timeout expires, the request
fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">nodes</code>
</span>
</dt>
<dd>
<p>
(object)
</p>
<details open>
<summary class="title">Properties of <code class="literal">nodes</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;node_id&gt;</code>
</span>
</dt>
<dd>
<p>
(object)
Contains information about a node connected to the snapshot repository.
</p>
<p>The key is the ID of the node.</p>
<details open>
<summary class="title">Properties of <code class="literal">&lt;node_id&gt;</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
<p>
(string)
Human-readable name for the node.
</p>
<p>You can set this name using the <a class="xref" href="important-settings.html#node-name" title="Node name setting"><code class="literal">node.name</code></a> property in
<code class="literal">elasticsearch.yml</code>. Defaults to the machine&#8217;s hostname.</p>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-snapshot-repo-api"></a>Get snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Gets information about one or more registered
<a class="xref" href="snapshots-register-repository.html" title="Register a snapshot repository">snapshot repositories</a>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository</pre>
</div>
<div class="console_widget" data-snippet="snippets/2316.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_snapshot/&lt;repository&gt;</code></p>
<p><code class="literal">GET /_snapshot</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">monitor_snapshot</code>, <code class="literal">create_snapshot</code>, or <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string)
Comma-separated list of snapshot repository names used to limit the request.
Wildcard (<code class="literal">*</code>) expressions are supported.
</p>
<p>To get information about all snapshot repositories registered in the
cluster, omit this parameter or use <code class="literal">*</code> or <code class="literal">_all</code>.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">local</code>
</span>
</dt>
<dd>
(Optional, Boolean) If <code class="literal">true</code>, the request gets information from the local node
only. If <code class="literal">false</code>, the request gets information from the master node. Defaults to
<code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
<p>
(object)
Contains information about the snapshot repository. Key is the name of the
snapshot repository.
</p>
<details open>
<summary class="title">Properties of <code class="literal">&lt;repository&gt;</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>(string)
Repository type.</p>
<details open>
<summary class="title">Values for <code class="literal">type</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">fs</code>
</span>
</dt>
<dd>
Shared file system repository. See <a class="xref" href="snapshots-register-repository.html#snapshots-filesystem-repository" title="Shared file system repository">Shared file system repository</a>.
</dd>
<dt>
<span class="term">
<span class="xpack"><code class="literal">source</code></span><a class="xpack_tag" href="/subscriptions"></a>
</span>
</dt>
<dd>
Source-only repository. See <a class="xref" href="snapshots-register-repository.html#snapshots-source-only-repository" title="Source only repository">Source only repository</a>.
</dd>
<dt>
<span class="term">
<code class="literal">url</code>
</span>
</dt>
<dd>
URL repository. See <a class="xref" href="snapshots-register-repository.html#snapshots-read-only-repository" title="Read-only URL repository">Read-only URL repository</a>.
</dd>
</dl>
</div>
</div>
</details>
<p>More repository types are available through these official plugins:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/repository-s3.html" class="ulink" target="_top">repository-s3</a> for S3 repository support
</li>
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/repository-hdfs.html" class="ulink" target="_top">repository-hdfs</a> for HDFS repository support in
Hadoop environments
</li>
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/repository-azure.html" class="ulink" target="_top">repository-azure</a> for Azure storage
repositories
</li>
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/repository-gcs.html" class="ulink" target="_top">repository-gcs</a> for Google Cloud Storage
repositories
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">settings</code>
</span>
</dt>
<dd>
<p>
(object)
Contains settings for the repository. Valid properties for the <code class="literal">settings</code> object
depend on the repository type, set using the
<a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api-request-type"><code class="literal">type</code></a> parameter.
</p>
<p>For properties, see the <a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api" title="Put snapshot repository API">put snapshot repository API</a>'s
<a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api-settings-param"><code class="literal">settings</code> parameter</a>.</p>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository</pre>
</div>
<div class="console_widget" data-snippet="snippets/2317.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "my_repository" : {
    "type" : "fs",
    "settings" : {
      "location" : "my_backup_location"
    }
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="delete-snapshot-repo-api"></a>Delete snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Unregisters one or more <a class="xref" href="snapshots-register-repository.html" title="Register a snapshot repository">snapshot repositories</a>.</p>
<p>When a repository is unregistered, Elasticsearch only removes the reference to the
location where the repository is storing the snapshots. The snapshots themselves
are left untouched and in place.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_snapshot/my_repository</pre>
</div>
<div class="console_widget" data-snippet="snippets/2318.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_snapshot/&lt;repository&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository to unregister. Wildcard (<code class="literal">*</code>) patterns are
supported.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a response. If no response is received before the timeout expires, the request
fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="clean-up-snapshot-repo-api"></a>Clean up snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Triggers the review of a snapshot repository&#8217;s contents and deletes any stale
data that is not referenced by existing snapshots.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/_cleanup</pre>
</div>
<div class="console_widget" data-snippet="snippets/2319.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;/_cleanup</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p>Over time, snapshot repositories can accumulate stale data that is no longer
referenced by existing snapshots.</p>
<p>While this unreferenced data does not negatively impact the performance or
safety of a snapshot repository, it can lead to more storage use than necessary.</p>
<p>You can use the clean up snapshot repository API to detect and delete this
unreferenced data.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Most cleanup operations performed by this API are performed automatically when
a snapshot is deleted from a repository.</p>
<p>If you regularly delete snapshots, calling this API may only reduce your storage
slightly or not at all.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository to review and clean up.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a connection to the master node. If no response is received
before the timeout expires, the request fails and returns an error. Defaults to
<code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a response. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">results</code>
</span>
</dt>
<dd>
<p>
(object)
Contains statistics for cleanup operations.
</p>
<details open>
<summary class="title">Properties of <code class="literal">results</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">deleted_bytes</code>
</span>
</dt>
<dd>
(integer)
Number of bytes freed by cleanup operations.
</dd>
<dt>
<span class="term">
<code class="literal">deleted_blobs</code>
</span>
</dt>
<dd>
(integer)
Number of binary large objects (blobs) removed from the snapshot repository
during cleanup operations. Any non-zero value implies that unreferenced blobs
were found and subsequently cleaned up.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/_cleanup</pre>
</div>
<div class="console_widget" data-snippet="snippets/2320.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "results": {
    "deleted_bytes": 20,
    "deleted_blobs": 5
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="clone-snapshot-api"></a>Clone snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Clones part or all of a snapshot into a new snapshot.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_snapshot/my_repository/source_snapshot/_clone/target_snapshot
{
  "indices": "index_a,index_b"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2321.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_snapshot/&lt;repository&gt;/&lt;source_snapshot&gt;/_clone/&lt;target_snapshot&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The clone snapshot API allows creating a copy of all or part of an existing snapshot
within the same repository.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository that both source and target snapshot belong to.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a response. If no response is received before the timeout expires, the request
fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
(Required, string)
A comma-separated list of indices to include in the snapshot.
<a class="xref" href="api-conventions.html#multi-index" title="Multi-target syntax">Multi-index syntax</a> is supported.
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="create-snapshot-api"></a>Create snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Takes a <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshot</a> of a cluster or specified data streams and
indices.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_snapshot/my_repository/my_snapshot</pre>
</div>
<div class="console_widget" data-snippet="snippets/2322.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;</code></p>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">create_snapshot</code> or <code class="literal">manage</code> <a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to
use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>You can use the create snapshot API to create a <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshot</a>, which is a
backup taken from a running Elasticsearch cluster.</p>
<p>By default, a snapshot includes all data streams and open indices in the
cluster, as well as the cluster state.  You can change this behavior by
specifying a list of data streams and indices to back up in the body of the
snapshot request.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must register a snapshot repository before performing snapshot and restore operations. Use the <a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api" title="Put snapshot repository API">put snapshot repository API</a> to register new repositories and update existing ones.</p>
</div>
</div>
<p>The snapshot process is incremental. When creating a snapshot, Elasticsearch analyzes the list of files that are already stored in the repository and copies only files that were created or changed since the last snapshot. This process allows multiple snapshots to be preserved in the repository in a compact form.</p>
<p>The snapshot process is executed in non-blocking fashion, so all indexing and searching operations can run concurrently against the data stream or index that Elasticsearch is snapshotting.</p>
<p>A snapshot represents a point-in-time view of the moment when the snapshot was created. No records that were added to a data stream or index after the snapshot process started will be present in the snapshot.</p>
<p>For primary shards that have not been started and are not currently relocating, the snapshot process starts immediately. If shards are in the process of starting or relocating, Elasticsearch waits for these processes to complete before taking a snapshot.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>While a snapshot of a particular shard is being created, this shard cannot be moved to another node. Relocating a shard during the snapshot process can interfere with rebalancing and allocation filtering. Elasticsearch can move a shard to another node (according to the current allocation filtering settings and rebalancing algorithm) only after the snapshot process completes.</p>
</div>
</div>
<p>Besides creating a copy of each data stream and index, the snapshot process can also store global cluster metadata, including persistent cluster settings and templates. The transient settings and registered snapshot repositories are not stored as part of the snapshot.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the repository to create a snapshot in.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot to create. This name must be unique in the snapshot repository.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a connection to the master node. If no response is received
before the timeout expires, the request fails and returns an error. Defaults to
<code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">wait_for_completion</code>
</span>
</dt>
<dd>
(Optional, Boolean) If <code class="literal">true</code>, the request returns a response when the snapshot
is complete. If <code class="literal">false</code>, the request returns a response when the snapshot
initializes. Defaults to <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the request returns an error for any data stream or index that is missing or closed. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, the request ignores data streams and indices in <code class="literal">indices</code> that are missing or closed.</p>
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
A comma-separated list of data streams and indices to include in the snapshot.
<a class="xref" href="api-conventions.html#multi-index" title="Multi-target syntax">Multi-index syntax</a> is supported.
</p>
<p>By default, a snapshot includes all data streams and indices in the cluster. If this
argument is provided, the snapshot only includes the specified data streams and clusters.</p>
</dd>
<dt>
<span class="term">
<code class="literal">include_global_state</code>
</span>
</dt>
<dd>
<p>(Optional, Boolean)
If <code class="literal">true</code>, the current cluster state is included in the snapshot.
Defaults to <code class="literal">true</code>.</p>
<p>The cluster state includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Persistent cluster settings
</li>
<li class="listitem">
Index templates
</li>
<li class="listitem">
Legacy index templates
</li>
<li class="listitem">
Ingest pipelines
</li>
<li class="listitem">
ILM lifecycle policies
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, the entire snapshot will fail if one or more indices included in the snapshot do not have all primary shards available. You can change this behavior by setting <a class="xref" href="snapshot-restore-apis.html#create-snapshot-api-partial"><code class="literal">partial</code></a> to <code class="literal">true</code>.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(Optional, object)
Attaches arbitrary metadata to the snapshot, such as a record of who took the snapshot, why it was taken, or any other useful data. Metadata must be less than 1024 bytes.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="create-snapshot-api-partial"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">partial</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the entire snapshot will fail if one or more indices included in the snapshot do not have all primary shards available. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, allows taking a partial snapshot of indices with unavailable shards.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following request takes a snapshot of <code class="literal">index_1</code> and <code class="literal">index_2</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_snapshot/my_repository/snapshot_2?wait_for_completion=true
{
  "indices": "index_1,index_2",
  "ignore_unavailable": true,
  "include_global_state": false,
  "metadata": {
    "taken_by": "user123",
    "taken_because": "backup before upgrading"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2323.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshot": {
    "snapshot": "snapshot_2",
    "uuid": "vdRctLCxSketdKb54xw67g",
    "version_id": &lt;version_id&gt;,
    "version": &lt;version&gt;,
    "indices": [],
    "data_streams": [],
    "include_global_state": false,
    "metadata": {
      "taken_by": "user123",
      "taken_because": "backup before upgrading"
    },
    "state": "SUCCESS",
    "start_time": "2020-06-25T14:00:28.850Z",
    "start_time_in_millis": 1593093628850,
    "end_time": "2020-06-25T14:00:28.850Z",
    "end_time_in_millis": 1593094752018,
    "duration_in_millis": 0,
    "failures": [],
    "shards": {
      "total": 0,
      "failed": 0,
      "successful": 0
    }
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-snapshot-api"></a>Get snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Retrieves information about one or more snapshots.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/my_snapshot</pre>
</div>
<div class="console_widget" data-snippet="snippets/2324.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">monitor_snapshot</code>, <code class="literal">create_snapshot</code>, or <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>Use the get snapshot API to return information about one or more snapshots, including:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Start and end time values
</li>
<li class="listitem">
Version of Elasticsearch that created the snapshot
</li>
<li class="listitem">
List of included indices
</li>
<li class="listitem">
Current state of the snapshot
</li>
<li class="listitem">
List of failures that occurred during the snapshot
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Snapshot repository name used to limit the request.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string)
Comma-separated list of snapshot names to retrieve. Also accepts wildcards (<code class="literal">*</code>).
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To get information about all snapshots in a registered repository, use a wildcard (<code class="literal">*</code>) or <code class="literal">_all</code>.
</li>
<li class="listitem">
<p>To get information about any snapshots that are currently running, use <code class="literal">_current</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using <code class="literal">_all</code> in a request fails if any snapshots are unavailable.
Set <a class="xref" href="snapshot-restore-apis.html#get-snapshot-api-ignore-unavailable"><code class="literal">ignore_unavailable</code></a> to <code class="literal">true</code> to return only available snapshots.</p>
</div>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<a id="get-snapshot-api-ignore-unavailable"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the request returns an error for any snapshots that are unavailable. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, the request ignores snapshots that are unavailable, such as those that are corrupted or temporarily cannot be returned.</p>
</dd>
<dt>
<span class="term">
<code class="literal">verbose</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">true</code>, returns all available information about a snapshot. Defaults to <code class="literal">true</code>.
</p>
<p>If <code class="literal">false</code>, omits additional information about the snapshot, such as version information, start and end times, and the number of snapshotted shards.</p>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">snapshot</code>
</span>
</dt>
<dd>
(string)
Name of the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">uuid</code>
</span>
</dt>
<dd>
(string)
Universally unique identifier (UUID) of the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">version_id</code>
</span>
</dt>
<dd>
(int)
Build ID of the Elasticsearch version used to create the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
(float)
Elasticsearch version used to create the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
(array)
List of indices included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">data_streams</code>
</span>
</dt>
<dd>
(array)
List of <a class="xref" href="data-streams.html" title="Data streams">data streams</a> included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">include_global_state</code>
</span>
</dt>
<dd>
(Boolean)
Indicates whether the current cluster state is included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">start_time</code>
</span>
</dt>
<dd>
(string)
Date timestamp of when the snapshot creation process started.
</dd>
<dt>
<span class="term">
<code class="literal">start_time_in_millis</code>
</span>
</dt>
<dd>
(long)
The time, in milliseconds, when the snapshot creation process started.
</dd>
<dt>
<span class="term">
<code class="literal">end_time</code>
</span>
</dt>
<dd>
(string)
Date timestamp of when the snapshot creation process ended.
</dd>
<dt>
<span class="term">
<code class="literal">end_time_in_millis</code>
</span>
</dt>
<dd>
(long)
The time, in milliseconds, when the snapshot creation process ended.
</dd>
<dt>
<span class="term">
<code class="literal">duration_in_millis</code>
</span>
</dt>
<dd>
(long)
How long, in milliseconds, it took to create the snapshot.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-api-response-failures"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">failures</code>
</span>
</dt>
<dd>
(array)
Lists any failures that occurred when creating the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">shards</code>
</span>
</dt>
<dd>
<p>
(object)
Contains a count of shards in the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">shards</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
(integer)
Total number of shards included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">successful</code>
</span>
</dt>
<dd>
(integer)
Number of shards that were successfully included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">failed</code>
</span>
</dt>
<dd>
(integer)
Number of shards that failed to be included in the snapshot.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">state</code>
</span>
</dt>
<dd>
<p>(string)
The snapshot <code class="literal">state</code> can be one of the following values:</p>
<details open>
<summary class="title">Values for <code class="literal">state</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">IN_PROGRESS</code>
</span>
</dt>
<dd>
The snapshot is currently running.
</dd>
<dt>
<span class="term">
<code class="literal">SUCCESS</code>
</span>
</dt>
<dd>
The snapshot finished and all shards were stored successfully.
</dd>
<dt>
<span class="term">
<code class="literal">FAILED</code>
</span>
</dt>
<dd>
The snapshot finished with an error and failed to store any data.
</dd>
<dt>
<span class="term">
<code class="literal">PARTIAL</code>
</span>
</dt>
<dd>
The global cluster state was stored, but data of at least one shard was not stored successfully.
The <a class="xref" href="snapshot-restore-apis.html#get-snapshot-api-response-failures"><code class="literal">failures</code></a> section of the response contains more detailed information about shards
that were not processed correctly.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following request returns information for <code class="literal">snapshot_2</code> in the <code class="literal">my_repository</code> repository.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/snapshot_2</pre>
</div>
<div class="console_widget" data-snippet="snippets/2325.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots": [
    {
      "snapshot": "snapshot_2",
      "uuid": "vdRctLCxSketdKb54xw67g",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.129Z",
      "start_time_in_millis": 1593093628850,
      "end_time": "2020-07-06T21:55:18.876Z",
      "end_time_in_millis": 1593094752018,
      "duration_in_millis": 0,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    }
  ]
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-snapshot-status-api"></a>Get snapshot status API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Retrieves a detailed description of the current state for each shard participating in the snapshot.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _snapshot/_status</pre>
</div>
<div class="console_widget" data-snippet="snippets/2326.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET _snapshot/_status</code></p>
<p><code class="literal">GET _snapshot/&lt;repository&gt;/_status</code></p>
<p><code class="literal">GET _snapshot/&lt;repository&gt;/&lt;snapshot&gt;/_status</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">monitor_snapshot</code>, <code class="literal">create_snapshot</code>, or <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<p>Use the get snapshot status API to get detailed information about the shards
participating in a snapshot.</p>
<p>If you omit the <code class="literal">&lt;snapshot&gt;</code> request path parameter, the request only retrieves
information for currently running snapshots. This usage is preferred.</p>
<p>If needed, you can specify <code class="literal">&lt;repository&gt;</code> and <code class="literal">&lt;snapshot&gt;</code> to retrieve
information for specific snapshots, even if they&#8217;re not currently running.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using the get snapshot status API to return any status results other than the currently running snapshots (<code class="literal">_current</code>) can be very expensive. Each request to retrieve snapshot status results in file reads from every shard in a snapshot, for each snapshot. Such requests are taxing to machine resources and can also incur high processing costs when running in the cloud.</p>
<p>For example, if you have 100 snapshots with 1,000 shards each, the API request will result in 100,000 file reads (100 snapshots * 1,000 shards). Depending on the latency of your file storage, the request can take extremely long to retrieve results.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Optional, string)
Snapshot repository name used to limit the request. Supports wildcards (<code class="literal">*</code>) if
<code class="literal">&lt;snapshot&gt;</code> isn&#8217;t specified.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
(Optional, string)
Comma-separated list of snapshots to retrieve status for. Defaults to
currently running snapshots. Wildcards (<code class="literal">*</code>) are not supported.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the request returns an error for any snapshots that are unavailable. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, the request ignores snapshots that are unavailable, such as those that are corrupted or temporarily cannot be returned.</p>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">repository</code>
</span>
</dt>
<dd>
(string)
Name of the repository that includes the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">snapshot</code>
</span>
</dt>
<dd>
(string)
Name of the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">uuid</code>
</span>
</dt>
<dd>
(string)
Universally unique identifier (UUID) of the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">state</code>
</span>
</dt>
<dd>
<p>(string)
Indicates the current snapshot state.</p>
<details open>
<summary class="title">Values for <code class="literal">state</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">FAILED</code>
</span>
</dt>
<dd>
The snapshot finished with an error and failed to store any data.
</dd>
<dt>
<span class="term">
<code class="literal">IN_PROGRESS</code>
</span>
</dt>
<dd>
The snapshot is currently running.
</dd>
<dt>
<span class="term">
<code class="literal">PARTIAL</code>
</span>
</dt>
<dd>
The global cluster state was stored, but data of at least one shard was not stored successfully.
The <a class="xref" href="snapshot-restore-apis.html#get-snapshot-api-response-failures"><code class="literal">failures</code></a> section of the response contains more detailed information about shards
that were not processed correctly.
</dd>
<dt>
<span class="term">
<code class="literal">SUCCESS</code>
</span>
</dt>
<dd>
The snapshot finished and all shards were stored successfully.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">include_global_state</code>
</span>
</dt>
<dd>
(Boolean)
Indicates whether the current cluster state is included in the snapshot.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-status-shards-stats"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">shards_stats</code>
</span>
</dt>
<dd>
<p>
(object)
Contains a count of shards in the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">shards_stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">initializing</code>
</span>
</dt>
<dd>
(integer)
Number of shards that are still initializing.
</dd>
<dt>
<span class="term">
<code class="literal">started</code>
</span>
</dt>
<dd>
(integer)
Number of shards that have started but not are not finalized.
</dd>
<dt>
<span class="term">
<code class="literal">finalizing</code>
</span>
</dt>
<dd>
(integer)
Number of shards that are finalizing but are not done.
</dd>
<dt>
<span class="term">
<code class="literal">done</code>
</span>
</dt>
<dd>
(integer)
Number of shards that initialized, started, and finalized successfully.
</dd>
<dt>
<span class="term">
<code class="literal">failed</code>
</span>
</dt>
<dd>
(integer)
Number of shards that failed to be included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
(integer)
Total number of shards included in the snapshot.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-status-stats"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">stats</code>
</span>
</dt>
<dd>
<p>
(object)
Provides details on the number (<code class="literal">file_count</code>) and size (<code class="literal">size_in_bytes</code>) of files included in the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">incremental</code>
</span>
</dt>
<dd>
<p>
(object)
Number and size of files that still need to be copied as part of the incremental snapshot.
</p>
<p>For completed snapshots, this property indicates the number and size
of files that were not already in the repository and were copied as
part of the incremental snapshot.</p>
</dd>
<dt>
<span class="term">
<code class="literal">processed</code>
</span>
</dt>
<dd>
(object)
Number and size of files that have already been uploaded to the snapshot. After a file is uploaded, the processed <code class="literal">file_count</code> and <code class="literal">size_in_bytes</code> are incremented in <code class="literal">stats</code>.
</dd>
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
(object)
Total number and size of files that are referenced by the snapshot.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-status-start-time"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">start_time_in_millis</code>
</span>
</dt>
<dd>
(long)
The time, in milliseconds, when the snapshot creation process started.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-status-total-time"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">time_in_millis</code>
</span>
</dt>
<dd>
(long)
The total time, in milliseconds, that it took for the snapshot process
to complete.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;index&gt;</code>
</span>
</dt>
<dd>
<p>
(list of objects)
List of objects containing information about the
indices included in the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">&lt;index&gt;</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">shards_stats</code>
</span>
</dt>
<dd>
(object)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-shards-stats"><code class="literal">shards_stats</code></a>.
</dd>
<dt>
<span class="term">
<code class="literal">stats</code>
</span>
</dt>
<dd>
(object)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-stats"><code class="literal">stats</code></a>.
</dd>
<dt>
<span class="term">
<code class="literal">shards</code>
</span>
</dt>
<dd>
<p>
(list of objects)
List of objects containing information about the
shards that include the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">shards</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">stage</code>
</span>
</dt>
<dd>
<p>
(string)
Indicates the current state of the shards that include the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">stage</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">DONE</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that were successfully stored in the repository.
</dd>
<dt>
<span class="term">
<code class="literal">FAILURE</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that were not successfully stored in
the repository.
</dd>
<dt>
<span class="term">
<code class="literal">FINALIZE</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that are in the finalizing stage
of being stored in the repository.
</dd>
<dt>
<span class="term">
<code class="literal">INIT</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that are in the initializing stage
of being stored in the repository.
</dd>
<dt>
<span class="term">
<code class="literal">STARTED</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that are in the started stage
of being stored in the repository.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">stats</code>
</span>
</dt>
<dd>
(object)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-stats"><code class="literal">stats</code></a>.
</dd>
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
(object)
Total number and size of files that are referenced by the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">start_time_in_millis</code>
</span>
</dt>
<dd>
(long)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-start-time"><code class="literal">start_time_in_millis</code></a>.
</dd>
<dt>
<span class="term">
<code class="literal">time_in_millis</code>
</span>
</dt>
<dd>
(long)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-total-time"><code class="literal">time_in_millis</code></a>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-example"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following request returns detailed status information for <code class="literal">snapshot_2</code> in the <code class="literal">my_repository</code> repository. This response includes additional information beyond the <a class="xref" href="snapshot-restore-apis.html#get-snapshot-api" title="Get snapshot API">Get snapshot API</a>, such as shard status and file statistics.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _snapshot/my_repository/snapshot_2/_status</pre>
</div>
<div class="console_widget" data-snippet="snippets/2327.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots" : [
    {
      "snapshot" : "snapshot_2",
      "repository" : "my_repository",
      "uuid" : "lNeQD1SvTQCqqJUMQSwmGg",
      "state" : "SUCCESS",
      "include_global_state" : false,
      "shards_stats" : {
        "initializing" : 0,
        "started" : 0,
        "finalizing" : 0,
        "done" : 1,
        "failed" : 0,
        "total" : 1
      },
      "stats" : {
        "incremental" : {
          "file_count" : 3,
          "size_in_bytes" : 5969
        },
        "total" : {
          "file_count" : 4,
          "size_in_bytes" : 6024
        },
        "start_time_in_millis" : 1594829326691,
        "time_in_millis" : 205
      },
      "indices" : {
        "index_1" : {
          "shards_stats" : {
            "initializing" : 0,
            "started" : 0,
            "finalizing" : 0,
            "done" : 1,
            "failed" : 0,
            "total" : 1
          },
          "stats" : {
            "incremental" : {
              "file_count" : 3,
              "size_in_bytes" : 5969
            },
            "total" : {
              "file_count" : 4,
              "size_in_bytes" : 6024
            },
            "start_time_in_millis" : 1594829326896,
            "time_in_millis" : 0
          },
          "shards" : {
            "0" : {
              "stage" : "DONE",
              "stats" : {
                "incremental" : {
                  "file_count" : 3,
                  "size_in_bytes" : 5969
                },
                "total" : {
                  "file_count" : 4,
                  "size_in_bytes" : 6024
                },
                "start_time_in_millis" : 1594829326896,
                "time_in_millis" : 0
              }
            }
          }
        }
      }
    }
  ]
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="restore-snapshot-api"></a>Restore snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Restores a <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshot</a> of a cluster or specified data streams and indices.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/my_snapshot/_restore</pre>
</div>
<div class="console_widget" data-snippet="snippets/2328.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;/_restore</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>Use the restore snapshot API to restore a snapshot of a cluster, including all data streams and indices in the snapshot. If you do not want to restore the entire snapshot, you can select specific data streams or indices to restore.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You cannot restore a data stream if a stream with the same name already
exists.</p>
</div>
</div>
<p>You can run the restore operation on a cluster that contains an elected
<a class="xref" href="settings.html#master-node" title="Master-eligible node">master node</a> and has data nodes with enough capacity to accommodate the snapshot
you are restoring. Existing indices can only be restored if they are
<a class="xref" href="indices.html#indices-close" title="Close index API">closed</a> and have the same number of shards as the indices in
the snapshot. The restore operation automatically opens restored indices if
they were closed and creates new indices if they do not exist in the cluster.</p>
<p>If a data stream is restored, its backing indices are also restored.
Alternatively, you can restore individual backing indices without restoring an
entire data stream. If you restore individual backing indices, they are not
automatically added to any existing data stream. For example, if only the
<code class="literal">.ds-logs-00003</code> backing index is restored from a snapshot, it is not
automatically added to the existing <code class="literal">logs</code> data stream.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">index_settings</code> and <code class="literal">ignore_index_settings</code> parameters affect
restored backing indices only. New backing indices created for a stream use the index
settings specified in the stream&#8217;s matching
<a class="xref" href="set-up-a-data-stream.html#create-a-data-stream-template" title="Create an index template">index template</a>.</p>
<p>If you change index settings during a restore, we recommend you make similar
changes in the stream&#8217;s matching index template. This ensures new backing
indices created for the stream use the same index settings.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the repository to restore a snapshot from.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot to restore.
</dd>
</dl>
</div>
</div>

<div class="section child-attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the request returns an error for any data stream or index that is missing or closed. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, the request ignores data streams and indices in <code class="literal">indices</code> that are missing or closed.</p>
</dd>
<dt>
<span class="term">
<code class="literal">ignore_index_settings</code>
</span>
</dt>
<dd>
(Optional, string)
A comma-separated list of index settings that should not be restored from a snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">include_aliases</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">true</code>, index aliases from the original snapshot are restored.
Defaults to <code class="literal">true</code>.
</p>
<p>If <code class="literal">false</code>, prevents aliases from being restored together with associated
indices.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-include-global-state"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">include_global_state</code>
</span>
</dt>
<dd>
<p>(Optional, Boolean)
If <code class="literal">false</code>, the cluster state is not restored. Defaults to <code class="literal">false</code>.</p>
<p>If <code class="literal">true</code>, the current cluster state is included in the restore operation.</p>
<p>The cluster state includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Persistent cluster settings
</li>
<li class="listitem">
Index templates
</li>
<li class="listitem">
Legacy index templates
</li>
<li class="listitem">
Ingest pipelines
</li>
<li class="listitem">
ILM lifecycle policies
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, the entire restore operation will fail if one or more indices included in the snapshot do not have all primary shards available. You can change this behavior by setting <a class="xref" href="snapshot-restore-apis.html#restore-snapshot-api-partial"><code class="literal">partial</code></a> to <code class="literal">true</code>.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-index-settings"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index_settings</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
A comma-separated list of settings to add or change in all restored indices. Use this parameter to override index settings when restoring snapshots.
</p>
<p>For data streams, these index settings are applied to the restored backing
indices.</p>
<p>For more information regarding all the different index-level settings
that you can specify, see
<a class="xref" href="index-modules.html" title="Index modules">index modules</a>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
A comma-separated list of data streams and indices to restore from the snapshot.
<a class="xref" href="api-conventions.html#multi-index" title="Multi-target syntax">Multi-index syntax</a> is supported.
</p>
<p>By default, a restore operation includes all data streams and indices in the snapshot. If this
argument is provided, the restore operation only includes the specified data streams and indices.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-partial"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">partial</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the entire restore operation will fail if one or more indices included in the snapshot do not have all primary shards available. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, allows restoring a partial snapshot of indices with unavailable shards. Only shards that were successfully included in the snapshot
will be restored. All missing shards will be recreated as empty.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-rename-pattern"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">rename_pattern</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Defines a rename pattern to apply to restored data streams and indices. Data streams and indices matching the rename pattern will be renamed according to
<a class="xref" href="snapshot-restore-apis.html#restore-snapshot-api-rename-replacement"><code class="literal">rename_replacement</code></a>.
</p>
<p>The rename pattern is applied as defined by the regular expression that
supports referencing the original text, according to the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/regex/Matcher.html#appendReplacement-java.lang.StringBuffer-java.lang.String-" class="ulink" target="_top"><code class="literal">appendReplacement</code></a> logic.</p>
<p>The request will fail if two or more data streams or indices will be renamed into the same name.</p>
<p>If you rename a restored data stream, its backing indices are also
renamed. For example, if you rename the <code class="literal">logs</code> data stream to <code class="literal">restored-logs</code>,
the backing index <code class="literal">.ds-logs-000005</code> is renamed to <code class="literal">.ds-restored-logs-000005</code>.</p>
</dd>
</dl>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you rename a restored stream, ensure an index template matches the new stream
name. If no index template matches the stream, it cannot
<a class="xref" href="use-a-data-stream.html#manually-roll-over-a-data-stream" title="Manually roll over a data stream">roll over</a> or create new backing indices.</p>
</div>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-rename-replacement"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">rename_replacement</code>
</span>
</dt>
<dd>
(Optional, string)
Defines the rename replacement string. See <a class="xref" href="snapshot-restore-apis.html#restore-snapshot-api-rename-pattern"><code class="literal">rename_pattern</code></a> for more information.
</dd>
<dt>
<span class="term">
<code class="literal">wait_for_completion</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the request returns a response when the restore operation initializes.
Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, the request returns a response when the restore operation
completes.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following request restores <code class="literal">index_1</code> and <code class="literal">index_2</code> from <code class="literal">snapshot_2</code>. The <code class="literal">rename_pattern</code> and <code class="literal">rename_replacement</code> parameters indicate any index matching the regular expression <code class="literal">index_(.+)</code> will be renamed using the pattern <code class="literal">restored_index_$1</code> when restored.</p>
<p>For example, <code class="literal">index_1</code> will be renamed to <code class="literal">restored_index_1</code>. <code class="literal">index_2</code> will be renamed to <code class="literal">restored_index_2</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/snapshot_2/_restore?wait_for_completion=true
{
  "indices": "index_1,index_2",
  "ignore_unavailable": true,
  "include_global_state": false,
  "rename_pattern": "index_(.+)",
  "rename_replacement": "restored_index_$1",
  "include_aliases": false
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2329.console"></div>
<p>The API returns an acknowledgement if the request succeeds. If the request encounters errors, the response indicates any issues found, such as
open indices that are blocking the restore operation from completing.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="delete-snapshot-api"></a>Delete snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Deletes a <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshot</a>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_snapshot/my_repository/my_snapshot</pre>
</div>
<div class="console_widget" data-snippet="snippets/2330.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>Use the delete snapshot API to delete a <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshot</a>, which is a backup taken from a running Elasticsearch cluster.</p>
<p>When deleting a snapshot from a repository, Elasticsearch deletes all files that are associated with the snapshot and not used by any other snapshots. All files that are shared with at least one other existing snapshot are left intact.</p>
<p>If you attempt to delete a snapshot while it is being created, the snapshot process aborts and all associated will be deleted.</p>
<p>To delete multiple snapshots in a single request, separate the snapshot names with a comma or use a wildcard (<code class="literal">*</code>).</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Use the delete snapshot API to cancel long-running snapshot operations that were started by mistake.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the repository to delete a snapshot from.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Comma-separated list of snapshot names to delete. Also accepts wildcards (<code class="literal">*</code>).
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-example"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following request deletes <code class="literal">snapshot_2</code> and <code class="literal">snapshot_3</code> from the repository named <code class="literal">my_repository</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_snapshot/my_repository/snapshot_2,snapshot_3</pre>
</div>
<div class="console_widget" data-snippet="snippets/2331.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "acknowledged" : true
}</pre>
</div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="security-api.html">« Security APIs</a>
</span>
<span class="next">
<a href="snapshot-lifecycle-management-api.html">Snapshot lifecycle management APIs »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
