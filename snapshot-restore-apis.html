<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="keywords" content="hot-spotting, hotspot, hot-spot, hot spot, hotspots, hotspotting">
<title>Snapshot and restore APIs | Elasticsearch Guide | Elastic</title>
<meta class="elastic" name="content" content="Snapshot and restore APIs | Elasticsearch Guide">

<link rel="home" href="index.html" title="Elasticsearch Guide"/>
<link rel="up" href="rest-apis.html" title="REST APIs"/>
<link rel="prev" href="security-api.html" title="Security APIs"/>
<link rel="next" href="snapshot-lifecycle-management-api.html" title="Snapshot lifecycle management APIs"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="security-api.html">« Security APIs</a>
</span>
<span class="next">
<a href="snapshot-lifecycle-management-api.html">Snapshot lifecycle management APIs »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="snapshot-restore-apis"></a>Snapshot and restore APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/snapshot-restore-apis.asciidoc">edit</a></h2>
</div></div></div>
<p>You can use the following APIs to set up snapshot repositories, manage snapshot
backups, and restore snapshots to a running cluster.</p>
<p>For more information, see <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">Snapshot and restore</a>.</p>
<h3><a id="snapshot-restore-repo-apis"></a>Snapshot repository management APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/snapshot-restore-apis.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api" title="Create or update snapshot repository API">Create or update snapshot repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#verify-snapshot-repo-api" title="Verify snapshot repository API">Verify snapshot repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#get-snapshot-repo-api" title="Get snapshot repository API">Get snapshot repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#delete-snapshot-repo-api" title="Delete snapshot repository API">Delete snapshot repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#clean-up-snapshot-repo-api" title="Clean up snapshot repository API">Clean up snapshot repository</a>
</li>
</ul>
</div>
<h3><a id="snapshot-management-apis"></a>Snapshot management APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/snapshot-restore-apis.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#create-snapshot-api" title="Create snapshot API">Create snapshot</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#clone-snapshot-api" title="Clone snapshot API">Clone snapshot</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#get-snapshot-api" title="Get snapshot API">Get snapshot</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-api" title="Get snapshot status API">Get snapshot status</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#restore-snapshot-api" title="Restore snapshot API">Restore snapshot</a>
</li>
<li class="listitem">
<a class="xref" href="snapshot-restore-apis.html#delete-snapshot-api" title="Delete snapshot API">Delete snapshot</a>
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="put-snapshot-repo-api"></a>Create or update snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Registers or updates a <a class="xref" href="snapshots-register-repository.html" title="Register a snapshot repository">snapshot repository</a>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_snapshot/my_repository
{
  "type": "fs",
  "settings": {
    "location": "my_backup_location"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2964.console"></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you&#8217;re migrating <a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.9/searchable-snapshots.html" class="ulink" target="_top">searchable snapshots</a>, the repository&#8217;s name must be identical in the source and destination clusters.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_snapshot/&lt;repository&gt;</code></p>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To register a snapshot repository, the cluster&#8217;s global metadata must be
writeable. Ensure there aren&#8217;t any <a class="xref" href="settings.html#cluster-read-only" title="Metadata">cluster blocks</a> that
prevent write access.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository to register or update.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Several options for this API can be specified using a query parameter
or a request body parameter. If both parameters are specified, only the query
parameter is used.</p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a response. If no response is received before the timeout expires, the request
fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">verify</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">true</code>, the request verifies the repository is functional on all master and
data nodes in the cluster. If <code class="literal">false</code>, this verification is skipped. Defaults to
<code class="literal">true</code>.
</p>
<p>You can manually perform this verification using the
<a class="xref" href="snapshot-restore-apis.html#verify-snapshot-repo-api" title="Verify snapshot repository API">verify snapshot repository API</a>.</p>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-snapshot-repo-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/put-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<a id="put-snapshot-repo-api-request-type"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>
(Required, string)
Repository type.
</p>
<details open>
<summary class="title">Valid values for <code class="literal">type</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">azure</code>
</span>
</dt>
<dd>
<a class="xref" href="snapshots-register-repository.html#repository-azure" title="Azure repository">Azure repository</a>
</dd>
<dt>
<span class="term">
<code class="literal">gcs</code>
</span>
</dt>
<dd>
<a class="xref" href="snapshots-register-repository.html#repository-gcs" title="Google Cloud Storage repository">Google Cloud Storage repository</a>
</dd>
<dt>
<span class="term">
<code class="literal">s3</code>
</span>
</dt>
<dd>
<a class="xref" href="snapshots-register-repository.html#repository-s3" title="S3 repository">S3 repository</a>
</dd>
<dt>
<span class="term">
<code class="literal">fs</code>
</span>
</dt>
<dd>
<a class="xref" href="snapshots-register-repository.html#snapshots-filesystem-repository" title="Shared file system repository">Shared file system repository</a>
</dd>
<dt>
<span class="term">
<code class="literal">source</code>
</span>
</dt>
<dd>
<a class="xref" href="snapshots-register-repository.html#snapshots-source-only-repository" title="Source-only repository">Source-only repository</a>
</dd>
<dt>
<span class="term">
<code class="literal">url</code>
</span>
</dt>
<dd>
<a class="xref" href="snapshots-register-repository.html#snapshots-read-only-repository" title="Read-only URL repository">Read-only URL repository</a>
</dd>
</dl>
</div>
<p>Other repository types are available through official plugins:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">hdfs</code>
</span>
</dt>
<dd>
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/8.9/repository-hdfs.html" class="ulink" target="_top">Hadoop Distributed File System (HDFS) repository</a>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="put-snapshot-repo-api-settings-param"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">settings</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Settings for the repository. Supported settings vary based on the repository
type:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="snapshots-register-repository.html#repository-azure" title="Azure repository">Azure repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshots-register-repository.html#repository-gcs" title="Google Cloud Storage repository">Google Cloud Storage repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshots-register-repository.html#repository-s3" title="S3 repository">S3 repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshots-register-repository.html#snapshots-filesystem-repository" title="Shared file system repository">Shared file system repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshots-register-repository.html#snapshots-read-only-repository" title="Read-only URL repository">Read-only URL repository</a>
</li>
<li class="listitem">
<a class="xref" href="snapshots-register-repository.html#snapshots-source-only-repository" title="Source-only repository">Source-only repository</a>
</li>
</ul>
</div>
<p>Other repository types are available through official plugins:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/8.9/repository-hdfs.html" class="ulink" target="_top">Hadoop Distributed File System (HDFS) repository</a>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">verify</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">true</code>, the request verifies the repository is functional on all master and
data nodes in the cluster. If <code class="literal">false</code>, this verification is skipped. Defaults to
<code class="literal">true</code>.
</p>
<p>You can manually perform this verification using the
<a class="xref" href="snapshots-register-repository.html#snapshots-repository-verification" title="Verify a repository">verify snapshot repository API</a>.</p>
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="verify-snapshot-repo-api"></a>Verify snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Checks for common misconfigurations in a snapshot repository. See
<a class="xref" href="snapshots-register-repository.html#snapshots-repository-verification" title="Verify a repository">Verify a repository</a>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/_verify</pre>
</div>
<div class="console_widget" data-snippet="snippets/2965.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;/_verify</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository to verify.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a response. If no response is received before the timeout expires, the request
fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="verify-snapshot-repo-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/verify-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">nodes</code>
</span>
</dt>
<dd>
<p>
(object)
</p>
<details open>
<summary class="title">Properties of <code class="literal">nodes</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;node_id&gt;</code>
</span>
</dt>
<dd>
<p>
(object)
Contains information about a node connected to the snapshot repository.
</p>
<p>The key is the ID of the node.</p>
<details open>
<summary class="title">Properties of <code class="literal">&lt;node_id&gt;</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
<p>
(string)
Human-readable name for the node.
</p>
<p>You can set this name using the <a class="xref" href="settings.html#node-name" title="Node name setting"><code class="literal">node.name</code></a> property in
<code class="literal">elasticsearch.yml</code>. Defaults to the machine&#8217;s hostname.</p>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="repo-analysis-api"></a>Repository analysis API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/repo-analysis-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Analyzes a repository, reporting its performance characteristics and any
incorrect behaviour found.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/_analyze?blob_count=10&amp;max_blob_size=1mb&amp;timeout=120s</pre>
</div>
<div class="console_widget" data-snippet="snippets/2966.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="repo-analysis-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/repo-analysis-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;/_analyze</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="repo-analysis-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/repo-analysis-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API. For more
information, see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
<li class="listitem">
If the <a class="xref" href="operator-privileges.html" title="Operator privileges">operator privileges feature</a> is enabled, only operator
users can use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="repo-analysis-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/repo-analysis-api.asciidoc">edit</a></h3>
</div></div></div>
<p>There are a large number of third-party storage systems available, not all of
which are suitable for use as a snapshot repository by Elasticsearch. Some storage
systems behave incorrectly, or perform poorly, especially when accessed
concurrently by multiple clients as the nodes of an Elasticsearch cluster do.</p>
<p>The Repository analysis API performs a collection of read and write operations
on your repository which are designed to detect incorrect behaviour and to
measure the performance characteristics of your storage system.</p>
<p>The default values for the parameters to this API are deliberately low to
reduce the impact of running an analysis inadvertently. A realistic experiment
should set <code class="literal">blob_count</code> to at least <code class="literal">2000</code>, <code class="literal">max_blob_size</code> to at least <code class="literal">2gb</code>,
and <code class="literal">max_total_data_size</code> to at least <code class="literal">1tb</code>, and will almost certainly need to
increase the <code class="literal">timeout</code> to allow time for the process to complete successfully.
You should run the analysis on a multi-node cluster of a similar size to your
production cluster so that it can detect any problems that only arise when the
repository is accessed by many nodes at once.</p>
<p>If the analysis fails then Elasticsearch detected that your repository behaved
unexpectedly. This usually means you are using a third-party storage system
with an incorrect or incompatible implementation of the API it claims to
support. If so, this storage system is not suitable for use as a snapshot
repository. You will need to work with the supplier of your storage system to
address the incompatibilities that Elasticsearch detects. See
<a class="xref" href="snapshots-register-repository.html#self-managed-repo-types" title="Self-managed repository types">Self-managed repository types</a> for more information.</p>
<p>If the analysis is successful this API returns details of the testing process,
optionally including how long each operation took. You can use this information
to determine the performance of your storage system. If any operation fails or
returns an incorrect result, this API returns an error. If the API returns an
error then it may not have removed all the data it wrote to the repository. The
error will indicate the location of any leftover data, and this path is also
recorded in the Elasticsearch logs. You should verify yourself that this location has
been cleaned up correctly. If there is still leftover data at the specified
location then you should manually remove it.</p>
<p>If the connection from your client to Elasticsearch is closed while the client is
waiting for the result of the analysis then the test is cancelled. Some clients
are configured to close their connection if no response is received within a
certain timeout. An analysis takes a long time to complete so you may need to
relax any such client-side timeouts. On cancellation the analysis attempts to
clean up the data it was writing, but it may not be able to remove it all. The
path to the leftover data is recorded in the Elasticsearch logs. You should verify
yourself that this location has been cleaned up correctly. If there is still
leftover data at the specified location then you should manually remove it.</p>
<p>If the analysis is successful then it detected no incorrect behaviour, but this
does not mean that correct behaviour is guaranteed. The analysis attempts to
detect common bugs but it certainly does not offer 100% coverage. Additionally,
it does not test the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Your repository must perform durable writes. Once a blob has been written it
must remain in place until it is deleted, even after a power loss or similar
disaster.
</li>
<li class="listitem">
Your repository must not suffer from silent data corruption. Once a blob has
been written its contents must remain unchanged until it is deliberately
modified or deleted.
</li>
<li class="listitem">
Your repository must behave correctly even if connectivity from the cluster
is disrupted. Reads and writes may fail in this case, but they must not return
incorrect results.
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>An analysis writes a substantial amount of data to your repository
and then reads it back again. This consumes bandwidth on the network between
the cluster and the repository, and storage space and IO bandwidth on the
repository itself. You must ensure this load does not affect other users of
these systems. Analyses respect the repository settings
<code class="literal">max_snapshot_bytes_per_sec</code> and <code class="literal">max_restore_bytes_per_sec</code> if available, and
the cluster setting <code class="literal">indices.recovery.max_bytes_per_sec</code> which you can use to
limit the bandwidth they consume.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API is intended for exploratory use by humans. You should expect the
request parameters and the response format to vary in future versions.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API may not work correctly in a mixed-version cluster.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_implementation_details"></a>Implementation details<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/repo-analysis-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This section of documentation describes how the Repository analysis API
works in this version of Elasticsearch, but you should expect the implementation to vary
between versions. The request parameters and response format depend on details
of the implementation so may also be different in newer versions.</p>
</div>
</div>
<p>The analysis comprises a number of blob-level tasks, as set by the <code class="literal">blob_count</code>
parameter. The blob-level tasks are distributed over the data and
master-eligible nodes in the cluster for execution.</p>
<p>For most blob-level tasks, the executing node first writes a blob to the
repository, and then instructs some of the other nodes in the cluster to
attempt to read the data it just wrote. The size of the blob is chosen
randomly, according to the <code class="literal">max_blob_size</code> and <code class="literal">max_total_data_size</code>
parameters. If any of these reads fails then the repository does not implement
the necessary read-after-write semantics that Elasticsearch requires.</p>
<p>For some blob-level tasks, the executing node will instruct some of its peers
to attempt to read the data before the writing process completes. These reads
are permitted to fail, but must not return partial data. If any read returns
partial data then the repository does not implement the necessary atomicity
semantics that Elasticsearch requires.</p>
<p>For some blob-level tasks, the executing node will overwrite the blob while its
peers are reading it. In this case the data read may come from either the
original or the overwritten blob, but the read operation must not return
partial data or a mix of data from the two blobs. If any of these reads returns
partial data or a mix of the two blobs then the repository does not implement
the necessary atomicity semantics that Elasticsearch requires for overwrites.</p>
<p>The executing node will use a variety of different methods to write the blob.
For instance, where applicable, it will use both single-part and multi-part
uploads. Similarly, the reading nodes will use a variety of different methods
to read the data back again. For instance they may read the entire blob from
start to end, or may read only a subset of the data.</p>
<p>For some blob-level tasks, the executing node will abort the write before it is
complete. In this case it still instructs some of the other nodes in the
cluster to attempt to read the blob, but all of these reads must fail to find
the blob.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="repo-analysis-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/repo-analysis-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository to test.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="repo-analysis-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/repo-analysis-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">blob_count</code>
</span>
</dt>
<dd>
(Optional, integer) The total number of blobs to write to the repository during
the test. Defaults to <code class="literal">100</code>. For realistic experiments you should set this to
at least <code class="literal">2000</code>.
</dd>
<dt>
<span class="term">
<code class="literal">max_blob_size</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#size-units" title="Unit-less quantities">size units</a>) The maximum size of a blob to be written
during the test. Defaults to <code class="literal">10mb</code>. For realistic experiments you should set
this to at least <code class="literal">2gb</code>.
</dd>
<dt>
<span class="term">
<code class="literal">max_total_data_size</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#size-units" title="Unit-less quantities">size units</a>) An upper limit on the total size of all
the blobs written during the test. Defaults to <code class="literal">1gb</code>. For realistic experiments
you should set this to at least <code class="literal">1tb</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
the test to complete. If no response is received before the timeout expires,
the test is cancelled and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_advanced_query_parameters"></a>Advanced query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/repo-analysis-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The following parameters allow additional control over the analysis, but you
will usually not need to adjust them.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">concurrency</code>
</span>
</dt>
<dd>
(Optional, integer) The number of write operations to perform concurrently.
Defaults to <code class="literal">10</code>.
</dd>
<dt>
<span class="term">
<code class="literal">read_node_count</code>
</span>
</dt>
<dd>
(Optional, integer) The number of nodes on which to perform a read operation
after writing each blob. Defaults to <code class="literal">10</code>.
</dd>
<dt>
<span class="term">
<code class="literal">early_read_node_count</code>
</span>
</dt>
<dd>
(Optional, integer) The number of nodes on which to perform an early read
operation while writing each blob. Defaults to <code class="literal">2</code>. Early read operations are
only rarely performed.
</dd>
<dt>
<span class="term">
<code class="literal">rare_action_probability</code>
</span>
</dt>
<dd>
(Optional, double) The probability of performing a rare action (an early read,
an overwrite, or an aborted write) on each blob. Defaults to <code class="literal">0.02</code>.
</dd>
<dt>
<span class="term">
<code class="literal">seed</code>
</span>
</dt>
<dd>
(Optional, integer) The seed for the pseudo-random number generator used to
generate the list of operations performed during the test. To repeat the same
set of operations in multiple experiments, use the same seed in each
experiment. Note that the operations are performed concurrently so may not
always happen in the same order on each run.
</dd>
<dt>
<span class="term">
<code class="literal">detailed</code>
</span>
</dt>
<dd>
(Optional, boolean) Whether to return detailed results, including timing
information for every operation performed during the analysis. Defaults to
<code class="literal">false</code>, meaning to return only a summary of the analysis.
</dd>
<dt>
<span class="term">
<code class="literal">rarely_abort_writes</code>
</span>
</dt>
<dd>
(Optional, boolean) Whether to rarely abort some write requests. Defaults to
<code class="literal">true</code>.
</dd>
</dl>
</div>
</div>

</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="repo-analysis-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/repo-analysis-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The response exposes implementation details of the analysis which may change
from version to version. The response body format is therefore not considered
stable and may be different in newer versions.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">coordinating_node</code>
</span>
</dt>
<dd>
<p>
(object)
Identifies the node which coordinated the analysis and performed the final cleanup.
</p>
<details open>
<summary class="title">Properties of <code class="literal">coordinating_node</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(string)
The id of the coordinating node.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string)
The name of the coordinating node
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">repository</code>
</span>
</dt>
<dd>
(string)
The name of the repository that was the subject of the analysis.
</dd>
<dt>
<span class="term">
<code class="literal">blob_count</code>
</span>
</dt>
<dd>
(integer)
The number of blobs written to the repository during the test, equal to the
<code class="literal">?blob_count</code> request parameter.
</dd>
<dt>
<span class="term">
<code class="literal">concurrency</code>
</span>
</dt>
<dd>
(integer)
The number of write operations performed concurrently during the test, equal to
the <code class="literal">?concurrency</code> request parameter.
</dd>
<dt>
<span class="term">
<code class="literal">read_node_count</code>
</span>
</dt>
<dd>
(integer)
The limit on the number of nodes on which read operations were performed after
writing each blob, equal to the <code class="literal">?read_node_count</code> request parameter.
</dd>
<dt>
<span class="term">
<code class="literal">early_read_node_count</code>
</span>
</dt>
<dd>
(integer)
The limit on the number of nodes on which early read operations were performed
after writing each blob, equal to the <code class="literal">?early_read_node_count</code> request
parameter.
</dd>
<dt>
<span class="term">
<code class="literal">max_blob_size</code>
</span>
</dt>
<dd>
(string)
The limit on the size of a blob written during the test, equal to the
<code class="literal">?max_blob_size</code> parameter.
</dd>
<dt>
<span class="term">
<code class="literal">max_blob_size_bytes</code>
</span>
</dt>
<dd>
(long)
The limit, in bytes, on the size of a blob written during the test, equal to
the <code class="literal">?max_blob_size</code> parameter.
</dd>
<dt>
<span class="term">
<code class="literal">max_total_data_size</code>
</span>
</dt>
<dd>
(string)
The limit on the total size of all blob written during the test, equal to the
<code class="literal">?max_total_data_size</code> parameter.
</dd>
<dt>
<span class="term">
<code class="literal">max_total_data_size_bytes</code>
</span>
</dt>
<dd>
(long)
The limit, in bytes, on the total size of all blob written during the test,
equal to the <code class="literal">?max_total_data_size</code> parameter.
</dd>
<dt>
<span class="term">
<code class="literal">seed</code>
</span>
</dt>
<dd>
(long)
The seed for the pseudo-random number generator used to generate the operations
used during the test. Equal to the <code class="literal">?seed</code> request parameter if set.
</dd>
<dt>
<span class="term">
<code class="literal">rare_action_probability</code>
</span>
</dt>
<dd>
(double)
The probability of performing rare actions during the test. Equal to the
<code class="literal">?rare_action_probability</code> request parameter.
</dd>
<dt>
<span class="term">
<code class="literal">blob_path</code>
</span>
</dt>
<dd>
(string)
The path in the repository under which all the blobs were written during the
test.
</dd>
<dt>
<span class="term">
<code class="literal">issues_detected</code>
</span>
</dt>
<dd>
(list)
A list of correctness issues detected, which will be empty if the API
succeeded. Included to emphasize that a successful response does not guarantee
correct behaviour in future.
</dd>
<dt>
<span class="term">
<code class="literal">summary</code>
</span>
</dt>
<dd>
<p>
(object)
A collection of statistics that summarise the results of the test.
</p>
<details open>
<summary class="title">Properties of <code class="literal">summary</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">write</code>
</span>
</dt>
<dd>
<p>
(object)
A collection of statistics that summarise the results of the write operations
in the test.
</p>
<details open>
<summary class="title">Properties of <code class="literal">write</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">count</code>
</span>
</dt>
<dd>
(integer)
The number of write operations performed in the test.
</dd>
<dt>
<span class="term">
<code class="literal">total_size</code>
</span>
</dt>
<dd>
(string)
The total size of all the blobs written in the test.
</dd>
<dt>
<span class="term">
<code class="literal">total_size_bytes</code>
</span>
</dt>
<dd>
(long)
The total size of all the blobs written in the test, in bytes.
</dd>
<dt>
<span class="term">
<code class="literal">total_throttled</code>
</span>
</dt>
<dd>
(string)
The total time spent waiting due to the <code class="literal">max_snapshot_bytes_per_sec</code> throttle.
</dd>
<dt>
<span class="term">
<code class="literal">total_throttled_nanos</code>
</span>
</dt>
<dd>
(long)
The total time spent waiting due to the <code class="literal">max_snapshot_bytes_per_sec</code> throttle,
in nanoseconds.
</dd>
<dt>
<span class="term">
<code class="literal">total_elapsed</code>
</span>
</dt>
<dd>
(string)
The total elapsed time spent on writing blobs in the test.
</dd>
<dt>
<span class="term">
<code class="literal">total_elapsed_nanos</code>
</span>
</dt>
<dd>
(long)
The total elapsed time spent on writing blobs in the test, in nanoseconds.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">read</code>
</span>
</dt>
<dd>
<p>
(object)
A collection of statistics that summarise the results of the read operations in
the test.
</p>
<details open>
<summary class="title">Properties of <code class="literal">read</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">count</code>
</span>
</dt>
<dd>
(integer)
The number of read operations performed in the test.
</dd>
<dt>
<span class="term">
<code class="literal">total_size</code>
</span>
</dt>
<dd>
(string)
The total size of all the blobs or partial blobs read in the test.
</dd>
<dt>
<span class="term">
<code class="literal">total_size_bytes</code>
</span>
</dt>
<dd>
(long)
The total size of all the blobs or partial blobs read in the test, in bytes.
</dd>
<dt>
<span class="term">
<code class="literal">total_wait</code>
</span>
</dt>
<dd>
(string)
The total time spent waiting for the first byte of each read request to be
received.
</dd>
<dt>
<span class="term">
<code class="literal">total_wait_nanos</code>
</span>
</dt>
<dd>
(long)
The total time spent waiting for the first byte of each read request to be
received, in nanoseconds.
</dd>
<dt>
<span class="term">
<code class="literal">max_wait</code>
</span>
</dt>
<dd>
(string)
The maximum time spent waiting for the first byte of any read request to be
received.
</dd>
<dt>
<span class="term">
<code class="literal">max_wait_nanos</code>
</span>
</dt>
<dd>
(long)
The maximum time spent waiting for the first byte of any read request to be
received, in nanoseconds.
</dd>
<dt>
<span class="term">
<code class="literal">total_throttled</code>
</span>
</dt>
<dd>
(string)
The total time spent waiting due to the <code class="literal">max_restore_bytes_per_sec</code> or
<code class="literal">indices.recovery.max_bytes_per_sec</code> throttles.
</dd>
<dt>
<span class="term">
<code class="literal">total_throttled_nanos</code>
</span>
</dt>
<dd>
(long)
The total time spent waiting due to the <code class="literal">max_restore_bytes_per_sec</code> or
<code class="literal">indices.recovery.max_bytes_per_sec</code> throttles, in nanoseconds.
</dd>
<dt>
<span class="term">
<code class="literal">total_elapsed</code>
</span>
</dt>
<dd>
(string)
The total elapsed time spent on reading blobs in the test.
</dd>
<dt>
<span class="term">
<code class="literal">total_elapsed_nanos</code>
</span>
</dt>
<dd>
(long)
The total elapsed time spent on reading blobs in the test, in nanoseconds.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">details</code>
</span>
</dt>
<dd>
<p>
(array)
A description of every read and write operation performed during the test. This
is only returned if the <code class="literal">?detailed</code> request parameter is set to <code class="literal">true</code>.
</p>
<details>
<summary class="title">Properties of items within <code class="literal">details</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">blob</code>
</span>
</dt>
<dd>
<p>
(object)
A description of the blob that was written and read.
</p>
<details open>
<summary class="title">Properties of <code class="literal">blob</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string)
The name of the blob.
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
(string)
The size of the blob.
</dd>
<dt>
<span class="term">
<code class="literal">size_bytes</code>
</span>
</dt>
<dd>
(long)
The size of the blob in bytes.
</dd>
<dt>
<span class="term">
<code class="literal">read_start</code>
</span>
</dt>
<dd>
(long)
The position, in bytes, at which read operations started.
</dd>
<dt>
<span class="term">
<code class="literal">read_end</code>
</span>
</dt>
<dd>
(long)
The position, in bytes, at which read operations completed.
</dd>
<dt>
<span class="term">
<code class="literal">read_early</code>
</span>
</dt>
<dd>
(boolean)
Whether any read operations were started before the write operation completed.
</dd>
<dt>
<span class="term">
<code class="literal">overwritten</code>
</span>
</dt>
<dd>
(boolean)
Whether the blob was overwritten while the read operations were ongoing.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">writer_node</code>
</span>
</dt>
<dd>
<p>
(object)
Identifies the node which wrote this blob and coordinated the read operations.
</p>
<details open>
<summary class="title">Properties of <code class="literal">writer_node</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(string)
The id of the writer node.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string)
The name of the writer node
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">write_elapsed</code>
</span>
</dt>
<dd>
(string)
The elapsed time spent writing this blob.
</dd>
<dt>
<span class="term">
<code class="literal">write_elapsed_nanos</code>
</span>
</dt>
<dd>
(long)
The elapsed time spent writing this blob, in nanoseconds.
</dd>
<dt>
<span class="term">
<code class="literal">overwrite_elapsed</code>
</span>
</dt>
<dd>
(string)
The elapsed time spent overwriting this blob. Omitted if the blob was not
overwritten.
</dd>
<dt>
<span class="term">
<code class="literal">overwrite_elapsed_nanos</code>
</span>
</dt>
<dd>
(long)
The elapsed time spent overwriting this blob, in nanoseconds. Omitted if the
blob was not overwritten.
</dd>
<dt>
<span class="term">
<code class="literal">write_throttled</code>
</span>
</dt>
<dd>
(string)
The length of time spent waiting for the <code class="literal">max_snapshot_bytes_per_sec</code> (or
<code class="literal">indices.recovery.max_bytes_per_sec</code> if the
<a class="xref" href="settings.html#recovery-settings-for-managed-services" title="Recovery settings for managed services">recovery settings for managed services</a>
are set) throttle while writing this blob.
</dd>
<dt>
<span class="term">
<code class="literal">write_throttled_nanos</code>
</span>
</dt>
<dd>
(long)
The length of time spent waiting for the <code class="literal">max_snapshot_bytes_per_sec</code> (or
<code class="literal">indices.recovery.max_bytes_per_sec</code> if the
<a class="xref" href="settings.html#recovery-settings-for-managed-services" title="Recovery settings for managed services">recovery settings for managed services</a>
are set) throttle while writing this blob, in nanoseconds.
</dd>
<dt>
<span class="term">
<code class="literal">reads</code>
</span>
</dt>
<dd>
<p>
(array)
A description of every read operation performed on this blob.
</p>
<details open>
<summary class="title">Properties of items within <code class="literal">reads</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">node</code>
</span>
</dt>
<dd>
<p>
(object)
Identifies the node which performed the read operation.
</p>
<details open>
<summary class="title">Properties of <code class="literal">node</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(string)
The id of the reader node.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string)
The name of the reader node
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">before_write_complete</code>
</span>
</dt>
<dd>
(boolean)
Whether the read operation may have started before the write operation was
complete. Omitted if <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">found</code>
</span>
</dt>
<dd>
(boolean)
Whether the blob was found by this read operation or not. May be <code class="literal">false</code> if the
read was started before the write completed, or the write was aborted before
completion.
</dd>
<dt>
<span class="term">
<code class="literal">first_byte_time</code>
</span>
</dt>
<dd>
(string)
The length of time waiting for the first byte of the read operation to be
received. Omitted if the blob was not found.
</dd>
<dt>
<span class="term">
<code class="literal">first_byte_time_nanos</code>
</span>
</dt>
<dd>
(long)
The length of time waiting for the first byte of the read operation to be
received, in nanoseconds. Omitted if the blob was not found.
</dd>
<dt>
<span class="term">
<code class="literal">elapsed</code>
</span>
</dt>
<dd>
(string)
The length of time spent reading this blob. Omitted if the blob was not found.
</dd>
<dt>
<span class="term">
<code class="literal">elapsed_nanos</code>
</span>
</dt>
<dd>
(long)
The length of time spent reading this blob, in nanoseconds. Omitted if the blob
was not found.
</dd>
<dt>
<span class="term">
<code class="literal">throttled</code>
</span>
</dt>
<dd>
(string)
The length of time spent waiting due to the <code class="literal">max_restore_bytes_per_sec</code> or
<code class="literal">indices.recovery.max_bytes_per_sec</code> throttles during the read of this blob.
Omitted if the blob was not found.
</dd>
<dt>
<span class="term">
<code class="literal">throttled_nanos</code>
</span>
</dt>
<dd>
(long)
The length of time spent waiting due to the <code class="literal">max_restore_bytes_per_sec</code> or
<code class="literal">indices.recovery.max_bytes_per_sec</code> throttles during the read of this blob, in
nanoseconds. Omitted if the blob was not found.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">listing_elapsed</code>
</span>
</dt>
<dd>
(string)
The time it took to retrieve a list of all the blobs in the container.
</dd>
<dt>
<span class="term">
<code class="literal">listing_elapsed_nanos</code>
</span>
</dt>
<dd>
(long)
The time it took to retrieve a list of all the blobs in the container, in
nanoseconds.
</dd>
<dt>
<span class="term">
<code class="literal">delete_elapsed</code>
</span>
</dt>
<dd>
(string)
The time it took to delete all the blobs in the container.
</dd>
<dt>
<span class="term">
<code class="literal">delete_elapsed_nanos</code>
</span>
</dt>
<dd>
(long)
The time it took to delete all the blobs in the container, in nanoseconds.
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-snapshot-repo-api"></a>Get snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Gets information about one or more registered
<a class="xref" href="snapshots-register-repository.html" title="Register a snapshot repository">snapshot repositories</a>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository</pre>
</div>
<div class="console_widget" data-snippet="snippets/2967.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_snapshot/&lt;repository&gt;</code></p>
<p><code class="literal">GET /_snapshot</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">monitor_snapshot</code>, <code class="literal">create_snapshot</code>, or <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Comma-separated list of snapshot repository names used to limit the request.
Wildcard (<code class="literal">*</code>) expressions are supported including combining wildcards with exclude patterns starting with <code class="literal">-</code>.
</p>
<p>To get information about all snapshot repositories registered in the
cluster, omit this parameter or use <code class="literal">*</code> or <code class="literal">_all</code>.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">local</code>
</span>
</dt>
<dd>
(Optional, Boolean) If <code class="literal">true</code>, the request gets information from the local node
only. If <code class="literal">false</code>, the request gets information from the master node. Defaults to
<code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
<p>
(object)
Contains information about the snapshot repository. Key is the name of the
snapshot repository.
</p>
<details open>
<summary class="title">Properties of <code class="literal">&lt;repository&gt;</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>(string)
Repository type.</p>
<details open>
<summary class="title">Values for <code class="literal">type</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">fs</code>
</span>
</dt>
<dd>
Shared file system repository. See <a class="xref" href="snapshots-register-repository.html#snapshots-filesystem-repository" title="Shared file system repository">Shared file system repository</a>.
</dd>
<dt>
<span class="term">
<span class="xpack"><code class="literal">source</code></span>
</span>
</dt>
<dd>
Source-only repository. See <a class="xref" href="snapshots-register-repository.html#snapshots-source-only-repository" title="Source-only repository">Source-only repository</a>.
</dd>
<dt>
<span class="term">
<code class="literal">url</code>
</span>
</dt>
<dd>
URL repository. See <a class="xref" href="snapshots-register-repository.html#snapshots-read-only-repository" title="Read-only URL repository">Read-only URL repository</a>.
</dd>
</dl>
</div>
</div>
</details>
<p>More repository types are available through these official plugins:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="snapshots-register-repository.html#repository-s3" title="S3 repository">repository-s3</a> for S3 repository support
</li>
<li class="listitem">
<a href="https://www.elastic.co/guide/en/elasticsearch/plugins/8.9/repository-hdfs.html" class="ulink" target="_top">repository-hdfs</a> for HDFS repository support in
Hadoop environments
</li>
<li class="listitem">
<a class="xref" href="snapshots-register-repository.html#repository-azure" title="Azure repository">repository-azure</a> for Azure storage repositories
</li>
<li class="listitem">
<a class="xref" href="snapshots-register-repository.html#repository-gcs" title="Google Cloud Storage repository">repository-gcs</a> for Google Cloud Storage repositories
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">settings</code>
</span>
</dt>
<dd>
<p>
(object)
Contains settings for the repository. Valid properties for the <code class="literal">settings</code> object
depend on the repository type, set using the
<a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api-request-type"><code class="literal">type</code></a> parameter.
</p>
<p>For properties, see the <a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api" title="Create or update snapshot repository API">create or update snapshot
repository API</a>'s <a class="xref" href="snapshot-restore-apis.html#put-snapshot-repo-api-settings-param"><code class="literal">settings</code>
parameter</a>.</p>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-repo-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository</pre>
</div>
<div class="console_widget" data-snippet="snippets/2968.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "my_repository" : {
    "type" : "fs",
    "uuid" : "0JLknrXbSUiVPuLakHjBrQ",
    "settings" : {
      "location" : "my_backup_location"
    }
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="delete-snapshot-repo-api"></a>Delete snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Unregisters one or more <a class="xref" href="snapshots-register-repository.html" title="Register a snapshot repository">snapshot repositories</a>.</p>
<p>When a repository is unregistered, Elasticsearch only removes the reference to the
location where the repository is storing the snapshots. The snapshots themselves
are left untouched and in place.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_snapshot/my_repository</pre>
</div>
<div class="console_widget" data-snippet="snippets/2969.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_snapshot/&lt;repository&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository to unregister. Wildcard (<code class="literal">*</code>) patterns are
supported.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a response. If no response is received before the timeout expires, the request
fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="clean-up-snapshot-repo-api"></a>Clean up snapshot repository API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Triggers the review of a snapshot repository&#8217;s contents and deletes any stale
data that is not referenced by existing snapshots. See
<a class="xref" href="snapshots-register-repository.html#snapshots-repository-cleanup" title="Clean up a repository">Clean up a repository</a>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/_cleanup</pre>
</div>
<div class="console_widget" data-snippet="snippets/2970.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;/_cleanup</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository to review and clean up.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a connection to the master node. If no response is received
before the timeout expires, the request fails and returns an error. Defaults to
<code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a response. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">results</code>
</span>
</dt>
<dd>
<p>
(object)
Contains statistics for cleanup operations.
</p>
<details open>
<summary class="title">Properties of <code class="literal">results</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">deleted_bytes</code>
</span>
</dt>
<dd>
(integer)
Number of bytes freed by cleanup operations.
</dd>
<dt>
<span class="term">
<code class="literal">deleted_blobs</code>
</span>
</dt>
<dd>
(integer)
Number of binary large objects (blobs) removed from the snapshot repository
during cleanup operations. Any non-zero value implies that unreferenced blobs
were found and subsequently cleaned up.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clean-up-snapshot-repo-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clean-up-repo-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/_cleanup</pre>
</div>
<div class="console_widget" data-snippet="snippets/2971.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "results": {
    "deleted_bytes": 20,
    "deleted_blobs": 5
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="clone-snapshot-api"></a>Clone snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Clones part or all of a snapshot into a new snapshot.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_snapshot/my_repository/source_snapshot/_clone/target_snapshot
{
  "indices": "index_a,index_b"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2972.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_snapshot/&lt;repository&gt;/&lt;source_snapshot&gt;/_clone/&lt;target_snapshot&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The clone snapshot API allows creating a copy of all or part of an existing snapshot
within the same repository.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository that both source and target snapshot belong to.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="clone-snapshot-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/clone-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a response. If no response is received before the timeout expires, the request
fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
(Required, string)
A comma-separated list of indices to include in the snapshot.
<a class="xref" href="api-conventions.html#api-multi-index" title="Multi-target syntax">multi-target syntax</a> is supported.
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="create-snapshot-api"></a>Create snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p><a class="xref" href="snapshots-take-snapshot.html" title="Create a snapshot">Takes a snapshot</a> of a cluster or specified data
streams and indices.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_snapshot/my_repository/my_snapshot</pre>
</div>
<div class="console_widget" data-snippet="snippets/2973.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;</code></p>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">create_snapshot</code> or <code class="literal">manage</code> <a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to
use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot repository.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot. Supports <a class="xref" href="api-conventions.html#api-date-math-index-names" title="Date math support in index and index alias names">date math</a>. Must be
unique within the snapshot repository.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a connection to the master node. If no response is received
before the timeout expires, the request fails and returns an error. Defaults to
<code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">wait_for_completion</code>
</span>
</dt>
<dd>
(Optional, Boolean) If <code class="literal">true</code>, the request returns a response when the snapshot
is complete. If <code class="literal">false</code>, the request returns a response when the snapshot
initializes. Defaults to <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">expand_wildcards</code>
</span>
</dt>
<dd>
<p>(Optional, string) Determines how wildcard patterns in the <code class="literal">indices</code> parameter
match data streams and indices. Supports comma-separated values, such as
<code class="literal">open,hidden</code>. Defaults to <code class="literal">all</code>. Valid values are:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">all</code>
</span>
</dt>
<dd>
Match any data stream or index, including closed and <a class="xref" href="api-conventions.html#multi-hidden" title="Hidden data streams and indices">hidden</a> ones.
</dd>
<dt>
<span class="term">
<code class="literal">open</code>
</span>
</dt>
<dd>
Match open indices and data streams.
</dd>
<dt>
<span class="term">
<code class="literal">closed</code>
</span>
</dt>
<dd>
Match closed indices and data streams.
</dd>
<dt>
<span class="term">
<code class="literal">hidden</code>
</span>
</dt>
<dd>
Match hidden data streams and indices. Must be combined with <code class="literal">open</code>, <code class="literal">closed</code>,
or both.
</dd>
<dt>
<span class="term">
<code class="literal">none</code>
</span>
</dt>
<dd>
Don&#8217;t expand wildcard patterns.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">false</code>, the snapshot fails if any data stream or index in <code class="literal">indices</code> is
missing. If <code class="literal">true</code>, the snapshot ignores missing data
streams and indices. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">include_global_state</code>
</span>
</dt>
<dd>
<p>(Optional, Boolean)
If <code class="literal">true</code>, include the cluster state in the snapshot. Defaults to <code class="literal">true</code>.
The cluster state includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="settings.html#cluster-setting-types" title="Cluster and node setting types">Persistent cluster settings</a>
</li>
<li class="listitem">
<a class="xref" href="index-templates.html" title="Index templates">Index templates</a>
</li>
<li class="listitem">
<a class="xref" href="indices.html#indices-templates-v1" title="Create or update index template API">Legacy index templates</a>
</li>
<li class="listitem">
<a class="xref" href="ingest.html" title="Ingest pipelines">Ingest pipelines</a>
</li>
<li class="listitem">
<a class="xref" href="index-lifecycle-management.html" title="ILM: Manage the index lifecycle">ILM policies</a>
</li>
<li class="listitem">
For snapshots taken after 7.12.0, <a class="xref" href="snapshot-restore.html#feature-state" title="Feature states">feature states</a>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
<p>
(Optional, string or array of strings)
Comma-separated list of data streams and indices to include in the snapshot.
Supports <a class="xref" href="api-conventions.html#api-multi-index" title="Multi-target syntax">multi-target syntax</a>. Defaults to an empty array
(<code class="literal">[]</code>), which includes all regular data streams and regular indices. To exclude
all data streams and indices, use <code class="literal">-*</code>.
</p>
<p>You can&#8217;t use this parameter to include or exclude <a class="xref" href="api-conventions.html#system-indices" title="System indices">system
indices or system data streams</a> from a snapshot. Use
<a class="xref" href="snapshot-restore-apis.html#create-snapshot-api-feature-states"><code class="literal">feature_states</code></a> instead.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="create-snapshot-api-feature-states"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feature_states</code>
</span>
</dt>
<dd>
<p>
(Optional, array of strings)
<a class="xref" href="snapshot-restore.html#feature-state" title="Feature states">Feature states</a> to include in the snapshot. To get a list of
possible values and their descriptions, use the <a class="xref" href="features-apis.html#get-features-api" title="Get Features API">get features
API</a>.
</p>
<p>If <code class="literal">include_global_state</code> is <code class="literal">true</code>, the snapshot includes all feature states by
default. If <code class="literal">include_global_state</code> is <code class="literal">false</code>, the snapshot includes no feature
states by default.</p>
<p>Note that specifying an empty array will result in the default behavior. To
exclude all feature states, regardless of the <code class="literal">include_global_state</code> value,
specify an array with only the value <code class="literal">none</code> (<code class="literal">["none"]</code>).</p>
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(Optional, object)
Attaches arbitrary metadata to the snapshot, such as a record of who took the snapshot, why it was taken, or any other useful data. Metadata must be less than 1024 bytes.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="create-snapshot-api-partial"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">partial</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the entire snapshot will fail if one or more indices included in the snapshot do not have all primary shards available. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, allows taking a partial snapshot of indices with unavailable shards.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-snapshot-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/create-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following request takes a snapshot of <code class="literal">index_1</code> and <code class="literal">index_2</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_snapshot/my_repository/snapshot_2?wait_for_completion=true
{
  "indices": "index_1,index_2",
  "ignore_unavailable": true,
  "include_global_state": false,
  "metadata": {
    "taken_by": "user123",
    "taken_because": "backup before upgrading"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2974.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshot": {
    "snapshot": "snapshot_2",
    "uuid": "vdRctLCxSketdKb54xw67g",
    "repository": "my_repository",
    "version_id": &lt;version_id&gt;,
    "version": &lt;version&gt;,
    "indices": [],
    "data_streams": [],
    "feature_states": [],
    "include_global_state": false,
    "metadata": {
      "taken_by": "user123",
      "taken_because": "backup before upgrading"
    },
    "state": "SUCCESS",
    "start_time": "2020-06-25T14:00:28.850Z",
    "start_time_in_millis": 1593093628850,
    "end_time": "2020-06-25T14:00:28.850Z",
    "end_time_in_millis": 1593094752018,
    "duration_in_millis": 0,
    "failures": [],
    "shards": {
      "total": 0,
      "failed": 0,
      "successful": 0
    }
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-snapshot-api"></a>Get snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Retrieves information about one or more snapshots.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/my_snapshot</pre>
</div>
<div class="console_widget" data-snippet="snippets/2975.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">monitor_snapshot</code>, <code class="literal">create_snapshot</code>, or <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string)
Comma-separated list of snapshot repository names used to limit the request.
Wildcard (<code class="literal">*</code>) expressions are supported including combining wildcards with exclude patterns starting with <code class="literal">-</code>.
</p>
<p>To get information about all snapshot repositories registered in the
cluster, omit this parameter or use <code class="literal">*</code> or <code class="literal">_all</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string)
Comma-separated list of snapshot names to retrieve.
Wildcard (<code class="literal">*</code>) expressions are supported including combining wildcards with exclude patterns starting with <code class="literal">-</code>.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To get information about all snapshots in a registered repository, use a wildcard (<code class="literal">*</code>) or <code class="literal">_all</code>.
</li>
<li class="listitem">
<p>To get information about any snapshots that are currently running, use <code class="literal">_current</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using <code class="literal">_all</code> in a request fails if any snapshots are unavailable.
Set <a class="xref" href="snapshot-restore-apis.html#get-snapshot-api-ignore-unavailable"><code class="literal">ignore_unavailable</code></a> to <code class="literal">true</code> to return only available snapshots.</p>
</div>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a connection to the master node. If no response is received
before the timeout expires, the request fails and returns an error. Defaults to
<code class="literal">30s</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-api-ignore-unavailable"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the request returns an error for any snapshots that are unavailable. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, the request ignores snapshots that are unavailable, such as those that are corrupted or temporarily cannot be returned.</p>
</dd>
<dt>
<span class="term">
<code class="literal">verbose</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, returns additional information about each snapshot such as the
version of Elasticsearch which took the snapshot, the start and end times of
the snapshot, and the number of shards snapshotted. Defaults to <code class="literal">true</code>. If
<code class="literal">false</code>, omits the additional information.
</dd>
<dt>
<span class="term">
<code class="literal">index_names</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, returns the list of index names included in each snapshot in the response.
Defaults to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">index_details</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, returns additional information about each index in the snapshot
comprising the number of shards in the index, the total size of the index in
bytes, and the maximum number of segments per shard in the index. Defaults to
<code class="literal">false</code>, meaning that this information is omitted.
</dd>
<dt>
<span class="term">
<code class="literal">include_repository</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, returns the repository name for each snapshot in the response.
Defaults to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">sort</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Allows setting a sort order for the result. Defaults to <code class="literal">start_time</code>, i.e. sorting by snapshot start time stamp.
</p>
<details open>
<summary class="title">Valid values for <code class="literal">sort</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">start_time</code>
</span>
</dt>
<dd>
Sort snapshots by their start time stamp and break ties by snapshot name.
</dd>
<dt>
<span class="term">
<code class="literal">duration</code>
</span>
</dt>
<dd>
Sort snapshots by their duration and break ties by snapshot name.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
Sort snapshots by their name.
</dd>
<dt>
<span class="term">
<code class="literal">repository</code>
</span>
</dt>
<dd>
Sort snapshots by their repository name and break ties by snapshot name.
</dd>
<dt>
<span class="term">
<code class="literal">index_count</code>
</span>
</dt>
<dd>
Sort snapshots by the number of indices they contain and break ties by snapshot name.
</dd>
<dt>
<span class="term">
<code class="literal">shard_count</code>
</span>
</dt>
<dd>
Sort snapshots by the number of shards they contain and break ties by snapshot name.
</dd>
<dt>
<span class="term">
<code class="literal">failed_shard_count</code>
</span>
</dt>
<dd>
Sort snapshots by the number of shards that they failed to snapshot and break ties by snapshot name.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
(Optional, integer)
 Maximum number of snapshots to return. Defaults to <code class="literal">0</code> which means return all that match the request without limit.
</dd>
<dt>
<span class="term">
<code class="literal">order</code>
</span>
</dt>
<dd>
(Optional, string)
Sort order. Valid values are <code class="literal">asc</code> for ascending and <code class="literal">desc</code> for descending order. Defaults to <code class="literal">asc</code>, meaning ascending order.
</dd>
<dt>
<span class="term">
<code class="literal">from_sort_value</code>
</span>
</dt>
<dd>
(Optional, string)
Value of the current sort column at which to start retrieval. Can either be a string snapshot- or repository name when sorting by
snapshot or repository name, a millisecond time value or a number when sorting by index- or shard count.
</dd>
<dt>
<span class="term">
<code class="literal">after</code>
</span>
</dt>
<dd>
(Optional, string)
Offset identifier to start pagination from as returned by the <code class="literal">next</code> field in the response body. Using this parameter is mutually exclusive
with using the <code class="literal">from_sort_value</code> parameter.
</dd>
<dt>
<span class="term">
<code class="literal">offset</code>
</span>
</dt>
<dd>
(Optional, integer)
Numeric offset to start pagination from based on the snapshots matching this request. Using a non-zero value for this parameter is mutually
exclusive with using the <code class="literal">after</code> parameter. Defaults to <code class="literal">0</code>.
</dd>
<dt>
<span class="term">
<code class="literal">slm_policy_filter</code>
</span>
</dt>
<dd>
(Optional, string)
Filter snapshots by a comma-separated list of SLM policy names that snapshots belong to. Also accepts wildcards (<code class="literal">\*</code>) and combinations
of wildcards followed by exclude patterns starting with <code class="literal">-</code>. For example, the pattern <code class="literal">*,-policy-a-\*</code> will return all snapshots except
for those that were created by an SLM policy with a name starting with <code class="literal">policy-a-</code>. Note that the wildcard pattern <code class="literal">*</code> matches all snapshots
created by an SLM policy but not those snapshots that were not created by an SLM policy. To include snapshots not created by an SLM
policy you can use the special pattern <code class="literal">_none</code> that will match all snapshots without an SLM policy.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">after</code> parameter and <code class="literal">next</code> field allow for iterating through snapshots with some consistency guarantees regarding concurrent
creation or deletion of snapshots. It is guaranteed that any snapshot that exists at the beginning of the iteration and is not concurrently
deleted will be seen during the iteration. Snapshots concurrently created may be seen during an iteration.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The parameters <code class="literal">size</code>, <code class="literal">order</code>, <code class="literal">after</code>, <code class="literal">from_sort_value</code>, <code class="literal">offset</code>, <code class="literal">slm_policy_filter</code> and <code class="literal">sort</code> are not supported when using
<code class="literal">verbose=false</code> and the sort order for requests with <code class="literal">verbose=false</code> is undefined.</p>
</div>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">snapshot</code>
</span>
</dt>
<dd>
(string)
Name of the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">uuid</code>
</span>
</dt>
<dd>
(string)
Universally unique identifier (UUID) of the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">version_id</code>
</span>
</dt>
<dd>
(int)
Build ID of the Elasticsearch version used to create the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
(float)
Elasticsearch version used to create the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
(array)
List of indices included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">index_details</code>
</span>
</dt>
<dd>
<p>
(object)
Details of each index in the snapshot, keyed by index name. Only present if the
<code class="literal">?index_details</code> query parameter is set, and only contains details for indices
that were completely snapshotted in a sufficiently recent version of Elasticsearch.
</p>
<details open>
<summary class="title">Properties of <code class="literal">index_details</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">shard_count</code>
</span>
</dt>
<dd>
(integer)
Number of shards in this index.
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
(string)
Total size of all shards in this index. Only present if the <code class="literal">?human</code> query
paramter is set.
</dd>
<dt>
<span class="term">
<code class="literal">size_in_bytes</code>
</span>
</dt>
<dd>
(long)
Total size of all shards in this index, in bytes.
</dd>
<dt>
<span class="term">
<code class="literal">max_segments_per_shard</code>
</span>
</dt>
<dd>
(integer)
Maximum number of segments per shard in this index snapshot.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">data_streams</code>
</span>
</dt>
<dd>
(array of strings)
List of <a class="xref" href="data-streams.html" title="Data streams">data streams</a> included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">include_global_state</code>
</span>
</dt>
<dd>
(Boolean)
Indicates whether the current cluster state is included in the snapshot.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-api-feature-states"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feature_states</code>
</span>
</dt>
<dd>
<p>
(array of objects) <a class="xref" href="snapshot-restore.html#feature-state" title="Feature states">Feature states</a> in the snapshot.
Only present if the snapshot contains one or more feature states.
</p>
<details open>
<summary class="title">Properties of <code class="literal">features_states</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feature_name</code>
</span>
</dt>
<dd>
(string) Name of the feature, as returned by the <a class="xref" href="features-apis.html#get-features-api" title="Get Features API">get features
API</a>.
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
(array of strings) Indices in the feature state.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">start_time</code>
</span>
</dt>
<dd>
(string)
Date timestamp of when the snapshot creation process started.
</dd>
<dt>
<span class="term">
<code class="literal">start_time_in_millis</code>
</span>
</dt>
<dd>
(long)
The time, in milliseconds, when the snapshot creation process started.
</dd>
<dt>
<span class="term">
<code class="literal">end_time</code>
</span>
</dt>
<dd>
(string)
Date timestamp of when the snapshot creation process ended.
</dd>
<dt>
<span class="term">
<code class="literal">end_time_in_millis</code>
</span>
</dt>
<dd>
(long)
The time, in milliseconds, when the snapshot creation process ended.
</dd>
<dt>
<span class="term">
<code class="literal">duration_in_millis</code>
</span>
</dt>
<dd>
(long)
How long, in milliseconds, it took to create the snapshot.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-api-response-failures"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">failures</code>
</span>
</dt>
<dd>
(array)
Lists any failures that occurred when creating the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">shards</code>
</span>
</dt>
<dd>
<p>
(object)
Contains a count of shards in the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">shards</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
(integer)
Total number of shards included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">successful</code>
</span>
</dt>
<dd>
(integer)
Number of shards that were successfully included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">failed</code>
</span>
</dt>
<dd>
(integer)
Number of shards that failed to be included in the snapshot.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-api-response-state"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">state</code>
</span>
</dt>
<dd>
<p>(string)
The snapshot <code class="literal">state</code> can be one of the following values:</p>
<details open>
<summary class="title">Values for <code class="literal">state</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">IN_PROGRESS</code>
</span>
</dt>
<dd>
The snapshot is currently running.
</dd>
<dt>
<span class="term">
<code class="literal">SUCCESS</code>
</span>
</dt>
<dd>
The snapshot finished and all shards were stored successfully.
</dd>
<dt>
<span class="term">
<code class="literal">FAILED</code>
</span>
</dt>
<dd>
The snapshot finished with an error and failed to store any data.
</dd>
<dt>
<span class="term">
<code class="literal">PARTIAL</code>
</span>
</dt>
<dd>
The global cluster state was stored, but data of at least one shard was not stored successfully.
The <a class="xref" href="snapshot-restore-apis.html#get-snapshot-api-response-failures"><code class="literal">failures</code></a> section of the response contains more detailed information about shards
that were not processed correctly.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">next</code>
</span>
</dt>
<dd>
(string)
If the request contained a size limit and there might be more results, a <code class="literal">next</code> field will be added to the response and can be used as the
<code class="literal">after</code> query parameter to fetch additional results.
</dd>
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
(integer)
The total number of snapshots that match the request when ignoring size limit or <code class="literal">after</code> query parameter.
</dd>
<dt>
<span class="term">
<code class="literal">remaining</code>
</span>
</dt>
<dd>
(integer)
The number of remaining snapshots that were not returned due to size limits and that can be fetched by additional requests using the <code class="literal">next</code>
field value.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following request returns information for <code class="literal">snapshot_2</code> in the <code class="literal">my_repository</code> repository.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/snapshot_2</pre>
</div>
<div class="console_widget" data-snippet="snippets/2976.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots": [
    {
      "snapshot": "snapshot_2",
      "uuid": "vdRctLCxSketdKb54xw67g",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.129Z",
      "start_time_in_millis": 1593093628850,
      "end_time": "2020-07-06T21:55:18.129Z",
      "end_time_in_millis": 1593094752018,
      "duration_in_millis": 0,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    }
  ],
  "total": 1,
  "remaining": 0
}</pre>
</div>
<p>The following request returns information for all snapshots with prefix <code class="literal">snapshot</code> in the <code class="literal">my_repository</code> repository,
limiting the response size to 2 and sorting by snapshot name.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/snapshot*?size=2&amp;sort=name</pre>
</div>
<div class="console_widget" data-snippet="snippets/2977.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots": [
    {
      "snapshot": "snapshot_1",
      "uuid": "dKb54xw67gvdRctLCxSket",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.129Z",
      "start_time_in_millis": 1593093628850,
      "end_time": "2020-07-06T21:55:18.129Z",
      "end_time_in_millis": 1593094752018,
      "duration_in_millis": 0,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    },
    {
      "snapshot": "snapshot_2",
      "uuid": "vdRctLCxSketdKb54xw67g",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.130Z",
      "start_time_in_millis": 1593093628851,
      "end_time": "2020-07-06T21:55:18.130Z",
      "end_time_in_millis": 1593094752019,
      "duration_in_millis": 1,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    }
  ],
  "next": "c25hcHNob3RfMixteV9yZXBvc2l0b3J5LHNuYXBzaG90XzI=",
  "total": 3,
  "remaining": 1
}</pre>
</div>
<p>A subsequent request for the remaining snapshots can then be made using the <code class="literal">next</code> value from the previous response as <code class="literal">after</code> parameter.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/snapshot*?size=2&amp;sort=name&amp;after=c25hcHNob3RfMixteV9yZXBvc2l0b3J5LHNuYXBzaG90XzI=</pre>
</div>
<div class="console_widget" data-snippet="snippets/2978.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots": [
    {
      "snapshot": "snapshot_3",
      "uuid": "dRctdKb54xw67gvLCxSket",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.129Z",
      "start_time_in_millis": 1593093628850,
      "end_time": "2020-07-06T21:55:18.129Z",
      "end_time_in_millis": 1593094752018,
      "duration_in_millis": 0,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    }
  ],
  "total": 3,
  "remaining": 0
}</pre>
</div>
<p>Alternatively, the same result could be retrieved by using an offset value of <code class="literal">2</code> to skip the two snapshot already seen.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/snapshot*?size=2&amp;sort=name&amp;offset=2</pre>
</div>
<div class="console_widget" data-snippet="snippets/2979.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots": [
    {
      "snapshot": "snapshot_3",
      "uuid": "dRctdKb54xw67gvLCxSket",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.129Z",
      "start_time_in_millis": 1593093628850,
      "end_time": "2020-07-06T21:55:18.129Z",
      "end_time_in_millis": 1593094752018,
      "duration_in_millis": 0,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    }
  ],
  "total": 3,
  "remaining": 0
}</pre>
</div>
<p>The following request returns information for all snapshots with prefix <code class="literal">snapshot</code> in the <code class="literal">my_repository</code> repository,
except for the one named <code class="literal">snapshot_3</code></p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/snapshot*,-snapshot_3?sort=name</pre>
</div>
<div class="console_widget" data-snippet="snippets/2980.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots": [
    {
      "snapshot": "snapshot_1",
      "uuid": "dKb54xw67gvdRctLCxSket",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.129Z",
      "start_time_in_millis": 1593093628850,
      "end_time": "2020-07-06T21:55:18.129Z",
      "end_time_in_millis": 1593094752018,
      "duration_in_millis": 0,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    },
    {
      "snapshot": "snapshot_2",
      "uuid": "vdRctLCxSketdKb54xw67g",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.130Z",
      "start_time_in_millis": 1593093628851,
      "end_time": "2020-07-06T21:55:18.130Z",
      "end_time_in_millis": 1593094752019,
      "duration_in_millis": 1,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    }
  ],
  "total": 2,
  "remaining": 0
}</pre>
</div>
<p>The following request returns information for all snapshots that come after <code class="literal">snapshot_2</code> when sorted by snapshot name in the default
ascending order.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/*?sort=name&amp;from_sort_value=snapshot_2</pre>
</div>
<div class="console_widget" data-snippet="snippets/2981.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots": [
    {
      "snapshot": "snapshot_2",
      "uuid": "vdRctLCxSketdKb54xw67g",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.130Z",
      "start_time_in_millis": 1593093628851,
      "end_time": "2020-07-06T21:55:18.130Z",
      "end_time_in_millis": 1593094752019,
      "duration_in_millis": 1,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    },
    {
      "snapshot": "snapshot_3",
      "uuid": "dRctdKb54xw67gvLCxSket",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.129Z",
      "start_time_in_millis": 1593093628850,
      "end_time": "2020-07-06T21:55:18.129Z",
      "end_time_in_millis": 1593094752018,
      "duration_in_millis": 0,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    }
  ],
  "total": 2,
  "remaining": 0
}</pre>
</div>
<p>The following request returns information for all snapshots with names starting with <code class="literal">snapshot_</code> and that started on or after timestamp
<code class="literal">1577833200000</code> (Jan 1st 2020) when sorted by snapshot start time in the default ascending order.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_snapshot/my_repository/snapshot_*?sort=start_time&amp;from_sort_value=1577833200000</pre>
</div>
<div class="console_widget" data-snippet="snippets/2982.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots": [
    {
      "snapshot": "snapshot_1",
      "uuid": "dKb54xw67gvdRctLCxSket",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.128Z",
      "start_time_in_millis": 1593093628849,
      "end_time": "2020-07-06T21:55:18.129Z",
      "end_time_in_millis": 1593093628850,
      "duration_in_millis": 1,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    },
    {
      "snapshot": "snapshot_2",
      "uuid": "vdRctLCxSketdKb54xw67g",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.130Z",
      "start_time_in_millis": 1593093628851,
      "end_time": "2020-07-06T21:55:18.130Z",
      "end_time_in_millis": 1593093628851,
      "duration_in_millis": 0,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    },
    {
      "snapshot": "snapshot_3",
      "uuid": "dRctdKb54xw67gvLCxSket",
      "repository": "my_repository",
      "version_id": &lt;version_id&gt;,
      "version": &lt;version&gt;,
      "indices": [],
      "data_streams": [],
      "feature_states": [],
      "include_global_state": true,
      "state": "SUCCESS",
      "start_time": "2020-07-06T21:55:18.131Z",
      "start_time_in_millis": 1593093628852,
      "end_time": "2020-07-06T21:55:18.135Z",
      "end_time_in_millis": 1593093628856,
      "duration_in_millis": 4,
      "failures": [],
      "shards": {
        "total": 0,
        "failed": 0,
        "successful": 0
      }
    }
  ],
  "total": 3,
  "remaining": 0
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="get-snapshot-status-api"></a>Get snapshot status API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Retrieves a detailed description of the current state for each shard participating in the snapshot.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _snapshot/_status</pre>
</div>
<div class="console_widget" data-snippet="snippets/2983.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET _snapshot/_status</code></p>
<p><code class="literal">GET _snapshot/&lt;repository&gt;/_status</code></p>
<p><code class="literal">GET _snapshot/&lt;repository&gt;/&lt;snapshot&gt;/_status</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">monitor_snapshot</code>, <code class="literal">create_snapshot</code>, or <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<p>Use the get snapshot status API to get detailed information about the shards
participating in a snapshot.</p>
<p>If you omit the <code class="literal">&lt;snapshot&gt;</code> request path parameter, the request only retrieves
information for currently running snapshots. This usage is preferred.</p>
<p>If needed, you can specify <code class="literal">&lt;repository&gt;</code> and <code class="literal">&lt;snapshot&gt;</code> to retrieve
information for specific snapshots, even if they&#8217;re not currently running.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using the API to return the status of any snapshots other than currently running
snapshots can be expensive. The API requires a read from the repository for each
shard in each snapshot. For example, if you have 100 snapshots with 1,000 shards
each, an API request that includes all snapshots will require 100,000 reads (100
snapshots * 1,000 shards).</p>
<p>Depending on the latency of your storage, such requests can take an extremely
long time to return results. These requests can also tax machine resources
and, when using cloud storage, incur high processing costs.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Optional, string)
Snapshot repository name used to limit the request. Supports wildcards (<code class="literal">*</code>) if
<code class="literal">&lt;snapshot&gt;</code> isn&#8217;t specified.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
(Optional, string)
Comma-separated list of snapshots to retrieve status for. Defaults to
currently running snapshots. Wildcards (<code class="literal">*</code>) are not supported.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a connection to the master node. If no response is received
before the timeout expires, the request fails and returns an error. Defaults to
<code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the request returns an error for any snapshots that are unavailable. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, the request ignores snapshots that are unavailable, such as those that are corrupted or temporarily cannot be returned.</p>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">repository</code>
</span>
</dt>
<dd>
(string)
Name of the repository that includes the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">snapshot</code>
</span>
</dt>
<dd>
(string)
Name of the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">uuid</code>
</span>
</dt>
<dd>
(string)
Universally unique identifier (UUID) of the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">state</code>
</span>
</dt>
<dd>
<p>(string)
Indicates the current snapshot state.</p>
<details open>
<summary class="title">Values for <code class="literal">state</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">FAILED</code>
</span>
</dt>
<dd>
The snapshot finished with an error and failed to store any data.
</dd>
<dt>
<span class="term">
<code class="literal">STARTED</code>
</span>
</dt>
<dd>
The snapshot is currently running.
</dd>
<dt>
<span class="term">
<code class="literal">PARTIAL</code>
</span>
</dt>
<dd>
The global cluster state was stored, but data of at least one shard was not stored successfully.
The <a class="xref" href="snapshot-restore-apis.html#get-snapshot-api-response-failures"><code class="literal">failures</code></a> section of the response contains more detailed information about shards
that were not processed correctly.
</dd>
<dt>
<span class="term">
<code class="literal">SUCCESS</code>
</span>
</dt>
<dd>
The snapshot finished and all shards were stored successfully.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">include_global_state</code>
</span>
</dt>
<dd>
(Boolean)
Indicates whether the current cluster state is included in the snapshot.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-status-shards-stats"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">shards_stats</code>
</span>
</dt>
<dd>
<p>
(object)
Contains a count of shards in the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">shards_stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">initializing</code>
</span>
</dt>
<dd>
(integer)
Number of shards that are still initializing.
</dd>
<dt>
<span class="term">
<code class="literal">started</code>
</span>
</dt>
<dd>
(integer)
Number of shards that have started but are not finalized.
</dd>
<dt>
<span class="term">
<code class="literal">finalizing</code>
</span>
</dt>
<dd>
(integer)
Number of shards that are finalizing but are not done.
</dd>
<dt>
<span class="term">
<code class="literal">done</code>
</span>
</dt>
<dd>
(integer)
Number of shards that initialized, started, and finalized successfully.
</dd>
<dt>
<span class="term">
<code class="literal">failed</code>
</span>
</dt>
<dd>
(integer)
Number of shards that failed to be included in the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
(integer)
Total number of shards included in the snapshot.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-status-stats"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">stats</code>
</span>
</dt>
<dd>
<p>
(object)
Provides details on the number (<code class="literal">file_count</code>) and size (<code class="literal">size_in_bytes</code>) of files included in the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">stats</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">incremental</code>
</span>
</dt>
<dd>
<p>
(object)
Number and size of files that still need to be copied as part of the incremental snapshot.
</p>
<p>For completed snapshots, this property indicates the number and size
of files that were not already in the repository and were copied as
part of the incremental snapshot.</p>
</dd>
<dt>
<span class="term">
<code class="literal">processed</code>
</span>
</dt>
<dd>
(object)
Number and size of files that have already been uploaded to the snapshot. After a file is uploaded, the processed <code class="literal">file_count</code> and <code class="literal">size_in_bytes</code> are incremented in <code class="literal">stats</code>.
</dd>
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
(object)
Total number and size of files that are referenced by the snapshot.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-status-start-time"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">start_time_in_millis</code>
</span>
</dt>
<dd>
(long)
The time, in milliseconds, when the snapshot creation process started.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="get-snapshot-status-total-time"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">time_in_millis</code>
</span>
</dt>
<dd>
(long)
The total time, in milliseconds, that it took for the snapshot process
to complete.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;index&gt;</code>
</span>
</dt>
<dd>
<p>
(list of objects)
List of objects containing information about the
indices included in the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">&lt;index&gt;</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">shards_stats</code>
</span>
</dt>
<dd>
(object)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-shards-stats"><code class="literal">shards_stats</code></a>.
</dd>
<dt>
<span class="term">
<code class="literal">stats</code>
</span>
</dt>
<dd>
(object)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-stats"><code class="literal">stats</code></a>.
</dd>
<dt>
<span class="term">
<code class="literal">shards</code>
</span>
</dt>
<dd>
<p>
(list of objects)
List of objects containing information about the
shards that include the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">shards</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">stage</code>
</span>
</dt>
<dd>
<p>
(string)
Indicates the current state of the shards that include the snapshot.
</p>
<details open>
<summary class="title">Properties of <code class="literal">stage</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">DONE</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that were successfully stored in the repository.
</dd>
<dt>
<span class="term">
<code class="literal">FAILURE</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that were not successfully stored in
the repository.
</dd>
<dt>
<span class="term">
<code class="literal">FINALIZE</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that are in the finalizing stage
of being stored in the repository.
</dd>
<dt>
<span class="term">
<code class="literal">INIT</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that are in the initializing stage
of being stored in the repository.
</dd>
<dt>
<span class="term">
<code class="literal">STARTED</code>
</span>
</dt>
<dd>
Number of shards in the snapshot that are in the started stage
of being stored in the repository.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">stats</code>
</span>
</dt>
<dd>
(object)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-stats"><code class="literal">stats</code></a>.
</dd>
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
(object)
Total number and size of files that are referenced by the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">start_time_in_millis</code>
</span>
</dt>
<dd>
(long)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-start-time"><code class="literal">start_time_in_millis</code></a>.
</dd>
<dt>
<span class="term">
<code class="literal">time_in_millis</code>
</span>
</dt>
<dd>
(long)
See <a class="xref" href="snapshot-restore-apis.html#get-snapshot-status-total-time"><code class="literal">time_in_millis</code></a>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="get-snapshot-status-api-example"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/get-snapshot-status-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following request returns detailed status information for <code class="literal">snapshot_2</code> in the <code class="literal">my_repository</code> repository. This response includes additional information beyond the <a class="xref" href="snapshot-restore-apis.html#get-snapshot-api" title="Get snapshot API">Get snapshot API</a>, such as shard status and file statistics.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _snapshot/my_repository/snapshot_2/_status</pre>
</div>
<div class="console_widget" data-snippet="snippets/2984.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "snapshots" : [
    {
      "snapshot" : "snapshot_2",
      "repository" : "my_repository",
      "uuid" : "lNeQD1SvTQCqqJUMQSwmGg",
      "state" : "SUCCESS",
      "include_global_state" : false,
      "shards_stats" : {
        "initializing" : 0,
        "started" : 0,
        "finalizing" : 0,
        "done" : 1,
        "failed" : 0,
        "total" : 1
      },
      "stats" : {
        "incremental" : {
          "file_count" : 3,
          "size_in_bytes" : 5969
        },
        "total" : {
          "file_count" : 4,
          "size_in_bytes" : 6024
        },
        "start_time_in_millis" : 1594829326691,
        "time_in_millis" : 205
      },
      "indices" : {
        "index_1" : {
          "shards_stats" : {
            "initializing" : 0,
            "started" : 0,
            "finalizing" : 0,
            "done" : 1,
            "failed" : 0,
            "total" : 1
          },
          "stats" : {
            "incremental" : {
              "file_count" : 3,
              "size_in_bytes" : 5969
            },
            "total" : {
              "file_count" : 4,
              "size_in_bytes" : 6024
            },
            "start_time_in_millis" : 1594829326896,
            "time_in_millis" : 0
          },
          "shards" : {
            "0" : {
              "stage" : "DONE",
              "stats" : {
                "incremental" : {
                  "file_count" : 3,
                  "size_in_bytes" : 5969
                },
                "total" : {
                  "file_count" : 4,
                  "size_in_bytes" : 6024
                },
                "start_time_in_millis" : 1594829326896,
                "time_in_millis" : 0
              }
            }
          }
        }
      }
    }
  ]
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="restore-snapshot-api"></a>Restore snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Restores a <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshot</a> of a cluster or specified data streams and indices.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/my_snapshot/_restore</pre>
</div>
<div class="console_widget" data-snippet="snippets/2985.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;/_restore</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you use Elasticsearch security features, you must have the <code class="literal">manage</code> or
<code class="literal">cluster:admin/snapshot/*</code> cluster privilege to use this API.
</li>
</ul>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You can only restore a snapshot to a running cluster with an elected
<a class="xref" href="settings.html#master-node" title="Master-eligible node">master node</a>. The snapshot&#8217;s repository must be
<a class="xref" href="snapshots-register-repository.html" title="Register a snapshot repository">registered</a> and available to the cluster.
</li>
<li class="listitem">
The snapshot and cluster versions must be compatible. See
<a class="xref" href="snapshot-restore.html#snapshot-restore-version-compatibility" title="Snapshot compatibility">Snapshot compatibility</a>.
</li>
<li class="listitem">
To restore a snapshot, the cluster&#8217;s global metadata must be writable. Ensure
there aren&#8217;t any <a class="xref" href="settings.html#cluster-read-only" title="Metadata">cluster blocks</a> that prevent writes. The
restore operation ignores <a class="xref" href="index-modules-blocks.html" title="Index blocks">index blocks</a>.
</li>
<li class="listitem">
<p>Before you restore a data stream, ensure the cluster contains a
<a class="xref" href="set-up-a-data-stream.html#create-index-template" title="Create an index template">matching index template</a> with data stream enabled. To
check, use Kibana&#8217;s <a class="xref" href="index-mgmt.html#manage-index-templates" title="Manage index templates"><span class="strong strong"><strong>Index Management</strong></span></a> feature or
the <a class="xref" href="indices.html#indices-get-template" title="Get index template API">get index template API</a>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _index_template/*?filter_path=index_templates.name,index_templates.index_template.index_patterns,index_templates.index_template.data_stream</pre>
</div>
<div class="console_widget" data-snippet="snippets/2986.console"></div>
<p>If no such template exists, you can <a class="xref" href="set-up-a-data-stream.html#create-index-template" title="Create an index template">create one</a> or
<a class="xref" href="snapshots-restore-snapshot.html#restore-entire-cluster" title="Restore an entire cluster">restore a cluster state</a> that
contains one. Without a matching index template, a data stream can&#8217;t roll over
or create backing indices.</p>
</li>
<li class="listitem">
If your snapshot contains data from App Search or Workplace Search, ensure
you&#8217;ve restored the <a href="https://www.elastic.co/guide/en/enterprise-search/8.9/encryption-keys.html" class="ulink" target="_top">Enterprise
Search encryption key</a> before restoring the snapshot.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the repository to restore a snapshot from.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the snapshot to restore.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a connection to the master node. If no response is received
before the timeout expires, the request fails and returns an error. Defaults to
<code class="literal">30s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">wait_for_completion</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean) If <code class="literal">true</code>, the request returns a response when the restore
operation completes. The operation is complete when it finishes all attempts to
<a class="xref" href="snapshots-restore-snapshot.html#monitor-restore" title="Monitor a restore">recover primary shards</a> for restored indices.
This applies even if one or more of the recovery attempts fail.
</p>
<p>If <code class="literal">false</code>, the request returns a response when the restore
operation initializes. Defaults to <code class="literal">false</code>.</p>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
(Optional, Boolean) If <code class="literal">true</code>, the request ignores any index or data stream in
<code class="literal">indices</code> that&#8217;s missing from the snapshot. If <code class="literal">false</code>, the request returns an
error for any missing index or data stream. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">ignore_index_settings</code>
</span>
</dt>
<dd>
<p>
(Optional, string or array of strings) Index settings to not restore from the snapshot. You can&#8217;t use this option to ignore <a class="xref" href="index-modules.html#index-number-of-shards"><code class="literal">index.number_of_shards</code></a>.
</p>
<p>For data streams, this option only applies to restored backing indices. New
backing indices are configured using the data stream&#8217;s matching index template.</p>
</dd>
<dt>
<span class="term">
<code class="literal">include_aliases</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, the request restores aliases for any restored data streams and
indices. If <code class="literal">false</code>, the request doesn&#8217;t restore aliases. Defaults to <code class="literal">true</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-include-global-state"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">include_global_state</code>
</span>
</dt>
<dd>
<p>(Optional, Boolean)
If <code class="literal">true</code>, restore the cluster state. Defaults to <code class="literal">false</code>.</p>
<p>The cluster state includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="settings.html#cluster-setting-types" title="Cluster and node setting types">Persistent cluster settings</a>
</li>
<li class="listitem">
<a class="xref" href="index-templates.html" title="Index templates">Index templates</a>
</li>
<li class="listitem">
<a class="xref" href="indices.html#indices-templates-v1" title="Create or update index template API">Legacy index templates</a>
</li>
<li class="listitem">
<a class="xref" href="ingest.html" title="Ingest pipelines">Ingest pipelines</a>
</li>
<li class="listitem">
<a class="xref" href="index-lifecycle-management.html" title="ILM: Manage the index lifecycle">ILM policies</a>
</li>
<li class="listitem">
For snapshots taken after 7.12.0, <a class="xref" href="snapshot-restore.html#feature-state" title="Feature states">feature states</a>
</li>
</ul>
</div>
<p>If <code class="literal">include_global_state</code> is <code class="literal">true</code> then the restore operation merges the
legacy index templates in your cluster with the templates contained in the
snapshot, replacing any existing ones whose name matches one in the snapshot.
It completely removes all persistent settings, non-legacy index templates,
ingest pipelines and ILM lifecycle policies that exist in your cluster
and replaces them with the corresponding items from the snapshot.</p>
<p>Use the <code class="literal">feature_states</code> parameter to configure how feature states are restored.</p>
<p>If <code class="literal">include_global_state</code> is <code class="literal">true</code> and a snapshot was created without a global
state then the restore request will fail.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-feature-states"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feature_states</code>
</span>
</dt>
<dd>
<p>
(Optional, array of strings)
<a class="xref" href="snapshot-restore.html#feature-state" title="Feature states">Feature states</a> to restore.
</p>
<p>If <code class="literal">include_global_state</code> is <code class="literal">true</code>, the request restores all feature states
in the snapshot by default. If <code class="literal">include_global_state</code> is <code class="literal">false</code>, the request
restores no feature states by default. Note that specifying an empty array
will result in the default behavior. To restore no feature states, regardless
of the <code class="literal">include_global_state</code> value, specify an array containing only the value
<code class="literal">none</code> (<code class="literal">["none"]</code>).</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-index-settings"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index_settings</code>
</span>
</dt>
<dd>
<p>
(Optional, object) Index settings to add or change in restored indices,
including backing indices. You can&#8217;t use this option to change
<a class="xref" href="index-modules.html#index-number-of-shards"><code class="literal">index.number_of_shards</code></a>.
</p>
<p>For data streams, this option only applies to restored backing indices. New
backing indices are configured using the data stream&#8217;s matching index template.</p>
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
<p>
(Optional, string or array of strings) Comma-separated list of indices and data
streams to restore. Supports <a class="xref" href="api-conventions.html#api-multi-index" title="Multi-target syntax">multi-target syntax</a>. Defaults
to all regular indices and regular data streams in the snapshot.
</p>
<p>You can&#8217;t use this parameter to restore <a class="xref" href="api-conventions.html#system-indices" title="System indices">system indices or
system data streams</a>. Use
<a class="xref" href="snapshot-restore-apis.html#restore-snapshot-api-feature-states"><code class="literal">feature_states</code></a> instead.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-partial"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">partial</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the entire restore operation will fail if one or more indices included in the snapshot do not have all primary shards available. Defaults to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, allows restoring a partial snapshot of indices with unavailable shards. Only shards that were successfully included in the snapshot
will be restored. All missing shards will be recreated as empty.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-rename-pattern"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">rename_pattern</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Defines a rename pattern to apply to restored data streams and indices. Data streams and indices matching the rename pattern will be renamed according to
<a class="xref" href="snapshot-restore-apis.html#restore-snapshot-api-rename-replacement"><code class="literal">rename_replacement</code></a>.
</p>
<p>The rename pattern is applied as defined by the regular expression that
supports referencing the original text, according to the <a href="https://docs.oracle.com/javase/8/docs/api/java/util/regex/Matcher.html#appendReplacement-java.lang.StringBuffer-java.lang.String-" class="ulink" target="_top"><code class="literal">appendReplacement</code></a> logic.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="restore-snapshot-api-rename-replacement"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">rename_replacement</code>
</span>
</dt>
<dd>
(Optional, string)
Defines the rename replacement string. See <a class="xref" href="snapshot-restore-apis.html#restore-snapshot-api-rename-pattern"><code class="literal">rename_pattern</code></a> for more information.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="restore-snapshot-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="restore-snapshot-api-example-rename"></a>Restore renamed<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The following request restores <code class="literal">index_1</code> and <code class="literal">index_2</code> from <code class="literal">snapshot_2</code>. The <code class="literal">rename_pattern</code> and <code class="literal">rename_replacement</code> parameters indicate any index matching the regular expression <code class="literal">index_(.+)</code> will be renamed using the pattern <code class="literal">restored_index_$1</code> when restored.</p>
<p>For example, <code class="literal">index_1</code> will be renamed to <code class="literal">restored_index_1</code>. <code class="literal">index_2</code> will be renamed to <code class="literal">restored_index_2</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_snapshot/my_repository/snapshot_2/_restore?wait_for_completion=true
{
  "indices": "index_1,index_2",
  "ignore_unavailable": true,
  "include_global_state": false,
  "rename_pattern": "index_(.+)",
  "rename_replacement": "restored_index_$1",
  "include_aliases": false
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2987.console"></div>
<p>The API returns an acknowledgement if the request succeeds. If the request encounters errors, the response indicates any issues found, such as
open indices that are blocking the restore operation from completing.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="restore-snapshot-api-example-inplace"></a>Restore in-place<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/restore-snapshot-api.asciidoc">edit</a></h4>
</div></div></div>
<p>You may want to restore an index in-place, for example when no alternative
options surface after the <a class="xref" href="cluster.html#cluster-allocation-explain" title="Cluster allocation explain API">Cluster allocation explain</a> API reports
<code class="literal">no_valid_shard_copy</code>.</p>
<p>The following request <a class="xref" href="indices.html#indices-close" title="Close index API">closes</a> <code class="literal">index_1</code> and then restores it
in-place from the <code class="literal">snapshot_2</code> snapshot in the <code class="literal">my_repository</code> repository.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST index_1/_close

POST /_snapshot/my_repository/snapshot_2/_restore?wait_for_completion=true
{
  "indices": "index_1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2988.console"></div>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="delete-snapshot-api"></a>Delete snapshot API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Deletes a <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshot</a>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_snapshot/my_repository/my_snapshot</pre>
</div>
<div class="console_widget" data-snippet="snippets/2989.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_snapshot/&lt;repository&gt;/&lt;snapshot&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;repository&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the repository to delete a snapshot from.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;snapshot&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Comma-separated list of snapshot names to delete. Also accepts wildcards (<code class="literal">*</code>).
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a connection to the master node. If no response is received
before the timeout expires, the request fails and returns an error. Defaults to
<code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="delete-snapshot-api-example"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.9/docs/reference/snapshot-restore/apis/delete-snapshot-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following request deletes <code class="literal">snapshot_2</code> and <code class="literal">snapshot_3</code> from the repository named <code class="literal">my_repository</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_snapshot/my_repository/snapshot_2,snapshot_3</pre>
</div>
<div class="console_widget" data-snippet="snippets/2990.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "acknowledged" : true
}</pre>
</div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="security-api.html">« Security APIs</a>
</span>
<span class="next">
<a href="snapshot-lifecycle-management-api.html">Snapshot lifecycle management APIs »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
