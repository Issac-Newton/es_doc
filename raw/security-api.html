<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Security APIs | Elasticsearch Guide | Elastic</title>
<meta class="elastic" name="content" content="Security APIs | Elasticsearch Guide">

<link rel="home" href="index.html" title="Elasticsearch Guide"/>
<link rel="up" href="rest-apis.html" title="REST APIs"/>
<link rel="prev" href="searchable-snapshots-apis.html" title="Searchable snapshots APIs"/>
<link rel="next" href="snapshot-restore-apis.html" title="Snapshot and restore APIs"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="searchable-snapshots-apis.html">« Searchable snapshots APIs</a>
</span>
<span class="next">
<a href="snapshot-restore-apis.html">Snapshot and restore APIs »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api"></a>Security APIs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>You can use the following APIs to perform security activities.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="security-api.html#security-api-authenticate" title="Authenticate API">Authenticate</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-clear-cache" title="Clear cache API">Clear cache</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-delegate-pki-authentication" title="Delegate PKI authentication API">Delegate PKI authentication</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-has-privileges" title="Has privileges API">Has privileges</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-ssl" title="SSL certificate API">SSL certificate</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-get-builtin-privileges" title="Get builtin privileges API">Get builtin privileges</a>
</li>
</ul>
</div>
<h3><a id="security-api-app-privileges"></a>Application privileges<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security.asciidoc">edit</a></h3>
<p>You can use the following APIs to add, update, retrieve, and remove application
privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="security-api.html#security-api-put-privileges" title="Create or update application privileges API">Create or update privileges</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-clear-privilege-cache" title="Clear privileges cache API">Clear privileges cache</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-delete-privilege" title="Delete application privileges API">Delete privileges</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-get-privileges" title="Get application privileges API">Get privileges</a>
</li>
</ul>
</div>
<h3><a id="security-role-mapping-apis"></a>Role mappings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security.asciidoc">edit</a></h3>
<p>You can use the following APIs to add, remove, update, and retrieve role mappings:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="security-api.html#security-api-put-role-mapping" title="Create or update role mappings API">Create or update role mappings</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-delete-role-mapping" title="Delete role mappings API">Delete role mappings</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-get-role-mapping" title="Get role mappings API">Get role mappings</a>
</li>
</ul>
</div>
<h3><a id="security-role-apis"></a>Roles<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security.asciidoc">edit</a></h3>
<p>You can use the following APIs to add, remove, update, and retrieve roles in the native realm:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="security-api.html#security-api-put-role" title="Create or update roles API">Create or update roles</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-clear-role-cache" title="Clear roles cache API">Clear roles cache</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-delete-role" title="Delete roles API">Delete roles</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-get-role" title="Get roles API">Get roles</a>
</li>
</ul>
</div>
<h3><a id="security-token-apis"></a>Tokens<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security.asciidoc">edit</a></h3>
<p>You can use the following APIs to create and invalidate bearer tokens for access
without requiring basic authentication:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="security-api.html#security-api-get-token" title="Get token API">Get token</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-invalidate-token" title="Invalidate token API">Invalidate token</a>
</li>
</ul>
</div>
<h3><a id="security-api-keys"></a>API Keys<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security.asciidoc">edit</a></h3>
<p>You can use the following APIs to create, retrieve and invalidate API keys for access
without requiring basic authentication:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="security-api.html#security-api-create-api-key" title="Create API key API">Create API key</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-get-api-key" title="Get API key information API">Get API key</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-invalidate-api-key" title="Invalidate API key API">Invalidate API key</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-clear-api-key-cache" title="Clear API key cache API">Clear API key cache</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-grant-api-key" title="Grant API key API">Grant API key</a>
</li>
</ul>
</div>
<h3><a id="security-user-apis"></a>Users<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security.asciidoc">edit</a></h3>
<p>You can use the following APIs to add, remove, update, or retrieve users in the
native realm:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="security-api.html#security-api-put-user" title="Create or update users API">Create or update users</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-change-password" title="Change passwords API">Change passwords</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-delete-user" title="Delete users API">Delete users</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-disable-user" title="Disable users API">Disable users</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-enable-user" title="Enable users API">Enable users</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-get-user" title="Get users API">Get users</a>
</li>
</ul>
</div>
<h3><a id="security-openid-apis"></a>OpenID Connect<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security.asciidoc">edit</a></h3>
<p>You can use the following APIs to authenticate users against an OpenID Connect
authentication realm when using a custom web application other than Kibana</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="security-api.html#security-api-oidc-prepare-authentication" title="OpenID Connect prepare authentication API">Prepare an authentication request</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-oidc-authenticate" title="OpenID Connect authenticate API">Submit an authentication response</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-oidc-logout" title="OpenID Connect logout API">Logout an authenticated user</a>
</li>
</ul>
</div>
<h3><a id="security-saml-apis"></a>SAML<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security.asciidoc">edit</a></h3>
<p>You can use the following APIs to authenticate users against a SAML authentication
realm when using a custom web application other than Kibana</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="security-api.html#security-api-saml-prepare-authentication" title="SAML prepare authentication API">Prepare an authentication request</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-saml-authenticate" title="SAML authenticate API">Submit an authentication response</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-saml-logout" title="SAML logout API">Logout an authenticated user</a>
</li>
<li class="listitem">
<a class="xref" href="security-api.html#security-api-saml-invalidate" title="SAML invalidate API">Submit a logout request from the IdP</a>
</li>
</ul>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-authenticate"></a>Authenticate API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/authenticate.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Enables you to submit a request with a basic auth header to
authenticate a user and retrieve information about the authenticated user.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-authenticate-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/authenticate.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_security/_authenticate</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-authenticate-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/authenticate.asciidoc">edit</a></h3>
</div></div></div>
<p>A successful call returns a JSON structure that shows user information such as their username, the roles that are
assigned to the user, any assigned metadata, and information about the realms that authenticated and authorized the user.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-authenticate-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/authenticate.asciidoc">edit</a></h3>
</div></div></div>
<p>If the user cannot be authenticated, this API returns a 401 status code.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-authenticate-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/authenticate.asciidoc">edit</a></h3>
</div></div></div>
<p>To authenticate a user, submit a GET request to the
<code class="literal">/_security/_authenticate</code> endpoint:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/_authenticate</pre>
</div>
<div class="console_widget" data-snippet="snippets/2233.console"></div>
<p>The following example output provides information about the "rdeniro" user:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "username": "rdeniro",
  "roles": [
    "admin"
  ],
  "full_name": null,
  "email":  null,
  "metadata": { },
  "enabled": true,
  "authentication_realm": {
    "name" : "file",
    "type" : "file"
  },
  "lookup_realm": {
    "name" : "file",
    "type" : "file"
  },
  "authentication_type": "realm"
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-change-password"></a>Change passwords API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/change-password.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Changes the passwords of users in the native realm and built-in users.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-change-password-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/change-password.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/user/_password</code><br></p>
<p><code class="literal">POST /_security/user/&lt;username&gt;/_password</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-change-password-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/change-password.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Every user can change their own password. Users with the <code class="literal">manage_security</code>
privilege can change passwords of other users.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-change-password-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/change-password.asciidoc">edit</a></h3>
</div></div></div>
<p>You can use the <a class="xref" href="security-api.html#security-api-put-user" title="Create or update users API">create user API</a> to update everything
but a user&#8217;s <code class="literal">username</code> and <code class="literal">password</code>. This API changes a user&#8217;s password.</p>
<p>For more information about the native realm, see
<a class="xref" href="setting-up-authentication.html#realms" title="Realms">Realms</a> and <a class="xref" href="setting-up-authentication.html#native-realm" title="Native user authentication">Native user authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-change-password-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/change-password.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Optional, string) The user whose password you want to change. If you do not specify
this parameter, the password is changed for the current user.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-change-password-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/change-password.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">password</code>
</span>
</dt>
<dd>
(Required, string) The new password value.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-change-password-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/change-password.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example updates the password for the <code class="literal">jacknich</code> user:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/user/jacknich/_password
{
  "password" : "s3cr3t"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2234.console"></div>
<p>A successful call returns an empty JSON structure.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-clear-cache"></a>Clear cache API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-cache.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Evicts users from the user cache. You can completely clear
the cache or evict specific users.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-cache.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/realm/&lt;realms&gt;/_clear_cache</code><br></p>
<p><code class="literal">POST /_security/realm/&lt;realms&gt;/_clear_cache?usernames=&lt;usernames&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-cache.asciidoc">edit</a></h3>
</div></div></div>
<p>User credentials are cached in memory on each node to avoid connecting to a
remote authentication service or hitting the disk for every incoming request.
There are realm settings that you can use to configure the user cache. For more
information, see
<a class="xref" href="setting-up-authentication.html#controlling-user-cache" title="Controlling the user cache">Controlling the user cache</a>.</p>
<p>To evict roles from the role cache, see the
<a class="xref" href="security-api.html#security-api-clear-role-cache" title="Clear roles cache API">Clear roles cache API</a>.
To evict privileges from the privilege cache, see the
<a class="xref" href="security-api.html#security-api-clear-privilege-cache" title="Clear privileges cache API">Clear privileges cache API</a>.
To evict API keys from the API key cache, see the
<a class="xref" href="security-api.html#security-api-clear-api-key-cache" title="Clear API key cache API">Clear API key cache API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-cache.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">realms</code>
</span>
</dt>
<dd>
(Required, list) A comma-separated list of the realms to clear.
</dd>
<dt>
<span class="term">
<code class="literal">usernames</code>
</span>
</dt>
<dd>
(Optional, list) A comma-separated list of the users to clear from the cache.
If you do not specify this parameter, the API evicts all users from the user
cache.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-cache.asciidoc">edit</a></h3>
</div></div></div>
<p>For example, to evict all users cached by the <code class="literal">file</code> realm:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/realm/default_file/_clear_cache</pre>
</div>
<div class="console_widget" data-snippet="snippets/2235.console"></div>
<p>To evict selected users, specify the <code class="literal">usernames</code> parameter:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/realm/default_file/_clear_cache?usernames=rdeniro,alpacino</pre>
</div>
<div class="console_widget" data-snippet="snippets/2236.console"></div>
<p>To clear the caches for multiple realms, specify the realms as a comma-delimited
list:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/realm/default_file,ldap1/_clear_cache</pre>
</div>
<div class="console_widget" data-snippet="snippets/2237.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-clear-role-cache"></a>Clear roles cache API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-roles-cache.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Evicts roles from the native role cache.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-role-cache-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-roles-cache.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/role/&lt;name&gt;/_clear_cache</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-role-cache-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-roles-cache.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster
privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-role-cache-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-roles-cache.asciidoc">edit</a></h3>
</div></div></div>
<p>For more information about the native realm, see
<a class="xref" href="setting-up-authentication.html#realms" title="Realms">Realms</a> and <a class="xref" href="setting-up-authentication.html#native-realm" title="Native user authentication">Native user authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-role-cache-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-roles-cache.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string) The name of the role.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-role-cache-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-roles-cache.asciidoc">edit</a></h3>
</div></div></div>
<p>The clear roles cache API evicts roles from the native role cache. For example,
to clear the cache for <code class="literal">my_admin_role</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role/my_admin_role/_clear_cache</pre>
</div>
<div class="console_widget" data-snippet="snippets/2238.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-clear-privilege-cache"></a>Clear privileges cache API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-privileges-cache.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Evicts privileges from the native application privilege cache.
The cache is also automatically cleared for applications that have their privileges updated.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-privilege-cache-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-privileges-cache.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/privilege/&lt;application&gt;/_clear_cache</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-privilege-cache-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-privileges-cache.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster
privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-privilege-cache-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-privileges-cache.asciidoc">edit</a></h3>
</div></div></div>
<p>For more information about the native realm, see
<a class="xref" href="setting-up-authentication.html#realms" title="Realms">Realms</a> and <a class="xref" href="setting-up-authentication.html#native-realm" title="Native user authentication">Native user authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-privilege-cache-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-privileges-cache.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">application</code>
</span>
</dt>
<dd>
(string) The name of the application. If omitted, all entries are evicted from the cache.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-privilege-cache-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-privileges-cache.asciidoc">edit</a></h3>
</div></div></div>
<p>The clear privileges cache API evicts privileges from the native application privilege cache.
For example, to clear the cache for <code class="literal">myapp</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/privilege/myapp/_clear_cache</pre>
</div>
<div class="console_widget" data-snippet="snippets/2239.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-clear-api-key-cache"></a>Clear API key cache API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-api-key-cache.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Evicts a subset of all entries from the API key cache.
The cache is also automatically cleared on state changes of the security index.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-api-key-cache-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-api-key-cache.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/api_key/&lt;ids&gt;/_clear_cache</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-api-key-cache-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-api-key-cache.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster
privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-api-key-cache-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-api-key-cache.asciidoc">edit</a></h3>
</div></div></div>
<p>For more information about API keys, see <a class="xref" href="security-api.html#security-api-create-api-key" title="Create API key API">Create API keys</a>,
<a class="xref" href="security-api.html#security-api-get-api-key" title="Get API key information API">Get API key information</a>, and <a class="xref" href="security-api.html#security-api-invalidate-api-key" title="Invalidate API key API">Invalidate API key</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-api-key-cache-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-api-key-cache.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ids</code>
</span>
</dt>
<dd>
(string) comma separated list of API key IDs. If empty, all keys are evicted from the cache.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-clear-api-key-cache-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/clear-api-key-cache.asciidoc">edit</a></h3>
</div></div></div>
<p>The clear API key cache API evicts entries from the API key cache.
For example, to clear the entry of API key with ID <code class="literal">yVGMr3QByxdh1MSaicYx</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/api_key/yVGMr3QByxdh1MSaicYx/_clear_cache</pre>
</div>
<div class="console_widget" data-snippet="snippets/2240.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-create-api-key"></a>Create API key API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-api-keys.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Creates an API key for access without requiring basic authentication.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-create-api-key-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/api_key</code></p>
<p><code class="literal">PUT /_security/api_key</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-create-api-key-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_api_key</code> cluster privilege.
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the credential that is used to authenticate this request is
an API key, the derived API key cannot have any privileges. If you specify privileges, the API returns an error.
See the note under <code class="literal">role_descriptors</code>.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-create-api-key-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>The API keys are created by the Elasticsearch API key service, which is automatically enabled
when you configure TLS on the HTTP interface. See <a class="xref" href="encrypting-communications.html#tls-http" title="Encrypting HTTP client communications">Encrypting HTTP client communications</a>. Alternatively,
you can explicitly enable the <code class="literal">xpack.security.authc.api_key.enabled</code> setting. When
you are running in production mode, a bootstrap check prevents you from enabling
the API key service unless you also enable TLS on the HTTP interface.</p>
<p>A successful create API key API call returns a JSON structure that contains the
API key, its unique id, and its name. If applicable, it also returns expiration
information for the API key in milliseconds.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, API keys never expire. You can specify expiration information
when you create the API keys.</p>
</div>
</div>
<p>See <a class="xref" href="settings.html#api-key-service-settings" title="API key service settings">API key service settings</a> for configuration settings related to API key
service.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-create-api-key-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the body of a POST or PUT request:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(Required, string) Specifies the name for this API key.
</dd>
<dt>
<span class="term">
<code class="literal">role_descriptors</code>
</span>
</dt>
<dd>
<p>
(Optional, array-of-role-descriptor) An array of role descriptors for this API
key. This parameter is optional. When it is not specified or is an empty array,
then the API key will have a <em>point in time snapshot of permissions of the
authenticated user</em>. If you supply role descriptors then the resultant permissions
would be an intersection of API keys permissions and authenticated user&#8217;s permissions
thereby limiting the access scope for API keys.
The structure of role descriptor is the same as the request for create role API.
For more details, see <a class="xref" href="security-api.html#security-api-put-role" title="Create or update roles API">create or update roles API</a>.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Due to the way in which this permission intersection is calculated, it is not
possible to create an API key that is a child of another API key, unless the derived
key is created without any privileges. In this case, you must explicitly specify a
role descriptor with no privileges. The derived API key can be used for
authentication; it will not have authority to call Elasticsearch APIs.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">expiration</code>
</span>
</dt>
<dd>
(Optional, string) Expiration time for the API key. By default, API keys never
expire.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-create-api-key-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example creates an API key:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/api_key
{
  "name": "my-api-key",
  "expiration": "1d", <a id="CO691-1"></a><i class="conum" data-value="1"></i>
  "role_descriptors": { <a id="CO691-2"></a><i class="conum" data-value="2"></i>
    "role-a": {
      "cluster": ["all"],
      "index": [
        {
          "names": ["index-a*"],
          "privileges": ["read"]
        }
      ]
    },
    "role-b": {
      "cluster": ["all"],
      "index": [
        {
          "names": ["index-b*"],
          "privileges": ["all"]
        }
      ]
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2241.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO691-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>optional expiration for the API key being generated. If expiration is not
provided then the API keys do not expire.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO691-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>optional role descriptors for this API key, if not provided then permissions
of authenticated user are applied.</p>
</td>
</tr>
</table>
</div>
<p>A successful call returns a JSON structure that provides
API key information.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "id":"VuaCfGcBCdbkQm-e5aOx", <a id="CO692-1"></a><i class="conum" data-value="1"></i>
  "name":"my-api-key",
  "expiration":1544068612110, <a id="CO692-2"></a><i class="conum" data-value="2"></i>
  "api_key":"ui2lp2axTNmsyakw9tvNnw" <a id="CO692-3"></a><i class="conum" data-value="3"></i>
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO692-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>unique id for this API key</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO692-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>optional expiration in milliseconds for this API key</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO692-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>generated API key</p>
</td>
</tr>
</table>
</div>
<p>The API key returned by this API can then be used by sending a request with a
<code class="literal">Authorization</code> header with a value having the prefix <code class="literal">ApiKey</code> followed
by the <em>credentials</em>, where <em>credentials</em> is the base64 encoding of <code class="literal">id</code> and <code class="literal">api_key</code> joined by a colon.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If your node has <code class="literal">xpack.security.http.ssl.enabled</code> set to <code class="literal">true</code>, then you must specify <code class="literal">https</code> when creating your API key.</p>
</div>
</div>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">curl -H "Authorization: ApiKey VnVhQ2ZHY0JDZGJrUW0tZTVhT3g6dWkybHAyYXhUTm1zeWFrdzl0dk5udw==" http://localhost:9200/_cluster/health</pre>
</div>
<p>One way to create the credentials from CLI on an Unix-like system is as the follows:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell"># Please note the use of "-n" to instruct echo to not print the trailing newline character.
# It should return VnVhQ2ZHY0JDZGJrUW0tZTVhT3g6dWkybHAyYXhUTm1zeWFrdzl0dk5udw==
echo -n "VuaCfGcBCdbkQm-e5aOx:ui2lp2axTNmsyakw9tvNnw" | base64</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-put-privileges"></a>Create or update application privileges API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/put-app-privileges.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Adds or updates <a class="xref" href="authorization.html#application-privileges" title="Application privileges">application privileges</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-privileges-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/put-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/privilege</code><br></p>
<p><code class="literal">PUT /_security/privilege</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-privileges-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/put-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>To use this API, you must have either:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
the <code class="literal">manage_security</code> cluster privilege (or a greater privilege such as <code class="literal">all</code>); <em>or</em>
</li>
<li class="listitem">
the <em>"Manage Application Privileges"</em> global privilege for the application
being referenced in the request
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-privileges-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/put-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>This API creates or updates privileges. To remove privileges, use the
<a class="xref" href="security-api.html#security-api-delete-privilege" title="Delete application privileges API">delete application privilege API</a>.</p>
<p>For more information, see <a class="xref" href="authorization.html#roles-application-priv" title="Application Privileges">Application Privileges</a>.</p>
<p>To check a user&#8217;s application privileges, use the
<a class="xref" href="security-api.html#security-api-has-privileges" title="Has privileges API">has privileges API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-privileges-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/put-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>The body is a JSON object where the names of the fields are the application
names and the value of each field is an object. The fields in this inner
object are the names of the privileges and each value is a JSON object that
includes the following fields:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">actions</code>
</span>
</dt>
<dd>
(array-of-string) A list of action names that are granted by this
privilege. This field must exist and cannot be an empty array.
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(object) Optional meta-data. Within the <code class="literal">metadata</code> object, keys
that begin with <code class="literal">_</code> are reserved for system usage.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-app-privileges-validation"></a>Validation<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/put-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Application names
</span>
</dt>
<dd>
<p>
Application names are formed from a <em>prefix</em>, with an optional <em>suffix</em> that
conform to the following rules:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The prefix must begin with a lowercase ASCII letter
</li>
<li class="listitem">
The prefix must contain only ASCII letters or digits
</li>
<li class="listitem">
The prefix must be at least 3 characters long
</li>
<li class="listitem">
If the suffix exists, it must begin with either <code class="literal">-</code> or <code class="literal">_</code>
</li>
<li class="listitem">
The suffix cannot contain any of the following characters:
<code class="literal">\</code>, <code class="literal">/</code>, <code class="literal">*</code>, <code class="literal">?</code>, <code class="literal">"</code>, <code class="literal">&lt;</code>, <code class="literal">&gt;</code>, <code class="literal">|</code>, <code class="literal">,</code>, <code class="literal">*</code>
</li>
<li class="listitem">
No part of the name can contain whitespace.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Privilege names
</span>
</dt>
<dd>
Privilege names must begin with a lowercase ASCII letter and must contain
only ASCII letters and digits along with the characters <code class="literal">_</code>, <code class="literal">-</code> and <code class="literal">.</code>
</dd>
<dt>
<span class="term">
Action names
</span>
</dt>
<dd>
Action names can contain any number of printable ASCII characters and must
contain at least one of the following characters: <code class="literal">/</code> <code class="literal">*</code>, <code class="literal">:</code>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-privileges-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/put-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>A successful call returns a JSON structure that shows whether the privilege has
been created or updated.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-privileges-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/put-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>To add a single privilege, submit a PUT or POST request to the
<code class="literal">/_security/privilege/</code> endpoint. For example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_security/privilege
{
  "myapp": {
    "read": {
      "actions": [ <a id="CO693-1"></a><i class="conum" data-value="1"></i>
        "data:read/*" , <a id="CO693-2"></a><i class="conum" data-value="2"></i>
        "action:login" ],
        "metadata": { <a id="CO693-3"></a><i class="conum" data-value="3"></i>
          "description": "Read access to myapp"
        }
      }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2242.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO693-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>These strings have significance within the "myapp" application. Elasticsearch does not
assign any meaning to them.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO693-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The use of a wildcard here (<code class="literal">*</code>) means that this privilege grants access to
all actions that start with <code class="literal">data:read/</code>. Elasticsearch does not assign any meaning
to these actions. However, if the request includes an application privilege
such as <code class="literal">data:read/users</code> or <code class="literal">data:read/settings</code>, the
<a class="xref" href="security-api.html#security-api-has-privileges" title="Has privileges API">has privileges API</a> respects the use of a
wildcard and returns <code class="literal">true</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO693-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The metadata object is optional.</p>
</td>
</tr>
</table>
</div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "myapp": {
    "read": {
      "created": true <a id="CO694-1"></a><i class="conum" data-value="1"></i>
    }
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO694-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>When an existing privilege is updated, <code class="literal">created</code> is set to false.</p>
</td>
</tr>
</table>
</div>
<p>To add multiple privileges, submit a POST request to the
<code class="literal">/_security/privilege/</code> endpoint. For example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_security/privilege
{
  "app01": {
    "read": {
      "actions": [ "action:login", "data:read/*" ]
    },
    "write": {
      "actions": [ "action:login", "data:write/*" ]
    }
  },
  "app02": {
    "all": {
      "actions": [ "*" ]
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2243.console"></div>
<p>A successful call returns a JSON structure that shows whether the privileges
have been created or updated.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "app02": {
    "all": {
      "created": true
    }
  },
  "app01": {
    "read": {
      "created": true
    },
    "write": {
      "created": true
    }
  }
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-put-role-mapping"></a>Create or update role mappings API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-role-mappings.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Creates and updates role mappings.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-mapping-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/role_mapping/&lt;name&gt;</code><br></p>
<p><code class="literal">PUT /_security/role_mapping/&lt;name&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-mapping-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-mapping-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p>Role mappings define which roles are assigned to each user. Each mapping has
<em>rules</em> that identify users and a list of <em>roles</em> that are granted to those users.</p>
<p>The role mapping APIs are generally the preferred way to manage role mappings
rather than using <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.10/mapping-roles.html#mapping-roles-file" class="ulink" target="_top">role mapping files</a>.
The create or update role mappings API cannot update role mappings that are defined
in role mapping files.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API does not create roles. Rather, it maps users to existing roles.
Roles can be created by using the <a class="xref" href="security-api.html#security-api-put-role" title="Create or update roles API">create or update
roles API</a> or <a class="xref" href="authorization.html#roles-management-file" title="File-based role management">roles files</a>.</p>
</div>
</div>
<p>For more information, see <a class="xref" href="authorization.html#mapping-roles" title="Mapping users and groups to roles">Mapping users and groups to roles</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_role_templates"></a>Role templates<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-role-mappings.asciidoc">edit</a></h4>
</div></div></div>
<p>The most common use for role mappings is to create a mapping from a known value
on the user to a fixed role name. For example, all users in the
<code class="literal">cn=admin,dc=example,dc=com</code> LDAP group should be given the <code class="literal">superuser</code> role in
Elasticsearch. The <code class="literal">roles</code> field is used for this purpose.</p>
<p>For more complex needs, it is possible to use Mustache templates to dynamically
determine the names of the roles that should be granted to the user. The
<code class="literal">role_templates</code> field is used for this purpose.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To use role templates successfully, the relevant scripting feature must be
enabled. Otherwise, all attempts to create a role mapping with role templates
fail. See <a class="xref" href="modules-scripting-security.html#allowed-script-types-setting" title="Allowed script types setting">Allowed script types setting</a>.</p>
</div>
</div>
<p>All of the <a class="xref" href="api-definitions.html#role-mapping-resources" title="Role mapping resources">user fields</a> that are available in the
role mapping <code class="literal">rules</code> are also available in the role templates. Thus it is possible
to assign a user to a role that reflects their <code class="literal">username</code>, their <code class="literal">groups</code>, or the
name of the <code class="literal">realm</code> to which they authenticated.</p>
<p>By default a template is evaluated to produce a single string that is the name
of the role which should be assigned to the user. If the <code class="literal">format</code> of the template
is set to <code class="literal">"json"</code> then the template is expected to produce a JSON string or an
array of JSON strings for the role names.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-mapping-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string) The distinct name that identifies the role mapping. The name is
 used solely as an identifier to facilitate interaction via the API; it does
 not affect the behavior of the mapping in any way.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-mapping-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the body of a PUT or POST request
and pertain to adding a role mapping:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">enabled</code>
</span>
</dt>
<dd>
(Required, Boolean) Mappings that have <code class="literal">enabled</code> set to <code class="literal">false</code> are ignored when
role mapping is performed.
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(object) Additional metadata that helps define which roles are assigned to each
user. Within the <code class="literal">metadata</code> object, keys beginning with <code class="literal">_</code> are reserved for
system usage.
</dd>
<dt>
<span class="term">
<code class="literal">roles</code>
</span>
</dt>
<dd>
(list of strings) A list of role names that are granted to the users that match
the role mapping rules.
<em>Exactly one of <code class="literal">roles</code> or <code class="literal">role_templates</code> must be specified</em>.
</dd>
<dt>
<span class="term">
<code class="literal">role_templates</code>
</span>
</dt>
<dd>
(list of objects) A list of mustache templates that will be evaluated to
determine the roles names that should granted to the users that match the role
mapping rules.
The format of these objects is defined below.
<em>Exactly one of <code class="literal">roles</code> or <code class="literal">role_templates</code> must be specified</em>.
</dd>
<dt>
<span class="term">
<code class="literal">rules</code>
</span>
</dt>
<dd>
(Required, object) The rules that determine which users should be matched by the
mapping. A rule is a logical condition that is expressed by using a JSON DSL.
See  <a class="xref" href="api-definitions.html#role-mapping-resources" title="Role mapping resources">Role mapping resources</a>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-mapping-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example assigns the "user" role to all users:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role_mapping/mapping1
{
  "roles": [ "user"],
  "enabled": true, <a id="CO695-1"></a><i class="conum" data-value="1"></i>
  "rules": {
    "field" : { "username" : "*" }
  },
  "metadata" : { <a id="CO695-2"></a><i class="conum" data-value="2"></i>
    "version" : 1
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2244.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO695-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Mappings that have <code class="literal">enabled</code> set to <code class="literal">false</code> are ignored when role mapping
is performed.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO695-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Metadata is optional.</p>
</td>
</tr>
</table>
</div>
<p>A successful call returns a JSON structure that shows whether the mapping has
been created or updated.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "role_mapping" : {
    "created" : true <a id="CO696-1"></a><i class="conum" data-value="1"></i>
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO696-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>When an existing mapping is updated, <code class="literal">created</code> is set to false.</p>
</td>
</tr>
</table>
</div>
<p>The following example assigns the "user" and "admin" roles to specific users:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role_mapping/mapping2
{
  "roles": [ "user", "admin" ],
  "enabled": true,
  "rules": {
     "field" : { "username" : [ "esadmin01", "esadmin02" ] }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2245.console"></div>
<p>The following example matches users who authenticated against a specific realm:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role_mapping/mapping3
{
  "roles": [ "ldap-user" ],
  "enabled": true,
  "rules": {
    "field" : { "realm.name" : "ldap1" }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2246.console"></div>
<p>The following example matches any user where either the username is <code class="literal">esadmin</code>
or the user is in the <code class="literal">cn=admin,dc=example,dc=com</code> group:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role_mapping/mapping4
{
  "roles": [ "superuser" ],
  "enabled": true,
  "rules": {
    "any": [
      {
        "field": {
          "username": "esadmin"
        }
      },
      {
        "field": {
          "groups": "cn=admins,dc=example,dc=com"
        }
      }
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2247.console"></div>
<p>The example above is useful when the group names in your identity management
system (such as Active Directory, or a SAML Identity Provider) do not have a
1-to-1 correspondence with the names of roles in Elasticsearch. The role mapping is the
means by which you link a <em>group name</em> with a <em>role name</em>.</p>
<p>However, in rare cases the names of your groups may be an exact match for the
names of your Elasticsearch roles. This can be the case when your SAML Identity Provider
includes its own "group mapping" feature and can be configured to release Elasticsearch
role names in the user&#8217;s SAML attributes.</p>
<p>In these cases it is possible to use a template that treats the group names as
role names.</p>
<p><span class="strong strong"><strong>Note</strong></span>: This should only be done if you intend to define roles for all of the
provided groups. Mapping a user to a large number of unnecessary or undefined
roles is inefficient and can have a negative effect on system performance.
If you only need to map a subset of the groups, then you should do this
using explicit mappings.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role_mapping/mapping5
{
  "role_templates": [
    {
      "template": { "source": "{{#tojson}}groups{{/tojson}}" }, <a id="CO697-1"></a><i class="conum" data-value="1"></i>
      "format" : "json" <a id="CO697-2"></a><i class="conum" data-value="2"></i>
    }
  ],
  "rules": {
    "field" : { "realm.name" : "saml1" }
  },
  "enabled": true
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2248.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO697-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">tojson</code> mustache function is used to convert the list of
group names into a valid JSON array.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO697-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Because the template produces a JSON array, the format must be
set to <code class="literal">json</code>.</p>
</td>
</tr>
</table>
</div>
<p>The following example matches users within a specific LDAP sub-tree:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role_mapping/mapping6
{
  "roles": [ "example-user" ],
  "enabled": true,
  "rules": {
    "field" : { "dn" : "*,ou=subtree,dc=example,dc=com" }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2249.console"></div>
<p>The following example matches users within a particular LDAP sub-tree in a
specific realm:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role_mapping/mapping7
{
  "roles": [ "ldap-example-user" ],
  "enabled": true,
  "rules": {
    "all": [
      { "field" : { "dn" : "*,ou=subtree,dc=example,dc=com" } },
      { "field" : { "realm.name" : "ldap1" } }
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2250.console"></div>
<p>The rules can be more complex and include wildcard matching. For example, the
following mapping matches any user where <span class="strong strong"><strong>all</strong></span> of these conditions are met:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
the <em>Distinguished Name</em> matches the pattern <code class="literal">*,ou=admin,dc=example,dc=com</code>,
or the username is <code class="literal">es-admin</code>, or the username is <code class="literal">es-system</code>
</li>
<li class="listitem">
the user in in the <code class="literal">cn=people,dc=example,dc=com</code> group
</li>
<li class="listitem">
the user does not have a <code class="literal">terminated_date</code>
</li>
</ul>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role_mapping/mapping8
{
  "roles": [ "superuser" ],
  "enabled": true,
  "rules": {
    "all": [
      {
        "any": [
          {
            "field": {
              "dn": "*,ou=admin,dc=example,dc=com"
            }
          },
          {
            "field": {
              "username": [ "es-admin", "es-system" ]
            }
          }
        ]
      },
      {
        "field": {
          "groups": "cn=people,dc=example,dc=com"
        }
      },
      {
        "except": {
          "field": {
            "metadata.terminated_date": null
          }
        }
      }
    ]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2251.console"></div>
<p>A templated role can be used to automatically map every user to their own
custom role. The role itself can be defined through the
<a class="xref" href="security-api.html#security-api-put-role" title="Create or update roles API">Roles API</a> or using a
<a class="xref" href="authorization.html#implementing-custom-roles-provider" title="Implementing a custom roles provider">custom roles provider</a>.</p>
<p>In this example every user who authenticates using the "cloud-saml" realm
will be automatically mapped to two roles - the <code class="literal">"saml_user"</code> role and a
role that is their username prefixed with <code class="literal">_user_</code>.
As an example, the user <code class="literal">nwong</code> would be assigned the <code class="literal">saml_user</code> and
<code class="literal">_user_nwong</code> roles.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role_mapping/mapping9
{
  "rules": { "field": { "realm.name": "cloud-saml" } },
  "role_templates": [
    { "template": { "source" : "saml_user" } }, <a id="CO698-1"></a><i class="conum" data-value="1"></i>
    { "template": { "source" : "_user_{{username}}" } }
  ],
  "enabled": true
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2252.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO698-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Because it is not possible to specify both <code class="literal">roles</code> and <code class="literal">role_templates</code> in
the same role mapping, we can apply a "fixed name" role by using a template
that has no substitutions.</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-put-role"></a>Create or update roles API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-roles.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Adds and updates roles in the native realm.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-roles.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/role/&lt;name&gt;</code><br></p>
<p><code class="literal">PUT /_security/role/&lt;name&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-roles.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster
privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-roles.asciidoc">edit</a></h3>
</div></div></div>
<p>The role management APIs are generally the preferred way to manage roles, rather than using
<a class="xref" href="authorization.html#roles-management-file" title="File-based role management">file-based role management</a>. The create
or update roles API cannot update roles that are defined in roles files.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-roles.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string) The name of the role.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-roles.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the body of a PUT or POST request
and pertain to adding a role:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">applications</code>
</span>
</dt>
<dd>
<p>
(list) A list of application privilege entries.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">application</code> (required)
</span>
</dt>
<dd>
(string) The name of the application to which this entry applies
</dd>
<dt>
<span class="term">
<code class="literal">privileges</code>
</span>
</dt>
<dd>
(list) A list of strings, where each element is the name of an application
privilege or action.
</dd>
<dt>
<span class="term">
<code class="literal">resources</code>
</span>
</dt>
<dd>
(list) A list resources to which the privileges are applied.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">cluster</code>
</span>
</dt>
<dd>
(list) A list of cluster privileges. These privileges define the
cluster level actions that users with this role are able to execute.
</dd>
<dt>
<span class="term">
<code class="literal">global</code>
</span>
</dt>
<dd>
(object) An object defining global privileges. A global privilege is
a form of cluster privilege that is request-aware. Support for global privileges
is currently limited to the management of application privileges.
This field is optional.
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
<p>
(list) A list of indices permissions entries.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field_security</code>
</span>
</dt>
<dd>
(list) The document fields that the owners of the role have
read access to. For more information, see
<a class="xref" href="authorization.html#field-and-document-access-control" title="Setting up field and document level security">Setting up field and document level security</a>.
</dd>
<dt>
<span class="term">
<code class="literal">names</code> (required)
</span>
</dt>
<dd>
(list) A list of indices (or index name patterns) to which the
permissions in this entry apply.
</dd>
<dt>
<span class="term">
<code class="literal">privileges</code>(required)
</span>
</dt>
<dd>
(list) The index level privileges that the owners of the role
have on the specified indices.
</dd>
<dt>
<span class="term">
<code class="literal">query</code>
</span>
</dt>
<dd>
A search query that defines the documents the owners of the role have
read access to. A document within the specified indices must match this query in
order for it to be accessible by the owners of the role.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(object) Optional meta-data. Within the <code class="literal">metadata</code> object, keys
that begin with <code class="literal">_</code> are reserved for system usage.
</dd>
<dt>
<span class="term">
<code class="literal">run_as</code>
</span>
</dt>
<dd>
(list) A list of users that the owners of this role can impersonate.
For more information, see
<a class="xref" href="authorization.html#run-as-privilege" title="Submitting requests on behalf of other users">Submitting requests on behalf of other users</a>.
</dd>
</dl>
</div>
<p>For more information, see <a class="xref" href="authorization.html#defining-roles" title="Defining roles">Defining roles</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-role-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-roles.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example adds a role called <code class="literal">my_admin_role</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role/my_admin_role
{
  "cluster": ["all"],
  "indices": [
    {
      "names": [ "index1", "index2" ],
      "privileges": ["all"],
      "field_security" : { // optional
        "grant" : [ "title", "body" ]
      },
      "query": "{\"match\": {\"title\": \"foo\"}}" // optional
    }
  ],
  "applications": [
    {
      "application": "myapp",
      "privileges": [ "admin", "read" ],
      "resources": [ "*" ]
    }
  ],
  "run_as": [ "other_user" ], // optional
  "metadata" : { // optional
    "version" : 1
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2253.console"></div>
<p>A successful call returns a JSON structure that shows whether the role has been
created or updated.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "role": {
    "created": true <a id="CO699-1"></a><i class="conum" data-value="1"></i>
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO699-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>When an existing role is updated, <code class="literal">created</code> is set to false.</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-put-user"></a>Create or update users API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-users.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Adds and updates users in the native realm. These users are commonly referred
to as <em>native users</em>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-user-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-users.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/user/&lt;username&gt;</code><br></p>
<p><code class="literal">PUT /_security/user/&lt;username&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-user-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-user-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-users.asciidoc">edit</a></h3>
</div></div></div>
<p>A <code class="literal">password</code> is required for adding a new user but is optional when updating an
existing user. To change a user&#8217;s password without updating any other fields,
use the <a class="xref" href="security-api.html#security-api-change-password" title="Change passwords API">change password API</a>.</p>
<p>For more information about the native realm, see
<a class="xref" href="setting-up-authentication.html#realms" title="Realms">Realms</a> and <a class="xref" href="setting-up-authentication.html#native-realm" title="Native user authentication">Native user authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-user-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
<p>
(Required, string) An identifier for the user.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<a id="username-validation"></a>
<p>Usernames must be at least 1 and no more than 1024 characters. They can
contain alphanumeric characters (<code class="literal">a-z</code>, <code class="literal">A-Z</code>, <code class="literal">0-9</code>), spaces, punctuation, and
printable symbols in the <a href="https://en.wikipedia.org/wiki/Basic_Latin_(Unicode_block)" class="ulink" target="_top">Basic Latin (ASCII) block</a>. Leading or trailing whitespace is not allowed.</p>
</div>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-user-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">refresh</code>
</span>
</dt>
<dd>
(string) One of <code class="literal">true</code>, <code class="literal">false</code>, or <code class="literal">wait_for</code>.
These values have the same meaning as in the <a class="xref" href="docs.html#docs-refresh" title="?refresh">Index API</a>,
but the default value for this API (Put User) is <code class="literal">true</code>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-user-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-users.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the body of a POST or PUT request:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">enabled</code>
</span>
</dt>
<dd>
(Boolean) Specifies whether the user is enabled. The default value is <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">email</code>
</span>
</dt>
<dd>
(string) The email of the user.
</dd>
<dt>
<span class="term">
<code class="literal">full_name</code>
</span>
</dt>
<dd>
(string) The full name of the user.
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(object) Arbitrary metadata that you want to associate with the user.
</dd>
<dt>
<span class="term">
<code class="literal">password</code>
</span>
</dt>
<dd>
<p>
(Required<a class="xref" href="security-api.html#not-always-required">*</a>, string) The user&#8217;s password. Passwords must be at least 6 characters long.
</p>
<p>When adding a user, one of <code class="literal">password</code> or <code class="literal">password_hash</code> is required.
When updating an existing user, the password is optional, so that other
fields on the user (such as their roles) may be updated without modifying
the user&#8217;s password.</p>
</dd>
<dt>
<span class="term">
<code class="literal">password_hash</code>
</span>
</dt>
<dd>
<p>
(string) A <em>hash</em> of the user&#8217;s password. This must be produced using the
same hashing algorithm as has been configured for password storage. For more
details, see the explanation of the
<code class="literal">xpack.security.authc.password_hashing.algorithm</code> setting in
<a class="xref" href="settings.html#hashing-settings" title="User cache and password hash algorithms">User cache and password hash algorithms</a>.
</p>
<p>Using this parameter allows the client to pre-hash the password for
performance and/or confidentiality reasons.</p>
<p>The <code class="literal">password</code> parameter and the <code class="literal">password_hash</code> parameter cannot be
used in the same request.</p>
</dd>
<dt>
<span class="term">
<code class="literal">roles</code>
</span>
</dt>
<dd>
(Required, list) A set of roles the user has. The roles determine the user&#8217;s
access  permissions. To create a user without any roles, specify an empty list:
<code class="literal">[]</code>.
</dd>
</dl>
</div>
<p><a id="not-always-required"></a>*Indicates that the setting is required in some, but not all situations.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-put-user-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/create-users.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example creates a user <code class="literal">jacknich</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/user/jacknich
{
  "password" : "j@rV1s",
  "roles" : [ "admin", "other_role1" ],
  "full_name" : "Jack Nicholson",
  "email" : "jacknich@example.com",
  "metadata" : {
    "intelligence" : 7
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2254.console"></div>
<p>A successful call returns a JSON structure that shows whether the user has been
created or updated.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "created": true <a id="CO700-1"></a><i class="conum" data-value="1"></i>
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO700-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>When an existing user is updated, <code class="literal">created</code> is set to false.</p>
</td>
</tr>
</table>
</div>
<p>After you add a user, requests from that user can be authenticated. For example:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">curl -u jacknich:j@rV1s http://localhost:9200/_cluster/health</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-delegate-pki-authentication"></a>Delegate PKI authentication API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delegate-pki-authentication.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Implements the exchange of an <em>X509Certificate</em> chain into an Elasticsearch access
token.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delegate-pki-authentication-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delegate-pki-authentication.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/delegate_pki</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delegate-pki-authentication-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delegate-pki-authentication.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To call this API, the (proxy) user must have the <code class="literal">delegate_pki</code> or the <code class="literal">all</code>
cluster privilege. The <code class="literal">kibana_system</code> built-in role already grants this
privilege. See <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delegate-pki-authentication-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delegate-pki-authentication.asciidoc">edit</a></h3>
</div></div></div>
<p>This API implements the exchange of an <em>X509Certificate</em> chain for an Elasticsearch
access token. The certificate chain is validated, according to RFC 5280, by
sequentially considering the trust configuration of every installed PKI realm
that has <code class="literal">delegation.enabled</code> set to <code class="literal">true</code> (default is <code class="literal">false</code>). A
successfully trusted client certificate is also subject to the validation of
the subject distinguished name according to that respective&#8217;s realm
<code class="literal">username_pattern</code>.</p>
<p>This API is called by <span class="strong strong"><strong>smart</strong></span> and <span class="strong strong"><strong>trusted</strong></span> proxies, such as Kibana, which
terminate the user&#8217;s TLS session but still want to authenticate the user
by using a PKI realm&#8212;&#8203;as if the user connected directly to Elasticsearch. For more
details, see <a class="xref" href="setting-up-authentication.html#pki-realm-for-proxied-clients" title="PKI authentication for clients connecting to Kibana">PKI authentication for clients connecting to Kibana</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>The association between the subject public key in the target
certificate and the corresponding private key is <span class="strong strong"><strong>not</strong></span> validated. This is part
of the TLS authentication process and it is delegated to the proxy that calls
this API. The proxy is <span class="strong strong"><strong>trusted</strong></span> to have performed the TLS authentication and
this API translates that authentication into an Elasticsearch access token.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delegate-pki-authentication-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delegate-pki-authentication.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">x509_certificate_chain</code>
</span>
</dt>
<dd>
<p>
(Required, list of strings) The <em>X509Certificate</em> chain, which is represented as
an ordered string array. Each string in the array is a base64-encoded
(Section 4 of RFC4648 - not base64url-encoded) of the certificate&#8217;s DER encoding.
</p>
<p>The first element is the target certificate contains the subject distinguished
name that is requesting access. This may be followed by additional certificates;
each subsequent certificate is used to certify the previous one.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delegate-pki-authentication-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delegate-pki-authentication.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">access_token</code>
</span>
</dt>
<dd>
(string) An access token associated to the subject distinguished name of the
client&#8217;s certificate.
</dd>
<dt>
<span class="term">
<code class="literal">expires_in</code>
</span>
</dt>
<dd>
(time units) The amount of time (in seconds) that the token expires in.
</dd>
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
(string) The type of token.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delegate-pki-authentication-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delegate-pki-authentication.asciidoc">edit</a></h3>
</div></div></div>
<p>The following is an example request:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/delegate_pki
{
  "x509_certificate_chain": ["MIIDbTCCAlWgAwIBAgIJAIxTS7Qdho9jMA0GCSqGSIb3DQEBCwUAMFMxKzApBgNVBAMTIkVsYXN0aWNzZWFyY2ggVGVzdCBJbnRlcm1lZGlhdGUgQ0ExFjAUBgNVBAsTDUVsYXN0aWNzZWFyY2gxDDAKBgNVBAoTA29yZzAeFw0xOTA3MTkxMzMzNDFaFw0yMzA3MTgxMzMzNDFaMEoxIjAgBgNVBAMTGUVsYXN0aWNzZWFyY2ggVGVzdCBDbGllbnQxFjAUBgNVBAsTDUVsYXN0aWNzZWFyY2gxDDAKBgNVBAoTA29yZzCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBANHgMX2aX8t0nj4sGLNuKISmmXIYCj9RwRqS7L03l9Nng7kOKnhHu/nXDt7zMRJyHj+q6FAt5khlavYSVCQyrDybRuA5z31gOdqXerrjs2OXS5HSHNvoDAnHFsaYX/5geMewVTtc/vqpd7Ph/QtaKfmG2FK0JNQo0k24tcgCIcyMtBh6BA70yGBM0OT8GdOgd/d/mA7mRhaxIUMNYQzRYRsp4hMnnWoOTkR5Q8KSO3MKw9dPSpPe8EnwtJE10S3s5aXmgytru/xQqrFycPBNj4KbKVmqMP0G60CzXik5pr2LNvOFz3Qb6sYJtqeZF+JKgGWdaTC89m63+TEnUHqk0lcCAwEAAaNNMEswCQYDVR0TBAIwADAdBgNVHQ4EFgQU/+aAD6Q4mFq1vpHorC25/OY5zjcwHwYDVR0jBBgwFoAU8siFCiMiYZZm/95qFC75AG/LRE0wDQYJKoZIhvcNAQELBQADggEBAIRpCgDLpvXcgDHUk10uhxev21mlIbU+VP46ANnCuj0UELhTrdTuWvO1PAI4z+WbDUxryQfOOXO9R6D0dE5yR56L/J7d+KayW34zU7yRDZM7+rXpocdQ1Ex8mjP9HJ/Bf56YZTBQJpXeDrKow4FvtkI3bcIMkqmbG16LHQXeG3RS4ds4S4wCnE2nA6vIn9y+4R999q6y1VSBORrYULcDWxS54plHLEdiMr1vVallg82AGobS9GMcTL2U4Nx5IYZG7sbTk3LrDxVpVg/S2wLofEdOEwqCeHug/iOihNLJBabEW6z4TDLJAVW5KCY1DfhkYlBfHn7vxKkfKoCUK/yLWWI="] <a id="CO701-1"></a><i class="conum" data-value="1"></i>
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2255.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO701-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>A one element certificate chain.</p>
</td>
</tr>
</table>
</div>
<p>Which returns the following response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "access_token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
  "type" : "Bearer",
  "expires_in" : 1200
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-delete-privilege"></a>Delete application privileges API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-app-privileges.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Removes <a class="xref" href="authorization.html#application-privileges" title="Application privileges">application privileges</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-privilege-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_security/privilege/&lt;application&gt;/&lt;privilege&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-privilege-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>To use this API, you must have either:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
the <code class="literal">manage_security</code> cluster privilege (or a greater privilege such as <code class="literal">all</code>); <em>or</em>
</li>
<li class="listitem">
the <em>"Manage Application Privileges"</em> global privilege for the application being referenced
in the request
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-privilege-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">application</code>
</span>
</dt>
<dd>
(Required, string) The name of the application. Application privileges are
always associated with exactly one application.
</dd>
<dt>
<span class="term">
<code class="literal">privilege</code>
</span>
</dt>
<dd>
(Required, string) The name of the privilege.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-privilege-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example deletes the <code class="literal">read</code> application privilege from the
<code class="literal">myapp</code> application:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/privilege/myapp/read</pre>
</div>
<div class="console_widget" data-snippet="snippets/2256.console"></div>
<p>If the privilege is successfully deleted, the request returns <code class="literal">{"found": true}</code>.
Otherwise, <code class="literal">found</code> is set to false.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "myapp": {
    "read": {
      "found" : true
    }
  }
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-delete-role-mapping"></a>Delete role mappings API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-role-mappings.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Removes role mappings.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-mapping-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_security/role_mapping/&lt;name&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-mapping-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-mapping-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p>Role mappings define which roles are assigned to each user. For more information,
see <a class="xref" href="authorization.html#mapping-roles" title="Mapping users and groups to roles">Mapping users and groups to roles</a>.</p>
<p>The role mapping APIs are generally the preferred way to manage role mappings
rather than using <a class="xref" href="authorization.html#mapping-roles-file" title="Using role mapping files">role mapping files</a>.
The delete role mappings API cannot remove role mappings that are defined
in role mapping files.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-mapping-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string) The distinct name that identifies the role mapping. The name is
 used solely as an identifier to facilitate interaction via the API; it does
 not affect the behavior of the mapping in any way.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-mapping-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example delete a role mapping:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/role_mapping/mapping1</pre>
</div>
<div class="console_widget" data-snippet="snippets/2257.console"></div>
<p>If the mapping is successfully deleted, the request returns <code class="literal">{"found": true}</code>.
Otherwise, <code class="literal">found</code> is set to false.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found" : true
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-delete-role"></a>Delete roles API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-roles.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Removes roles in the native realm.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-roles.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_security/role/&lt;name&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-roles.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-roles.asciidoc">edit</a></h3>
</div></div></div>
<p>The role management APIs are generally the preferred way to manage roles, rather than using
<a class="xref" href="authorization.html#roles-management-file" title="File-based role management">file-based role management</a>. The delete roles API cannot remove roles that are defined in roles files.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-roles.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(string) The name of the role.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-role-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-roles.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example deletes a <code class="literal">my_admin_role</code> role:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/role/my_admin_role</pre>
</div>
<div class="console_widget" data-snippet="snippets/2258.console"></div>
<p>If the role is successfully deleted, the request returns <code class="literal">{"found": true}</code>.
Otherwise, <code class="literal">found</code> is set to false.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found" : true
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-delete-user"></a>Delete users API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-users.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Deletes users from the native realm.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-user-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-users.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_security/user/&lt;username&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-user-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-user-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-users.asciidoc">edit</a></h3>
</div></div></div>
<p>For more information about the native realm, see
<a class="xref" href="setting-up-authentication.html#realms" title="Realms">Realms</a> and <a class="xref" href="setting-up-authentication.html#native-realm" title="Native user authentication">Native user authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-user-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Required, string) An identifier for the user.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-delete-user-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/delete-users.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example deletes the user <code class="literal">jacknich</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/user/jacknich</pre>
</div>
<div class="console_widget" data-snippet="snippets/2259.console"></div>
<p>If the user is successfully deleted, the request returns <code class="literal">{"found": true}</code>.
Otherwise, <code class="literal">found</code> is set to false.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found" : true
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-disable-user"></a>Disable users API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/disable-users.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Disables users in the native realm.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-disable-user-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/disable-users.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_security/user/&lt;username&gt;/_disable</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-disable-user-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/disable-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-disable-user-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/disable-users.asciidoc">edit</a></h3>
</div></div></div>
<p>By default, when you create users, they are enabled. You can use this API to
revoke a user&#8217;s access to Elasticsearch. To re-enable a user, there is an
<a class="xref" href="security-api.html#security-api-enable-user" title="Enable users API">enable users API</a>.</p>
<p>For more information about the native realm, see
<a class="xref" href="setting-up-authentication.html#realms" title="Realms">Realms</a> and <a class="xref" href="setting-up-authentication.html#native-realm" title="Native user authentication">Native user authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-disable-user-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/disable-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Required, string) An identifier for the user.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-disable-user-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/disable-users.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example disables the user <code class="literal">jacknich</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_security/user/jacknich/_disable</pre>
</div>
<div class="console_widget" data-snippet="snippets/2260.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-enable-user"></a>Enable users API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/enable-users.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Enables users in the native realm.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-enable-user-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/enable-users.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_security/user/&lt;username&gt;/_enable</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-enable-user-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/enable-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-enable-user-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/enable-users.asciidoc">edit</a></h3>
</div></div></div>
<p>By default, when you create users, they are enabled. You can use this enable
users API and the <a class="xref" href="security-api.html#security-api-disable-user" title="Disable users API">disable users API</a> to change that attribute.</p>
<p>For more information about the native realm, see
<a class="xref" href="setting-up-authentication.html#realms" title="Realms">Realms</a> and <a class="xref" href="setting-up-authentication.html#native-realm" title="Native user authentication">Native user authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-enable-user-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/enable-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Required, string) An identifier for the user.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-enable-user-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/enable-users.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example enables the user <code class="literal">jacknich</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_security/user/jacknich/_enable</pre>
</div>
<div class="console_widget" data-snippet="snippets/2261.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-get-api-key"></a>Get API key information API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-api-keys.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves information for one or more API keys.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-api-key-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_security/api_key</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-api-key-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_api_key</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-api-key-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>The information for the API keys created by
<a class="xref" href="security-api.html#security-api-create-api-key" title="Create API key API">create API Key</a> can be retrieved using this API.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-api-key-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the query parameters of a GET request and
pertain to retrieving api keys:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(Optional, string) An API key id. This parameter cannot be used with any of
<code class="literal">name</code>, <code class="literal">realm_name</code> or <code class="literal">username</code> are used.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(Optional, string) An API key name. This parameter cannot be used with any of
<code class="literal">id</code>, <code class="literal">realm_name</code> or <code class="literal">username</code> are used. It supports prefix search with wildcard.
</dd>
<dt>
<span class="term">
<code class="literal">realm_name</code>
</span>
</dt>
<dd>
(Optional, string) The name of an authentication realm. This parameter cannot be
used with either <code class="literal">id</code> or <code class="literal">name</code> or when <code class="literal">owner</code> flag is set to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Optional, string) The username of a user. This parameter cannot be used with
either <code class="literal">id</code> or <code class="literal">name</code> or when <code class="literal">owner</code> flag is set to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">owner</code>
</span>
</dt>
<dd>
(Optional, Boolean) A boolean flag that can be used to query API keys owned
by the currently authenticated user. Defaults to false.
The <em>realm_name</em> or <em>username</em> parameters cannot be specified when this
parameter is set to <em>true</em> as they are assumed to be the currently authenticated ones.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When none of the parameters "id", "name", "username" and "realm_name"
are specified, and the "owner" is set to false then it will retrieve all API
keys if the user is authorized. If the user is not authorized to retrieve other user&#8217;s
API keys, then an error will be returned.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-api-key-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>If you create an API key as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/api_key
{
  "name": "my-api-key",
  "role_descriptors": {}
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2262.console"></div>
<p>A successful call returns a JSON structure that provides
API key information. For example:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "id":"VuaCfGcBCdbkQm-e5aOx",
  "name":"my-api-key",
  "api_key":"ui2lp2axTNmsyakw9tvNnw"
}</pre>
</div>
<p>You can use the following example to retrieve the API key by ID:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key?id=VuaCfGcBCdbkQm-e5aOx</pre>
</div>
<div class="console_widget" data-snippet="snippets/2263.console"></div>
<p>You can use the following example to retrieve the API key by name:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key?name=my-api-key</pre>
</div>
<div class="console_widget" data-snippet="snippets/2264.console"></div>
<p>API key name supports prefix search by using wildcard:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key?name=my-*</pre>
</div>
<div class="console_widget" data-snippet="snippets/2265.console"></div>
<p>The following example retrieves all API keys for the <code class="literal">native1</code> realm:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key?realm_name=native1</pre>
</div>
<div class="console_widget" data-snippet="snippets/2266.console"></div>
<p>The following example retrieves all API keys for the user <code class="literal">myuser</code> in all realms:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key?username=myuser</pre>
</div>
<div class="console_widget" data-snippet="snippets/2267.console"></div>
<p>The following example retrieves all API keys owned by the currently authenticated user:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key?owner=true</pre>
</div>
<div class="console_widget" data-snippet="snippets/2268.console"></div>
<p>The following example retrieves all API keys if the user is authorized to do so:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key</pre>
</div>
<div class="console_widget" data-snippet="snippets/2269.console"></div>
<p>Following creates an API key</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/api_key
{
  "name": "my-api-key-1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2270.console"></div>
<p>The following example retrieves the API key identified by the specified <code class="literal">id</code> if
it is owned by the currently authenticated user:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key?id=VuaCfGcBCdbkQm-e5aOx&amp;owner=true</pre>
</div>
<div class="console_widget" data-snippet="snippets/2271.console"></div>
<p>Finally, the following example retrieves all API keys for the user <code class="literal">myuser</code> in
 the <code class="literal">native1</code> realm immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key?username=myuser&amp;realm_name=native1</pre>
</div>
<div class="console_widget" data-snippet="snippets/2272.console"></div>
<p>A successful call returns a JSON structure that contains the information of one or more API keys that were retrieved.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "api_keys": [ <a id="CO702-1"></a><i class="conum" data-value="1"></i>
    {
      "id": "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==", <a id="CO702-2"></a><i class="conum" data-value="2"></i>
      "name": "hadoop_myuser_key", <a id="CO702-3"></a><i class="conum" data-value="3"></i>
      "creation": 1548550550158, <a id="CO702-4"></a><i class="conum" data-value="4"></i>
      "expiration": 1548551550158, <a id="CO702-5"></a><i class="conum" data-value="5"></i>
      "invalidated": false, <a id="CO702-6"></a><i class="conum" data-value="6"></i>
      "username": "myuser", <a id="CO702-7"></a><i class="conum" data-value="7"></i>
      "realm": "native1" <a id="CO702-8"></a><i class="conum" data-value="8"></i>
    },
    {
      "id": "api-key-id-2",
      "name": "api-key-name-2",
      "creation": 1548550550158,
      "invalidated": false,
      "username": "user-y",
      "realm": "realm-2"
    }
  ]
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO702-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The list of API keys that were retrieved for this request.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO702-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Id for the API key</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO702-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Name of the API key</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO702-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Creation time for the API key in milliseconds</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO702-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Optional expiration time for the API key in milliseconds</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO702-6"><i class="conum" data-value="6"></i></a></p>
</td>
<td align="left" valign="top">
<p>Invalidation status for the API key. If the key has been invalidated, it has
a value of <code class="literal">true</code>. Otherwise, it is <code class="literal">false</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO702-7"><i class="conum" data-value="7"></i></a></p>
</td>
<td align="left" valign="top">
<p>Principal for which this API key was created</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO702-8"><i class="conum" data-value="8"></i></a></p>
</td>
<td align="left" valign="top">
<p>Realm name of the principal for which this API key was created</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-get-privileges"></a>Get application privileges API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-app-privileges.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves <a class="xref" href="authorization.html#application-privileges" title="Application privileges">application privileges</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-privileges-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_security/privilege</code><br></p>
<p><code class="literal">GET /_security/privilege/&lt;application&gt;</code><br></p>
<p><code class="literal">GET /_security/privilege/&lt;application&gt;/&lt;privilege&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-privileges-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>To use this API, you must have either:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
the <code class="literal">manage_security</code> cluster privilege (or a greater privilege such as <code class="literal">all</code>); <em>or</em>
</li>
<li class="listitem">
the <em>"Manage Application Privileges"</em> global privilege for the application being referenced
in the request
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-privileges-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>To check a user&#8217;s application privileges, use the
<a class="xref" href="security-api.html#security-api-has-privileges" title="Has privileges API">has privileges API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-privileges-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">application</code>
</span>
</dt>
<dd>
(Optional, string) The name of the application. Application privileges are
always associated with exactly one application. If you do not specify this
parameter, the API returns information about all privileges for all
applications.
</dd>
<dt>
<span class="term">
<code class="literal">privilege</code>
</span>
</dt>
<dd>
(Optional, string) The name of the privilege. If you do not specify this
parameter, the API returns information about all privileges for the requested
application.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-privileges-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-app-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example retrieves information about the <code class="literal">read</code> privilege for the
<code class="literal">app01</code> application:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/privilege/myapp/read</pre>
</div>
<div class="console_widget" data-snippet="snippets/2273.console"></div>
<p>A successful call returns an object keyed by application name and privilege
name. If the privilege is not defined, the request responds with a 404 status.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "myapp": {
    "read": {
      "application": "myapp",
      "name": "read",
      "actions": [
        "data:read/*",
        "action:login"
      ],
      "metadata": {
        "description": "Read access to myapp"
      }
    }
  }
}</pre>
</div>
<p>To retrieve all privileges for an application, omit the privilege name:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/privilege/myapp/</pre>
</div>
<div class="console_widget" data-snippet="snippets/2274.console"></div>
<p>To retrieve every privilege, omit both the application and privilege names:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/privilege/</pre>
</div>
<div class="console_widget" data-snippet="snippets/2275.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-get-builtin-privileges"></a>Get builtin privileges API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-builtin-privileges.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves the list of <a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privileges</a> and
<a class="xref" href="authorization.html#privileges-list-indices" title="Indices privileges">index privileges</a> that are
available in this version of Elasticsearch.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-builtin-privileges-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-builtin-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_security/privilege/_builtin</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-builtin-privileges-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-builtin-privileges.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have - the <code class="literal">manage_security</code> cluster privilege
(or a greater privilege such as <code class="literal">all</code>).
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-builtin-privileges-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-builtin-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>This API retrieves the set of cluster and index privilege names that are
available in the version of Elasticsearch that is being queried.</p>
<p>To check whether a user has particular privileges, use the
<a class="xref" href="security-api.html#security-api-has-privileges" title="Has privileges API">has privileges API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-builtin-privileges-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-builtin-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>The response is an object with two fields:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">cluster</code>
</span>
</dt>
<dd>
(array of string) The list of
<a class="xref" href="authorization.html#privileges-list-cluster" title="Cluster privileges">cluster privileges</a> that are understood by this
version of Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
(array of string) The list of
<a class="xref" href="authorization.html#privileges-list-indices" title="Indices privileges">index privileges</a> that are understood by this version
of Elasticsearch.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-builtin-privileges-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-builtin-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example retrieves the names of all builtin privileges:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/privilege/_builtin</pre>
</div>
<div class="console_widget" data-snippet="snippets/2276.console"></div>
<p>A successful call returns an object with "cluster" and "index" fields.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "cluster" : [
    "all",
    "create_snapshot",
    "delegate_pki",
    "grant_api_key",
    "manage",
    "manage_api_key",
    "manage_autoscaling",
    "manage_ccr",
    "manage_data_frame_transforms",
    "manage_enrich",
    "manage_ilm",
    "manage_index_templates",
    "manage_ingest_pipelines",
    "manage_logstash_pipelines",
    "manage_ml",
    "manage_oidc",
    "manage_own_api_key",
    "manage_pipeline",
    "manage_rollup",
    "manage_saml",
    "manage_security",
    "manage_slm",
    "manage_token",
    "manage_transform",
    "manage_watcher",
    "monitor",
    "monitor_data_frame_transforms",
    "monitor_ml",
    "monitor_rollup",
    "monitor_snapshot",
    "monitor_transform",
    "monitor_watcher",
    "none",
    "read_ccr",
    "read_ilm",
    "read_slm",
    "transport_client"
  ],
  "index" : [
    "all",
    "auto_configure",
    "create",
    "create_doc",
    "create_index",
    "delete",
    "delete_index",
    "index",
    "maintenance",
    "manage",
    "manage_follow_index",
    "manage_ilm",
    "manage_leader_index",
    "monitor",
    "none",
    "read",
    "read_cross_cluster",
    "view_index_metadata",
    "write"
  ]
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-get-role-mapping"></a>Get role mappings API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-role-mappings.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves role mappings.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-mapping-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_security/role_mapping</code><br></p>
<p><code class="literal">GET /_security/role_mapping/&lt;name&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-mapping-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-mapping-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p>Role mappings define which roles are assigned to each user. For more information,
see <a class="xref" href="authorization.html#mapping-roles" title="Mapping users and groups to roles">Mapping users and groups to roles</a>.</p>
<p>The role mapping APIs are generally the preferred way to manage role mappings
rather than using <a class="xref" href="authorization.html#mapping-roles-file" title="Using role mapping files">role mapping files</a>.
The get role mappings API cannot retrieve role mappings that are defined
in role mapping files.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-mapping-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(Optional, string) The distinct name that identifies the role mapping. The name
is used solely as an identifier to facilitate interaction via the API; it does
not affect the behavior of the mapping in any way. You can specify multiple
mapping names as a comma-separated list. If you do not specify this
parameter, the API returns information about all role mappings.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-mapping-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p>A successful call retrieves an object, where the keys are the
names of the request mappings, and the values are the JSON representation of
those mappings. For more information, see
<a class="xref" href="api-definitions.html#role-mapping-resources" title="Role mapping resources">Role mapping resources</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-mapping-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p>If there is no mapping with the requested name, the
response will have status code <code class="literal">404</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-mapping-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-role-mappings.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example retrieves information about the <code class="literal">mapping1</code> role mapping:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/role_mapping/mapping1</pre>
</div>
<div class="console_widget" data-snippet="snippets/2277.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "mapping1": {
    "enabled": true,
    "roles": [
      "user"
    ],
    "rules": {
      "field": {
        "username": "*"
      }
    },
    "metadata": {}
  }
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-get-role"></a>Get roles API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-roles.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves roles in the native realm.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-roles.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_security/role</code><br></p>
<p><code class="literal">GET /_security/role/&lt;name&gt;</code><br></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-roles.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster
privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-roles.asciidoc">edit</a></h3>
</div></div></div>
<p>The role management APIs are generally the preferred way to manage roles, rather than using
<a class="xref" href="authorization.html#roles-management-file" title="File-based role management">file-based role management</a>. The get roles
API cannot retrieve roles that are defined in roles files.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-roles.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(Optional, string) The name of the role. You can specify multiple roles as a
comma-separated list. If you do not specify this parameter, the API
returns information about all roles.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-roles.asciidoc">edit</a></h3>
</div></div></div>
<p>A successful call returns an array of roles with the JSON representation of the
role.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-roles.asciidoc">edit</a></h3>
</div></div></div>
<p>If the role is not defined in the native realm, the request returns 404.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-role-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-roles.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example retrieves information about the <code class="literal">my_admin_role</code> role in
the native realm:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/role/my_admin_role</pre>
</div>
<div class="console_widget" data-snippet="snippets/2278.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "my_admin_role": {
    "cluster" : [ "all" ],
    "indices" : [
      {
        "names" : [ "index1", "index2" ],
        "privileges" : [ "all" ],
        "allow_restricted_indices" : false,
        "field_security" : {
          "grant" : [ "title", "body" ]}
      }
    ],
    "applications" : [ ],
    "run_as" : [ "other_user" ],
    "metadata" : {
      "version" : 1
    },
    "transient_metadata": {
      "enabled": true
    }
  }
}</pre>
</div>
<p>To retrieve all roles, omit the role name:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/role</pre>
</div>
<div class="console_widget" data-snippet="snippets/2279.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-get-token"></a>Get token API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-tokens.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Creates a bearer token for access without requiring basic authentication.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-token-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-tokens.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/oauth2/token</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-token-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-tokens.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have the <code class="literal">manage_token</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-token-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-tokens.asciidoc">edit</a></h3>
</div></div></div>
<p>The tokens are created by the Elasticsearch Token Service, which is automatically enabled
when you configure TLS on the HTTP interface. See <a class="xref" href="encrypting-communications.html#tls-http" title="Encrypting HTTP client communications">Encrypting HTTP client communications</a>. Alternatively,
you can explicitly enable the <code class="literal">xpack.security.authc.token.enabled</code> setting. When
you are running in production mode, a bootstrap check prevents you from enabling
the token service unless you also enable TLS on the HTTP interface.</p>
<p>The get token API takes the same parameters as a typical OAuth 2.0 token API
except for the use of a JSON request body.</p>
<p>A successful get token API call returns a JSON structure that contains the access
token, the amount of time (seconds) that the token expires in, the type, and the
scope if available.</p>
<p>The tokens returned by the get token API have a finite period of time for which
they are valid and after that time period, they can no longer be used. That time
period is defined by the <code class="literal">xpack.security.authc.token.timeout</code> setting. For more
information, see <a class="xref" href="settings.html#token-service-settings" title="Token service settings">Token service settings</a>.</p>
<p>If you want to invalidate a token immediately, you can do so by using the
<a class="xref" href="security-api.html#security-api-invalidate-token" title="Invalidate token API">invalidate token API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-token-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-tokens.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the body of a POST request and
pertain to creating a token:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">grant_type</code>
</span>
</dt>
<dd>
<p>
(Required, string) The type of grant.
Supported grant types are: <code class="literal">password</code>, <code class="literal">_kerberos</code>,
<code class="literal">client_credentials</code> and <code class="literal">refresh_token</code>.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">client_credentials</code>
</span>
</dt>
<dd>
This grant type implements the Client Credentials Grant of OAuth2. It is geared
for machine to machine communication and is not suitable or designed for the
self-service user creation of tokens. It generates only access tokens that
cannot be refreshed. The premise is that the entity that uses
<code class="literal">client_credentials</code> has constant access to a set of (client, not end-user)
credentials and can authenticate itself at will.
</dd>
<dt>
<span class="term">
<code class="literal">_kerberos</code>
</span>
</dt>
<dd>
This grant type is supported internally and implements SPNEGO based Kerberos
support. The <code class="literal">_kerberos</code> grant type may change from version to version.
</dd>
<dt>
<span class="term">
<code class="literal">password</code>
</span>
</dt>
<dd>
This grant type implements the Resource Owner Password Credentials Grant of
OAuth2. In this grant, a trusted client exchanges the end user&#8217;s credentials
for an access token and (possibly) a refresh token. The request needs to be made
by an authenticated user but happens <em>on behalf</em> of another authenticated user
(the one whose credentials are passed as request parameters). This grant type is
not suitable or designed for the self-service user creation of tokens.
</dd>
<dt>
<span class="term">
<code class="literal">refresh_token</code>
</span>
</dt>
<dd>
This grant type implements the Refresh Token Grant of OAuth2.
In this grant a user exchanges a previously issued refresh token for a new access token and a new refresh token.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">password</code>
</span>
</dt>
<dd>
(Optional<sup>*</sup>, string) The user&#8217;s password. If you specify the <code class="literal">password</code> grant type, this
parameter is required. This parameter is not valid with any other supported
grant type.
</dd>
<dt>
<span class="term">
<code class="literal">kerberos_ticket</code>
</span>
</dt>
<dd>
(Optional<sup>*</sup>, string) The base64 encoded kerberos ticket. If you specify the
<code class="literal">_kerberos</code> grant type, this parameter is required. This parameter is not valid
with any other supported grant type.
</dd>
<dt>
<span class="term">
<code class="literal">refresh_token</code>
</span>
</dt>
<dd>
(Optional<sup>*</sup>, string) The string that was returned when you created the token,
which enables you to extend its life. If you specify the <code class="literal">refresh_token</code> grant
type, this parameter is required. This parameter is not valid with any other
supported grant type.
</dd>
<dt>
<span class="term">
<code class="literal">scope</code>
</span>
</dt>
<dd>
(Optional, string) The scope of the token. Currently tokens are only issued for a scope of
<code class="literal">FULL</code> regardless of the value sent with the request.
</dd>
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Optional<sup>*</sup>, string) The username that identifies the user. If you specify the <code class="literal">password</code>
grant type, this parameter is required. This parameter is not valid with any
other supported grant type.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-token-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-tokens.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example obtains a token using the <code class="literal">client_credentials</code> grant type,
which simply creates a token as the authenticated user:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oauth2/token
{
  "grant_type" : "client_credentials"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2280.console"></div>
<p>The following example output contains the access token, the amount of time (in
seconds) that the token expires in, and the type:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "access_token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
  "type" : "Bearer",
  "expires_in" : 1200
}</pre>
</div>
<p>The token returned by this API can be used by sending a request with a
<code class="literal">Authorization</code> header with a value having the prefix <code class="literal">Bearer ` followed
by the value of the `access_token</code>.</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">curl -H "Authorization: Bearer dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==" http://localhost:9200/_cluster/health</pre>
</div>
<p>The following example obtains a token for the <code class="literal">test_admin</code> user using the
<code class="literal">password</code> grant type:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oauth2/token
{
  "grant_type" : "password",
  "username" : "test_admin",
  "password" : "x-pack-test-password"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2281.console"></div>
<p>The following example output contains the access token, the amount of time (in
seconds) that the token expires in, the type, and the refresh token:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "access_token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
  "type" : "Bearer",
  "expires_in" : 1200,
  "refresh_token": "vLBPvmAB6KvwvJZr27cS"
}</pre>
</div>
<p><a id="security-api-refresh-token"></a>To extend the life of an existing token obtained using the <code class="literal">password</code> grant type,
you can call the API again with the refresh token within 24 hours of the token&#8217;s
creation. For example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oauth2/token
{
  "grant_type": "refresh_token",
  "refresh_token": "vLBPvmAB6KvwvJZr27cS"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2282.console"></div>
<p>The API will return a new token and refresh token. Each refresh token may only
be used one time.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "access_token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
  "type" : "Bearer",
  "expires_in" : 1200,
  "refresh_token": "vLBPvmAB6KvwvJZr27cS"
}</pre>
</div>
<p>The following example obtains a access token and refresh token using the <code class="literal">kerberos</code> grant type,
which simply creates a token in exchange for the base64 encoded kerberos ticket:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">POST /_security/oauth2/token
{
  "grant_type" : "_kerberos",
  "kerberos_ticket" : "YIIB6wYJKoZIhvcSAQICAQBuggHaMIIB1qADAgEFoQMCAQ6iBtaDcp4cdMODwOsIvmvdX//sye8NDJZ8Gstabor3MOGryBWyaJ1VxI4WBVZaSn1WnzE06Xy2"
}</pre>
</div>
<p>The API will return a new token and refresh token if kerberos authentication is successful.
Each refresh token may only be used one time. When the mutual authentication is requested in the Spnego GSS context,
 a base64 encoded token will be returned by the server in the <code class="literal">kerberos_authentication_response_token</code>
 for clients to consume and finalize the authentication.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "access_token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
  "type" : "Bearer",
  "expires_in" : 1200,
  "refresh_token": "vLBPvmAB6KvwvJZr27cS"
  "kerberos_authentication_response_token": "YIIB6wYJKoZIhvcSAQICAQBuggHaMIIB1qADAg"
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-get-user"></a>Get users API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-users.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Retrieves information about users in the native realm and built-in users.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-user-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-users.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_security/user</code><br></p>
<p><code class="literal">GET /_security/user/&lt;username&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-user-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-user-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-users.asciidoc">edit</a></h3>
</div></div></div>
<p>For more information about the native realm, see
<a class="xref" href="setting-up-authentication.html#realms" title="Realms">Realms</a> and <a class="xref" href="setting-up-authentication.html#native-realm" title="Native user authentication">Native user authentication</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-user-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-users.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Optional, string) An identifier for the user. You can specify multiple
usernames as a comma-separated list. If you omit this parameter, the API
retrieves information about all users.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-user-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-users.asciidoc">edit</a></h3>
</div></div></div>
<p>A successful call returns an array of users with the JSON representation of the
users. Note that user passwords are not included.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-user-response-codes"></a>Response codes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-users.asciidoc">edit</a></h3>
</div></div></div>
<p>If the user is not defined in the <code class="literal">native</code> realm, the request 404s.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-get-user-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/get-users.asciidoc">edit</a></h3>
</div></div></div>
<p>To retrieve a native user, submit a GET request to the <code class="literal">/_security/user/&lt;username&gt;</code>
endpoint:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/user/jacknich</pre>
</div>
<div class="console_widget" data-snippet="snippets/2283.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "jacknich": {
    "username": "jacknich",
    "roles": [
      "admin", "other_role1"
    ],
    "full_name": "Jack Nicholson",
    "email": "jacknich@example.com",
    "metadata": { "intelligence" : 7 },
    "enabled": true
  }
}</pre>
</div>
<p>Omit the username to retrieve all users:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/user</pre>
</div>
<div class="console_widget" data-snippet="snippets/2284.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-grant-api-key"></a>Grant API key API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/grant-api-keys.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Creates an API key on behalf of another user.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-grant-api-key-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/grant-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/api_key/grant</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-grant-api-key-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/grant-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have the <code class="literal">grant_api_key</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-grant-api-key-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/grant-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>This API is similar to <a class="xref" href="security-api.html#security-api-create-api-key" title="Create API key API">Create API keys</a>, however it creates the
API key for a user that is different than the user that runs the API.</p>
<p>The caller must have authentication credentials (either an access token, or a username and password) for the user on whose behalf the API key will be created. It is not possible to use this API to create an API key without that user&#8217;s credentials.</p>
<p>This API is intended be used by applications that need to create and manage API keys for end users, but cannot guarantee that those users have permission to create API keys on their own behalf (see <a class="xref" href="security-api.html#security-api-create-api-key-prereqs" title="Prerequisites">Prerequisites</a>).
The API keys are created by the Elasticsearch API key service, which is automatically
enabled when you configure TLS on the HTTP interface. See <a class="xref" href="encrypting-communications.html#tls-http" title="Encrypting HTTP client communications">Encrypting HTTP client communications</a>.
Alternatively, you can explicitly enable the
<code class="literal">xpack.security.authc.api_key.enabled</code> setting. When you are running in
production mode, a bootstrap check prevents you from enabling the API key
service unless you also enable TLS on the HTTP interface.</p>
<p>A successful grant API key API call returns a JSON structure that contains the
API key, its unique id, and its name. If applicable, it also returns expiration
information for the API key in milliseconds.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, API keys never expire. You can specify expiration information
when you create the API keys.</p>
</div>
</div>
<p>See <a class="xref" href="settings.html#api-key-service-settings" title="API key service settings">API key service settings</a> for configuration settings related to API key
service.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-grant-api-key-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/grant-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the body of a POST request:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">access_token</code>
</span>
</dt>
<dd>
(Required*, string)
The user&#8217;s access token. If you specify the <code class="literal">access_token</code> grant type, this
parameter is required. It is not valid with other grant types.
</dd>
<dt>
<span class="term">
<code class="literal">api_key</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Defines the API key.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">expiration</code>
</span>
</dt>
<dd>
(Optional, string) Expiration time for the API key. By default, API keys never
expire.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(Required, string) Specifies the name for this API key.
</dd>
<dt>
<span class="term">
<code class="literal">role_descriptors</code>
</span>
</dt>
<dd>
(Optional, array-of-role-descriptor) An array of role descriptors for this API
key. This parameter is optional. When it is not specified or is an empty array,
the API key has a point in time snapshot of permissions of the specified user or
access token. If you supply role descriptors, the resultant permissions are an
intersection of API keys permissions and the permissions of the user or access
token. The structure of role descriptor is the same as the request for create
role API. For more details, see <a class="xref" href="security-api.html#security-api-put-role" title="Create or update roles API">Create or update roles</a>.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">grant_type</code>
</span>
</dt>
<dd>
<p>
(Required, string)
The type of grant. Supported grant types are: <code class="literal">access_token</code>,<code class="literal">password</code>.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">access_token</code>
</span>
</dt>
<dd>
(Required*, string)
In this type of grant, you must supply an access token that was created by the
Elasticsearch token service. For more information, see
<a class="xref" href="security-api.html#security-api-get-token" title="Get token API">Get token</a> and <a class="xref" href="encrypting-communications.html#tls-http" title="Encrypting HTTP client communications">Encrypting HTTP client communications</a>.
</dd>
<dt>
<span class="term">
<code class="literal">password</code>
</span>
</dt>
<dd>
In this type of grant, you must supply the user ID and password for which you
want to create the API key.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">password</code>
</span>
</dt>
<dd>
(Optional*, string)
The user&#8217;s password. If you specify the <code class="literal">password</code> grant type, this parameter is
required. It is not valid with other grant types.
</dd>
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Optional*, string)
The user name that identifies the user. If you specify the <code class="literal">password</code> grant type,
this parameter is required. It is not valid with other grant types.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-grant-api-key-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/grant-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/api_key/grant
{
  "grant_type": "password",
  "username" : "test_admin",
  "password" : "x-pack-test-password",
  "api_key" : {
    "name": "my-api-key",
    "expiration": "1d",
    "role_descriptors": {
      "role-a": {
        "cluster": ["all"],
        "index": [
          {
          "names": ["index-a*"],
          "privileges": ["read"]
          }
        ]
      },
      "role-b": {
        "cluster": ["all"],
        "index": [
          {
          "names": ["index-b*"],
          "privileges": ["all"]
          }
        ]
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2285.console"></div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-has-privileges"></a>Has privileges API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/has-privileges.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p><a id="security-api-has-privilege"></a>The <code class="literal">has_privileges</code> API allows you to determine whether the logged in user has
a specified list of privileges.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/has-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_security/user/_has_privileges</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/has-privileges.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
All users can use this API, but only to determine their own privileges.
To check the privileges of other users, you must use the run as feature. For
more information, see
<a class="xref" href="authorization.html#run-as-privilege" title="Submitting requests on behalf of other users">Submitting requests on behalf of other users</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/has-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>For a list of the privileges that you can specify in this API,
see <a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.</p>
<p>A successful call returns a JSON structure that shows whether each specified
privilege is assigned to the user.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/has-privileges.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">cluster</code>
</span>
</dt>
<dd>
(list) A list of the cluster privileges that you want to check.
</dd>
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">names</code>
</span>
</dt>
<dd>
(list) A list of indices.
</dd>
<dt>
<span class="term">
<code class="literal">allow_restricted_indices</code>
</span>
</dt>
<dd>
(Boolean) This needs to be set to <code class="literal">true</code> (default
is <code class="literal">false</code>) if using wildcards or regexps for patterns that cover restricted
indices. Implicitly, restricted indices do not match index patterns because
restricted indices usually have limited privileges and including them in
pattern tests would render most such tests <code class="literal">false</code>. If restricted indices are
explicitly included in the <code class="literal">names</code> list, privileges will be checked against
them regardless of the value of <code class="literal">allow_restricted_indices</code>.
</dd>
<dt>
<span class="term">
<code class="literal">privileges</code>
</span>
</dt>
<dd>
(list) A list of the privileges that you want to check for the
specified indices.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">application</code>
</span>
</dt>
<dd>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">application</code>
</span>
</dt>
<dd>
(string) The name of the application.
</dd>
<dt>
<span class="term">
<code class="literal">privileges</code>
</span>
</dt>
<dd>
(list) A list of the privileges that you want to check for the
specified resources. May be either application privilege names, or the names of
actions that are granted by those privileges
</dd>
<dt>
<span class="term">
<code class="literal">resources</code>
</span>
</dt>
<dd>
(list) A list of resource names against which the privileges
should be checked
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-has-privileges-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/has-privileges.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example checks whether the current user has a specific set of
cluster, index, and application privileges:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/user/_has_privileges
{
  "cluster": [ "monitor", "manage" ],
  "index" : [
    {
      "names": [ "suppliers", "products" ],
      "privileges": [ "read" ]
    },
    {
      "names": [ "inventory" ],
      "privileges" : [ "read", "write" ]
    }
  ],
  "application": [
    {
      "application": "inventory_manager",
      "privileges" : [ "read", "data:write/inventory" ],
      "resources" : [ "product/1852563" ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2286.console"></div>
<p>The following example output indicates which privileges the "rdeniro" user has:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "username": "rdeniro",
  "has_all_requested" : false,
  "cluster" : {
    "monitor" : true,
    "manage" : false
  },
  "index" : {
    "suppliers" : {
      "read" : true
    },
    "products" : {
      "read" : true
    },
    "inventory" : {
      "read" : true,
      "write" : false
    }
  },
  "application" : {
    "inventory_manager" : {
      "product/1852563" : {
        "read": false,
        "data:write/inventory": false
      }
    }
  }
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-invalidate-api-key"></a>Invalidate API key API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-api-keys.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Invalidates one or more API keys.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-api-key-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_security/api_key</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-api-key-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_api_key</code> cluster privilege.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-api-key-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>The API keys created by <a class="xref" href="security-api.html#security-api-create-api-key" title="Create API key API">create API Key</a> can be
invalidated using this API.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-api-key-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the body of a DELETE request and
pertain to invalidating api keys:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(Optional, string) An API key id. This parameter cannot be used when any of
<code class="literal">ids</code>, <code class="literal">name</code>, <code class="literal">realm_name</code> or <code class="literal">username</code> are used.
</dd>
<dt>
<span class="term">
<code class="literal">ids</code>
</span>
</dt>
<dd>
(Optional, array of string) A list of API key ids. This parameter cannot be used
when any of <code class="literal">id</code>, <code class="literal">name</code>, <code class="literal">realm_name</code>, <code class="literal">username</code> are used
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(Optional, string) An API key name. This parameter cannot be used with any of
<code class="literal">id</code>, <code class="literal">realm_name</code> or <code class="literal">username</code> are used.
</dd>
<dt>
<span class="term">
<code class="literal">realm_name</code>
</span>
</dt>
<dd>
(Optional, string) The name of an authentication realm. This parameter cannot be
used with either <code class="literal">id</code> or <code class="literal">name</code> or when <code class="literal">owner</code> flag is set to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Optional, string) The username of a user. This parameter cannot be used with
either <code class="literal">id</code> or <code class="literal">name</code> or when <code class="literal">owner</code> flag is set to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">owner</code>
</span>
</dt>
<dd>
(Optional, Boolean) A boolean flag that can be used to query API keys owned
by the currently authenticated user. Defaults to false.
The <em>realm_name</em> or <em>username</em> parameters cannot be specified when this
parameter is set to <em>true</em> as they are assumed to be the currently authenticated ones.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>At least one of "id", "name", "username" and "realm_name" must be specified
 if "owner" is "false" (default).</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-api-key-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>A successful call returns a JSON structure that contains the ids of the API keys
that were invalidated, the ids of the API keys that had already been invalidated,
and potentially a list of errors encountered while invalidating specific api
keys.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-api-key-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-api-keys.asciidoc">edit</a></h3>
</div></div></div>
<p>If you create an API key as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/api_key
{
  "name": "my-api-key"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2287.console"></div>
<p>A successful call returns a JSON structure that provides
API key information. For example:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "id":"VuaCfGcBCdbkQm-e5aOx",
  "name":"my-api-key",
  "api_key":"ui2lp2axTNmsyakw9tvNnw"
}</pre>
</div>
<p>The following example invalidates the API key identified by specified <code class="literal">id</code>
immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/api_key
{
  "id" : "VuaCfGcBCdbkQm-e5aOx"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2288.console"></div>
<p>The above request can also be performed using the <code class="literal">ids</code> field which takes
a list of API keys for bulk invalidation:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/api_key
{
  "ids" : [ "VuaCfGcBCdbkQm-e5aOx" ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2289.console"></div>
<p>The following example invalidates the API key identified by specified <code class="literal">name</code>
immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/api_key
{
  "name" : "my-api-key"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2290.console"></div>
<p>The following example invalidates all API keys for the <code class="literal">native1</code> realm
immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/api_key
{
  "realm_name" : "native1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2291.console"></div>
<p>The following example invalidates all API keys for the user <code class="literal">myuser</code> in all
realms immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/api_key
{
  "username" : "myuser"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2292.console"></div>
<p>The following example invalidates the API key identified by the specified <code class="literal">id</code> if
 it is owned by the currently authenticated user immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/api_key
{
  "id" : "VuaCfGcBCdbkQm-e5aOx",
  "owner" : "true"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2293.console"></div>
<p>The following example invalidates all API keys owned by the currently authenticated
 user immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/api_key
{
  "owner" : "true"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2294.console"></div>
<p>Finally, the following example invalidates all API keys for the user <code class="literal">myuser</code> in
 the <code class="literal">native1</code> realm immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/api_key
{
  "username" : "myuser",
  "realm_name" : "native1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2295.console"></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "invalidated_api_keys": [ <a id="CO703-1"></a><i class="conum" data-value="1"></i>
    "api-key-id-1"
  ],
  "previously_invalidated_api_keys": [ <a id="CO703-2"></a><i class="conum" data-value="2"></i>
    "api-key-id-2",
    "api-key-id-3"
  ],
  "error_count": 2, <a id="CO703-3"></a><i class="conum" data-value="3"></i>
  "error_details": [ <a id="CO703-4"></a><i class="conum" data-value="4"></i>
    {
      "type": "exception",
      "reason": "error occurred while invalidating api keys",
      "caused_by": {
        "type": "illegal_argument_exception",
        "reason": "invalid api key id"
      }
    },
    {
      "type": "exception",
      "reason": "error occurred while invalidating api keys",
      "caused_by": {
        "type": "illegal_argument_exception",
        "reason": "invalid api key id"
      }
    }
  ]
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO703-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The IDs of the API keys that were invalidated as part of this request.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO703-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The IDs of the API keys that were already invalidated.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO703-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of errors that were encountered when invalidating the API keys.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO703-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Details about these errors. This field is not present in the response when
<code class="literal">error_count</code> is 0.</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-invalidate-token"></a>Invalidate token API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-tokens.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Invalidates one or more access tokens or refresh tokens.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-token-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-tokens.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE /_security/oauth2/token</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-token-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-tokens.asciidoc">edit</a></h3>
</div></div></div>
<p>The access tokens returned by the <a class="xref" href="security-api.html#security-api-get-token" title="Get token API">get token API</a> have a
finite period of time for which they are valid and after that time period, they
can no longer be used. That time period is defined by the
<code class="literal">xpack.security.authc.token.timeout</code> setting. For more information, see
<a class="xref" href="settings.html#token-service-settings" title="Token service settings">Token service settings</a>.</p>
<p>The refresh tokens returned by the <a class="xref" href="security-api.html#security-api-get-token" title="Get token API">get token API</a> are
only valid for 24 hours. They can also be used exactly once.</p>
<p>If you want to invalidate one or more access or refresh tokens immediately, use
this invalidate token API.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-token-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-tokens.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the body of a DELETE request and
pertain to invalidating tokens:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">token</code>
</span>
</dt>
<dd>
(Optional, string) An access token. This parameter cannot be used any of
<code class="literal">refresh_token</code>, <code class="literal">realm_name</code> or <code class="literal">username</code> are used.
</dd>
<dt>
<span class="term">
<code class="literal">refresh_token</code>
</span>
</dt>
<dd>
(Optional, string) A refresh token. This parameter cannot be used any of
<code class="literal">refresh_token</code>, <code class="literal">realm_name</code> or <code class="literal">username</code> are used.
</dd>
<dt>
<span class="term">
<code class="literal">realm_name</code>
</span>
</dt>
<dd>
(Optional, string) The name of an authentication realm. This parameter cannot be
used with either <code class="literal">refresh_token</code> or <code class="literal">token</code>.
</dd>
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(Optional, string) The username of a user. This parameter cannot be used with
either <code class="literal">refresh_token</code> or <code class="literal">token</code>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>While all parameters are optional, at least one of them is required. More
specifically, either one of <code class="literal">token</code> or <code class="literal">refresh_token</code> parameters is required.
If none of these two are specified, then <code class="literal">realm_name</code> and/or <code class="literal">username</code> need to
be specified.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-token-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-tokens.asciidoc">edit</a></h3>
</div></div></div>
<p>A successful call returns a JSON structure that contains the number of tokens
that were invalidated, the number of tokens that had already been invalidated,
and potentially a list of errors encountered while invalidating specific tokens.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-invalidate-token-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/invalidate-tokens.asciidoc">edit</a></h3>
</div></div></div>
<p>For example, if you create a token using the <code class="literal">client_credentials</code> grant type as
follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oauth2/token
{
  "grant_type" : "client_credentials"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2296.console"></div>
<p>The get token API returns the following information about the access token:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "access_token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
  "type" : "Bearer",
  "expires_in" : 1200
}</pre>
</div>
<p>This access token can now be immediately invalidated, as shown in the following
example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/oauth2/token
{
  "token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ=="
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2297.console"></div>
<p>If you used the <code class="literal">password</code> grant type to obtain a token for a user, the response
might also contain a refresh token. For example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oauth2/token
{
  "grant_type" : "password",
  "username" : "test_admin",
  "password" : "x-pack-test-password"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2298.console"></div>
<p>The get token API returns the following information:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "access_token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
  "type" : "Bearer",
  "expires_in" : 1200,
  "refresh_token": "vLBPvmAB6KvwvJZr27cS"
}</pre>
</div>
<p>The refresh token can now also be immediately invalidated as shown
in the following example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/oauth2/token
{
  "refresh_token" : "vLBPvmAB6KvwvJZr27cS"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2299.console"></div>
<p>The following example invalidates all access tokens and refresh tokens for the
<code class="literal">saml1</code> realm immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/oauth2/token
{
  "realm_name" : "saml1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2300.console"></div>
<p>The following example invalidates all access tokens and refresh tokens for the
user <code class="literal">myuser</code> in all realms immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/oauth2/token
{
  "username" : "myuser"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2301.console"></div>
<p>Finally, the following example invalidates all access tokens and refresh tokens
for the user <code class="literal">myuser</code> in the <code class="literal">saml1</code> realm immediately:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">DELETE /_security/oauth2/token
{
  "username" : "myuser",
  "realm_name" : "saml1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2302.console"></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "invalidated_tokens":9, <a id="CO704-1"></a><i class="conum" data-value="1"></i>
  "previously_invalidated_tokens":15, <a id="CO704-2"></a><i class="conum" data-value="2"></i>
  "error_count":2, <a id="CO704-3"></a><i class="conum" data-value="3"></i>
  "error_details":[ <a id="CO704-4"></a><i class="conum" data-value="4"></i>
    {
      "type":"exception",
      "reason":"Elasticsearch exception [type=exception, reason=foo]",
      "caused_by":{
        "type":"exception",
        "reason":"Elasticsearch exception [type=illegal_argument_exception, reason=bar]"
      }
    },
    {
      "type":"exception",
      "reason":"Elasticsearch exception [type=exception, reason=boo]",
      "caused_by":{
        "type":"exception",
        "reason":"Elasticsearch exception [type=illegal_argument_exception, reason=far]"
      }
    }
  ]
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO704-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of the tokens that were invalidated as part of this request.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO704-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of tokens that were already invalidated.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO704-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of errors that were encountered when invalidating the tokens.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO704-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Details about these errors. This field is not present in the response when
<code class="literal">error_count</code> is 0.</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-oidc-prepare-authentication"></a>OpenID Connect prepare authentication API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-prepare-authentication-api.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Creates an oAuth 2.0 authentication request as a URL string based on the
configuration of the respective OpenID Connect authentication realm in Elasticsearch.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-prepare-authentication-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-prepare-authentication-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/oidc/prepare</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-prepare-authentication-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-prepare-authentication-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The response of this API is a URL pointing to the Authorization Endpoint of the
configured OpenID Connect Provider and can be used to redirect the browser of
the user in order to continue the authentication process.</p>
<p>Elasticsearch exposes all the necessary OpenID Connect related functionality via the
OpenID Connect APIs. These APIs are used internally by Kibana in order to provide
OpenID Connect based authentication, but can also be used by other, custom web
applications or other clients. See also
<a class="xref" href="security-api.html#security-api-oidc-authenticate" title="OpenID Connect authenticate API">OpenID Connect authenticate API</a>
and <a class="xref" href="security-api.html#security-api-oidc-logout" title="OpenID Connect logout API">OpenID Connect logout API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-prepare-authentication-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-prepare-authentication-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following parameters can be specified in the body of the request:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
  (Optional, string) The name of the OpenID Connect realm in Elasticsearch the configuration of which should
be used in order to generate the authentication request. Cannot be specified
when <code class="literal">iss</code> is specified. One of <code class="literal">realm</code>, <code class="literal">iss</code> is required.
</dd>
<dt>
<span class="term">
<code class="literal">state</code>
</span>
</dt>
<dd>
  (Optional, string) Value used to maintain state between the authentication request and the
response, typically used as a Cross-Site Request Forgery mitigation. If the
caller of the API doesn&#8217;t provide a value, Elasticsearch will generate one with
sufficient entropy itself and return it in the response.
</dd>
<dt>
<span class="term">
<code class="literal">nonce</code>
</span>
</dt>
<dd>
  (Optional, string) Value used to associate a Client session with an ID Token and to mitigate
replay attacks. If the caller of the API doesn&#8217;t provide a value, Elasticsearch will
generate one with sufficient entropy itself and return it in the response.
</dd>
<dt>
<span class="term">
<code class="literal">iss</code>
</span>
</dt>
<dd>
  (Optional, string) In the case of a 3rd Party initiated Single Sign On, this is the Issuer
Identifier for the OP that the RP is to send the Authentication Request to.
Cannot be specified when <code class="literal">realm</code> is specified. One of <code class="literal">realm</code>, <code class="literal">iss</code> is required.
</dd>
<dt>
<span class="term">
<code class="literal">login_hint</code>
</span>
</dt>
<dd>
  (Optional, string) In the case of a 3rd Party initiated Single Sign On, a string value to be
included in the authentication request, as the <code class="literal">login_hint</code> parameter. This
parameter is not valid when <code class="literal">realm</code> is specified
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-prepare-authentication-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-prepare-authentication-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example generates an authentication request for the OpenID Connect
Realm <code class="literal">oidc1</code>:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oidc/prepare
{
  "realm" : "oidc1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2303.console"></div>
<p>The following example output of the response contains the URI pointing to the Authorization Endpoint of the OpenID Connect Provider with all the parameters of
the Authentication Request, as HTTP GET parameters:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "redirect" : "http://127.0.0.1:8080/c2id-login?scope=openid&amp;response_type=id_token&amp;redirect_uri=https%3A%2F%2Fmy.fantastic.rp%2Fcb&amp;state=4dbrihtIAt3wBTwo6DxK-vdk-sSyDBV8Yf0AjdkdT5I&amp;nonce=WaBPH0KqPVdG5HHdSxPRjfoZbXMCicm5v1OiAj0DUFM&amp;client_id=elasticsearch-rp",
  "state" : "4dbrihtIAt3wBTwo6DxK-vdk-sSyDBV8Yf0AjdkdT5I",
  "nonce" : "WaBPH0KqPVdG5HHdSxPRjfoZbXMCicm5v1OiAj0DUFM"
}</pre>
</div>
<p>The following example generates an authentication request for the OpenID Connect
Realm <code class="literal">oidc1</code>, where the values for the state and the nonce have been generated
by the client:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oidc/prepare
{
  "realm" : "oidc1",
  "state" : "lGYK0EcSLjqH6pkT5EVZjC6eIW5YCGgywj2sxROO",
  "nonce" : "zOBXLJGUooRrbLbQk5YCcyC8AXw3iloynvluYhZ5"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2304.console"></div>
<p>The following example output of the response contains the URI pointing to the Authorization Endpoint of the OpenID Connect Provider with all the parameters of
the Authentication Request, as HTTP GET parameters:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "redirect" : "http://127.0.0.1:8080/c2id-login?scope=openid&amp;response_type=id_token&amp;redirect_uri=https%3A%2F%2Fmy.fantastic.rp%2Fcb&amp;state=lGYK0EcSLjqH6pkT5EVZjC6eIW5YCGgywj2sxROO&amp;nonce=zOBXLJGUooRrbLbQk5YCcyC8AXw3iloynvluYhZ5&amp;client_id=elasticsearch-rp",
  "state" : "lGYK0EcSLjqH6pkT5EVZjC6eIW5YCGgywj2sxROO",
  "nonce" : "zOBXLJGUooRrbLbQk5YCcyC8AXw3iloynvluYhZ5"
}</pre>
</div>
<p>The following example generates an authentication request for a 3rd party
initiated single sign on, specifying the issuer that should be used for matching
the appropriate OpenID Connect Authentication realm:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oidc/prepare
{
  "iss" : "http://127.0.0.1:8080",
  "login_hint": "this_is_an_opaque_string"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2305.console"></div>
<p>The following example output of the response contains the URI pointing to the Authorization Endpoint of the OpenID Connect Provider with all the parameters of
the Authentication Request, as HTTP GET parameters:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "redirect" : "http://127.0.0.1:8080/c2id-login?login_hint=this_is_an_opaque_string&amp;scope=openid&amp;response_type=id_token&amp;redirect_uri=https%3A%2F%2Fmy.fantastic.rp%2Fcb&amp;state=4dbrihtIAt3wBTwo6DxK-vdk-sSyDBV8Yf0AjdkdT5I&amp;nonce=WaBPH0KqPVdG5HHdSxPRjfoZbXMCicm5v1OiAj0DUFM&amp;client_id=elasticsearch-rp",
  "state" : "4dbrihtIAt3wBTwo6DxK-vdk-sSyDBV8Yf0AjdkdT5I",
  "nonce" : "WaBPH0KqPVdG5HHdSxPRjfoZbXMCicm5v1OiAj0DUFM"
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-oidc-authenticate"></a>OpenID Connect authenticate API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-authenticate-api.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Submits the response to an oAuth 2.0 authentication request for consumption from
Elasticsearch. Upon successful validation, Elasticsearch will respond with an Elasticsearch internal Access
Token and Refresh Token that can be subsequently used for authentication.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-authenticate-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-authenticate-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/oidc/authenticate</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-authenticate-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-authenticate-api.asciidoc">edit</a></h3>
</div></div></div>
<p>This API endpoint basically exchanges successful OpenID Connect Authentication
responses for Elasticsearch access and refresh tokens to be used for authentication.</p>
<p>Elasticsearch exposes all the necessary OpenID Connect related functionality via the
OpenID Connect APIs. These APIs are used internally by Kibana in order to provide
OpenID Connect based authentication, but can also be used by other, custom web
 applications or other clients. See also
<a class="xref" href="security-api.html#security-api-oidc-prepare-authentication" title="OpenID Connect prepare authentication API">OpenID Connect prepare authentication API</a>
and <a class="xref" href="security-api.html#security-api-oidc-logout" title="OpenID Connect logout API">OpenID Connect logout API</a></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-authenticate-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-authenticate-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">redirect_uri</code>
</span>
</dt>
<dd>
  (Required, string) The URL to which the OpenID Connect Provider redirected the User Agent in
response to an authentication request, after a successful authentication. This
URL is expected to be provided as-is (URL encoded), taken from the body of the
response or as the value of a <code class="literal">Location</code> header in the response from the OpenID
Connect Provider.
</dd>
<dt>
<span class="term">
<code class="literal">state</code>
</span>
</dt>
<dd>
  (Required, string) Used to maintain state between the authentication request and the
response. This value needs to be the same as the one that was provided to the
call to <code class="literal">/_security/oidc/prepare</code> earlier, or the one that was generated by Elasticsearch
and included in the response to that call.
</dd>
<dt>
<span class="term">
<code class="literal">nonce</code>
</span>
</dt>
<dd>
  (Required, string) Used to associate a Client session with an ID Token and to mitigate
replay attacks. This value needs to be the same as the one that was provided to
the call to <code class="literal">/_security/oidc/prepare</code> earlier, or the one that was generated by
Elasticsearch and included in the response to that call.
</dd>
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
  (Optional, string) Used to identify the name of the OpenID Connect realm that should
be used to authenticate this. Useful when multiple realms have been defined.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-authenticate-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-authenticate-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example request exchanges the response that was returned from the
OpenID Connect Provider after a successful authentication, for an Elasticsearch access
token and refresh token to be used in subsequent requests. This example is from
an authentication that uses the authorization code grant flow.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oidc/authenticate
{
  "redirect_uri" : "https://oidc-kibana.elastic.co:5603/api/security/oidc/callback?code=jtI3Ntt8v3_XvcLzCFGq&amp;state=4dbrihtIAt3wBTwo6DxK-vdk-sSyDBV8Yf0AjdkdT5I",
  "state" : "4dbrihtIAt3wBTwo6DxK-vdk-sSyDBV8Yf0AjdkdT5I",
  "nonce" : "WaBPH0KqPVdG5HHdSxPRjfoZbXMCicm5v1OiAj0DUFM",
  "realm" : "oidc1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2306.console"></div>
<p>The following example output contains the access token that was generated in
response, the amount of time (in seconds) that the token expires in, the type,
and the refresh token:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "access_token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
  "type" : "Bearer",
  "expires_in" : 1200,
  "refresh_token": "vLBPvmAB6KvwvJZr27cS"
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-oidc-logout"></a>OpenID Connect logout API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-logout-api.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Submits a request to invalidate a refresh token and an access token that was
generated as a response to a call to <code class="literal">/_security/oidc/authenticate</code>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-logout-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-logout-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/oidc/logout</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-logout-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-logout-api.asciidoc">edit</a></h3>
</div></div></div>
<p>If the OpenID Connect authentication realm in Elasticsearch is accordingly configured,
the response to this call will contain a URI pointing to the End Session
Endpoint of the OpenID Connect Provider in order to perform Single Logout.</p>
<p>Elasticsearch exposes all the necessary OpenID Connect related functionality via the
OpenID Connect APIs. These APIs are used internally by Kibana in order to provide
OpenID Connect based authentication, but can also be used by other, custom web
applications or other clients. See also
<a class="xref" href="security-api.html#security-api-oidc-authenticate" title="OpenID Connect authenticate API">OpenID Connect authenticate API</a>
and
<a class="xref" href="security-api.html#security-api-oidc-prepare-authentication" title="OpenID Connect prepare authentication API">OpenID Connect prepare authentication API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-logout-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-logout-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">access_token</code>
</span>
</dt>
<dd>
(Required, string) The value of the access token to be invalidated as part of the logout.
</dd>
<dt>
<span class="term">
<code class="literal">refresh_token</code>
</span>
</dt>
<dd>
(Optional, string) The value of the refresh token to be invalidated as part of the logout.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-oidc-logout-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/oidc-logout-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example performs logout</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/oidc/logout
{
  "token" : "dGhpcyBpcyBub3QgYSByZWFsIHRva2VuIGJ1dCBpdCBpcyBvbmx5IHRlc3QgZGF0YS4gZG8gbm90IHRyeSB0byByZWFkIHRva2VuIQ==",
  "refresh_token": "vLBPvmAB6KvwvJZr27cS"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2307.console"></div>
<p>The following example output of the response contains the URI pointing to the
End Session Endpoint of the OpenID Connect Provider with all the parameters of
the Logout Request, as HTTP GET parameters:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "redirect" : "https://op-provider.org/logout?id_token_hint=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c&amp;post_logout_redirect_uri=http%3A%2F%2Foidc-kibana.elastic.co%2Floggedout&amp;state=lGYK0EcSLjqH6pkT5EVZjC6eIW5YCGgywj2sxROO"
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-saml-prepare-authentication"></a>SAML prepare authentication API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-prepare-authentication-api.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Creates a SAML authentication request (<code class="literal">&lt;AuthnRequest&gt;</code>) as a URL string, based on the configuration of the respective SAML realm in Elasticsearch.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API is intended for use by custom web applications other than Kibana.
If you are using Kibana, see the <a class="xref" href="saml-guide.html" title="Configuring SAML single-sign-on on the Elastic Stack"><em>Configuring SAML single-sign-on on the Elastic Stack</em></a>.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-prepare-authentication-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-prepare-authentication-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/saml/prepare</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-prepare-authentication-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-prepare-authentication-api.asciidoc">edit</a></h3>
</div></div></div>
<p>This API returns a URL pointing to the SAML Identity
Provider. You can use the URL to redirect the browser of the user in order to
continue the authentication process. The URL includes a single parameter named <code class="literal">SAMLRequest</code>,
which contains a SAML Authentication request that is deflated and
Base64 encoded. If the configuration dictates that SAML authentication requests
should be signed, the URL has two extra parameters named <code class="literal">SigAlg</code> and
<code class="literal">Signature</code>. These parameters contain the algorithm used for the signature and
the signature value itself.
It also returns a random string that uniquely identifies this SAML Authentication request. The
caller of this API needs to store this identifier as it needs to used in a following step of
the authentication process (see <a class="xref" href="security-api.html#security-api-saml-authenticate" title="SAML authenticate API">SAML authenticate API</a>).</p>
<p>Elasticsearch exposes all the necessary SAML related functionality via the SAML APIs.
These APIs are used internally by Kibana in order to provide SAML based
authentication, but can also be used by other custom web applications or other
clients. See also <a class="xref" href="security-api.html#security-api-saml-authenticate" title="SAML authenticate API">SAML authenticate API</a>,
<a class="xref" href="security-api.html#security-api-saml-invalidate" title="SAML invalidate API">SAML invalidate API</a>, and
<a class="xref" href="security-api.html#security-api-saml-logout" title="SAML logout API">SAML logout API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-prepare-authentication-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-prepare-authentication-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">acs</code>
</span>
</dt>
<dd>
(Optional, string) The Assertion Consumer Service URL that matches the one of the SAML
realms in Elasticsearch. The realm is used to generate the authentication request.
You must specify either this parameter or the <code class="literal">realm</code> parameter.
</dd>
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
(Optional, string) The name of the SAML realm in Elasticsearch for which the configuration is
used to generate the authentication request. You must specify either this parameter or the <code class="literal">acs</code>
parameter.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-prepare-authentication-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-prepare-authentication-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(string) A unique identifier for the SAML Request to be stored by the caller
of the API.
</dd>
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
(string) The name of the Elasticsearch realm that was used to construct the
authentication request.
</dd>
<dt>
<span class="term">
<code class="literal">redirect</code>
</span>
</dt>
<dd>
(string) The URL to redirect the user to.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-prepare-authentication-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-prepare-authentication-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example generates a SAML authentication request for the SAML realm with name <code class="literal">saml1</code></p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/saml/prepare
{
  "realm" : "saml1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2308.console"></div>
<p>The following example generates a SAML authentication request for the SAML realm with an Assertion
Consuming Service URL matching `https://kibana.org/api/security/v1/saml</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/saml/prepare
{
  "acs" : "https://kibana.org/api/security/v1/saml"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2309.console"></div>
<p>This API returns the following response:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "redirect": "https://my-idp.org/login?SAMLRequest=fVJdc6IwFP0rmbwDgUKLGbFDtc462%2B06FX3Yl50rBJsKCZsbrPbXL6J22hdfk%2FNx7zl3eL%2BvK7ITBqVWCfVdRolQuS6k2iR0mU2dmN6Phgh1FTQ8be2rehH%2FWoGWdESF%2FPST0NYorgElcgW1QG5zvkh%2FPfHAZbwx2upcV5SkiMLYzmqsFba1MAthdjIXy5enhL5a23DPOyo6W7kGBa7cwhZ2gO7G8OiW%2BR400kORt0bag7fzezAlk24eqcD2OxxlsNN5O3MdsW9c6CZnbq7rntF4d3s0D7BaHTZhIWN52P%2BcjiuGRbDU6cdj%2BEjJbJLQv4N4ADdhxBiEZbQuWclY4Q8iABbCXczCdSiKMAC%2FgyO2YqbQgrIJDZg%2FcFjsMD%2Fzb3gUcBa5sR%2F9oWR%2BzuJBqlPG14Jbn0DIf2TZ3Jn%2FXmSUrC5ddQB6bob37uZrJdeF4dIDHV3iuhb70Ptq83kOz53ubDLXlcwPJK0q%2FT42AqxIaAkVCkqm2tRgr49yfJGFU%2FZQ3hy3QyuUpd7obPv97kb%2FAQ%3D%3D"}",
  "realm": "saml1",
  "id": "_989a34500a4f5bf0f00d195aa04a7804b4ed42a1"
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-saml-authenticate"></a>SAML authenticate API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-authenticate-api.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Submits a SAML <code class="literal">Response</code> message to Elasticsearch for consumption.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API is intended for use by custom web applications other than Kibana.
If you are using Kibana, see the <a class="xref" href="saml-guide.html" title="Configuring SAML single-sign-on on the Elastic Stack"><em>Configuring SAML single-sign-on on the Elastic Stack</em></a>.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-authenticate-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-authenticate-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/saml/authenticate</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-authenticate-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-authenticate-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The SAML message that is submitted can be:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
a response to a SAML authentication request that was previously created using the
<a class="xref" href="security-api.html#security-api-saml-prepare-authentication" title="SAML prepare authentication API">SAML prepare authentication API</a>.
</li>
<li class="listitem">
an unsolicited SAML message in the case of an IdP-initiated single sign-on (SSO) flow.
</li>
</ul>
</div>
<p>In either cases, the SAML message needs to be a base64 encoded XML document with a root
element of <code class="literal">&lt;Response&gt;</code></p>
<p>After successful validation, Elasticsearch responds with an
Elasticsearch internal access token and refresh token that can be subsequently used for authentication.
This API endpoint essentially exchanges SAML responses that
indicate successful authentication in the IdP for Elasticsearch access and refresh tokens,
which can be used for authentication against Elasticsearch.</p>
<p>Elasticsearch exposes all the necessary SAML related functionality via the SAML APIs.
These APIs are used internally by Kibana in order to provide SAML based
authentication, but can also be used by other, custom web applications or other
clients. See also
<a class="xref" href="security-api.html#security-api-saml-prepare-authentication" title="SAML prepare authentication API">SAML prepare authentication API</a>,
<a class="xref" href="security-api.html#security-api-saml-invalidate" title="SAML invalidate API">SAML invalidate API</a> and
<a class="xref" href="security-api.html#security-api-saml-logout" title="SAML logout API">SAML logout API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-authenticate-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-authenticate-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">content</code>
</span>
</dt>
<dd>
(Required, string) The SAML response as it was sent by the user&#8217;s browser, usually a
Base64 encoded XML document.
</dd>
<dt>
<span class="term">
<code class="literal">ids</code>
</span>
</dt>
<dd>
(Required, array) A json array with all the valid SAML Request Ids that the caller of
the API has for the current user.
</dd>
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
(Optional, string) The name of the realm that should authenticate the SAML response.
Useful in cases where many SAML realms are defined.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-authenticate-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-authenticate-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">access_token</code>
</span>
</dt>
<dd>
(string) The access token that was generated by Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(string) The authenticated user&#8217;s name.
</dd>
<dt>
<span class="term">
<code class="literal">expires_in</code>
</span>
</dt>
<dd>
(integer) The amount of time (in seconds) left until the token expires.
</dd>
<dt>
<span class="term">
<code class="literal">refresh_token</code>
</span>
</dt>
<dd>
(string) The refresh token that was generated by Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
(string) The name of the realm that the user was authenticated by.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-authenticate-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-authenticate-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example exchanges a SAML Response indicating a successful
authentication at the SAML IdP for an Elasticsearch access token and refresh token to be
used in subsequent requests:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/saml/authenticate
{
  "content" : "PHNhbWxwOlJlc3BvbnNlIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiIHhtbG5zOnNhbWw9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMD.....",
  "ids" : ["4fee3b046395c4e751011e97f8900b5273d56685"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2310.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "access_token" : "46ToAxZVaXVVZTVKOVF5YU04ZFJVUDVSZlV3",
  "username" : "Bearer",
  "expires_in" : 1200,
  "refresh_token": "mJdXLtmvTUSpoLwMvdBt_w",
  "realm": "saml1"
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-saml-logout"></a>SAML logout API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-logout-api.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Submits a request to invalidate an access token and refresh token.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API is intended for use by custom web applications other than Kibana.
If you are using Kibana, see the <a class="xref" href="saml-guide.html" title="Configuring SAML single-sign-on on the Elastic Stack"><em>Configuring SAML single-sign-on on the Elastic Stack</em></a>.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-logout-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-logout-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/saml/logout</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-logout-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-logout-api.asciidoc">edit</a></h3>
</div></div></div>
<p>This API invalidates the tokens that were generated for a user by the
<a class="xref" href="security-api.html#security-api-saml-authenticate" title="SAML authenticate API">SAML authenticate API</a>.</p>
<p>If the SAML realm in Elasticsearch is configured accordingly and the SAML IdP supports
this, the Elasticsearch response contains a URL to redirect the user to the IdP
that contains a SAML logout request (starting an SP-initiated SAML Single Logout).</p>
<p>Elasticsearch exposes all the necessary SAML related functionality via the SAML APIs.
These APIs are used internally by Kibana in order to provide SAML based
authentication, but can also be used by other custom web applications or other
clients. See also <a class="xref" href="security-api.html#security-api-saml-authenticate" title="SAML authenticate API">SAML authenticate API</a>,
<a class="xref" href="security-api.html#security-api-saml-prepare-authentication" title="SAML prepare authentication API">SAML prepare authentication API</a>,
and <a class="xref" href="security-api.html#security-api-saml-invalidate" title="SAML invalidate API">SAML invalidate API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-logout-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-logout-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">token</code>
</span>
</dt>
<dd>
(Required, string) The access token that was returned as a response to calling the
<a class="xref" href="security-api.html#security-api-saml-authenticate" title="SAML authenticate API">SAML authenticate API</a>. Alternatively, the most
recent token that was received after refreshing the original one by using a
<code class="literal">refresh_token</code>.
</dd>
<dt>
<span class="term">
<code class="literal">refresh_token</code>
</span>
</dt>
<dd>
(Optional, string) The refresh token that was returned as a response to calling the
<a class="xref" href="security-api.html#security-api-saml-authenticate" title="SAML authenticate API">SAML authenticate API</a>. Alternatively, the
most recent refresh token that was received after refreshing the original access token.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-logout-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-logout-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">redirect</code>
</span>
</dt>
<dd>
(string) A URL that contains a SAML logout request as a parameter. The user
can use this URL to be redirected back to the SAML IdP and to initiate Single
Logout.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-logout-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-logout-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example invalidates the pair of tokens that were generated by
calling the <a class="xref" href="security-api.html#security-api-saml-authenticate" title="SAML authenticate API">SAML authenticate API</a>
with a successful SAML response:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/saml/logout
{
  "token" : "46ToAxZVaXVVZTVKOVF5YU04ZFJVUDVSZlV3",
  "refresh_token" : "mJdXLtmvTUSpoLwMvdBt_w"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2311.console"></div>
<p>The API returns the following response:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "redirect" : "https://my-idp.org/logout/SAMLRequest=...."
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-saml-invalidate"></a>SAML invalidate API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-invalidate-api.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Submits a SAML LogoutRequest message to Elasticsearch for consumption.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API is intended for use by custom web applications other than Kibana.
If you are using Kibana, see the <a class="xref" href="saml-guide.html" title="Configuring SAML single-sign-on on the Elastic Stack"><em>Configuring SAML single-sign-on on the Elastic Stack</em></a>.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-invalidate-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-invalidate-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST /_security/saml/invalidate</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-invalidate-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-invalidate-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The logout request comes from the SAML IdP during an IdP initiated Single Logout.
The custom web application can use this API to have Elasticsearch process the <code class="literal">LogoutRequest</code>.
After successful validation of the request, Elasticsearch invalidates the access token
and refresh token that corresponds to that specific SAML principal and provides
a URL that contains a SAML LogoutResponse message, so that the user can be
redirected back to their IdP.</p>
<p>Elasticsearch exposes all the necessary SAML related functionality via the SAML APIs.
These APIs are used internally by Kibana in order to provide SAML based
authentication, but can also be used by other custom web applications or other
clients. See also <a class="xref" href="security-api.html#security-api-saml-authenticate" title="SAML authenticate API">SAML authenticate API</a>,
<a class="xref" href="security-api.html#security-api-saml-prepare-authentication" title="SAML prepare authentication API">SAML prepare authentication API</a>,
and <a class="xref" href="security-api.html#security-api-saml-logout" title="SAML logout API">SAML logout API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-invalidate-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-invalidate-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">acs</code>
</span>
</dt>
<dd>
(Optional, string) The Assertion Consumer Service URL that matches the one of the SAML
realm in Elasticsearch that should be used. You must specify either this parameter or the <code class="literal">realm</code> parameter.
</dd>
<dt>
<span class="term">
<code class="literal">queryString</code>
</span>
</dt>
<dd>
  (Required, string) The query part of the URL that the user was redirected to by the SAML
  IdP to initiate the Single Logout. This query should include a single
  parameter named <code class="literal">SAMLRequest</code> that contains a SAML logout request that is
  deflated and Base64 encoded. If the SAML IdP has signed the logout request,
  the URL should include two extra parameters named <code class="literal">SigAlg</code> and <code class="literal">Signature</code>
  that contain the algorithm used for the signature and the signature value itself.
In order for Elasticsearch to be able to verify the IdP&#8217;s signature, the value of the queryString field must be an exact match to the string provided by the browser.
The client application must not attempt to parse or process the string in any way.
</dd>
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
(Optional, string) The name of the SAML realm in Elasticsearch the configuration. You must specify
either this parameter or the <code class="literal">acs</code> parameter.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-invalidate-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-invalidate-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">invalidated</code>
</span>
</dt>
<dd>
(integer) The number of tokens that were invalidated as part of this logout.
</dd>
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
(string) The realm name of the SAML realm in Elasticsearch that authenticated the user.
</dd>
<dt>
<span class="term">
<code class="literal">redirect</code>
</span>
</dt>
<dd>
(string) A SAML logout response as a parameter so that the user can be
redirected back to the SAML IdP.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-saml-invalidate-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/saml-invalidate-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example invalidates all the tokens for realm <code class="literal">saml1</code> pertaining to
the user that is identified in the SAML Logout Request:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/saml/invalidate
{
  "queryString" : "SAMLRequest=nZFda4MwFIb%2FiuS%2BmviRpqFaClKQdbvo2g12M2KMraCJ9cRR9utnW4Wyi13sMie873MeznJ1aWrnS3VQGR0j4mLkKC1NUeljjA77zYyhVbIE0dR%2By7fmaHq7U%2BdegXWGpAZ%2B%2F4pR32luBFTAtWgUcCv56%2Fp5y30X87Yz1khTIycdgpUW9kY7WdsC9zxoXTvMvWuVV98YyMnSGH2SYE5pwALBIr9QKiwDGpW0oGVUznGeMyJZKFkQ4jBf5HnhUymjIhzCAL3KNFihbYx8TBYzzGaY7EnIyZwHzCWMfiDnbRIftkSjJr%2BFu0e9v%2B0EgOquRiiZjKpiVFp6j50T4WXoyNJ%2FEWC9fdqc1t%2F1%2B2F3aUpjzhPiXpqMz1%2FHSn4A&amp;SigAlg=http%3A%2F%2Fwww.w3.org%2F2001%2F04%2Fxmldsig-more%23rsa-sha256&amp;Signature=MsAYz2NFdovMG2mXf6TSpu5vlQQyEJAg%2B4KCwBqJTmrb3yGXKUtIgvjqf88eCAK32v3eN8vupjPC8LglYmke1ZnjK0%2FKxzkvSjTVA7mMQe2AQdKbkyC038zzRq%2FYHcjFDE%2Bz0qISwSHZY2NyLePmwU7SexEXnIz37jKC6NMEhus%3D",
  "realm" : "saml1"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2312.console"></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "redirect" : "https://my-idp.org/logout/SAMLResponse=....",
  "invalidated" : 2,
  "realm" : "saml1"
}</pre>
</div>
</div>

</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-ssl"></a>SSL certificate API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/ssl.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>The <code class="literal">certificates</code> API enables you to retrieve information about the X.509
certificates that are used to encrypt communications in your Elasticsearch cluster.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-ssl-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/ssl.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_ssl/certificates</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-ssl-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/ssl.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the security features are enabled, you must have <code class="literal">monitor</code> cluster
privileges to use this API. For more information, see
<a class="xref" href="authorization.html#security-privileges" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-ssl-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/ssl.asciidoc">edit</a></h3>
</div></div></div>
<p>For more information about how certificates are configured in conjunction with
Transport Layer Security (TLS), see
<a class="xref" href="encrypting-communications.html#ssl-tls" title="Setting up TLS on a cluster">Setting up TLS on a cluster</a>.</p>
<p>The API returns a list that includes certificates from all TLS contexts
including:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Settings for transport and HTTP interfaces
</li>
<li class="listitem">
TLS settings that are used within authentication realms
</li>
<li class="listitem">
TLS settings for remote monitoring exporters
</li>
</ul>
</div>
<p>The list includes certificates that are used for configuring trust, such as
those configured in the <code class="literal">xpack.security.transport.ssl.truststore</code> and
<code class="literal">xpack.security.transport.ssl.certificate_authorities</code> settings. It also
includes certificates that are used for configuring server identity, such as
<code class="literal">xpack.security.http.ssl.keystore</code> and
<code class="literal">xpack.security.http.ssl.certificate</code> settings.</p>
<p>The list does not include certificates that are sourced from the default SSL
context of the Java Runtime Environment (JRE), even if those certificates are in
use within Elasticsearch.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When a PKCS#11 token is configured as the truststore of the JRE, the API
will return all the certificates that are included in the PKCS#11 token
irrespectively to whether these are used in the Elasticsearch TLS configuration or not.</p>
</div>
</div>
<p>If Elasticsearch is configured to use a keystore or truststore, the API output
includes all certificates in that store, even though some of the certificates
might not be in active use within the cluster.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-ssl-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/ssl.asciidoc">edit</a></h3>
</div></div></div>
<p>The response is an array of objects, with each object representing a
single certificate. The fields in each object are:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">path</code>
</span>
</dt>
<dd>
(string) The path to the certificate, as configured in the
<code class="literal">elasticsearch.yml</code> file.
</dd>
<dt>
<span class="term">
<code class="literal">format</code>
</span>
</dt>
<dd>
(string) The format of the file. One of: <code class="literal">jks</code>, <code class="literal">PKCS12</code>, <code class="literal">PEM</code>.
</dd>
<dt>
<span class="term">
<code class="literal">alias</code>
</span>
</dt>
<dd>
(string) If the path refers to a container file (a jks keystore, or a
PKCS#12 file), the alias of the certificate. Otherwise, null.
</dd>
<dt>
<span class="term">
<code class="literal">subject_dn</code>
</span>
</dt>
<dd>
(string) The Distinguished Name of the certificate&#8217;s subject.
</dd>
<dt>
<span class="term">
<code class="literal">serial_number</code>
</span>
</dt>
<dd>
(string) The hexadecimal representation of the certificate&#8217;s
serial number.
</dd>
<dt>
<span class="term">
<code class="literal">has_private_key</code>
</span>
</dt>
<dd>
(Boolean) If Elasticsearch has access to the private key for this
certificate, this field has a value of <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">expiry</code>
</span>
</dt>
<dd>
(string) The ISO formatted date of the certificate&#8217;s expiry
(not-after) date.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-ssl-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/x-pack/docs/en/rest-api/security/ssl.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example provides information about the certificates on a single
node of Elasticsearch:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_ssl/certificates</pre>
</div>
<div class="console_widget" data-snippet="snippets/2313.console"></div>
<p>The API returns the following results:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">[
  {
    "path": "certs/elastic-certificates.p12",
    "format": "PKCS12",
    "alias": "instance",
    "subject_dn": "CN=Elastic Certificate Tool Autogenerated CA",
    "serial_number": "a20f0ee901e8f69dc633ff633e5cd5437cdb4137",
    "has_private_key": false,
    "expiry": "2021-01-15T20:42:49.000Z"
  },
  {
    "path": "certs/elastic-certificates.p12",
    "format": "PKCS12",
    "alias": "ca",
    "subject_dn": "CN=Elastic Certificate Tool Autogenerated CA",
    "serial_number": "a20f0ee901e8f69dc633ff633e5cd5437cdb4137",
    "has_private_key": false,
    "expiry": "2021-01-15T20:42:49.000Z"
  },
  {
    "path": "certs/elastic-certificates.p12",
    "format": "PKCS12",
    "alias": "instance",
    "subject_dn": "CN=instance",
    "serial_number": "fc1905e1494dc5230218d079c47a617088f84ce0",
    "has_private_key": true,
    "expiry": "2021-01-15T20:44:32.000Z"
  }
]</pre>
</div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="searchable-snapshots-apis.html">« Searchable snapshots APIs</a>
</span>
<span class="next">
<a href="snapshot-restore-apis.html">Snapshot and restore APIs »</a>
</span>
</div>
</div>
</body>
</html>
