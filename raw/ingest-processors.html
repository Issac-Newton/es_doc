<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Processors | Elasticsearch Guide | Elastic</title>
<meta class="elastic" name="content" content="Processors | Elasticsearch Guide">

<link rel="home" href="index.html" title="Elasticsearch Guide"/>
<link rel="up" href="ingest.html" title="Ingest node"/>
<link rel="prev" href="ingest-enriching-data.html" title="Enrich your data"/>
<link rel="next" href="search-your-data.html" title="Search your data"/>
<meta class="elastic" name="product_version" content=""/>
<meta class="elastic" name="product_name" content=""/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/"/>
<meta name="DC.subject" content=""/>
<meta name="DC.identifier" content=""/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ingest.html">Ingest node</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ingest-enriching-data.html">« Enrich your data</a>
</span>
<span class="next">
<a href="search-your-data.html">Search your data »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ingest-processors"></a>Processors<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/ingest-node.asciidoc">edit</a></h2>
</div></div></div>
<p>All processors are defined in the following way within a pipeline definition:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "PROCESSOR_NAME" : {
    ... processor configuration options ...
  }
}</pre>
</div>
<p>Each processor defines its own configuration parameters, but all processors have
the ability to declare <code class="literal">tag</code>, <code class="literal">on_failure</code> and <code class="literal">if</code> fields. These fields are optional.</p>
<p>A <code class="literal">tag</code> is simply a string identifier of the specific instantiation of a certain
processor in a pipeline. The <code class="literal">tag</code> field does not affect the processor&#8217;s behavior,
but is very useful for bookkeeping and tracing errors to specific processors.</p>
<p>The <code class="literal">if</code> field must contain a script that returns a boolean value. If the script evaluates to <code class="literal">true</code>
then the processor will be executed for the given document otherwise it will be skipped.
The <code class="literal">if</code> field takes an object with the script fields defined in <a class="xref" href="ingest-processors.html#script-processor" title="Script processor">script-options</a>
and accesses a read only version of the document via the same <code class="literal">ctx</code> variable used by scripts in the
<a class="xref" href="ingest-processors.html#script-processor" title="Script processor">Script</a>.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "set": {
    "if": "ctx.foo == 'someValue'",
    "field": "found",
    "value": true
  }
}</pre>
</div>
<p>See <a class="xref" href="ingest-conditionals.html" title="Conditional Execution in Pipelines"><em>Conditional Execution in Pipelines</em></a> to learn more about the <code class="literal">if</code> field and conditional execution.</p>
<p>See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a> to learn more about the <code class="literal">on_failure</code> field and error handling in pipelines.</p>
<p>The <a class="xref" href="cluster.html#cluster-nodes-info" title="Nodes info API">node info API</a> will provide a per node list of what processors are available.</p>
<p>Custom processors must be installed on all nodes. The put pipeline API will fail if a processor specified in a pipeline
doesn&#8217;t exist on all nodes. If you rely on custom processor plugins make sure to mark these plugins as mandatory by adding
<code class="literal">plugin.mandatory</code> setting to the <code class="literal">config/elasticsearch.yml</code> file, for example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">plugin.mandatory: ingest-attachment</pre>
</div>
<p>A node will not start if this plugin is not available.</p>
<p>The <a class="xref" href="cluster.html#cluster-nodes-stats" title="Nodes stats API">node stats API</a> can be used to fetch ingest usage statistics, globally and on a per
pipeline basis. Useful to find out which pipelines are used the most or spent the most time on preprocessing.</p>
<h3><a id="_ingest_processor_plugins"></a>Ingest Processor Plugins<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/ingest-node.asciidoc">edit</a></h3>
<p>Additional ingest processors can be implemented and installed as Elasticsearch <a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/intro.html" class="ulink" target="_top">plugins</a>.
See <a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/ingest.html" class="ulink" target="_top">Ingest plugins</a> for information about the available ingest plugins.</p>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="append-processor"></a>Append processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/append.asciidoc">edit</a></h2>
</div></div></div>

<p>Appends one or more values to an existing array if the field already exists and it is an array.
Converts a scalar to an array and appends one or more values to it if the field exists and it is a scalar.
Creates an array containing the provided values if the field doesn&#8217;t exist.
Accepts a single value or an array of values.</p>
<div class="table">
<a id="append-options"></a>
<p class="title"><strong>Table 3. Append Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Append Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be appended to. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">value</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The value to be appended. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">allow_duplicates</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>true</p></td>
<td align="left" valign="top"><p>If <code class="literal">false</code>, the processor does not append
values already present in the field.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "append": {
    "field": "tags",
    "value": ["production", "{{app}}", "{{owner}}"]
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="bytes-processor"></a>Bytes processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/bytes.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a human readable byte value (e.g. 1kb) to its value in bytes (e.g. 1024). If the field is an array of strings, all members of the array will be converted.</p>
<p>Supported human readable units are "b", "kb", "mb", "gb", "tb", "pb" case insensitive. An error will occur if
the field is not a supported format or resultant value exceeds 2^63.</p>
<div class="table">
<a id="bytes-options"></a>
<p class="title"><strong>Table 4. Bytes Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Bytes Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to convert</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "bytes": {
    "field": "file.size"
  }
}</pre>
</div>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ingest-circle-processor"></a>Circle processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/circle.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Converts circle definitions of shapes to regular polygons which approximate them.</p>
<div class="table">
<a id="circle-processor-options"></a>
<p class="title"><strong>Table 5. Circle Processor Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Circle Processor Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The string-valued field to trim whitespace from</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the polygon shape to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">error_distance</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The difference between the resulting inscribed distance from center to side and the circle&#8217;s radius (measured in meters for <code class="literal">geo_shape</code>, unit-less for <code class="literal">shape</code>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">shape_type</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>which field mapping type is to be used when processing the circle: <code class="literal">geo_shape</code> or <code class="literal">shape</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p><span class="image"><img src="images/spatial/error_distance.png" alt="error distance"></span></p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT circles
{
  "mappings": {
    "properties": {
      "circle": {
        "type": "geo_shape"
      }
    }
  }
}

PUT _ingest/pipeline/polygonize_circles
{
  "description": "translate circle to polygon",
  "processors": [
    {
      "circle": {
        "field": "circle",
        "error_distance": 28.0,
        "shape_type": "geo_shape"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/611.console"></div>
<p>Using the above pipeline, we can attempt to index a document into the <code class="literal">circles</code> index.
The circle can be represented as either a WKT circle or a GeoJSON circle. The resulting
polygon will be represented and indexed using the same format as the input circle. WKT will
be translated to a WKT polygon, and GeoJSON circles will be translated to GeoJSON polygons.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_example_circle_defined_in_well_known_text"></a>Example: Circle defined in Well Known Text<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/circle.asciidoc">edit</a></h3>
</div></div></div>
<p>In this example a circle defined in WKT format is indexed</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT circles/_doc/1?pipeline=polygonize_circles
{
  "circle": "CIRCLE (30 10 40)"
}

GET circles/_doc/1</pre>
</div>
<div class="console_widget" data-snippet="snippets/612.console"></div>
<p>The response from the above index request:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "circles",
  "_type": "_doc",
  "_id": "1",
  "_version": 1,
  "_seq_no": 22,
  "_primary_term": 1,
  "_source": {
    "circle": "POLYGON ((30.000365257263184 10.0, 30.000111397193788 10.00034284530941, 29.999706043744222 10.000213571721195, 29.999706043744222 9.999786428278805, 30.000111397193788 9.99965715469059, 30.000365257263184 10.0))"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_example_circle_defined_in_geojson"></a>Example: Circle defined in GeoJSON<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/circle.asciidoc">edit</a></h3>
</div></div></div>
<p>In this example a circle defined in GeoJSON format is indexed</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT circles/_doc/2?pipeline=polygonize_circles
{
  "circle": {
    "type": "circle",
    "radius": "40m",
    "coordinates": [30, 10]
  }
}

GET circles/_doc/2</pre>
</div>
<div class="console_widget" data-snippet="snippets/613.console"></div>
<p>The response from the above index request:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "circles",
  "_type": "_doc",
  "_id": "2",
  "_version": 1,
  "_seq_no": 22,
  "_primary_term": 1,
  "_source": {
    "circle": {
      "coordinates": [
        [
          [30.000365257263184, 10.0],
          [30.000111397193788, 10.00034284530941],
          [29.999706043744222, 10.000213571721195],
          [29.999706043744222, 9.999786428278805],
          [30.000111397193788, 9.99965715469059],
          [30.000365257263184, 10.0]
        ]
      ],
      "type": "Polygon"
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="circle-processor-notes"></a>Notes on Accuracy<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/circle.asciidoc">edit</a></h3>
</div></div></div>
<p>Accuracy of the polygon that represents the circle is defined as <code class="literal">error_distance</code>. The smaller this
difference is, the closer to a perfect circle the polygon is.</p>
<p>Below is a table that aims to help capture how the radius of the circle affects the resulting number of sides
of the polygon given different inputs.</p>
<p>The minimum number of sides is <code class="literal">4</code> and the maximum is <code class="literal">1000</code>.</p>
<div class="table">
<a id="circle-processor-accuracy"></a>
<p class="title"><strong>Table 6. Circle Processor Accuracy</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Circle Processor Accuracy">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">error_distance</th>
<th align="left" valign="top">radius in meters</th>
<th align="left" valign="top">number of sides of polygon</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>1.0</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>10.0</p></td>
<td align="left" valign="top"><p>14</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>100.0</p></td>
<td align="left" valign="top"><p>45</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>1000.0</p></td>
<td align="left" valign="top"><p>141</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>10000.0</p></td>
<td align="left" valign="top"><p>445</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.00</p></td>
<td align="left" valign="top"><p>100000.0</p></td>
<td align="left" valign="top"><p>1000</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="convert-processor"></a>Convert processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/convert.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a field in the currently ingested document to a different type, such as converting a string to an integer.
If the field value is an array, all members will be converted.</p>
<p>The supported types include: <code class="literal">integer</code>, <code class="literal">long</code>, <code class="literal">float</code>, <code class="literal">double</code>, <code class="literal">string</code>, <code class="literal">boolean</code>, and <code class="literal">auto</code>.</p>
<p>Specifying <code class="literal">boolean</code> will set the field to true if its string value is equal to <code class="literal">true</code> (ignore case), to
false if its string value is equal to <code class="literal">false</code> (ignore case), or it will throw an exception otherwise.</p>
<p>Specifying <code class="literal">auto</code> will attempt to convert the string-valued <code class="literal">field</code> into the closest non-string type.
For example, a field whose value is <code class="literal">"true"</code> will be converted to its respective boolean type: <code class="literal">true</code>. Do note
that float takes precedence of double in <code class="literal">auto</code>. A value of <code class="literal">"242.15"</code> will "automatically" be converted to
<code class="literal">242.15</code> of type <code class="literal">float</code>. If a provided field cannot be appropriately converted, the Convert Processor will
still process successfully and leave the field value as-is. In such a case, <code class="literal">target_field</code> will
still be updated with the unconverted field value.</p>
<div class="table">
<a id="convert-options"></a>
<p class="title"><strong>Table 7. Convert Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Convert Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field whose value is to be converted</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">type</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The type to convert the existing value to</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">PUT _ingest/pipeline/my-pipeline-id
{
  "description": "converts the content of the id field to an integer",
  "processors" : [
    {
      "convert" : {
        "field" : "id",
        "type": "integer"
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="csv-processor"></a>CSV processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/csv.asciidoc">edit</a></h2>
</div></div></div>

<p>Extracts fields from CSV line out of a single text field within a document. Any empty field in CSV will be skipped.</p>
<div class="table">
<a id="csv-options"></a>
<p class="title"><strong>Table 8. CSV Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="CSV Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to extract data from</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_fields</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The array of fields to assign extracted values to</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">separator</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>,</p></td>
<td align="left" valign="top"><p>Separator used in CSV, has to be single character string</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">quote</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>"</p></td>
<td align="left" valign="top"><p>Quote used in CSV, has to be single character string</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">trim</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Trim whitespaces in unquoted fields</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">empty_value</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Value used to fill empty fields, empty fields will be skipped if this is not provided.
                                             Empty field is one with no value (2 consecutive separators) or empty quotes (<code class="literal">""</code>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "csv": {
    "field": "my_field",
    "target_fields": ["field1", "field2"]
  }
}</pre>
</div>
<p>If the <code class="literal">trim</code> option is enabled then any whitespace in the beginning and in the end of each unquoted field will be trimmed.
For example with configuration above, a value of <code class="literal">A, B</code> will result in field <code class="literal">field2</code>
having value <code class="literal">{nbsp}B</code> (with space at the beginning). If <code class="literal">trim</code> is enabled <code class="literal">A, B</code> will result in field <code class="literal">field2</code>
having value <code class="literal">B</code> (no whitespace). Quoted fields will be left untouched.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="date-processor"></a>Date processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/date.asciidoc">edit</a></h2>
</div></div></div>

<p>Parses dates from fields, and then uses the date or timestamp as the timestamp for the document.
By default, the date processor adds the parsed date as a new field called <code class="literal">@timestamp</code>. You can specify a
different field by setting the <code class="literal">target_field</code> configuration parameter. Multiple date formats are supported
as part of the same date processor definition. They will be used sequentially to attempt parsing the date field,
in the same order they were defined as part of the processor definition.</p>
<div class="table">
<a id="date-options"></a>
<p class="title"><strong>Table 9. Date options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Date options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to get the date from.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>The field that will hold the parsed date.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">formats</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An array of the expected date formats. Can be a <a class="xref" href="mapping-params.html#mapping-date-format" title="format">java time pattern</a> or one of the following formats: ISO8601, UNIX, UNIX_MS, or TAI64N.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">timezone</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>UTC</p></td>
<td align="left" valign="top"><p>The timezone to use when parsing the date. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">locale</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>ENGLISH</p></td>
<td align="left" valign="top"><p>The locale to use when parsing the date, relevant when parsing month names or week days. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">output_format</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">yyyy-MM-dd'T'HH:mm:ss.SSSXXX</code></p></td>
<td align="left" valign="top"><p>The format to use when writing the date to <code class="literal">target_field</code>. Can be a <a class="xref" href="mapping-params.html#mapping-date-format" title="format">java time pattern</a> or one of the following formats: ISO8601, UNIX, UNIX_MS, or TAI64N.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example that adds the parsed date to the <code class="literal">timestamp</code> field based on the <code class="literal">initial_date</code> field:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "...",
  "processors" : [
    {
      "date" : {
        "field" : "initial_date",
        "target_field" : "timestamp",
        "formats" : ["dd/MM/yyyy HH:mm:ss"],
        "timezone" : "Europe/Amsterdam"
      }
    }
  ]
}</pre>
</div>
<p>The <code class="literal">timezone</code> and <code class="literal">locale</code> processor parameters are templated. This means that their values can be
extracted from fields within documents. The example below shows how to extract the locale/timezone
details from existing fields, <code class="literal">my_timezone</code> and <code class="literal">my_locale</code>, in the ingested document that contain
the timezone and locale values.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "...",
  "processors" : [
    {
      "date" : {
        "field" : "initial_date",
        "target_field" : "timestamp",
        "formats" : ["ISO8601"],
        "timezone" : "{{my_timezone}}",
        "locale" : "{{my_locale}}"
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="date-index-name-processor"></a>Date index name processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/date-index-name.asciidoc">edit</a></h2>
</div></div></div>

<p>The purpose of this processor is to point documents to the right time based index based
on a date or timestamp field in a document by using the <a class="xref" href="api-conventions.html#date-math-index-names" title="Date math support in index names">date math index name support</a>.</p>
<p>The processor sets the <code class="literal">_index</code> metadata field with a date math index name expression based on the provided index name
prefix, a date or timestamp field in the documents being processed and the provided date rounding.</p>
<p>First, this processor fetches the date or timestamp from a field in the document being processed. Optionally,
date formatting can be configured on how the field&#8217;s value should be parsed into a date. Then this date,
the provided index name prefix and the provided date rounding get formatted into a date math index name expression.
Also here optionally date formatting can be specified on how the date should be formatted into a date math index name
expression.</p>
<p>An example pipeline that points documents to a monthly index that starts with a <code class="literal">my-index-</code> prefix based on a
date in the <code class="literal">date1</code> field:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/monthlyindex
{
  "description": "monthly date-time index naming",
  "processors" : [
    {
      "date_index_name" : {
        "field" : "date1",
        "index_name_prefix" : "my-index-",
        "date_rounding" : "M"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/614.console"></div>
<p>Using that pipeline for an index request:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /my-index/_doc/1?pipeline=monthlyindex
{
  "date1" : "2016-04-25T12:02:01.789Z"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/615.console"></div>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "_index" : "my-index-2016-04-01",
  "_type" : "_doc",
  "_id" : "1",
  "_version" : 1,
  "result" : "created",
  "_shards" : {
    "total" : 2,
    "successful" : 1,
    "failed" : 0
  },
  "_seq_no" : 55,
  "_primary_term" : 1
}</pre>
</div>
<p>The above request will not index this document into the <code class="literal">my-index</code> index, but into the <code class="literal">my-index-2016-04-01</code> index because
it was rounded by month. This is because the date-index-name-processor overrides the <code class="literal">_index</code> property of the document.</p>
<p>To see the date-math value of the index supplied in the actual index request which resulted in the above document being
indexed into <code class="literal">my-index-2016-04-01</code> we can inspect the effects of the processor using a simulate request.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline" :
  {
    "description": "monthly date-time index naming",
    "processors" : [
      {
        "date_index_name" : {
          "field" : "date1",
          "index_name_prefix" : "my-index-",
          "date_rounding" : "M"
        }
      }
    ]
  },
  "docs": [
    {
      "_source": {
        "date1": "2016-04-25T12:02:01.789Z"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/616.console"></div>
<p>and the result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs" : [
    {
      "doc" : {
        "_id" : "_id",
        "_index" : "&lt;my-index-{2016-04-25||/M{yyyy-MM-dd|UTC}}&gt;",
        "_type" : "_doc",
        "_source" : {
          "date1" : "2016-04-25T12:02:01.789Z"
        },
        "_ingest" : {
          "timestamp" : "2016-11-08T19:43:03.850+0000"
        }
      }
    }
  ]
}</pre>
</div>
<p>The above example shows that <code class="literal">_index</code> was set to <code class="literal">&lt;my-index-{2016-04-25||/M{yyyy-MM-dd|UTC}}&gt;</code>. Elasticsearch
understands this to mean <code class="literal">2016-04-01</code> as is explained in the <a class="xref" href="api-conventions.html#date-math-index-names" title="Date math support in index names">date math index name documentation</a></p>
<div class="table">
<a id="date-index-name-options"></a>
<p class="title"><strong>Table 10. Date index name options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Date index name options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to get the date or timestamp from.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">index_name_prefix</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>A prefix of the index name to be prepended before the printed date. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">date_rounding</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>How to round the date when formatting the date into the index name. Valid values are: <code class="literal">y</code> (year), <code class="literal">M</code> (month), <code class="literal">w</code> (week), <code class="literal">d</code> (day), <code class="literal">h</code> (hour), <code class="literal">m</code> (minute) and <code class="literal">s</code> (second). Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">date_formats</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>yyyy-MM-dd'T'HH:mm:ss.SSSXX</p></td>
<td align="left" valign="top"><p>An array of the expected date formats for parsing dates / timestamps in the document being preprocessed. Can be a java time pattern or one of the following formats: ISO8601, UNIX, UNIX_MS, or TAI64N.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">timezone</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>UTC</p></td>
<td align="left" valign="top"><p>The timezone to use when parsing the date and when date math index supports resolves expressions into concrete index names.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">locale</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>ENGLISH</p></td>
<td align="left" valign="top"><p>The locale to use when parsing the date from the document being preprocessed, relevant when parsing month names or week days.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">index_name_format</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>yyyy-MM-dd</p></td>
<td align="left" valign="top"><p>The format to be used when printing the parsed date into the index name. A valid java time pattern is expected here. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="dissect-processor"></a>Dissect processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h2>
</div></div></div>

<p>Similar to the <a class="xref" href="ingest-processors.html#grok-processor" title="Grok processor">Grok Processor</a>, dissect also extracts structured fields out of a single text field
within a document.  However unlike the <a class="xref" href="ingest-processors.html#grok-processor" title="Grok processor">Grok Processor</a>, dissect does not use
<a href="https://en.wikipedia.org/wiki/Regular_expression" class="ulink" target="_top">Regular Expressions</a>. This allows dissect&#8217;s syntax to be simple and for
some cases faster than the <a class="xref" href="ingest-processors.html#grok-processor" title="Grok processor">Grok Processor</a>.</p>
<p>Dissect matches a single text field against a defined pattern.</p>
<p>For example the following pattern:</p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">%{clientip} %{ident} %{auth} [%{@timestamp}] \"%{verb} %{request} HTTP/%{httpversion}\" %{status} %{size}</pre>
</div>
<p>will match a log line of this format:</p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">1.2.3.4 - - [30/Apr/1998:22:00:52 +0000] \"GET /english/venues/cities/images/montpellier/18.gif HTTP/1.0\" 200 3171</pre>
</div>
<p>and result in a document with the following fields:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"doc": {
  "_index": "_index",
  "_type": "_type",
  "_id": "_id",
  "_source": {
    "request": "/english/venues/cities/images/montpellier/18.gif",
    "auth": "-",
    "ident": "-",
    "verb": "GET",
    "@timestamp": "30/Apr/1998:22:00:52 +0000",
    "size": "3171",
    "clientip": "1.2.3.4",
    "httpversion": "1.0",
    "status": "200"
  }
}</pre>
</div>
<p>A dissect pattern is defined by the parts of the string that will be discarded. In the example above the first part
to be discarded is a single space. Dissect finds this space, then assigns the value of <code class="literal">clientip</code> is everything up
until that space.
Later dissect matches the <code class="literal">[</code> and then <code class="literal">]</code> and then assigns <code class="literal">@timestamp</code> to everything in-between <code class="literal">[</code> and <code class="literal">]</code>.
Paying special attention the parts of the string to discard will help build successful dissect patterns.</p>
<p>Successful matches require all keys in a pattern to have a value. If any of the <code class="literal">%{keyname}</code> defined in the pattern do
not have a value, then an exception is thrown and may be handled by the <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines">on_failure</a> directive.
An empty key <code class="literal">%{}</code> or a <a class="xref" href="ingest-processors.html#dissect-modifier-named-skip-key">named skip key</a> can be used to match values, but exclude the value from
the final document. All matched values are represented as string data types. The <a class="xref" href="ingest-processors.html#convert-processor" title="Convert processor">convert processor</a>
may be used to convert to expected data type.</p>
<p>Dissect also supports <a class="xref" href="ingest-processors.html#dissect-key-modifiers" title="Dissect key modifiers">key modifiers</a> that can change dissect&#8217;s default
behavior. For example you can instruct dissect to ignore certain fields, append fields, skip over padding, etc.
See <a class="xref" href="ingest-processors.html#dissect-key-modifiers" title="Dissect key modifiers">below</a> for more information.</p>
<div class="table">
<a id="dissect-options"></a>
<p class="title"><strong>Table 11. Dissect Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Dissect Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to dissect</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">pattern</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The pattern to apply to the field</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">append_separator</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>"" (empty string)</p></td>
<td align="left" valign="top"><p>The character(s) that separate the appended fields.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "dissect": {
    "field": "message",
    "pattern" : "%{clientip} %{ident} %{auth} [%{@timestamp}] \"%{verb} %{request} HTTP/%{httpversion}\" %{status} %{size}"
   }
}</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dissect-key-modifiers"></a>Dissect key modifiers<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h3>
</div></div></div>
<p>Key modifiers can change the default behavior for dissection. Key modifiers may be found on the left or right
of the <code class="literal">%{keyname}</code> always inside the <code class="literal">%{</code> and <code class="literal">}</code>. For example <code class="literal">%{+keyname -&gt;}</code> has the append and right padding
modifiers.</p>
<div class="table">
<a id="dissect-key-modifiers-table"></a>
<p class="title"><strong>Table 12. Dissect Key Modifiers</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Dissect Key Modifiers">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
<col class="col_6"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Modifier</th>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Position</th>
<th align="left" valign="top">Example</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Details</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">-&gt;</code></p></td>
<td align="left" valign="top"><p>Skip right padding</p></td>
<td align="left" valign="top"><p>(far) right</p></td>
<td align="left" valign="top"><p><code class="literal">%{keyname1-&gt;}</code></p></td>
<td align="left" valign="top"><p>Skips any repeated characters to the right</p></td>
<td align="left" valign="top"><p><a class="xref" href="ingest-processors.html#dissect-modifier-skip-right-padding" title="Right padding modifier (-&gt;)">link</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">+</code></p></td>
<td align="left" valign="top"><p>Append</p></td>
<td align="left" valign="top"><p>left</p></td>
<td align="left" valign="top"><p><code class="literal">%{+keyname} %{+keyname}</code></p></td>
<td align="left" valign="top"><p>Appends two or more fields together</p></td>
<td align="left" valign="top"><p><a class="xref" href="ingest-processors.html#dissect-modifier-append-key">link</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">+</code> with <code class="literal">/n</code></p></td>
<td align="left" valign="top"><p>Append with order</p></td>
<td align="left" valign="top"><p>left and right</p></td>
<td align="left" valign="top"><p><code class="literal">%{+keyname/2} %{+keyname/1}</code></p></td>
<td align="left" valign="top"><p>Appends two or more fields together in the order specified</p></td>
<td align="left" valign="top"><p><a class="xref" href="ingest-processors.html#dissect-modifier-append-key-with-order">link</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">?</code></p></td>
<td align="left" valign="top"><p>Named skip key</p></td>
<td align="left" valign="top"><p>left</p></td>
<td align="left" valign="top"><p><code class="literal">%{?ignoreme}</code></p></td>
<td align="left" valign="top"><p>Skips the matched value in the output. Same behavior as <code class="literal">%{}</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="ingest-processors.html#dissect-modifier-named-skip-key">link</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">*</code> and <code class="literal">&amp;</code></p></td>
<td align="left" valign="top"><p>Reference keys</p></td>
<td align="left" valign="top"><p>left</p></td>
<td align="left" valign="top"><p><code class="literal">%{*r1} %{&amp;r1}</code></p></td>
<td align="left" valign="top"><p>Sets the output key as value of <code class="literal">*</code> and output value of <code class="literal">&amp;</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="ingest-processors.html#dissect-modifier-reference-keys">link</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="dissect-modifier-skip-right-padding"></a>Right padding modifier (<code class="literal">-&gt;</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p>The algorithm that performs the dissection is very strict in that it requires all characters in the pattern to match
the source string. For example, the pattern <code class="literal">%{fookey} %{barkey}</code> (1 space), will match the string "foo&#160;bar"
(1 space), but will not match the string "foo&#160;&#160;bar" (2 spaces) since the pattern has only 1 space and the
source string has 2 spaces.</p>
<p>The right padding modifier helps with this case. Adding the right padding modifier to the pattern <code class="literal">%{fookey-&gt;} %{barkey}</code>,
It will now will match "foo&#160;bar" (1 space) and "foo&#160;&#160;bar" (2 spaces)
and even "foo&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;bar" (10 spaces).</p>
<p>Use the right padding modifier to allow for repetition of the characters after a <code class="literal">%{keyname-&gt;}</code>.</p>
<p>The right padding modifier may be placed on any key with any other modifiers. It should always be the furthest right
modifier. For example: <code class="literal">%{+keyname/1-&gt;}</code> and <code class="literal">%{-&gt;}</code></p>
<p>Right padding modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">%{ts-&gt;} %{level}</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>1998-08-10T17:15:42,466&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;WARN</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
ts = 1998-08-10T17:15:42,466
</li>
<li class="listitem">
level = WARN
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<p>The right padding modifier may be used with an empty key to help skip unwanted data. For example, the same input string, but wrapped with brackets requires the use of an empty right padded key to achieve the same result.</p>
<p>Right padding modifier with empty key example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">[%{ts}]%{-&gt;}[%{level}]</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>[1998-08-10T17:15:42,466]&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;[WARN]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
ts = 1998-08-10T17:15:42,466
</li>
<li class="listitem">
level = WARN
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="append-modifier"></a>Append modifier (<code class="literal">+</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p><a id="dissect-modifier-append-key"></a>Dissect supports appending two or more results together for the output.
Values are appended left to right. An append separator can be specified.
In this example the append_separator is defined as a space.</p>
<p>Append modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">%{+name} %{+name} %{+name} %{+name}</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>john jacob jingleheimer schmidt</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
name = john jacob jingleheimer schmidt
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="append-order-modifier"></a>Append with order modifier (<code class="literal">+</code> and <code class="literal">/n</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p><a id="dissect-modifier-append-key-with-order"></a>Dissect supports appending two or more results together for the output.
Values are appended based on the order defined (<code class="literal">/n</code>). An append separator can be specified.
In this example the append_separator is defined as a comma.</p>
<p>Append with order modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">%{+name/2} %{+name/4} %{+name/3} %{+name/1}</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>john jacob jingleheimer schmidt</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
name = schmidt,john,jingleheimer,jacob
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="named-skip-key"></a>Named skip key (<code class="literal">?</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p><a id="dissect-modifier-named-skip-key"></a>Dissect supports ignoring matches in the final result. This can be done with an empty key <code class="literal">%{}</code>, but for readability
it may be desired to give that empty key a name.</p>
<p>Named skip key modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">%{clientip} %{?ident} %{?auth} [%{@timestamp}]</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>1.2.3.4 - - [30/Apr/1998:22:00:52 +0000]</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
clientip = 1.2.3.4
</li>
<li class="listitem">
@timestamp = 30/Apr/1998:22:00:52 +0000
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="reference-keys"></a>Reference keys (<code class="literal">*</code> and <code class="literal">&amp;</code>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/dissect.asciidoc">edit</a></h4>
</div></div></div>
<p><a id="dissect-modifier-reference-keys"></a>Dissect support using parsed values as the key/value pairings for the structured content. Imagine a system that
partially logs in key/value pairs. Reference keys allow you to maintain that key/value relationship.</p>
<p>Reference key modifier example</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Pattern</strong></span></p></td>
<td align="left" valign="top"><p><code class="literal">[%{ts}] [%{level}] %{*p1}:%{&amp;p1} %{*p2}:%{&amp;p2}</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Input</strong></span></p></td>
<td align="left" valign="top"><p>[2018-08-10T17:15:42,466] [ERR] ip:1.2.3.4 error:REFUSED</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Result</strong></span></p></td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
ts = 1998-08-10T17:15:42,466
</li>
<li class="listitem">
level = ERR
</li>
<li class="listitem">
ip = 1.2.3.4
</li>
<li class="listitem">
error = REFUSED
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="dot-expand-processor"></a>Dot expander processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/dot-expand.asciidoc">edit</a></h2>
</div></div></div>

<p>Expands a field with dots into an object field. This processor allows fields
with dots in the name to be accessible by other processors in the pipeline.
Otherwise these <a class="xref" href="accessing-data-in-pipelines.html" title="Accessing Data in Pipelines">fields</a> can&#8217;t be accessed by any processor.</p>
<div class="table">
<a id="dot-expander-options"></a>
<p class="title"><strong>Table 13. Dot Expand Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Dot Expand Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to expand into an object field</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">path</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field that contains the field to expand. Only required if the field to expand is part another object field, because the <code class="literal">field</code> option can only understand leaf fields.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "dot_expander": {
    "field": "foo.bar"
  }
}</pre>
</div>
<p>For example the dot expand processor would turn this document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo.bar" : "value"
}</pre>
</div>
<p>into:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo" : {
    "bar" : "value"
  }
}</pre>
</div>
<p>If there is already a <code class="literal">bar</code> field nested under <code class="literal">foo</code> then
this processor merges the <code class="literal">foo.bar</code> field into it. If the field is
a scalar value then it will turn that field into an array field.</p>
<p>For example, the following document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo.bar" : "value2",
  "foo" : {
    "bar" : "value1"
  }
}</pre>
</div>
<p>is transformed by the <code class="literal">dot_expander</code> processor into:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo" : {
    "bar" : ["value1", "value2"]
  }
}</pre>
</div>
<p>If any field outside of the leaf field conflicts with a pre-existing field of the same name,
then that field needs to be renamed first.</p>
<p>Consider the following document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foo": "value1",
  "foo.bar": "value2"
}</pre>
</div>
<p>Then the <code class="literal">foo</code> needs to be renamed first before the <code class="literal">dot_expander</code>
processor is applied. So in order for the <code class="literal">foo.bar</code> field to properly
be expanded into the <code class="literal">bar</code> field under the <code class="literal">foo</code> field the following
pipeline should be used:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "processors" : [
    {
      "rename" : {
        "field" : "foo",
        "target_field" : "foo.bar""
      }
    },
    {
      "dot_expander": {
        "field": "foo.bar"
      }
    }
  ]
}</pre>
</div>
<p>The reason for this is that Ingest doesn&#8217;t know how to automatically cast
a scalar field to an object field.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="drop-processor"></a>Drop processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/drop.asciidoc">edit</a></h2>
</div></div></div>

<p>Drops the document without raising any errors. This is useful to prevent the document from
getting indexed based on some condition.</p>
<div class="table">
<a id="drop-options"></a>
<p class="title"><strong>Table 14. Drop Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Drop Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "drop": {
    "if" : "ctx.network_name == 'Guest'"
  }
}</pre>
</div>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="enrich-processor"></a>Enrich processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/enrich.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>The <code class="literal">enrich</code> processor can enrich documents with data from another index.
See <a class="xref" href="ingest-enriching-data.html" title="Enrich your data">enrich data</a> section for more information about how to set this up.</p>
<div class="table">
<a id="enrich-options"></a>
<p class="title"><strong>Table 15. Enrich Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Enrich Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">policy_name</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The name of the enrich policy to use.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field in the input document that matches the policies match_field used to retrieve the enrichment data. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Field added to incoming documents to contain enrich data. This field contains both the <code class="literal">match_field</code> and <code class="literal">enrich_fields</code> specified in the <a class="xref" href="ingest-enriching-data.html#enrich-policy-definition" title="Enrich policy definition">enrich policy</a>. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">override</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>true</p></td>
<td align="left" valign="top"><p>If processor will update fields with pre-existing non-null-valued field. When set to <code class="literal">false</code>, such fields will not be touched.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">max_matches</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>The maximum number of matched documents to include under the configured target field. The <code class="literal">target_field</code> will be turned into a json array if <code class="literal">max_matches</code> is higher than 1, otherwise <code class="literal">target_field</code> will become a json object. In order to avoid documents getting too large, the maximum allowed value is 128.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">shape_relation</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">INTERSECTS</code></p></td>
<td align="left" valign="top"><p>A spatial relation operator used to match the <a class="xref" href="mapping-types.html#geo-shape" title="Geo-shape field type">geo_shape</a> of incoming documents to documents in the enrich index. This option is only used for <code class="literal">geo_match</code> enrich policy types. The <a class="xref" href="mapping-types.html#spatial-strategy" title="Spatial strategies">geo_shape strategy</a> mapping parameter determines which spatial relation operators are available. See <a class="xref" href="geo-queries.html#_spatial_relations" title="Spatial Relations">Spatial Relations</a> for operators and more information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="fail-processor"></a>Fail processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/fail.asciidoc">edit</a></h2>
</div></div></div>

<p>Raises an exception. This is useful for when
you expect a pipeline to fail and want to relay a specific message
to the requester.</p>
<div class="table">
<a id="fail-options"></a>
<p class="title"><strong>Table 16. Fail Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Fail Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">message</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The error message thrown by the processor. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "fail": {
    "if" : "ctx.tags.contains('production') != true",
    "message": "The production tag is not present, found tags: {{tags}}"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="foreach-processor"></a>Foreach processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/foreach.asciidoc">edit</a></h2>
</div></div></div>

<p>Processes elements in an array of unknown length.</p>
<p>All processors can operate on elements inside an array, but if all elements of an array need to
be processed in the same way, defining a processor for each element becomes cumbersome and tricky
because it is likely that the number of elements in an array is unknown. For this reason the <code class="literal">foreach</code>
processor exists. By specifying the field holding array elements and a processor that
defines what should happen to each element, array fields can easily be preprocessed.</p>
<p>A processor inside the foreach processor works in the array element context and puts that in the ingest metadata
under the <code class="literal">_ingest._value</code> key. If the array element is a json object it holds all immediate fields of that json object.
and if the nested object is a value is <code class="literal">_ingest._value</code> just holds that value. Note that if a processor prior to the
<code class="literal">foreach</code> processor used <code class="literal">_ingest._value</code> key then the specified value will not be available to the processor inside
the <code class="literal">foreach</code> processor. The <code class="literal">foreach</code> processor does restore the original value, so that value is available to processors
after the <code class="literal">foreach</code> processor.</p>
<p>Note that any other field from the document are accessible and modifiable like with all other processors. This processor
just puts the current array element being read into <code class="literal">_ingest._value</code> ingest metadata attribute, so that it may be
pre-processed.</p>
<p>If the <code class="literal">foreach</code> processor fails to process an element inside the array, and no <code class="literal">on_failure</code> processor has been specified,
then it aborts the execution and leaves the array unmodified.</p>
<div class="table">
<a id="foreach-options"></a>
<p class="title"><strong>Table 17. Foreach Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Foreach Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The array field</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">processor</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The processor to execute against each field</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Assume the following document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "values" : ["foo", "bar", "baz"]
}</pre>
</div>
<p>When this <code class="literal">foreach</code> processor operates on this sample document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foreach" : {
    "field" : "values",
    "processor" : {
      "uppercase" : {
        "field" : "_ingest._value"
      }
    }
  }
}</pre>
</div>
<p>Then the document will look like this after preprocessing:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "values" : ["FOO", "BAR", "BAZ"]
}</pre>
</div>
<p>Let&#8217;s take a look at another example:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "persons" : [
    {
      "id" : "1",
      "name" : "John Doe"
    },
    {
      "id" : "2",
      "name" : "Jane Doe"
    }
  ]
}</pre>
</div>
<p>In this case, the <code class="literal">id</code> field needs to be removed,
so the following <code class="literal">foreach</code> processor is used:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foreach" : {
    "field" : "persons",
    "processor" : {
      "remove" : {
        "field" : "_ingest._value.id"
      }
    }
  }
}</pre>
</div>
<p>After preprocessing the result is:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "persons" : [
    {
      "name" : "John Doe"
    },
    {
      "name" : "Jane Doe"
    }
  ]
}</pre>
</div>
<p>The wrapped processor can have a <code class="literal">on_failure</code> definition.
For example, the <code class="literal">id</code> field may not exist on all person objects.
Instead of failing the index request, you can use an <code class="literal">on_failure</code>
block to send the document to the <em>failure_index</em> index for later inspection:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "foreach" : {
    "field" : "persons",
    "processor" : {
      "remove" : {
        "field" : "_value.id",
        "on_failure" : [
          {
            "set" : {
              "field": "_index",
              "value": "failure_index"
            }
          }
        ]
      }
    }
  }
}</pre>
</div>
<p>In this example, if the <code class="literal">remove</code> processor does fail, then
the array elements that have been processed thus far will
be updated.</p>
<p>Another advanced example can be found in the <a href="https://www.elastic.co/guide/en/elasticsearch/plugins/7.10/ingest-attachment-with-arrays.html" class="ulink" target="_top">attachment processor documentation</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="geoip-processor"></a>GeoIP processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">geoip</code> processor adds information about the geographical location of IP addresses, based on data from the Maxmind databases.
This processor adds this information by default under the <code class="literal">geoip</code> field. The <code class="literal">geoip</code> processor can resolve both IPv4 and
IPv6 addresses.</p>
<p>The <code class="literal">ingest-geoip</code> module ships by default with the GeoLite2 City, GeoLite2 Country and GeoLite2 ASN GeoIP2 databases from Maxmind made available
under the CCA-ShareAlike 4.0 license. For more details see, <a href="http://dev.maxmind.com/geoip/geoip2/geolite2/" class="ulink" target="_top">http://dev.maxmind.com/geoip/geoip2/geolite2/</a></p>
<p>The <code class="literal">geoip</code> processor can run with other city, country and ASN GeoIP2 databases
from Maxmind. The database files must be copied into the <code class="literal">ingest-geoip</code> config
directory located at <code class="literal">$ES_CONFIG/ingest-geoip</code>. Custom database files must be
stored uncompressed and the extension must be <code class="literal">-City.mmdb</code>, <code class="literal">-Country.mmdb</code>, or
<code class="literal">-ASN.mmdb</code> to indicate the type of the database. These database files can not
have the same filename as any of the built-in database names. The
<code class="literal">database_file</code> processor option is used to specify the filename of the custom
database to use for the processor.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="using-ingest-geoip"></a>Using the <code class="literal">geoip</code> Processor in a Pipeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h3>
</div></div></div>
<div class="table">
<a id="ingest-geoip-options"></a>
<p class="title"><strong>Table 18. <code class="literal">geoip</code> options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="geoip options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to get the ip address from for the geographical lookup.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>geoip</p></td>
<td align="left" valign="top"><p>The field that will hold the geographical information looked up from the Maxmind database.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">database_file</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>GeoLite2-City.mmdb</p></td>
<td align="left" valign="top"><p>The database filename referring to a database the module ships with (GeoLite2-City.mmdb, GeoLite2-Country.mmdb, or GeoLite2-ASN.mmdb) or a custom database in the <code class="literal">ingest-geoip</code> config directory.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">properties</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>[<code class="literal">continent_name</code>, <code class="literal">country_iso_code</code>, <code class="literal">country_name</code>, <code class="literal">region_iso_code</code>, <code class="literal">region_name</code>, <code class="literal">city_name</code>, <code class="literal">location</code>] *</p></td>
<td align="left" valign="top"><p>Controls what properties are added to the <code class="literal">target_field</code> based on the geoip lookup.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">first_only</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> only first found geoip data will be returned, even if <code class="literal">field</code> contains array</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>*Depends on what is available in <code class="literal">database_file</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the GeoLite2 City database is used, then the following fields may be added under the <code class="literal">target_field</code>: <code class="literal">ip</code>,
<code class="literal">country_iso_code</code>, <code class="literal">country_name</code>, <code class="literal">continent_name</code>, <code class="literal">region_iso_code</code>, <code class="literal">region_name</code>, <code class="literal">city_name</code>, <code class="literal">timezone</code>, <code class="literal">latitude</code>, <code class="literal">longitude</code>
and <code class="literal">location</code>. The fields actually added depend on what has been found and which properties were configured in <code class="literal">properties</code>.
</li>
<li class="listitem">
If the GeoLite2 Country database is used, then the following fields may be added under the <code class="literal">target_field</code>: <code class="literal">ip</code>,
<code class="literal">country_iso_code</code>, <code class="literal">country_name</code> and <code class="literal">continent_name</code>. The fields actually added depend on what has been found and which properties
were configured in <code class="literal">properties</code>.
</li>
<li class="listitem">
If the GeoLite2 ASN database is used, then the following fields may be added under the <code class="literal">target_field</code>: <code class="literal">ip</code>,
<code class="literal">asn</code>, <code class="literal">organization_name</code> and <code class="literal">network</code>. The fields actually added depend on what has been found and which properties were configured
in <code class="literal">properties</code>.
</li>
</ul>
</div>
<p>Here is an example that uses the default city database and adds the geographical information to the <code class="literal">geoip</code> field based on the <code class="literal">ip</code> field:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/geoip
{
  "description" : "Add geoip info",
  "processors" : [
    {
      "geoip" : {
        "field" : "ip"
      }
    }
  ]
}
PUT my-index-00001/_doc/my_id?pipeline=geoip
{
  "ip": "8.8.8.8"
}
GET my-index-00001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/617.console"></div>
<p>Which returns:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "my-index-00001",
  "_type": "_doc",
  "_id": "my_id",
  "_version": 1,
  "_seq_no": 55,
  "_primary_term": 1,
  "_source": {
    "ip": "8.8.8.8",
    "geoip": {
      "continent_name": "North America",
      "country_name": "United States",
      "country_iso_code": "US",
      "location": { "lat": 37.751, "lon": -97.822 }
    }
  }
}</pre>
</div>
<p>Here is an example that uses the default country database and adds the
geographical information to the <code class="literal">geo</code> field based on the <code class="literal">ip</code> field. Note that
this database is included in the module. So this:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/geoip
{
  "description" : "Add geoip info",
  "processors" : [
    {
      "geoip" : {
        "field" : "ip",
        "target_field" : "geo",
        "database_file" : "GeoLite2-Country.mmdb"
      }
    }
  ]
}
PUT my-index-00001/_doc/my_id?pipeline=geoip
{
  "ip": "8.8.8.8"
}
GET my-index-00001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/618.console"></div>
<p>returns this:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "my-index-00001",
  "_type": "_doc",
  "_id": "my_id",
  "_version": 1,
  "_seq_no": 65,
  "_primary_term": 1,
  "_source": {
    "ip": "8.8.8.8",
    "geo": {
      "continent_name": "North America",
      "country_name": "United States",
      "country_iso_code": "US",
    }
  }
}</pre>
</div>
<p>Not all IP addresses find geo information from the database, When this
occurs, no <code class="literal">target_field</code> is inserted into the document.</p>
<p>Here is an example of what documents will be indexed as when information for "80.231.5.0"
cannot be found:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/geoip
{
  "description" : "Add geoip info",
  "processors" : [
    {
      "geoip" : {
        "field" : "ip"
      }
    }
  ]
}

PUT my-index-00001/_doc/my_id?pipeline=geoip
{
  "ip": "80.231.5.0"
}

GET my-index-00001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/619.console"></div>
<p>Which returns:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "_index" : "my-index-00001",
  "_type" : "_doc",
  "_id" : "my_id",
  "_version" : 1,
  "_seq_no" : 71,
  "_primary_term": 1,
  "found" : true,
  "_source" : {
    "ip" : "80.231.5.0"
  }
}</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ingest-geoip-mappings-note"></a>Recognizing Location as a Geopoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h4>
</div></div></div>
<p>Although this processor enriches your document with a <code class="literal">location</code> field containing
the estimated latitude and longitude of the IP address, this field will not be
indexed as a <a href="https://www.elastic.co/guide/en/elasticsearch/reference/7.10/geo-point.html" class="ulink" target="_top"><code class="literal">geo_point</code></a> type in Elasticsearch without explicitly defining it
as such in the mapping.</p>
<p>You can use the following mapping for the example index above:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT my_ip_locations
{
  "mappings": {
    "properties": {
      "geoip": {
        "properties": {
          "location": { "type": "geo_point" }
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/620.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ingest-geoip-settings"></a>Node Settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/geoip.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">geoip</code> processor supports the following setting:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ingest.geoip.cache_size</code>
</span>
</dt>
<dd>
The maximum number of results that should be cached. Defaults to <code class="literal">1000</code>.
</dd>
</dl>
</div>
<p>Note that these settings are node settings and apply to all <code class="literal">geoip</code> processors, i.e. there is one cache for all defined <code class="literal">geoip</code> processors.</p>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="grok-processor"></a>Grok processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/grok.asciidoc">edit</a></h2>
</div></div></div>

<p>Extracts structured fields out of a single text field within a document. You choose which field to
extract matched fields from, as well as the grok pattern you expect will match. A grok pattern is like a regular
expression that supports aliased expressions that can be reused.</p>
<p>This tool is perfect for syslog logs, apache and other webserver logs, mysql logs, and in general, any log format
that is generally written for humans and not computer consumption.
This processor comes packaged with many
<a href="https://github.com/elastic/elasticsearch/blob/7.10/libs/grok/src/main/resources/patterns" class="ulink" target="_top">reusable patterns</a>.</p>
<p>If you need help building patterns to match your logs, you will find the <a href="https://www.elastic.co/guide/en/kibana/7.10/xpack-grokdebugger.html" class="ulink" target="_top">Grok Debugger</a> tool quite useful! The Grok Debugger is an X-Pack feature under the Basic License and is therefore <span class="strong strong"><strong>free to use</strong></span>. The <a href="https://grokconstructor.appspot.com" class="ulink" target="_top">Grok Constructor</a> is also a useful tool.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="grok-basics"></a>Grok Basics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>Grok sits on top of regular expressions, so any regular expressions are valid in grok as well.
The regular expression library is Oniguruma, and you can see the full supported regexp syntax
<a href="https://github.com/kkos/oniguruma/blob/master/doc/RE" class="ulink" target="_top">on the Oniguruma site</a>.</p>
<p>Grok works by leveraging this regular expression language to allow naming existing patterns and combining them into more
complex patterns that match your fields.</p>
<p>The syntax for reusing a grok pattern comes in three forms: <code class="literal">%{SYNTAX:SEMANTIC}</code>, <code class="literal">%{SYNTAX}</code>, <code class="literal">%{SYNTAX:SEMANTIC:TYPE}</code>.</p>
<p>The <code class="literal">SYNTAX</code> is the name of the pattern that will match your text. For example, <code class="literal">3.44</code> will be matched by the <code class="literal">NUMBER</code>
pattern and <code class="literal">55.3.244.1</code> will be matched by the <code class="literal">IP</code> pattern. The syntax is how you match. <code class="literal">NUMBER</code> and <code class="literal">IP</code> are both
patterns that are provided within the default patterns set.</p>
<p>The <code class="literal">SEMANTIC</code> is the identifier you give to the piece of text being matched. For example, <code class="literal">3.44</code> could be the
duration of an event, so you could call it simply <code class="literal">duration</code>. Further, a string <code class="literal">55.3.244.1</code> might identify
the <code class="literal">client</code> making a request.</p>
<p>The <code class="literal">TYPE</code> is the type you wish to cast your named field. <code class="literal">int</code>, <code class="literal">long</code>, <code class="literal">double</code>, <code class="literal">float</code> and <code class="literal">boolean</code> are supported types for coercion.</p>
<p>For example, you might want to match the following text:</p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">3.44 55.3.244.1</pre>
</div>
<p>You may know that the message in the example is a number followed by an IP address. You can match this text by using the following
Grok expression.</p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">%{NUMBER:duration} %{IP:client}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="using-grok"></a>Using the Grok Processor in a Pipeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<div class="table">
<a id="grok-options"></a>
<p class="title"><strong>Table 19. Grok Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Grok Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to use for grok expression parsing</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">patterns</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An ordered list of grok expression to match and extract named captures with. Returns on the first expression in the list that matches.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">pattern_definitions</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>A map of pattern-name and pattern tuples defining custom patterns to be used by the current processor. Patterns matching existing names will override the pre-existing definition.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">trace_match</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>when true, <code class="literal">_ingest._grok_match_index</code> will be inserted into your matched document&#8217;s metadata with the index into the pattern found in <code class="literal">patterns</code> that matched.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example of using the provided patterns to extract out and name structured fields from a string field in
a document.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
    "description" : "...",
    "processors": [
      {
        "grok": {
          "field": "message",
          "patterns": ["%{IP:client} %{WORD:method} %{URIPATHPARAM:request} %{NUMBER:bytes:int} %{NUMBER:duration:double}"]
        }
      }
    ]
  },
  "docs":[
    {
      "_source": {
        "message": "55.3.244.1 GET /index.html 15824 0.043"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/621.console"></div>
<p>This pipeline will insert these named captures as new fields within the document, like so:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_index": "_index",
        "_type": "_doc",
        "_id": "_id",
        "_source" : {
          "duration" : 0.043,
          "request" : "/index.html",
          "method" : "GET",
          "bytes" : 15824,
          "client" : "55.3.244.1",
          "message" : "55.3.244.1 GET /index.html 15824 0.043"
        },
        "_ingest": {
          "timestamp": "2016-11-08T19:43:03.850+0000"
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="custom-patterns"></a>Custom Patterns<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>The Grok processor comes pre-packaged with a base set of patterns. These patterns may not always have
what you are looking for. Patterns have a very basic format. Each entry has a name and the pattern itself.</p>
<p>You can add your own patterns to a processor definition under the <code class="literal">pattern_definitions</code> option.
Here is an example of a pipeline specifying custom pattern definitions:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "...",
  "processors": [
    {
      "grok": {
        "field": "message",
        "patterns": ["my %{FAVORITE_DOG:dog} is colored %{RGB:color}"],
        "pattern_definitions" : {
          "FAVORITE_DOG" : "beagle",
          "RGB" : "RED|GREEN|BLUE"
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="trace-match"></a>Providing Multiple Match Patterns<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>Sometimes one pattern is not enough to capture the potential structure of a field. Let&#8217;s assume we
want to match all messages that contain your favorite pet breeds of either cats or dogs. One way to accomplish
this is to provide two distinct patterns that can be matched, instead of one really complicated expression capturing
the same <code class="literal">or</code> behavior.</p>
<p>Here is an example of such a configuration executed against the simulate API:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ingest/pipeline/_simulate
{
  "pipeline": {
  "description" : "parse multiple patterns",
  "processors": [
    {
      "grok": {
        "field": "message",
        "patterns": ["%{FAVORITE_DOG:pet}", "%{FAVORITE_CAT:pet}"],
        "pattern_definitions" : {
          "FAVORITE_DOG" : "beagle",
          "FAVORITE_CAT" : "burmese"
        }
      }
    }
  ]
},
"docs":[
  {
    "_source": {
      "message": "I love burmese cats!"
    }
  }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/622.console"></div>
<p>response:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_type": "_doc",
        "_index": "_index",
        "_id": "_id",
        "_source": {
          "message": "I love burmese cats!",
          "pet": "burmese"
        },
        "_ingest": {
          "timestamp": "2016-11-08T19:43:03.850+0000"
        }
      }
    }
  ]
}</pre>
</div>
<p>Both patterns will set the field <code class="literal">pet</code> with the appropriate match, but what if we want to trace which of our
patterns matched and populated our fields? We can do this with the <code class="literal">trace_match</code> parameter. Here is the output of
that same pipeline, but with <code class="literal">"trace_match": true</code> configured:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs": [
    {
      "doc": {
        "_type": "_doc",
        "_index": "_index",
        "_id": "_id",
        "_source": {
          "message": "I love burmese cats!",
          "pet": "burmese"
        },
        "_ingest": {
          "_grok_match_index": "1",
          "timestamp": "2016-11-08T19:43:03.850+0000"
        }
      }
    }
  ]
}</pre>
</div>
<p>In the above response, you can see that the index of the pattern that matched was <code class="literal">"1"</code>. This is to say that it was the
second (index starts at zero) pattern in <code class="literal">patterns</code> to match.</p>
<p>This trace metadata enables debugging which of the patterns matched. This information is stored in the ingest
metadata and will not be indexed.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="grok-processor-rest-get"></a>Retrieving patterns from REST endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>The Grok Processor comes packaged with its own REST endpoint for retrieving which patterns the processor is packaged with.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _ingest/processor/grok</pre>
</div>
<div class="console_widget" data-snippet="snippets/623.console"></div>
<p>The above request will return a response body containing a key-value representation of the built-in patterns dictionary.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "patterns" : {
    "BACULA_CAPACITY" : "%{INT}{1,3}(,%{INT}{3})*",
    "PATH" : "(?:%{UNIXPATH}|%{WINPATH})",
    ...
}</pre>
</div>
<p>By default, the API returns patterns in the order they are read from disk. This
sort order preserves groupings of related patterns. For example, all patterns
related to parsing Linux syslog lines stay grouped together.</p>
<p>You can use the optional boolean <code class="literal">s</code> query parameter to sort returned patterns
by key name instead.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET _ingest/processor/grok?s</pre>
</div>
<div class="console_widget" data-snippet="snippets/624.console"></div>
<p>The API returns the following response.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "patterns" : {
    "BACULA_CAPACITY" : "%{INT}{1,3}(,%{INT}{3})*",
    "BACULA_DEVICE" : "%{USER}",
    "BACULA_DEVICEPATH" : "%{UNIXPATH}",
    ...
}</pre>
</div>
<p>This can be useful to reference as the built-in patterns change across versions.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="grok-watchdog"></a>Grok watchdog<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>Grok expressions that take too long to execute are interrupted and
the grok processor then fails with an exception. The grok
processor has a watchdog thread that determines when evaluation of
a grok expression takes too long and is controlled by the following
settings:</p>
<div class="table">
<a id="grok-watchdog-options"></a>
<p class="title"><strong>Table 20. Grok watchdog settings</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Grok watchdog settings">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ingest.grok.watchdog.interval</code></p></td>
<td align="left" valign="top"><p>1s</p></td>
<td align="left" valign="top"><p>How often to check whether there are grok evaluations that take longer than the maximum allowed execution time.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ingest.grok.watchdog.max_execution_time</code></p></td>
<td align="left" valign="top"><p>1s</p></td>
<td align="left" valign="top"><p>The maximum allowed execution of a grok expression evaluation.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="grok-debugging"></a>Grok debugging<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/grok.asciidoc">edit</a></h3>
</div></div></div>
<p>It is advised to use the <a href="https://www.elastic.co/guide/en/kibana/7.10/xpack-grokdebugger.html" class="ulink" target="_top">Grok Debugger</a> to debug grok patterns. From there you can test one or more
patterns in the UI against sample data. Under the covers it uses the same engine as ingest node processor.</p>
<p>Additionally, it is recommended to enable debug logging for Grok so that any additional messages may also be seen in the Elasticsearch
server log.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">PUT _cluster/settings
{
  "transient": {
    "logger.org.elasticsearch.ingest.common.GrokProcessor": "debug"
  }
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="gsub-processor"></a>Gsub processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/gsub.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a string field by applying a regular expression and a replacement.
If the field is an array of string, all members of the array will be converted. If any non-string values are encountered, the processor will throw an exception.</p>
<div class="table">
<a id="gsub-options"></a>
<p class="title"><strong>Table 21. Gsub Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Gsub Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to apply the replacement to</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">pattern</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The pattern to be replaced</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">replacement</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The string to replace the matching patterns with</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "gsub": {
    "field": "field1",
    "pattern": "\\.",
    "replacement": "-"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="htmlstrip-processor"></a>HTML strip processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/html_strip.asciidoc">edit</a></h2>
</div></div></div>

<p>Removes HTML tags from the field. If the field is an array of strings, HTML tags will be removed from all members of the array.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Each HTML tag is replaced with a <code class="literal">\n</code> character.</p>
</div>
</div>
<div class="table">
<a id="htmlstrip-options"></a>
<p class="title"><strong>Table 22. HTML Strip Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="HTML Strip Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The string-valued field to remove HTML tags from</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "html_strip": {
    "field": "foo"
  }
}</pre>
</div>
</div>

<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="inference-processor"></a>Inference processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/inference.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Uses a pre-trained data frame analytics model to infer against the data that is being
ingested in the pipeline.</p>
<div class="table">
<a id="inference-options"></a>
<p class="title"><strong>Table 23. Inference Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Inference Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">model_id</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>(String) The ID of the model to load and infer against.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">ml.inference.&lt;processor_tag&gt;</code></p></td>
<td align="left" valign="top"><p>(String) Field added to incoming documents to contain results objects.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">field_map</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>If defined the model&#8217;s default field map</p></td>
<td align="left" valign="top"><p>(Object) Maps the document field names to the known field names of the model. This mapping takes precedence over any default mappings provided in the model configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">inference_config</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>The default settings defined in the model</p></td>
<td align="left" valign="top"><p>(Object) Contains the inference type and its options. There are two types: <a class="xref" href="ingest-processors.html#inference-processor-regression-opt" title="Regression configuration options"><code class="literal">regression</code></a> and <a class="xref" href="ingest-processors.html#inference-processor-classification-opt" title="Classification configuration options"><code class="literal">classification</code></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "inference": {
    "model_id": "flight_delay_regression-1571767128603",
    "target_field": "FlightDelayMin_prediction_infer",
    "field_map": {
      "your_field": "my_field"
    },
    "inference_config": { "regression": {} }
  }
}</pre>
</div>
<h4><a id="inference-processor-regression-opt"></a>Regression configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<p>Regression configuration for inference.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to the <code class="literal">results_field</code> value of the data frame analytics job that was
used to train the model, which defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document.
By default, it is zero and no feature importance calculation occurs.
</dd>
</dl>
</div>
<h4><a id="inference-processor-classification-opt"></a>Classification configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<p>Classification configuration for inference.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">num_top_classes</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the number of top class predictions to return. Defaults to 0.
</dd>
<dt>
<span class="term">
<code class="literal">num_top_feature_importance_values</code>
</span>
</dt>
<dd>
(Optional, integer)
Specifies the maximum number of
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-importance.html" class="ulink" target="_top">feature importance</a> values per document. By
default, it is zero and no feature importance calculation occurs.
</dd>
<dt>
<span class="term">
<code class="literal">results_field</code>
</span>
</dt>
<dd>
(Optional, string)
The field that is added to incoming documents to contain the inference
prediction. Defaults to the <code class="literal">results_field</code> value of the data frame analytics job that was
used to train the model, which defaults to <code class="literal">&lt;dependent_variable&gt;_prediction</code>.
</dd>
<dt>
<span class="term">
<code class="literal">top_classes_results_field</code>
</span>
</dt>
<dd>
(Optional, string)
Specifies the field to which the top classes are written. Defaults to
<code class="literal">top_classes</code>.
</dd>
<dt>
<span class="term">
<code class="literal">prediction_field_type</code>
</span>
</dt>
<dd>
(Optional, string)
Specifies the type of the predicted field to write.
Acceptable values are: <code class="literal">string</code>, <code class="literal">number</code>, <code class="literal">boolean</code>. When <code class="literal">boolean</code> is provided
<code class="literal">1.0</code> is transformed to <code class="literal">true</code> and <code class="literal">0.0</code> to <code class="literal">false</code>.
</dd>
</dl>
</div>
<h4><a id="inference-processor-config-example"></a><code class="literal">inference_config</code> examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"inference":{
  "model_id":"my_model_id"
  "inference_config": {
    "regression": {
      "results_field": "my_regression"
    }
  }
}</pre>
</div>
<p>This configuration specifies a <code class="literal">regression</code> inference and the results are
written to the <code class="literal">my_regression</code> field contained in the <code class="literal">target_field</code> results
object.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"inference":{
  "model_id":"my_model_id"
  "inference_config": {
    "classification": {
      "num_top_classes": 2,
      "results_field": "prediction",
      "top_classes_results_field": "probabilities"
    }
  }
}</pre>
</div>
<p>This configuration specifies a <code class="literal">classification</code> inference. The number of
categories for which the predicted probabilities are reported is 2
(<code class="literal">num_top_classes</code>). The result is written to the <code class="literal">prediction</code> field and the top
classes to the <code class="literal">probabilities</code> field. Both fields are contained in the
<code class="literal">target_field</code> results object.</p>
<p>Refer to the
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-lang-ident.html#ml-lang-ident-example" class="ulink" target="_top">language identification</a>
trained model documentation for a full example.</p>
<h4><a id="inference-processor-feature-importance"></a>Feature importance object mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/inference.asciidoc">edit</a></h4>
<p>To get the full benefit of aggregating and searching for
<a href="https://www.elastic.co/guide/en/machine-learning/7.10/ml-feature-importance.html" class="ulink" target="_top">feature importance</a>, update your index mapping of
the feature importance result field as you can see below:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"ml.inference.feature_importance": {
  "type": "nested",
  "dynamic": true,
  "properties": {
    "feature_name": {
      "type": "keyword"
    },
    "importance": {
      "type": "double"
    }
  }
}</pre>
</div>
<p>The mapping field name for feature importance (in the example above, it is
<code class="literal">ml.inference.feature_importance</code>) is compounded as follows:</p>
<p><code class="literal">&lt;ml.inference.target_field&gt;</code>.<code class="literal">&lt;inference.tag&gt;</code>.<code class="literal">feature_importance</code></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">&lt;ml.inference.target_field&gt;</code>: defaults to <code class="literal">ml.inference</code>.
</li>
<li class="listitem">
<code class="literal">&lt;inference.tag&gt;</code>: if is not provided in the processor definition, then it is
not part of the field path.
</li>
</ul>
</div>
<p>For example, if you provide a tag <code class="literal">foo</code> in the definition as you can see below:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "tag": "foo",
  ...
}</pre>
</div>
<p>Then, the feature importance value is written to the
<code class="literal">ml.inference.foo.feature_importance</code> field.</p>
<p>You can also specify the target field as follows:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "tag": "foo",
  "target_field": "my_field"
}</pre>
</div>
<p>In this case, feature importance is exposed in the
<code class="literal">my_field.foo.feature_importance</code> field.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="join-processor"></a>Join processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/join.asciidoc">edit</a></h2>
</div></div></div>

<p>Joins each element of an array into a single string using a separator character between each element.
Throws an error when the field is not an array.</p>
<div class="table">
<a id="join-options"></a>
<p class="title"><strong>Table 24. Join Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Join Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Field containing array values to join</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">separator</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The separator character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the joined value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "join": {
    "field": "joined_array_field",
    "separator": "-"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="json-processor"></a>JSON processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/json.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a JSON string into a structured JSON object.</p>
<div class="table">
<a id="json-options"></a>
<p class="title"><strong>Table 25. Json Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Json Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be parsed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field that the converted structured object will be written into. Any existing content in this field will be overwritten.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">add_to_root</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>false</p></td>
<td align="left" valign="top"><p>Flag that forces the serialized json to be injected into the top level of the document. <code class="literal">target_field</code> must not be set when this option is chosen.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>All JSON-supported types will be parsed (null, boolean, number, array, object, string).</p>
<p>Suppose you provide this configuration of the <code class="literal">json</code> processor:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "json" : {
    "field" : "string_source",
    "target_field" : "json_target"
  }
}</pre>
</div>
<p>If the following document is processed:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "string_source": "{\"foo\": 2000}"
}</pre>
</div>
<p>after the <code class="literal">json</code> processor operates on it, it will look like:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "string_source": "{\"foo\": 2000}",
  "json_target": {
    "foo": 2000
  }
}</pre>
</div>
<p>If the following configuration is provided, omitting the optional <code class="literal">target_field</code> setting:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "json" : {
    "field" : "source_and_target"
  }
}</pre>
</div>
<p>then after the <code class="literal">json</code> processor operates on this document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "source_and_target": "{\"foo\": 2000}"
}</pre>
</div>
<p>it will look like:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "source_and_target": {
    "foo": 2000
  }
}</pre>
</div>
<p>This illustrates that, unless it is explicitly named in the processor configuration, the <code class="literal">target_field</code>
is the same field provided in the required <code class="literal">field</code> configuration.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="kv-processor"></a>KV processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/kv.asciidoc">edit</a></h2>
</div></div></div>

<p>This processor helps automatically parse messages (or specific event fields) which are of the <code class="literal">foo=bar</code> variety.</p>
<p>For example, if you have a log message which contains <code class="literal">ip=1.2.3.4 error=REFUSED</code>, you can parse those fields automatically by configuring:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "kv": {
    "field": "message",
    "field_split": " ",
    "value_split": "="
  }
}</pre>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using the KV Processor can result in field names that you cannot control. Consider using the <a class="xref" href="mapping-types.html#flattened" title="Flattened field type">Flattened</a> data type instead, which maps an entire object as a single field and allows for simple searches over its contents.</p>
</div>
</div>
<div class="table">
<a id="kv-options"></a>
<p class="title"><strong>Table 26. KV Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="KV Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be parsed</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">field_split</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Regex pattern to use for splitting key-value pairs</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">value_split</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Regex pattern to use for splitting the key from the value within a key-value pair</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>The field to insert the extracted keys into. Defaults to the root of the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">include_keys</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>List of keys to filter and insert into document. Defaults to including all keys</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">exclude_keys</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>List of keys to exclude from document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">prefix</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>Prefix to be added to extracted keys</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">trim_key</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>String of characters to trim from extracted keys</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">trim_value</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
<td align="left" valign="top"><p>String of characters to trim from extracted values</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">strip_brackets</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> strip brackets <code class="literal">()</code>, <code class="literal">&lt;&gt;</code>, <code class="literal">[]</code> as well as quotes <code class="literal">'</code> and <code class="literal">"</code> from extracted values</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="lowercase-processor"></a>Lowercase processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/lowercase.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a string to its lowercase equivalent. If the field is an array of strings, all members of the array will be converted.</p>
<div class="table">
<a id="lowercase-options"></a>
<p class="title"><strong>Table 27. Lowercase Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Lowercase Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to make lowercase</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "lowercase": {
    "field": "foo"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="pipeline-processor"></a>Pipeline processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/pipeline.asciidoc">edit</a></h2>
</div></div></div>

<p>Executes another pipeline.</p>
<div class="table">
<a id="pipeline-options"></a>
<p class="title"><strong>Table 28. Pipeline Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Pipeline Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">name</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The name of the pipeline to execute. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "pipeline": {
    "name": "inner-pipeline"
  }
}</pre>
</div>
<p>The name of the current pipeline can be accessed from the <code class="literal">_ingest.pipeline</code> ingest metadata key.</p>
<p>An example of using this processor for nesting pipelines would be:</p>
<p>Define an inner pipeline:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/pipelineA
{
  "description" : "inner pipeline",
  "processors" : [
    {
      "set" : {
        "field": "inner_pipeline_set",
        "value": "inner"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/625.console"></div>
<p>Define another pipeline that uses the previously defined inner pipeline:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/pipelineB
{
  "description" : "outer pipeline",
  "processors" : [
    {
      "pipeline" : {
        "name": "pipelineA"
      }
    },
    {
      "set" : {
        "field": "outer_pipeline_set",
        "value": "outer"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/626.console"></div>
<p>Now indexing a document while applying the outer pipeline will see the inner pipeline executed
from the outer pipeline:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /my-index/_doc/1?pipeline=pipelineB
{
  "field": "value"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/627.console"></div>
<p>Response from the index request:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "_index": "my-index",
  "_type": "_doc",
  "_id": "1",
  "_version": 1,
  "result": "created",
  "_shards": {
    "total": 2,
    "successful": 1,
    "failed": 0
  },
  "_seq_no": 66,
  "_primary_term": 1,
}</pre>
</div>
<p>Indexed document:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "field": "value",
  "inner_pipeline_set": "inner",
  "outer_pipeline_set": "outer"
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="remove-processor"></a>Remove processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/remove.asciidoc">edit</a></h2>
</div></div></div>

<p>Removes existing fields. If one field doesn&#8217;t exist, an exception will be thrown.</p>
<div class="table">
<a id="remove-options"></a>
<p class="title"><strong>Table 29. Remove Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Remove Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Fields to be removed. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example to remove a single field:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "remove": {
    "field": "user_agent"
  }
}</pre>
</div>
<p>To remove multiple fields, you can use the following query:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "remove": {
    "field": ["user_agent", "url"]
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rename-processor"></a>Rename processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/rename.asciidoc">edit</a></h2>
</div></div></div>

<p>Renames an existing field. If the field doesn&#8217;t exist or the new name is already used, an exception will be thrown.</p>
<div class="table">
<a id="rename-options"></a>
<p class="title"><strong>Table 30. Rename Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Rename Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be renamed. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The new name of the field. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "rename": {
    "field": "provider",
    "target_field": "cloud.provider"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="script-processor"></a>Script processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/script.asciidoc">edit</a></h2>
</div></div></div>

<p>Allows inline and stored scripts to be executed within ingest pipelines.</p>
<p>See <a class="xref" href="modules-scripting-using.html" title="How to use scripts">How to use scripts</a> to learn more about writing scripts. The Script Processor
leverages caching of compiled scripts for improved performance. Since the
script specified within the processor is potentially re-compiled per document, it is important
to understand how script caching works. To learn more about
caching see <a class="xref" href="modules-scripting-using.html#modules-scripting-using-caching" title="Script caching">Script Caching</a>.</p>
<div class="table">
<a id="script-options"></a>
<p class="title"><strong>Table 31. Script Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Script Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">lang</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>"painless"</p></td>
<td align="left" valign="top"><p>The scripting language</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">id</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The stored script id to refer to</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">source</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An inline script to be executed</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">params</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Script Parameters</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>One of <code class="literal">id</code> or <code class="literal">source</code> options must be provided in order to properly reference a script to execute.</p>
<p>You can access the current ingest document from within the script context by using the <code class="literal">ctx</code> variable.</p>
<p>The following example sets a new field called <code class="literal">field_a_plus_b_times_c</code> to be the sum of two existing
numeric fields <code class="literal">field_a</code> and <code class="literal">field_b</code> multiplied by the parameter param_c:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "script": {
    "lang": "painless",
    "source": "ctx.field_a_plus_b_times_c = (ctx.field_a + ctx.field_b) * params.param_c",
    "params": {
      "param_c": 10
    }
  }
}</pre>
</div>
<p>It is possible to use the Script Processor to manipulate document metadata like <code class="literal">_index</code> and <code class="literal">_type</code> during
ingestion. Here is an example of an Ingest Pipeline that renames the index and type to <code class="literal">my-index</code> no matter what
was provided in the original index request:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/my-index
{
  "description": "use index:my-index",
  "processors": [
    {
      "script": {
        "source": """
          ctx._index = 'my-index';
          ctx._type = '_doc';
        """
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/628.console"></div>
<p>Using the above pipeline, we can attempt to index a document into the <code class="literal">any-index</code> index.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT any-index/_doc/1?pipeline=my-index
{
  "message": "text"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/629.console"></div>
<p>The response from the above index request:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "_index": "my-index",
  "_type": "_doc",
  "_id": "1",
  "_version": 1,
  "result": "created",
  "_shards": {
    "total": 2,
    "successful": 1,
    "failed": 0
  },
  "_seq_no": 89,
  "_primary_term": 1,
}</pre>
</div>
<p>In the above response, you can see that our document was actually indexed into <code class="literal">my-index</code> instead of
<code class="literal">any-index</code>. This type of manipulation is often convenient in pipelines that have various branches of transformation,
and depending on the progress made, indexed into different indices.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="set-processor"></a>Set processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/set.asciidoc">edit</a></h2>
</div></div></div>

<p>Sets one field and associates it with the specified value. If the field already exists,
its value will be replaced with the provided one.</p>
<div class="table">
<a id="set-options"></a>
<p class="title"><strong>Table 32. Set Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Set Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to insert, upsert, or update. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">value</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The value to be set for the field. Supports <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippets</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">override</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>true</p></td>
<td align="left" valign="top"><p>If processor will update fields with pre-existing non-null-valued field. When set to <code class="literal">false</code>, such fields will not be touched.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_empty_value</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">value</code> is a <a class="xref" href="accessing-data-in-pipelines.html#accessing-template-fields" title="Accessing Fields and Metafields in Templates">template snippet</a> that evaluates to <code class="literal">null</code> or the empty string, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "description" : "sets the value of count to 1"
  "set": {
    "field": "count",
    "value": 1
  }
}</pre>
</div>
<p>This processor can also be used to copy data from one field to another. For example:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/set_os
{
  "description": "sets the value of host.os.name from the field os",
  "processors": [
    {
      "set": {
        "field": "host.os.name",
        "value": "{{os}}"
      }
    }
  ]
}

POST _ingest/pipeline/set_os/_simulate
{
  "docs": [
    {
      "_source": {
        "os": "Ubuntu"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/630.console"></div>
<p>Result:</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "docs" : [
    {
      "doc" : {
        "_index" : "_index",
        "_type" : "_doc",
        "_id" : "_id",
        "_source" : {
          "host" : {
            "os" : {
              "name" : "Ubuntu"
            }
          },
          "os" : "Ubuntu"
        },
        "_ingest" : {
          "timestamp" : "2019-03-11T21:54:37.909224Z"
        }
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ingest-node-set-security-user-processor"></a>Set security user processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/set-security-user.asciidoc">edit</a></h2>
</div></div></div>

<p>Sets user-related details (such as <code class="literal">username</code>,  <code class="literal">roles</code>, <code class="literal">email</code>, <code class="literal">full_name</code>,
<code class="literal">metadata</code>, <code class="literal">api_key</code>, <code class="literal">realm</code> and <code class="literal">authentication_type</code>) from the current
authenticated user to the current document by pre-processing the ingest.
The <code class="literal">api_key</code> property exists only if the user authenticates with an
API key. It is an object containing the <code class="literal">id</code> and <code class="literal">name</code> fields of the API key.
The <code class="literal">realm</code> property is also an object with two fields, <code class="literal">name</code> and <code class="literal">type</code>.
When using API key authentication, the <code class="literal">realm</code> property refers to the realm
from which the API key is created.
The <code class="literal">authentication_type</code> property is a string that can take value from
<code class="literal">REALM</code>, <code class="literal">API_KEY</code>, <code class="literal">TOKEN</code> and <code class="literal">ANONYMOUS</code>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Requires an authenticated user for the index request.</p>
</div>
</div>
<div class="table">
<a id="set-security-user-options"></a>
<p class="title"><strong>Table 33. Set Security User Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Set Security User Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to store the user information into.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">properties</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>[<code class="literal">username</code>, <code class="literal">roles</code>, <code class="literal">email</code>, <code class="literal">full_name</code>, <code class="literal">metadata</code>, <code class="literal">api_key</code>, <code class="literal">realm</code>, <code class="literal">authentication_type</code>]</p></td>
<td align="left" valign="top"><p>Controls what user related properties are added to the <code class="literal">field</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The following example adds all user details for the current authenticated user
to the <code class="literal">user</code> field for all documents that are processed by this pipeline:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "processors" : [
    {
      "set_security_user": {
        "field": "user"
      }
    }
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="sort-processor"></a>Sort processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/sort.asciidoc">edit</a></h2>
</div></div></div>

<p>Sorts the elements of an array ascending or descending.  Homogeneous arrays of numbers will be sorted
numerically, while arrays of strings or heterogeneous arrays of strings + numbers will be sorted lexicographically.
Throws an error when the field is not an array.</p>
<div class="table">
<a id="sort-options"></a>
<p class="title"><strong>Table 34. Sort Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Sort Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to be sorted</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">order</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">"asc"</code></p></td>
<td align="left" valign="top"><p>The sort order to use. Accepts <code class="literal">"asc"</code> or <code class="literal">"desc"</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the sorted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "sort": {
    "field": "array_field_to_sort",
    "order": "desc"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="split-processor"></a>Split processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/split.asciidoc">edit</a></h2>
</div></div></div>

<p>Splits a field into an array using a separator character. Only works on string fields.</p>
<div class="table">
<a id="split-options"></a>
<p class="title"><strong>Table 35. Split Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Split Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to split</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">separator</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>A regex which matches the separator, eg <code class="literal">,</code> or <code class="literal">\s+</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the split value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">preserve_trailing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Preserves empty trailing fields, if any.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "split": {
    "field": "my_field",
    "separator": "\\s+" <a id="CO173-1"></a><i class="conum" data-value="1"></i>
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO173-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Treat all consecutive whitespace characters as a single separator</p>
</td>
</tr>
</table>
</div>
<p>If the <code class="literal">preserve_trailing</code> option is enabled, any trailing empty fields in the input will be preserved. For example,
in the configuration below, a value of <code class="literal">A,,B,,</code> in the <code class="literal">my_field</code> property will be split into an array of five elements
<code class="literal">["A", "", "B", "", ""]</code> with two empty trailing fields. If the <code class="literal">preserve_trailing</code> property were not enabled, the two
empty trailing fields would be discarded resulting in the three-element array <code class="literal">["A", "", "B"]</code>.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "split": {
    "field": "my_field",
    "separator": ",",
    "preserve_trailing": true
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="trim-processor"></a>Trim processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/trim.asciidoc">edit</a></h2>
</div></div></div>

<p>Trims whitespace from field. If the field is an array of strings, all members of the array will be trimmed.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This only works on leading and trailing whitespace.</p>
</div>
</div>
<div class="table">
<a id="trim-options"></a>
<p class="title"><strong>Table 36. Trim Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Trim Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The string-valued field to trim whitespace from</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the trimmed value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "trim": {
    "field": "foo"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="uppercase-processor"></a>Uppercase processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/uppercase.asciidoc">edit</a></h2>
</div></div></div>

<p>Converts a string to its uppercase equivalent. If the field is an array of strings, all members of the array will be converted.</p>
<div class="table">
<a id="uppercase-options"></a>
<p class="title"><strong>Table 37. Uppercase Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Uppercase Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to make uppercase</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "uppercase": {
    "field": "foo"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="urldecode-processor"></a>URL decode processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/url-decode.asciidoc">edit</a></h2>
</div></div></div>

<p>URL-decodes a string. If the field is an array of strings, all members of the array will be decoded.</p>
<div class="table">
<a id="urldecode-options"></a>
<p class="title"><strong>Table 38. URL Decode Options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="URL Decode Options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field to decode</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>The field to assign the converted value to, by default <code class="literal">field</code> is updated in-place</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist or is <code class="literal">null</code>, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">if</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Conditionally execute this processor.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">on_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>Handle failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_failure</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Ignore failures for this processor. See <a class="xref" href="handling-failure-in-pipelines.html" title="Handling Failures in Pipelines"><em>Handling Failures in Pipelines</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tag</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>An identifier for this processor. Useful for debugging and metrics.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "urldecode": {
    "field": "my_url_to_decode"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="user-agent-processor"></a>User agent processor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/user-agent.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">user_agent</code> processor extracts details from the user agent string a browser sends with its web requests.
This processor adds this information by default under the <code class="literal">user_agent</code> field.</p>
<p>The ingest-user-agent module ships by default with the regexes.yaml made available by uap-java with an Apache 2.0 license. For more details see <a href="https://github.com/ua-parser/uap-core" class="ulink" target="_top">https://github.com/ua-parser/uap-core</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="using-ingest-user-agent"></a>Using the user_agent Processor in a Pipeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/user-agent.asciidoc">edit</a></h3>
</div></div></div>
<div class="table">
<a id="ingest-user-agent-options"></a>
<p class="title"><strong>Table 39. User-agent options</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="User-agent options">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>yes</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The field containing the user agent string.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">target_field</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>user_agent</p></td>
<td align="left" valign="top"><p>The field that will be filled with the user agent details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">regex_file</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>-</p></td>
<td align="left" valign="top"><p>The name of the file in the <code class="literal">config/ingest-user-agent</code> directory containing the regular expressions for parsing the user agent string. Both the directory and the file have to be created before starting Elasticsearch. If not specified, ingest-user-agent will use the regexes.yaml from uap-core it ships with (see below).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">properties</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p>[<code class="literal">name</code>, <code class="literal">major</code>, <code class="literal">minor</code>, <code class="literal">patch</code>, <code class="literal">build</code>, <code class="literal">os</code>, <code class="literal">os_name</code>, <code class="literal">os_major</code>, <code class="literal">os_minor</code>, <code class="literal">device</code>]</p></td>
<td align="left" valign="top"><p>Controls what properties are added to <code class="literal">target_field</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ignore_missing</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code> and <code class="literal">field</code> does not exist, the processor quietly exits without modifying the document</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ecs</code></p></td>
<td align="left" valign="top"><p>no</p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p><span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono u-strikethrough">7.2</span>]
<span class="Admonishment-detail">
Deprecated in 7.2.
</span>
</span> Whether to return the output in Elastic Common Schema format.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Here is an example that adds the user agent details to the <code class="literal">user_agent</code> field based on the <code class="literal">agent</code> field:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/user_agent
{
  "description" : "Add user agent information",
  "processors" : [
    {
      "user_agent" : {
        "field" : "agent"
      }
    }
  ]
}
PUT my-index-000001/_doc/my_id?pipeline=user_agent
{
  "agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36"
}
GET my-index-000001/_doc/my_id</pre>
</div>
<div class="console_widget" data-snippet="snippets/631.console"></div>
<p>Which returns</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "found": true,
  "_index": "my-index-000001",
  "_type": "_doc",
  "_id": "my_id",
  "_version": 1,
  "_seq_no": 22,
  "_primary_term": 1,
  "_source": {
    "agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36",
    "user_agent": {
      "name": "Chrome",
      "original": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36",
      "version": "51.0.2704.103",
      "os": {
        "name": "Mac OS X",
        "version": "10.10.5",
        "full": "Mac OS X 10.10.5"
      },
      "device" : {
        "name" : "Mac"
      },
    }
  }
}</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_using_a_custom_regex_file"></a>Using a custom regex file<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/user-agent.asciidoc">edit</a></h4>
</div></div></div>
<p>To use a custom regex file for parsing the user agents, that file has to be put into the <code class="literal">config/ingest-user-agent</code> directory and
has to have a <code class="literal">.yml</code> filename extension. The file has to be present at node startup, any changes to it or any new files added
while the node is running will not have any effect.</p>
<p>In practice, it will make most sense for any custom regex file to be a variant of the default file, either a more recent version
or a customised version.</p>
<p>The default file included in <code class="literal">ingest-user-agent</code> is the <code class="literal">regexes.yaml</code> from uap-core: <a href="https://github.com/ua-parser/uap-core/blob/master/regexes.yaml" class="ulink" target="_top">https://github.com/ua-parser/uap-core/blob/master/regexes.yaml</a></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ingest-user-agent-settings"></a>Node Settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.10/docs/reference/ingest/processors/user-agent.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">user_agent</code> processor supports the following setting:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">ingest.user_agent.cache_size</code>
</span>
</dt>
<dd>
The maximum number of results that should be cached. Defaults to <code class="literal">1000</code>.
</dd>
</dl>
</div>
<p>Note that these settings are node settings and apply to all <code class="literal">user_agent</code> processors, i.e. there is one cache for all defined <code class="literal">user_agent</code> processors.</p>
</div>

</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ingest-enriching-data.html">« Enrich your data</a>
</span>
<span class="next">
<a href="search-your-data.html">Search your data »</a>
</span>
</div>
</div>
</body>
</html>
